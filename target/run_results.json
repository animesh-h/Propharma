{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-05-19T15:15:09.107433Z", "invocation_id": "0e5d2cac-ec62-4615-931d-56bea66dd1aa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.640654Z", "completed_at": "2025-05-19T15:15:08.651524Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.653006Z", "completed_at": "2025-05-19T15:15:08.653006Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017037153244018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_inventory", "compiled": true, "compiled_code": "\n\nwith raw_inventory as (\n    select * from \"propharma\".\"public\".\"inventory\"\n)\n\nselect\n    medicine_id,\n    stock_qty::int as stock_qty,\n    last_updated::date as last_updated\nfrom raw_inventory", "relation_name": "\"propharma\".\"public\".\"stg_inventory\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.662647Z", "completed_at": "2025-05-19T15:15:08.674118Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.676113Z", "completed_at": "2025-05-19T15:15:08.676113Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01804828643798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_medicines", "compiled": true, "compiled_code": "\n\nwith raw_medicines as (\n    select * from \"propharma\".\"public\".\"medicines\"\n)\n\nselect\n    medicine_id,\n    name,\n    category,\n    price::numeric(10,2) as price,\n    expiry_date::date as expiry_date\nfrom raw_medicines", "relation_name": "\"propharma\".\"public\".\"stg_medicines\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.683712Z", "completed_at": "2025-05-19T15:15:08.695581Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.697611Z", "completed_at": "2025-05-19T15:15:08.697611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01719212532043457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_patients", "compiled": true, "compiled_code": "\n\nwith raw_patients as (\n    select * from \"propharma\".\"public\".\"patients\"\n)\n\nselect\n    patient_id,\n    name,\n    dob::date as dob,\n    gender\nfrom raw_patients", "relation_name": "\"propharma\".\"public\".\"stg_patients\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.705624Z", "completed_at": "2025-05-19T15:15:08.714203Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.716631Z", "completed_at": "2025-05-19T15:15:08.716631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015250682830810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_prescriptions", "compiled": true, "compiled_code": "\n\nwith raw_prescriptions as (\n    select * from \"propharma\".\"public\".\"prescriptions\"\n)\n\nselect\n    prescription_id,\n    patient_id,\n    medicine_id,\n    prescribed_date,\n    quantity::int as quantity\nfrom raw_prescriptions", "relation_name": "\"propharma\".\"public\".\"stg_prescriptions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.722896Z", "completed_at": "2025-05-19T15:15:08.732138Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.734221Z", "completed_at": "2025-05-19T15:15:08.734221Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014508724212646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_sales", "compiled": true, "compiled_code": "\n\n\nwith raw_sales as (\n    select * from \"propharma\".\"public\".\"sales\"\n)\nselect\n    sale_id,\n    prescription_id,\n    medicine_id,\n    sale_date::date as sale_date,\n    quantity_sold::int,\n    amount::numeric(10,2)\nfrom raw_sales", "relation_name": "\"propharma\".\"public\".\"stg_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.740309Z", "completed_at": "2025-05-19T15:15:08.748513Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.749753Z", "completed_at": "2025-05-19T15:15:08.750763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013493537902832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.stg_suppliers", "compiled": true, "compiled_code": "\n\n\nwith raw_suppliers as (\n    select * from \"propharma\".\"public\".\"suppliers\"\n)\n\nselect\n    supplier_id,\n    supplier_name,\n    medicine_id,\n    last_supplied_date::date as last_supplied_date\nfrom raw_suppliers", "relation_name": "\"propharma\".\"public\".\"stg_suppliers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.756747Z", "completed_at": "2025-05-19T15:15:08.759738Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.761733Z", "completed_at": "2025-05-19T15:15:08.761733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007977724075317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.Propharma.sample_data", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.767751Z", "completed_at": "2025-05-19T15:15:08.786673Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.788667Z", "completed_at": "2025-05-19T15:15:08.788667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02493882179260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4", "compiled": true, "compiled_code": "\n        SELECT name\n        FROM \"propharma\".\"public\".\"medicines\"\n        WHERE TRIM(name) = ''\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.798647Z", "completed_at": "2025-05-19T15:15:08.825882Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.827880Z", "completed_at": "2025-05-19T15:15:08.827880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03521418571472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect inventory_id\nfrom \"propharma\".\"public\".\"inventory\"\nwhere inventory_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.838825Z", "completed_at": "2025-05-19T15:15:08.854783Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.857776Z", "completed_at": "2025-05-19T15:15:08.857776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024227142333984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect medicine_id\nfrom \"propharma\".\"public\".\"medicines\"\nwhere medicine_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.866774Z", "completed_at": "2025-05-19T15:15:08.881025Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.882028Z", "completed_at": "2025-05-19T15:15:08.882028Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02023935317993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect name\nfrom \"propharma\".\"public\".\"medicines\"\nwhere name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.889009Z", "completed_at": "2025-05-19T15:15:08.901157Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.903157Z", "completed_at": "2025-05-19T15:15:08.903157Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017140865325927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect patient_id\nfrom \"propharma\".\"public\".\"patients\"\nwhere patient_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.911047Z", "completed_at": "2025-05-19T15:15:08.924820Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.926835Z", "completed_at": "2025-05-19T15:15:08.926835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01817178726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prescription_id\nfrom \"propharma\".\"public\".\"prescriptions\"\nwhere prescription_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.932952Z", "completed_at": "2025-05-19T15:15:08.943922Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.945953Z", "completed_at": "2025-05-19T15:15:08.945953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015027761459350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_id\nfrom \"propharma\".\"public\".\"sales\"\nwhere sale_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.952297Z", "completed_at": "2025-05-19T15:15:08.963329Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.964332Z", "completed_at": "2025-05-19T15:15:08.964332Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016385555267333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect supplier_id\nfrom \"propharma\".\"public\".\"suppliers\"\nwhere supplier_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.972719Z", "completed_at": "2025-05-19T15:15:08.989674Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:08.990671Z", "completed_at": "2025-05-19T15:15:08.990671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02235102653503418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.expired_med_count_in_days", "compiled": true, "compiled_code": "with  __dbt__cte__date_spine as (\n\n\n\n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 10\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2025-05-15' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2025-05-25' as date)\n\n)\n\nselect * from filtered\n\n\n), spine as (\n  select min(date_day) as start_date, max(date_day) as end_date\n  from __dbt__cte__date_spine\n)\n\nselect i.stock_qty\n,m.name\n,m.expiry_date\n,-(m.price*i.stock_qty ) as \"loss\"\nfrom \"propharma\".\"public\".\"stg_medicines\" m\njoin \"propharma\".\"public\".\"stg_inventory\" i on m.medicine_id = i.medicine_id\njoin spine on 1=1\nwhere m.expiry_date between spine.start_date and spine.end_date", "relation_name": "\"propharma\".\"public\".\"expired_med_count_in_days\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:08.996659Z", "completed_at": "2025-05-19T15:15:09.008525Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.010631Z", "completed_at": "2025-05-19T15:15:09.010631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016963720321655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.mart_expired_drugs", "compiled": true, "compiled_code": "\n\nselect\n    m.medicine_id,\n    m.name,\n    m.category,\n    m.price,\n    m.expiry_date,\n    i.stock_qty,\n    i.last_updated,\n    case \n        when i.stock_qty < 20 then true\n        else false\n    end as low_stock_flag,\n    \n        true as expired\n    \nfrom \"propharma\".\"public\".\"stg_inventory\" i\njoin \"propharma\".\"public\".\"stg_medicines\" m on i.medicine_id = m.medicine_id", "relation_name": "\"propharma\".\"public\".\"mart_expired_drugs\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:09.016210Z", "completed_at": "2025-05-19T15:15:09.027248Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.028252Z", "completed_at": "2025-05-19T15:15:09.028252Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01535940170288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.mart_inventory_status", "compiled": true, "compiled_code": "\n\nselect\n    m.medicine_id,\n    m.name,\n    m.category,\n    m.price,\n    m.expiry_date,\n    i.stock_qty,\n    i.last_updated,\n    case \n        when i.stock_qty < 20 then true\n        else false\n    end as low_stock_flag\nfrom \"propharma\".\"public\".\"stg_inventory\" i\njoin \"propharma\".\"public\".\"stg_medicines\" m on i.medicine_id = m.medicine_id", "relation_name": "\"propharma\".\"public\".\"mart_inventory_status\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:09.035232Z", "completed_at": "2025-05-19T15:15:09.041217Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.042214Z", "completed_at": "2025-05-19T15:15:09.042214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009973764419555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.Propharma.snapshot_prescriptions", "compiled": true, "compiled_code": "\n\nselect * from \"propharma\".\"public\".\"stg_prescriptions\"", "relation_name": "\"propharma\".\"snapshots\".\"snapshot_prescriptions\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:09.049107Z", "completed_at": "2025-05-19T15:15:09.064807Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.065814Z", "completed_at": "2025-05-19T15:15:09.065814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02091360092163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.mart_sales_summary", "compiled": true, "compiled_code": "\n\nselect\n    date_trunc('day', sale_date) as sales_day,\n    date_trunc('month', sale_date) as sales_month,\n    count(*) as total_sales_count,\n    sum(quantity_sold)::int as total_quantity,\n    sum(amount)::numeric(10,2) as total_revenue\nfrom \"propharma\".\"public\".\"stg_sales\"\ngroup by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3\n--group by sales_day, sales_month\norder by sales_day", "relation_name": "\"propharma\".\"public\".\"mart_sales_summary\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:09.072291Z", "completed_at": "2025-05-19T15:15:09.081370Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.083461Z", "completed_at": "2025-05-19T15:15:09.083461Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014184951782226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.mart_top_customers", "compiled": true, "compiled_code": "\n\nselect\n    p.patient_id,\n    p.name,\n    count(*) as purchase_count,\n    sum(s.amount)::numeric(10,2) as total_value\nfrom \"propharma\".\"public\".\"stg_sales\" s\njoin \"propharma\".\"public\".\"stg_prescriptions\" pr on s.prescription_id = pr.prescription_id\njoin \"propharma\".\"public\".\"stg_patients\" p on pr.patient_id = p.patient_id\ngroup by p.patient_id, p.name", "relation_name": "\"propharma\".\"public\".\"mart_top_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-05-19T15:15:09.089503Z", "completed_at": "2025-05-19T15:15:09.100039Z"}, {"name": "execute", "started_at": "2025-05-19T15:15:09.101038Z", "completed_at": "2025-05-19T15:15:09.101038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013544082641601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Propharma.mart_invoice", "compiled": true, "compiled_code": "\n\nselect pat.patient_id,\n\tpat.name AS \"Patients Name\",\n\tEXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS \"Patients Age\",\n\tpre.prescribed_date as \"Prescribed Date\",\n\tpre.quantity as \"Prescribed Quantity\",\n\tmed.name as \"Medicine Name\",\n\tsup.supplier_name as \"Supplier Name\",\n\tpre.quantity * med.price::numeric(10,2) as \"Total Price\",\n\tmed.expiry_date AS \"Medicine Expiry Date\"\n\tfrom \"propharma\".\"public\".\"stg_patients\" pat\n\tjoin \"propharma\".\"public\".\"stg_prescriptions\" pre on pat.patient_id = pre.patient_id\n\tjoin \"propharma\".\"public\".\"stg_medicines\" med on pre.medicine_id = med.medicine_id\n\tjoin \"propharma\".\"public\".\"stg_suppliers\" sup on med.medicine_id = sup.medicine_id", "relation_name": "\"propharma\".\"public\".\"mart_invoice\"", "batch_results": null}], "elapsed_time": 2.406912088394165, "args": {"print": true, "version_check": true, "use_colors": true, "vars": {}, "log_level": "info", "require_explicit_package_overrides_for_builtin_materializations": true, "compile": true, "log_path": "C:\\Users\\anisin06\\Downloads\\Propharma\\logs", "cache_selected_only": false, "profiles_dir": "C:\\Users\\anisin06\\Downloads\\Propharma", "select": [], "state_modified_compare_more_unrendered_values": false, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "static": false, "state_modified_compare_vars": false, "use_colors_file": true, "static_parser": true, "strict_mode": false, "printer_width": 80, "write_json": true, "log_file_max_bytes": 10485760, "require_resource_names_without_spaces": false, "macro_debugging": false, "log_format": "default", "defer": false, "which": "generate", "require_nested_cumulative_type_params": false, "send_anonymous_usage_stats": true, "require_yaml_configuration_for_mf_time_spines": false, "empty_catalog": false, "partial_parse": true, "log_level_file": "debug", "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "favor_state": false, "quiet": false, "project_dir": "C:\\Users\\anisin06\\Downloads\\Propharma", "partial_parse_file_diff": true, "exclude": [], "introspect": true, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false, "invocation_command": "dbt docs generate", "log_format_file": "debug"}}