[0m12:25:23.976768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D0B5ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D0B52550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D06E40D0>]}


============================== 12:25:23.989528 | 292d3f67-fdf6-4bdd-98af-cfa0fe08839a ==============================
[0m12:25:23.989528 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:25:23.991672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:23.999882 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'Propharma'
[0m12:25:24.003844 [debug] [MainThread]: Command `dbt run` failed at 12:25:24.002846 after 0.71 seconds
[0m12:25:24.004840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D0B988D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D0B52810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245D0B50F90>]}
[0m12:25:24.006883 [debug] [MainThread]: Flushing usage events
[0m12:25:25.213959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:14.179890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA19937390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA18C33B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA199362D0>]}


============================== 12:26:14.187868 | 113d885a-90c5-448a-86fc-0992dc1ac75b ==============================
[0m12:26:14.187868 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:26:14.189863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:26:14.340306 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "Propharma", target "dev" invalid: 'port' is a required property
[0m12:26:14.343821 [debug] [MainThread]: Command `dbt run` failed at 12:26:14.342744 after 0.85 seconds
[0m12:26:14.344360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA19942790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA148BFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EA198D0F10>]}
[0m12:26:14.346396 [debug] [MainThread]: Flushing usage events
[0m12:26:15.497407 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:54.135623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD9F02810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDA2E4A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD6F30FD0>]}


============================== 12:26:54.144244 | 333a4dfb-b1f0-4235-90dd-dced3b72ee4e ==============================
[0m12:26:54.144244 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:26:54.146243 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:54.582564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '333a4dfb-b1f0-4235-90dd-dced3b72ee4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDA431E10>]}
[0m12:26:54.694691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '333a4dfb-b1f0-4235-90dd-dced3b72ee4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BD6F4F250>]}
[0m12:26:54.701689 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:26:55.552539 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:26:55.556530 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:26:55.557550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '333a4dfb-b1f0-4235-90dd-dced3b72ee4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDA430550>]}
[0m12:26:58.226069 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:26:58.229751 [debug] [MainThread]: Command `dbt run` failed at 12:26:58.228719 after 4.76 seconds
[0m12:26:58.230751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDB70D750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDB4A73D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025BDB7315D0>]}
[0m12:26:58.231746 [debug] [MainThread]: Flushing usage events
[0m12:26:59.406770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:40:16.766065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5449458D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B544946010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5448E1F90>]}


============================== 12:40:16.776638 | bb6b19f5-2bee-40c1-bf27-3c59d6355f09 ==============================
[0m12:40:16.776638 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:40:16.779900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:40:17.235095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb6b19f5-2bee-40c1-bf27-3c59d6355f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B544A9B650>]}
[0m12:40:17.355571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb6b19f5-2bee-40c1-bf27-3c59d6355f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B54154EC10>]}
[0m12:40:17.359561 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:40:18.252481 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:40:18.256471 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:40:18.257467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb6b19f5-2bee-40c1-bf27-3c59d6355f09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B544928DD0>]}
[0m12:40:20.845089 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:40:20.849170 [debug] [MainThread]: Command `dbt run` failed at 12:40:20.847951 after 4.77 seconds
[0m12:40:20.849710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B545AC8B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B544A8E6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B544A8C390>]}
[0m12:40:20.851452 [debug] [MainThread]: Flushing usage events
[0m12:40:22.020587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:42:45.994099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED63FED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED6052D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED63F2550>]}


============================== 12:42:46.002253 | a27aee82-bbbc-4d06-8dc5-90a5a369296f ==============================
[0m12:42:46.002253 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:42:46.004065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:42:46.449384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a27aee82-bbbc-4d06-8dc5-90a5a369296f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED63F3090>]}
[0m12:42:46.563210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a27aee82-bbbc-4d06-8dc5-90a5a369296f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED304EC50>]}
[0m12:42:46.566369 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:42:47.530707 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:42:47.534093 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:42:47.535104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a27aee82-bbbc-4d06-8dc5-90a5a369296f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED65F6AD0>]}
[0m12:42:50.909082 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:42:50.912071 [debug] [MainThread]: Command `dbt run` failed at 12:42:50.912071 after 5.58 seconds
[0m12:42:50.913068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED65F42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED659D910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017ED659F210>]}
[0m12:42:50.915063 [debug] [MainThread]: Flushing usage events
[0m12:42:52.118705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:47:02.469780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8D195350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8D1B7CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8D1B7390>]}


============================== 12:47:02.477729 | 559015e1-bfba-43a4-ad28-e7b44dcb2e24 ==============================
[0m12:47:02.477729 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:47:02.479544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:47:02.886904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '559015e1-bfba-43a4-ad28-e7b44dcb2e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8D2A5AD0>]}
[0m12:47:02.998187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '559015e1-bfba-43a4-ad28-e7b44dcb2e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A89DAD310>]}
[0m12:47:03.002145 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:47:03.818145 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:47:03.822099 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:47:03.823077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '559015e1-bfba-43a4-ad28-e7b44dcb2e24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8E376FD0>]}
[0m12:47:06.360481 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:47:06.363400 [debug] [MainThread]: Command `dbt run` failed at 12:47:06.363400 after 4.56 seconds
[0m12:47:06.364436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8E576650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8E5FF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018A8E5F5850>]}
[0m12:47:06.365399 [debug] [MainThread]: Flushing usage events
[0m12:47:07.453223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:06.132741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A3A32610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A3A3C650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A3A3CAD0>]}


============================== 12:48:06.146248 | e80b1bb4-8bf4-4dfa-a2fd-321d2361fddc ==============================
[0m12:48:06.146248 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:48:06.148238 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:06.232387 [info ] [MainThread]: dbt version: 1.9.4
[0m12:48:06.233907 [info ] [MainThread]: python version: 3.11.4
[0m12:48:06.235901 [info ] [MainThread]: python path: C:\Users\anisin06\AppData\Local\Programs\Python\Python311\python.exe
[0m12:48:06.236898 [info ] [MainThread]: os info: Windows-10-10.0.22631-SP0
[0m12:48:06.401149 [info ] [MainThread]: Using profiles dir at C:\Users\anisin06\Downloads\Propharma
[0m12:48:06.402687 [info ] [MainThread]: Using profiles.yml file at C:\Users\anisin06\Downloads\Propharma\profiles.yml
[0m12:48:06.404681 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\anisin06\Downloads\Propharma\dbt_project.yml
[0m12:48:06.408279 [info ] [MainThread]: adapter type: postgres
[0m12:48:06.410281 [info ] [MainThread]: adapter version: 1.9.0
[0m12:48:06.595826 [info ] [MainThread]: Configuration:
[0m12:48:06.598831 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:06.600768 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:06.602874 [info ] [MainThread]: Required dependencies:
[0m12:48:06.605273 [debug] [MainThread]: Executing "git --help"
[0m12:48:07.454089 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:07.456083 [debug] [MainThread]: STDERR: "b''"
[0m12:48:07.457505 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:07.460004 [info ] [MainThread]: Connection:
[0m12:48:07.462146 [info ] [MainThread]:   host: localhost
[0m12:48:07.464579 [info ] [MainThread]:   port: 5432
[0m12:48:07.467581 [info ] [MainThread]:   user: postgres
[0m12:48:07.469575 [info ] [MainThread]:   database: propharma
[0m12:48:07.471570 [info ] [MainThread]:   schema: public
[0m12:48:07.472975 [info ] [MainThread]:   connect_timeout: 10
[0m12:48:07.475704 [info ] [MainThread]:   role: None
[0m12:48:07.477709 [info ] [MainThread]:   search_path: None
[0m12:48:07.479703 [info ] [MainThread]:   keepalives_idle: 0
[0m12:48:07.482449 [info ] [MainThread]:   sslmode: None
[0m12:48:07.487942 [info ] [MainThread]:   sslcert: None
[0m12:48:07.489997 [info ] [MainThread]:   sslkey: None
[0m12:48:07.492007 [info ] [MainThread]:   sslrootcert: None
[0m12:48:07.494021 [info ] [MainThread]:   application_name: dbt
[0m12:48:07.496035 [info ] [MainThread]:   retries: 1
[0m12:48:07.499056 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:48:08.671771 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:48:09.361358 [debug] [MainThread]: Using postgres connection "debug"
[0m12:48:09.362950 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:09.363957 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:09.718836 [debug] [MainThread]: SQL status: SELECT 1 in 0.354 seconds
[0m12:48:09.720829 [debug] [MainThread]: On debug: Close
[0m12:48:09.722338 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:09.724337 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:09.729439 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:09.728205 after 4.49 seconds
[0m12:48:09.730734 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:09.732735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A2D934D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A3CAAF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229A28E4CD0>]}
[0m12:48:09.734729 [debug] [MainThread]: Flushing usage events
[0m12:48:10.959526 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:25.668646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169A2ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169A64990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169A87B90>]}


============================== 12:50:25.676092 | 89ddc822-b5b7-4c5c-83e5-90a52efe0a13 ==============================
[0m12:50:25.676092 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:50:25.678166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:50:25.680092 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path C:\Users\anisin06\Downloads\Propharma\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m12:50:25.682241 [debug] [MainThread]: Command `dbt run` failed at 12:50:25.682241 after 0.67 seconds
[0m12:50:25.684237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169682E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169A86C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022169A20F50>]}
[0m12:50:25.685233 [debug] [MainThread]: Flushing usage events
[0m12:50:26.789493 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:50:58.896402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B18EED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B1930CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B1947F90>]}


============================== 12:50:58.906272 | 47f3a5a1-e733-42a3-85d3-bbcfe359d67a ==============================
[0m12:50:58.906272 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:50:58.908515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:50:59.314332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47f3a5a1-e733-42a3-85d3-bbcfe359d67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B1A5D990>]}
[0m12:50:59.423805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47f3a5a1-e733-42a3-85d3-bbcfe359d67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AE59D510>]}
[0m12:50:59.426796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:51:00.244302 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:51:00.247926 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:51:00.249955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '47f3a5a1-e733-42a3-85d3-bbcfe359d67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B1B36AD0>]}
[0m12:51:02.889506 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:51:02.892192 [debug] [MainThread]: Command `dbt run` failed at 12:51:02.892192 after 4.68 seconds
[0m12:51:02.893218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213AC8DFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B2D48090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213B1B142D0>]}
[0m12:51:02.894226 [debug] [MainThread]: Flushing usage events
[0m12:51:03.994938 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:14.981647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021569EF75D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156A016F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021569E02650>]}


============================== 12:52:14.989724 | dc19943f-5fe0-41f3-8240-cbf83c0f72ab ==============================
[0m12:52:14.989724 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:52:14.991902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:15.396028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc19943f-5fe0-41f3-8240-cbf83c0f72ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156A048390>]}
[0m12:52:15.509137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc19943f-5fe0-41f3-8240-cbf83c0f72ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566C6EDD0>]}
[0m12:52:15.512128 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:16.356752 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:52:16.360742 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:52:16.362737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc19943f-5fe0-41f3-8240-cbf83c0f72ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156A017190>]}
[0m12:52:18.247561 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_sales (models\staging\stg_sales.sql)
  'str' object is not callable
[0m12:52:18.251290 [debug] [MainThread]: Command `dbt run` failed at 12:52:18.251290 after 3.92 seconds
[0m12:52:18.253274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021566C51050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156B458090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002156B423C90>]}
[0m12:52:18.254271 [debug] [MainThread]: Flushing usage events
[0m12:52:19.363766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:46.812292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C1695F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C1696F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C1680C10>]}


============================== 12:52:46.820431 | 421a0325-4adf-48e0-8d5d-7ea31d8be034 ==============================
[0m12:52:46.820431 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:52:46.822853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:52:47.276224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '421a0325-4adf-48e0-8d5d-7ea31d8be034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C182CB10>]}
[0m12:52:47.389016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '421a0325-4adf-48e0-8d5d-7ea31d8be034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257BE32D650>]}
[0m12:52:47.392475 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:52:48.233894 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:52:48.238540 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:52:48.239545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '421a0325-4adf-48e0-8d5d-7ea31d8be034', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C1836AD0>]}
[0m12:52:50.043666 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_sales (models\staging\stg_sales.sql)
  'str' object is not callable
[0m12:52:50.046375 [debug] [MainThread]: Command `dbt run` failed at 12:52:50.046375 after 3.90 seconds
[0m12:52:50.047413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C16A2490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C16A2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257C2C543D0>]}
[0m12:52:50.048449 [debug] [MainThread]: Flushing usage events
[0m12:52:51.102678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:53:05.305409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E8B7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E8B5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E85F190>]}


============================== 12:53:05.314384 | 95c0ba13-b282-4712-b0c8-1306a4a68ed1 ==============================
[0m12:53:05.314384 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:53:05.316379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:05.842963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95c0ba13-b282-4712-b0c8-1306a4a68ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E8C4AD0>]}
[0m12:53:05.955856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95c0ba13-b282-4712-b0c8-1306a4a68ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925B4AEF90>]}
[0m12:53:05.959035 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:53:06.810635 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:53:06.813629 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:53:06.816116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '95c0ba13-b282-4712-b0c8-1306a4a68ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925EA5AE90>]}
[0m12:53:09.496247 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_sales' (models\staging\stg_sales.sql) depends on a source named 'public.sales' which was not found
[0m12:53:09.499452 [debug] [MainThread]: Command `dbt run` failed at 12:53:09.498450 after 4.90 seconds
[0m12:53:09.500933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925FC942D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E9FE2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002925E9FD310>]}
[0m12:53:09.501951 [debug] [MainThread]: Flushing usage events
[0m12:53:10.776711 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:35.386179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172007DED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200442AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200835F10>]}


============================== 12:54:35.393697 | adcbdff4-20d5-43b6-a6de-1863646ea826 ==============================
[0m12:54:35.393697 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:54:35.396176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:35.801488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200835F90>]}
[0m12:54:35.912621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727D43D550>]}
[0m12:54:35.915614 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:54:36.727172 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:54:36.730164 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:54:36.731254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200A4F1D0>]}
[0m12:54:39.405794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017201BD6490>]}
[0m12:54:39.568363 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:54:39.581465 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:54:39.650655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017201F21590>]}
[0m12:54:39.651651 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m12:54:39.653035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172001AF8D0>]}
[0m12:54:39.658178 [info ] [MainThread]: 
[0m12:54:39.659185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:39.661996 [info ] [MainThread]: 
[0m12:54:39.663678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:39.676719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m12:54:40.142432 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m12:54:40.143429 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m12:54:40.144427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:40.548295 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.404 seconds
[0m12:54:40.551296 [debug] [ThreadPool]: On list_propharma: Close
[0m12:54:40.556308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m12:54:40.569267 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:54:40.570268 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:54:40.571720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:40.811525 [debug] [ThreadPool]: SQL status: BEGIN in 0.240 seconds
[0m12:54:40.812960 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:54:40.813968 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:40.832565 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.017 seconds
[0m12:54:40.835153 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:54:40.837156 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:54:40.839215 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m12:54:40.846256 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:54:40.847617 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:54:40.848623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:41.103752 [debug] [ThreadPool]: SQL status: BEGIN in 0.255 seconds
[0m12:54:41.106303 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:54:41.107305 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:54:41.119422 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m12:54:41.122419 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:54:41.124782 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:54:41.135927 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:41.137929 [debug] [MainThread]: On master: BEGIN
[0m12:54:41.138926 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:41.393343 [debug] [MainThread]: SQL status: BEGIN in 0.255 seconds
[0m12:54:41.394348 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:41.395352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:41.423276 [debug] [MainThread]: SQL status: SELECT 0 in 0.026 seconds
[0m12:54:41.426043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017201E5D9D0>]}
[0m12:54:41.427091 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:41.428077 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:41.429077 [debug] [MainThread]: On master: BEGIN
[0m12:54:41.431033 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:54:41.432199 [debug] [MainThread]: On master: COMMIT
[0m12:54:41.432741 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:41.433742 [debug] [MainThread]: On master: COMMIT
[0m12:54:41.435379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:41.436916 [debug] [MainThread]: On master: Close
[0m12:54:41.447532 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m12:54:41.448534 [info ] [Thread-1 (]: 1 of 10 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m12:54:41.451569 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.mart_expired_drugs'
[0m12:54:41.451569 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m12:54:41.465556 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m12:54:41.472517 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m12:54:41.536597 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m12:54:41.543696 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:54:41.545705 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m12:54:41.546702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:41.775709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m12:54:41.776705 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:54:41.777703 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    -- filter medicines with expiry_date < current_date
  );
[0m12:54:41.780209 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:41.781213 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: ROLLBACK
[0m12:54:41.782318 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m12:54:41.805040 [debug] [Thread-1 (]: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:54:41.810026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200A09E10>]}
[0m12:54:41.811023 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.mart_expired_drugs ................ [[31mERROR[0m in 0.36s]
[0m12:54:41.814139 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m12:54:41.815134 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m12:54:41.816331 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_expired_drugs' to be skipped because of status 'error'.  Reason: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql.
[0m12:54:41.817336 [info ] [Thread-1 (]: 2 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m12:54:41.820732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m12:54:41.822761 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m12:54:41.826745 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m12:54:41.829810 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m12:54:41.838790 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m12:54:41.842930 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:54:41.843937 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m12:54:41.845367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:42.211170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.366 seconds
[0m12:54:42.213163 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:54:42.214160 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    -- join inventory with medicines and flag low stock
  );
[0m12:54:42.216159 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:42.218153 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: ROLLBACK
[0m12:54:42.219151 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m12:54:42.225934 [debug] [Thread-1 (]: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:54:42.227741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720243DB10>]}
[0m12:54:42.229015 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model public.mart_inventory_status ............. [[31mERROR[0m in 0.41s]
[0m12:54:42.232452 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m12:54:42.233455 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m12:54:42.234455 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_inventory_status' to be skipped because of status 'error'.  Reason: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql.
[0m12:54:42.236445 [info ] [Thread-1 (]: 3 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m12:54:42.238440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m12:54:42.240815 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m12:54:42.248006 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m12:54:42.252944 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m12:54:42.263569 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m12:54:42.268565 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:54:42.270773 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m12:54:42.272062 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:42.541167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.269 seconds
[0m12:54:42.542542 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:54:42.543547 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    -- model to aggregate daily/monthly sales
  );
[0m12:54:42.545542 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:42.546539 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: ROLLBACK
[0m12:54:42.548534 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m12:54:42.556071 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:54:42.557069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017202429210>]}
[0m12:54:42.559064 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model public.mart_sales_summary ................ [[31mERROR[0m in 0.32s]
[0m12:54:42.561059 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m12:54:42.563506 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m12:54:42.564504 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql.
[0m12:54:42.565501 [info ] [Thread-1 (]: 4 of 10 START sql view model public.mart_top_customers ......................... [RUN]
[0m12:54:42.567500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m12:54:42.569495 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m12:54:42.574612 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m12:54:42.578610 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m12:54:42.585128 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m12:54:42.590461 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:54:42.592440 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m12:54:42.593438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:42.848504 [debug] [Thread-1 (]: SQL status: BEGIN in 0.255 seconds
[0m12:54:42.850517 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:54:42.852530 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    -- aggregate patients by purchase frequency and value
  );
[0m12:54:42.854537 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:42.856550 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: ROLLBACK
[0m12:54:42.858571 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m12:54:42.866977 [debug] [Thread-1 (]: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:54:42.868885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720224BA90>]}
[0m12:54:42.870888 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model public.mart_top_customers ................ [[31mERROR[0m in 0.30s]
[0m12:54:42.872885 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m12:54:42.874953 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m12:54:42.875962 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_top_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql.
[0m12:54:42.876972 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m12:54:42.880533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.stg_inventory)
[0m12:54:42.881544 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m12:54:42.885576 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m12:54:42.891817 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m12:54:42.899071 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m12:54:42.903102 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:54:42.905097 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m12:54:42.906095 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:43.302011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.396 seconds
[0m12:54:43.304115 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:54:43.306442 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    -- similar structure for inventory
  );
[0m12:54:43.308803 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:43.310803 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: ROLLBACK
[0m12:54:43.312797 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m12:54:43.322615 [debug] [Thread-1 (]: Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql
[0m12:54:43.325467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017202360390>]}
[0m12:54:43.327464 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model public.stg_inventory ..................... [[31mERROR[0m in 0.45s]
[0m12:54:43.331539 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m12:54:43.332583 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m12:54:43.334582 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_inventory' to be skipped because of status 'error'.  Reason: Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql.
[0m12:54:43.336597 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m12:54:43.339639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m12:54:43.340648 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m12:54:43.347942 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m12:54:43.352157 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m12:54:43.361338 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m12:54:43.366726 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:54:43.368725 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m12:54:43.369722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:43.643312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.274 seconds
[0m12:54:43.644310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:54:43.646304 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    -- similar structure for medicines
  );
[0m12:54:43.648299 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:43.649296 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: ROLLBACK
[0m12:54:43.651291 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m12:54:43.658549 [debug] [Thread-1 (]: Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql
[0m12:54:43.660009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172023BC7D0>]}
[0m12:54:43.663267 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model public.stg_medicines ..................... [[31mERROR[0m in 0.32s]
[0m12:54:43.665269 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m12:54:43.667265 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m12:54:43.668266 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_medicines' to be skipped because of status 'error'.  Reason: Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql.
[0m12:54:43.669264 [info ] [Thread-1 (]: 7 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m12:54:43.672256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m12:54:43.674707 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m12:54:43.679026 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m12:54:43.684589 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m12:54:43.695559 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m12:54:43.700797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:54:43.701794 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m12:54:43.703788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:43.952894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.249 seconds
[0m12:54:43.953901 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:54:43.956122 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    -- similar structure for patients
  );
[0m12:54:43.959145 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:43.960150 [debug] [Thread-1 (]: On model.Propharma.stg_patients: ROLLBACK
[0m12:54:43.961319 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m12:54:43.968529 [debug] [Thread-1 (]: Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql
[0m12:54:43.970525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720204A450>]}
[0m12:54:43.972519 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model public.stg_patients ...................... [[31mERROR[0m in 0.30s]
[0m12:54:43.974718 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m12:54:43.975913 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m12:54:43.977346 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql.
[0m12:54:43.978770 [info ] [Thread-1 (]: 8 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m12:54:43.981216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m12:54:43.983232 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m12:54:43.988069 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m12:54:43.993282 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m12:54:44.001777 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m12:54:44.006769 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:54:44.008940 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m12:54:44.009949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:44.263331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.253 seconds
[0m12:54:44.265382 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:54:44.266380 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    -- similar structure for prescriptions
  );
[0m12:54:44.268414 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:44.269415 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: ROLLBACK
[0m12:54:44.271426 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m12:54:44.279405 [debug] [Thread-1 (]: Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql
[0m12:54:44.281398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001720285F410>]}
[0m12:54:44.282907 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model public.stg_prescriptions ................. [[31mERROR[0m in 0.30s]
[0m12:54:44.285880 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m12:54:44.287390 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m12:54:44.289381 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_prescriptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql.
[0m12:54:44.290383 [info ] [Thread-1 (]: 9 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m12:54:44.292785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m12:54:44.295063 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m12:54:44.300836 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m12:54:44.305330 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m12:54:44.312943 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m12:54:44.316933 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:54:44.317930 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m12:54:44.319921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:44.546737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m12:54:44.547698 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:54:44.548695 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m12:54:44.560929 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m12:54:44.573043 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:54:44.574037 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m12:54:44.576169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:54:44.604088 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:54:44.605051 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:54:44.606332 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:54:44.609008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:54:44.621016 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m12:54:44.629992 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:54:44.630990 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m12:54:44.632453 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:54:44.637702 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m12:54:44.638697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017201E5D810>]}
[0m12:54:44.640660 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.35s]
[0m12:54:44.643650 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m12:54:44.644681 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m12:54:44.645679 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stg_suppliers ............................. [RUN]
[0m12:54:44.648207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m12:54:44.649214 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m12:54:44.653794 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m12:54:44.657227 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m12:54:44.664213 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m12:54:44.670481 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:54:44.671495 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m12:54:44.673877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:44.895349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m12:54:44.897072 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:54:44.898682 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    -- similar structure for suppliers
  );
[0m12:54:44.899820 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:54:44.901276 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: ROLLBACK
[0m12:54:44.903850 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m12:54:44.910042 [debug] [Thread-1 (]: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql
[0m12:54:44.912163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adcbdff4-20d5-43b6-a6de-1863646ea826', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172022FF0D0>]}
[0m12:54:44.912705 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model public.stg_suppliers .................... [[31mERROR[0m in 0.26s]
[0m12:54:44.915601 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m12:54:44.917246 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_suppliers' to be skipped because of status 'error'.  Reason: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql.
[0m12:54:44.920331 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:44.921844 [debug] [MainThread]: On master: BEGIN
[0m12:54:44.922841 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:45.155645 [debug] [MainThread]: SQL status: BEGIN in 0.232 seconds
[0m12:54:45.156655 [debug] [MainThread]: On master: COMMIT
[0m12:54:45.157736 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:45.158771 [debug] [MainThread]: On master: COMMIT
[0m12:54:45.159836 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:54:45.161154 [debug] [MainThread]: On master: Close
[0m12:54:45.162377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:45.163727 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m12:54:45.164725 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m12:54:45.165723 [debug] [MainThread]: Connection 'model.Propharma.stg_suppliers' was properly closed.
[0m12:54:45.167503 [info ] [MainThread]: 
[0m12:54:45.169540 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m12:54:45.176091 [debug] [MainThread]: Command end result
[0m12:54:45.229210 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:54:45.235400 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:54:45.250718 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:54:45.252081 [info ] [MainThread]: 
[0m12:54:45.254206 [info ] [MainThread]: [31mCompleted with 9 errors, 0 partial successes, and 0 warnings:[0m
[0m12:54:45.255243 [info ] [MainThread]: 
[0m12:54:45.256663 [error] [MainThread]:   Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:54:45.259633 [info ] [MainThread]: 
[0m12:54:45.260646 [error] [MainThread]:   Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:54:45.263116 [info ] [MainThread]: 
[0m12:54:45.267975 [error] [MainThread]:   Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:54:45.270033 [info ] [MainThread]: 
[0m12:54:45.272227 [error] [MainThread]:   Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:54:45.274244 [info ] [MainThread]: 
[0m12:54:45.276295 [error] [MainThread]:   Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql
[0m12:54:45.282279 [info ] [MainThread]: 
[0m12:54:45.284784 [error] [MainThread]:   Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql
[0m12:54:45.287127 [info ] [MainThread]: 
[0m12:54:45.290125 [error] [MainThread]:   Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql
[0m12:54:45.292120 [info ] [MainThread]: 
[0m12:54:45.294318 [error] [MainThread]:   Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql
[0m12:54:45.299174 [info ] [MainThread]: 
[0m12:54:45.301223 [error] [MainThread]:   Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql
[0m12:54:45.302226 [info ] [MainThread]: 
[0m12:54:45.304585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=9 SKIP=0 TOTAL=10
[0m12:54:45.307994 [debug] [MainThread]: Command `dbt run` failed at 12:54:45.306990 after 10.59 seconds
[0m12:54:45.308996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200840610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017200A16B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001727F5F5450>]}
[0m12:54:45.310125 [debug] [MainThread]: Flushing usage events
[0m12:54:46.727374 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:58:14.809274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751B94C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751B51650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751A942D0>]}


============================== 12:58:14.819042 | 37c24590-b638-4acd-8d37-551d35585006 ==============================
[0m12:58:14.819042 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:58:14.821067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:58:15.259364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751BDF410>]}
[0m12:58:15.377845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E7BEA10>]}
[0m12:58:15.381834 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:58:16.242659 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:58:16.695859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m12:58:16.697371 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m12:58:16.698369 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_suppliers.sql
[0m12:58:16.700526 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_inventory.sql
[0m12:58:16.701535 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_medicines.sql
[0m12:58:16.703295 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_patients.sql
[0m12:58:16.704805 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_sales.sql
[0m12:58:17.259047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751CB4950>]}
[0m12:58:17.426070 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:58:17.437043 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:58:17.497352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7532E6890>]}
[0m12:58:17.499368 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m12:58:17.500374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75313CF90>]}
[0m12:58:17.505498 [info ] [MainThread]: 
[0m12:58:17.506268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:17.507727 [info ] [MainThread]: 
[0m12:58:17.510151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:58:17.523074 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m12:58:17.907211 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m12:58:17.909178 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m12:58:17.910204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:18.424296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.515 seconds
[0m12:58:18.427296 [debug] [ThreadPool]: On list_propharma: Close
[0m12:58:18.432806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m12:58:18.443755 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:58:18.445884 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:58:18.446889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:18.667758 [debug] [ThreadPool]: SQL status: BEGIN in 0.221 seconds
[0m12:58:18.668755 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:58:18.669752 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:58:18.681723 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m12:58:18.684560 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:58:18.685560 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:58:18.687428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m12:58:18.692138 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:58:18.694683 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:58:18.695689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:18.923707 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m12:58:18.924951 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:58:18.925487 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:58:18.937475 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:58:18.940381 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:58:18.941413 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:58:18.953956 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:18.955919 [debug] [MainThread]: On master: BEGIN
[0m12:58:18.956929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:58:19.183441 [debug] [MainThread]: SQL status: BEGIN in 0.226 seconds
[0m12:58:19.184773 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:19.185775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:58:19.213012 [debug] [MainThread]: SQL status: SELECT 1 in 0.026 seconds
[0m12:58:19.216009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B752F0AA10>]}
[0m12:58:19.217006 [debug] [MainThread]: On master: ROLLBACK
[0m12:58:19.218004 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:19.219999 [debug] [MainThread]: On master: BEGIN
[0m12:58:19.220505 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:58:19.222400 [debug] [MainThread]: On master: COMMIT
[0m12:58:19.222951 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:19.224394 [debug] [MainThread]: On master: COMMIT
[0m12:58:19.225477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:19.227418 [debug] [MainThread]: On master: Close
[0m12:58:19.237222 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m12:58:19.238223 [info ] [Thread-1 (]: 1 of 10 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m12:58:19.240711 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.mart_expired_drugs'
[0m12:58:19.241767 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m12:58:19.255821 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m12:58:19.259009 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m12:58:19.325119 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m12:58:19.328649 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:58:19.330644 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m12:58:19.331641 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:58:19.663054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.332 seconds
[0m12:58:19.665049 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:58:19.667461 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    -- filter medicines with expiry_date < current_date
  );
[0m12:58:19.669456 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:58:19.670481 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: ROLLBACK
[0m12:58:19.672476 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m12:58:19.688688 [debug] [Thread-1 (]: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:58:19.693677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B753670DD0>]}
[0m12:58:19.694709 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.mart_expired_drugs ................ [[31mERROR[0m in 0.45s]
[0m12:58:19.697743 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m12:58:19.699746 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m12:58:19.700744 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_expired_drugs' to be skipped because of status 'error'.  Reason: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql.
[0m12:58:19.701741 [info ] [Thread-1 (]: 2 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m12:58:19.705289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m12:58:19.706321 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m12:58:19.711122 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m12:58:19.714475 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m12:58:19.721726 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m12:58:19.725680 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:58:19.727918 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m12:58:19.729919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:19.955948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m12:58:19.956944 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:58:19.958903 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    -- join inventory with medicines and flag low stock
  );
[0m12:58:19.959943 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:58:19.961900 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: ROLLBACK
[0m12:58:19.963926 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m12:58:19.970875 [debug] [Thread-1 (]: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:58:19.972845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75367AD90>]}
[0m12:58:19.974876 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model public.mart_inventory_status ............. [[31mERROR[0m in 0.27s]
[0m12:58:19.978138 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m12:58:19.979653 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m12:58:19.980650 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_inventory_status' to be skipped because of status 'error'.  Reason: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql.
[0m12:58:19.981643 [info ] [Thread-1 (]: 3 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m12:58:19.983897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m12:58:19.984898 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m12:58:19.988887 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m12:58:19.992881 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m12:58:20.003337 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m12:58:20.007332 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:58:20.009602 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m12:58:20.011648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:20.234627 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m12:58:20.235624 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:58:20.236622 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    -- model to aggregate daily/monthly sales
  );
[0m12:58:20.238616 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:58:20.239613 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: ROLLBACK
[0m12:58:20.241608 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m12:58:20.248622 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:58:20.249619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B753B59D10>]}
[0m12:58:20.251584 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model public.mart_sales_summary ................ [[31mERROR[0m in 0.27s]
[0m12:58:20.254227 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m12:58:20.255228 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m12:58:20.256226 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql.
[0m12:58:20.257225 [info ] [Thread-1 (]: 4 of 10 START sql view model public.mart_top_customers ......................... [RUN]
[0m12:58:20.260995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m12:58:20.261991 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m12:58:20.327984 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m12:58:20.331012 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m12:58:20.337994 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m12:58:20.342237 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:58:20.343272 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m12:58:20.345228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:20.598429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.254 seconds
[0m12:58:20.600545 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:58:20.601770 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    -- aggregate patients by purchase frequency and value
  );
[0m12:58:20.603280 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:58:20.604747 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: ROLLBACK
[0m12:58:20.606805 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m12:58:20.614131 [debug] [Thread-1 (]: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:58:20.616126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B752FDD750>]}
[0m12:58:20.618120 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model public.mart_top_customers ................ [[31mERROR[0m in 0.36s]
[0m12:58:20.620323 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m12:58:20.621831 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m12:58:20.622834 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_top_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql.
[0m12:58:20.623833 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m12:58:20.627215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.stg_inventory)
[0m12:58:20.628217 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m12:58:20.632927 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m12:58:20.636905 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m12:58:20.644617 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m12:58:20.648616 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:58:20.650515 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m12:58:20.651708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:20.881009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m12:58:20.882476 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:58:20.883927 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory;
  );
[0m12:58:20.885971 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: from raw_inventory;
                           ^

[0m12:58:20.886968 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: ROLLBACK
[0m12:58:20.888963 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m12:58:20.895944 [debug] [Thread-1 (]: Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ";"
  LINE 15: from raw_inventory;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql
[0m12:58:20.896941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B752FC9050>]}
[0m12:58:20.898938 [error] [Thread-1 (]: 5 of 10 ERROR creating sql view model public.stg_inventory ..................... [[31mERROR[0m in 0.27s]
[0m12:58:20.901930 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m12:58:20.902956 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m12:58:20.903960 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_inventory' to be skipped because of status 'error'.  Reason: Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ";"
  LINE 15: from raw_inventory;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql.
[0m12:58:20.904951 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m12:58:20.908416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m12:58:20.909435 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m12:58:20.913773 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m12:58:20.917974 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m12:58:20.924560 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m12:58:20.929178 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:58:20.930181 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m12:58:20.932175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:21.238628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.307 seconds
[0m12:58:21.240116 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:58:21.241466 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines;
  );
[0m12:58:21.243785 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: from raw_medicines;
                           ^

[0m12:58:21.245798 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: ROLLBACK
[0m12:58:21.246900 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m12:58:21.254544 [debug] [Thread-1 (]: Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ";"
  LINE 17: from raw_medicines;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql
[0m12:58:21.256564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751D08D90>]}
[0m12:58:21.257572 [error] [Thread-1 (]: 6 of 10 ERROR creating sql view model public.stg_medicines ..................... [[31mERROR[0m in 0.35s]
[0m12:58:21.260089 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m12:58:21.262086 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m12:58:21.263083 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_medicines' to be skipped because of status 'error'.  Reason: Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ";"
  LINE 17: from raw_medicines;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql.
[0m12:58:21.264108 [info ] [Thread-1 (]: 7 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m12:58:21.266074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m12:58:21.268065 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m12:58:21.272058 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m12:58:21.277044 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m12:58:21.285026 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m12:58:21.289017 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:58:21.291011 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m12:58:21.292059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:21.529197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.238 seconds
[0m12:58:21.531216 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:58:21.532227 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients;
  );
[0m12:58:21.534517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: from raw_patients;
                          ^

[0m12:58:21.535560 [debug] [Thread-1 (]: On model.Propharma.stg_patients: ROLLBACK
[0m12:58:21.536569 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m12:58:21.544558 [debug] [Thread-1 (]: Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ";"
  LINE 16: from raw_patients;
                            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql
[0m12:58:21.546553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B753B5B490>]}
[0m12:58:21.548550 [error] [Thread-1 (]: 7 of 10 ERROR creating sql view model public.stg_patients ...................... [[31mERROR[0m in 0.28s]
[0m12:58:21.551409 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m12:58:21.552410 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m12:58:21.553408 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_patients' to be skipped because of status 'error'.  Reason: Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ";"
  LINE 16: from raw_patients;
                            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql.
[0m12:58:21.555398 [info ] [Thread-1 (]: 8 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m12:58:21.558115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m12:58:21.559111 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m12:58:21.563100 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m12:58:21.567368 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m12:58:21.574354 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m12:58:21.578347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:58:21.579344 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m12:58:21.581337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:21.903701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.322 seconds
[0m12:58:21.904840 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:58:21.906383 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions;
  );
[0m12:58:21.908639 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: from raw_prescriptions;
                               ^

[0m12:58:21.910641 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: ROLLBACK
[0m12:58:21.911638 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m12:58:21.918206 [debug] [Thread-1 (]: Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ";"
  LINE 17: from raw_prescriptions;
                                 ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql
[0m12:58:21.920206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B753737F10>]}
[0m12:58:21.922239 [error] [Thread-1 (]: 8 of 10 ERROR creating sql view model public.stg_prescriptions ................. [[31mERROR[0m in 0.36s]
[0m12:58:21.925434 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m12:58:21.926398 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m12:58:21.927428 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_prescriptions' to be skipped because of status 'error'.  Reason: Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ";"
  LINE 17: from raw_prescriptions;
                                 ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql.
[0m12:58:21.928399 [info ] [Thread-1 (]: 9 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m12:58:21.931185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m12:58:21.932187 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m12:58:21.936069 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m12:58:21.941025 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m12:58:21.950352 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m12:58:21.953344 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:58:21.955693 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m12:58:21.956759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:22.181415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m12:58:22.183403 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:58:22.184514 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales;
  );
[0m12:58:22.185528 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: from raw_sales;
                       ^

[0m12:58:22.186874 [debug] [Thread-1 (]: On model.Propharma.stg_sales: ROLLBACK
[0m12:58:22.188884 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m12:58:22.195721 [debug] [Thread-1 (]: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 17: from raw_sales;
                         ^
  compiled code at target\run\Propharma\models\staging\stg_sales.sql
[0m12:58:22.197796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7516B3010>]}
[0m12:58:22.198835 [error] [Thread-1 (]: 9 of 10 ERROR creating sql view model public.stg_sales ......................... [[31mERROR[0m in 0.27s]
[0m12:58:22.201149 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m12:58:22.202182 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m12:58:22.204168 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 17: from raw_sales;
                         ^
  compiled code at target\run\Propharma\models\staging\stg_sales.sql.
[0m12:58:22.205237 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stg_suppliers ............................. [RUN]
[0m12:58:22.207577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m12:58:22.209578 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m12:58:22.213567 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m12:58:22.216987 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m12:58:22.225796 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m12:58:22.229828 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:58:22.231507 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m12:58:22.231507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:58:22.462959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m12:58:22.464676 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:58:22.465715 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers;
  );
[0m12:58:22.467647 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: from raw_suppliers;
                           ^

[0m12:58:22.469081 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: ROLLBACK
[0m12:58:22.471305 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m12:58:22.477714 [debug] [Thread-1 (]: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ";"
  LINE 16: from raw_suppliers;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql
[0m12:58:22.479709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37c24590-b638-4acd-8d37-551d35585006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75150D2D0>]}
[0m12:58:22.481704 [error] [Thread-1 (]: 10 of 10 ERROR creating sql view model public.stg_suppliers .................... [[31mERROR[0m in 0.27s]
[0m12:58:22.483699 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m12:58:22.486181 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.stg_suppliers' to be skipped because of status 'error'.  Reason: Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ";"
  LINE 16: from raw_suppliers;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql.
[0m12:58:22.488540 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:22.490596 [debug] [MainThread]: On master: BEGIN
[0m12:58:22.491599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:58:22.724231 [debug] [MainThread]: SQL status: BEGIN in 0.233 seconds
[0m12:58:22.726230 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.727227 [debug] [MainThread]: Using postgres connection "master"
[0m12:58:22.729221 [debug] [MainThread]: On master: COMMIT
[0m12:58:22.731384 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:58:22.732434 [debug] [MainThread]: On master: Close
[0m12:58:22.734435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:22.735432 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m12:58:22.736438 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m12:58:22.736438 [debug] [MainThread]: Connection 'model.Propharma.stg_suppliers' was properly closed.
[0m12:58:22.738910 [info ] [MainThread]: 
[0m12:58:22.739915 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m12:58:22.745552 [debug] [MainThread]: Command end result
[0m12:58:22.798318 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:58:22.804297 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:58:22.818764 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:58:22.819762 [info ] [MainThread]: 
[0m12:58:22.822303 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m12:58:22.824319 [info ] [MainThread]: 
[0m12:58:22.826395 [error] [MainThread]:   Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:58:22.827652 [info ] [MainThread]: 
[0m12:58:22.830128 [error] [MainThread]:   Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:58:22.830980 [info ] [MainThread]: 
[0m12:58:22.833661 [error] [MainThread]:   Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:58:22.834655 [info ] [MainThread]: 
[0m12:58:22.837002 [error] [MainThread]:   Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:58:22.838005 [info ] [MainThread]: 
[0m12:58:22.840262 [error] [MainThread]:   Database Error in model stg_inventory (models\staging\stg_inventory.sql)
  syntax error at or near ";"
  LINE 15: from raw_inventory;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_inventory.sql
[0m12:58:22.841278 [info ] [MainThread]: 
[0m12:58:22.851172 [error] [MainThread]:   Database Error in model stg_medicines (models\staging\stg_medicines.sql)
  syntax error at or near ";"
  LINE 17: from raw_medicines;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_medicines.sql
[0m12:58:22.854106 [info ] [MainThread]: 
[0m12:58:22.855149 [error] [MainThread]:   Database Error in model stg_patients (models\staging\stg_patients.sql)
  syntax error at or near ";"
  LINE 16: from raw_patients;
                            ^
  compiled code at target\run\Propharma\models\staging\stg_patients.sql
[0m12:58:22.857450 [info ] [MainThread]: 
[0m12:58:22.859451 [error] [MainThread]:   Database Error in model stg_prescriptions (models\staging\stg_prescriptions.sql)
  syntax error at or near ";"
  LINE 17: from raw_prescriptions;
                                 ^
  compiled code at target\run\Propharma\models\staging\stg_prescriptions.sql
[0m12:58:22.863440 [info ] [MainThread]: 
[0m12:58:22.864468 [error] [MainThread]:   Database Error in model stg_sales (models\staging\stg_sales.sql)
  syntax error at or near ";"
  LINE 17: from raw_sales;
                         ^
  compiled code at target\run\Propharma\models\staging\stg_sales.sql
[0m12:58:22.866231 [info ] [MainThread]: 
[0m12:58:22.867718 [error] [MainThread]:   Database Error in model stg_suppliers (models\staging\stg_suppliers.sql)
  syntax error at or near ";"
  LINE 16: from raw_suppliers;
                             ^
  compiled code at target\run\Propharma\models\staging\stg_suppliers.sql
[0m12:58:22.869718 [info ] [MainThread]: 
[0m12:58:22.870926 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=10 SKIP=0 TOTAL=10
[0m12:58:22.874554 [debug] [MainThread]: Command `dbt run` failed at 12:58:22.874554 after 8.75 seconds
[0m12:58:22.876666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74CA7EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7535F91D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74CA89750>]}
[0m12:58:22.879226 [debug] [MainThread]: Flushing usage events
[0m12:58:24.155149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:59:26.659628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FCB64D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FCB6910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FCB7150>]}


============================== 12:59:26.672882 | a59875dc-ded5-4d60-947b-6a310a099c3e ==============================
[0m12:59:26.672882 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:59:26.675600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:59:27.155426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FCB5E50>]}
[0m12:59:27.303880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4C8AEA50>]}
[0m12:59:27.307029 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:59:28.198893 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:59:28.634111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m12:59:28.636069 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m12:59:28.637797 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_patients.sql
[0m12:59:28.638798 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_sales.sql
[0m12:59:28.640793 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_suppliers.sql
[0m12:59:28.641790 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_medicines.sql
[0m12:59:28.642787 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_inventory.sql
[0m12:59:29.192389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE51263E50>]}
[0m12:59:29.357152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:59:29.369571 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:59:29.433274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE513E1CD0>]}
[0m12:59:29.434272 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m12:59:29.436013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FE693D0>]}
[0m12:59:29.441003 [info ] [MainThread]: 
[0m12:59:29.442007 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:29.444361 [info ] [MainThread]: 
[0m12:59:29.445776 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:59:29.459700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m12:59:29.878051 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m12:59:29.879048 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m12:59:29.880047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:30.225184 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.345 seconds
[0m12:59:30.228145 [debug] [ThreadPool]: On list_propharma: Close
[0m12:59:30.232813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m12:59:30.244475 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:59:30.245010 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:59:30.246016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:30.473396 [debug] [ThreadPool]: SQL status: BEGIN in 0.227 seconds
[0m12:59:30.474409 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:59:30.475412 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:59:30.487708 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.011 seconds
[0m12:59:30.490726 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:59:30.491729 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:59:30.494228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m12:59:30.499214 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:59:30.500212 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:59:30.502726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:30.751157 [debug] [ThreadPool]: SQL status: BEGIN in 0.248 seconds
[0m12:59:30.752830 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:59:30.755154 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:59:30.766273 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m12:59:30.770263 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:59:30.771268 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:59:30.784847 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:30.786695 [debug] [MainThread]: On master: BEGIN
[0m12:59:30.787700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:59:31.146667 [debug] [MainThread]: SQL status: BEGIN in 0.359 seconds
[0m12:59:31.147704 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:31.148709 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:59:31.179710 [debug] [MainThread]: SQL status: SELECT 1 in 0.029 seconds
[0m12:59:31.182703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5177DBD0>]}
[0m12:59:31.184669 [debug] [MainThread]: On master: ROLLBACK
[0m12:59:31.186788 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:31.187788 [debug] [MainThread]: On master: BEGIN
[0m12:59:31.190003 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:59:31.190966 [debug] [MainThread]: On master: COMMIT
[0m12:59:31.192468 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:31.193502 [debug] [MainThread]: On master: COMMIT
[0m12:59:31.194922 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:31.195427 [debug] [MainThread]: On master: Close
[0m12:59:31.205462 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m12:59:31.206494 [info ] [Thread-1 (]: 1 of 10 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m12:59:31.209281 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.mart_expired_drugs'
[0m12:59:31.210314 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m12:59:31.224526 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m12:59:31.227511 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m12:59:31.295517 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m12:59:31.299473 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:59:31.300474 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m12:59:31.302989 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:59:31.532326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m12:59:31.534296 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:59:31.535589 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    -- filter medicines with expiry_date < current_date
  );
[0m12:59:31.537308 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:59:31.538383 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: ROLLBACK
[0m12:59:31.539876 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m12:59:31.554569 [debug] [Thread-1 (]: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:59:31.558495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE513090D0>]}
[0m12:59:31.559756 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.mart_expired_drugs ................ [[31mERROR[0m in 0.35s]
[0m12:59:31.563267 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m12:59:31.565266 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m12:59:31.566600 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_expired_drugs' to be skipped because of status 'error'.  Reason: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql.
[0m12:59:31.567603 [info ] [Thread-1 (]: 2 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m12:59:31.570757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m12:59:31.572911 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m12:59:31.576899 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m12:59:31.580946 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m12:59:31.587834 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m12:59:31.590829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:59:31.592620 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m12:59:31.594276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:31.822550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m12:59:31.823547 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:59:31.824576 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    -- join inventory with medicines and flag low stock
  );
[0m12:59:31.826053 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:59:31.828052 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: ROLLBACK
[0m12:59:31.829049 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m12:59:31.836952 [debug] [Thread-1 (]: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:59:31.838944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE51BCD790>]}
[0m12:59:31.839911 [error] [Thread-1 (]: 2 of 10 ERROR creating sql view model public.mart_inventory_status ............. [[31mERROR[0m in 0.27s]
[0m12:59:31.842732 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m12:59:31.844732 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m12:59:31.845771 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_inventory_status' to be skipped because of status 'error'.  Reason: Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql.
[0m12:59:31.846759 [info ] [Thread-1 (]: 3 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m12:59:31.848911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m12:59:31.850917 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m12:59:31.855057 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m12:59:31.858049 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m12:59:31.868352 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m12:59:31.872373 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:59:31.874370 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m12:59:31.875371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:32.100744 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m12:59:32.102265 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:59:32.103271 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    -- model to aggregate daily/monthly sales
  );
[0m12:59:32.104268 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:59:32.106603 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: ROLLBACK
[0m12:59:32.108111 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m12:59:32.115598 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:59:32.117070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE51BD0150>]}
[0m12:59:32.118988 [error] [Thread-1 (]: 3 of 10 ERROR creating sql view model public.mart_sales_summary ................ [[31mERROR[0m in 0.27s]
[0m12:59:32.121487 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m12:59:32.123487 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m12:59:32.124514 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql.
[0m12:59:32.125511 [info ] [Thread-1 (]: 4 of 10 START sql view model public.mart_top_customers ......................... [RUN]
[0m12:59:32.127775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m12:59:32.129443 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m12:59:32.199906 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m12:59:32.203615 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m12:59:32.210596 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m12:59:32.214588 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:59:32.215584 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m12:59:32.217579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:32.451538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m12:59:32.452076 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:59:32.453745 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    -- aggregate patients by purchase frequency and value
  );
[0m12:59:32.455427 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m12:59:32.456377 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: ROLLBACK
[0m12:59:32.458408 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m12:59:32.464368 [debug] [Thread-1 (]: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:59:32.466975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE5104B9D0>]}
[0m12:59:32.468976 [error] [Thread-1 (]: 4 of 10 ERROR creating sql view model public.mart_top_customers ................ [[31mERROR[0m in 0.34s]
[0m12:59:32.470840 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m12:59:32.471874 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m12:59:32.473805 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_top_customers' to be skipped because of status 'error'.  Reason: Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql.
[0m12:59:32.474341 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m12:59:32.477338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.stg_inventory)
[0m12:59:32.478372 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m12:59:32.483767 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m12:59:32.488783 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m12:59:32.495874 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m12:59:32.500192 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:59:32.501765 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m12:59:32.503304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:32.736403 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m12:59:32.737402 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:59:32.738429 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m12:59:32.747333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:59:32.760302 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:59:32.762298 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m12:59:32.763295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:32.797366 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m12:59:32.799429 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:59:32.801431 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m12:59:32.803938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:59:32.815911 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m12:59:32.825340 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:59:32.827305 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m12:59:32.828495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:59:32.833622 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m12:59:32.835184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE512B59D0>]}
[0m12:59:32.837158 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m12:59:32.839739 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m12:59:32.841738 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m12:59:32.843732 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m12:59:32.846054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m12:59:32.847051 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m12:59:32.851977 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m12:59:32.854972 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m12:59:32.862714 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m12:59:32.866011 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:59:32.868046 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m12:59:32.869109 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:33.108454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m12:59:33.109951 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:59:33.110993 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m12:59:33.121765 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:59:33.127797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:59:33.129747 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m12:59:33.130783 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:33.135501 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m12:59:33.136501 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:59:33.137495 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m12:59:33.140457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:59:33.147887 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m12:59:33.149890 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:59:33.151911 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m12:59:33.153617 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:59:33.156646 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m12:59:33.157611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE51832D10>]}
[0m12:59:33.159075 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m12:59:33.162188 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m12:59:33.164359 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m12:59:33.166089 [info ] [Thread-1 (]: 7 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m12:59:33.168114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m12:59:33.169109 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m12:59:33.173127 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m12:59:33.176160 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m12:59:33.184389 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m12:59:33.188378 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:59:33.189415 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m12:59:33.190409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:33.422543 [debug] [Thread-1 (]: SQL status: BEGIN in 0.232 seconds
[0m12:59:33.424538 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:59:33.425535 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m12:59:33.435536 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:59:33.441520 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:59:33.442517 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m12:59:33.444605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:33.448065 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m12:59:33.449325 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:59:33.450502 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m12:59:33.453662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:59:33.459060 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m12:59:33.460355 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:59:33.461390 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m12:59:33.463439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:59:33.466577 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m12:59:33.468599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4CDC0F90>]}
[0m12:59:33.469626 [info ] [Thread-1 (]: 7 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m12:59:33.472946 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m12:59:33.473943 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m12:59:33.475940 [info ] [Thread-1 (]: 8 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m12:59:33.478230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m12:59:33.479234 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m12:59:33.484252 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m12:59:33.487862 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m12:59:33.495547 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m12:59:33.500454 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:59:33.501457 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m12:59:33.502456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:33.869610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.367 seconds
[0m12:59:33.870635 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:59:33.872600 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m12:59:33.881824 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:59:33.887518 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:59:33.889479 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m12:59:33.890484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:33.893502 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m12:59:33.895703 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:59:33.896707 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m12:59:33.903110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:59:33.908227 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m12:59:33.910192 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:59:33.911220 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m12:59:33.913215 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:59:33.916036 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m12:59:33.918574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FE08150>]}
[0m12:59:33.919576 [info ] [Thread-1 (]: 8 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m12:59:33.922908 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m12:59:33.923904 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m12:59:33.925990 [info ] [Thread-1 (]: 9 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m12:59:33.928190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m12:59:33.929187 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m12:59:33.935210 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m12:59:33.939204 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m12:59:33.946953 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m12:59:33.951275 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:33.953335 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m12:59:33.954338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:34.183977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m12:59:34.185937 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:34.186934 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m12:59:34.195980 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:59:34.203497 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:34.205021 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m12:59:34.206053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:34.216027 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:34.217024 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m12:59:34.218021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:34.225010 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:59:34.226973 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:34.227973 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:59:34.237624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:59:34.243029 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m12:59:34.244027 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:59:34.246522 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m12:59:34.253594 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m12:59:34.257265 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m12:59:34.258303 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4FE57890>]}
[0m12:59:34.260261 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m12:59:34.263256 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m12:59:34.264250 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m12:59:34.266351 [info ] [Thread-1 (]: 10 of 10 START sql view model public.stg_suppliers ............................. [RUN]
[0m12:59:34.268373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m12:59:34.269384 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m12:59:34.274079 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m12:59:34.279320 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m12:59:34.288012 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m12:59:34.292129 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:59:34.293500 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m12:59:34.294526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:59:34.520165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m12:59:34.522162 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:59:34.523157 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m12:59:34.532786 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:59:34.538728 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:59:34.539756 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m12:59:34.541721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:59:34.544715 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m12:59:34.545714 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:59:34.546737 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m12:59:34.558276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m12:59:34.565823 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m12:59:34.567849 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:59:34.568845 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m12:59:34.570838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:59:34.574104 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m12:59:34.575139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a59875dc-ded5-4d60-947b-6a310a099c3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE51705C10>]}
[0m12:59:34.577553 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.stg_suppliers ........................ [[32mCREATE VIEW[0m in 0.31s]
[0m12:59:34.579736 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m12:59:34.582407 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:34.584002 [debug] [MainThread]: On master: BEGIN
[0m12:59:34.585008 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:59:34.820946 [debug] [MainThread]: SQL status: BEGIN in 0.236 seconds
[0m12:59:34.822551 [debug] [MainThread]: On master: COMMIT
[0m12:59:34.823586 [debug] [MainThread]: Using postgres connection "master"
[0m12:59:34.824581 [debug] [MainThread]: On master: COMMIT
[0m12:59:34.825577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:59:34.826544 [debug] [MainThread]: On master: Close
[0m12:59:34.828543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:34.829711 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m12:59:34.830714 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m12:59:34.833101 [debug] [MainThread]: Connection 'model.Propharma.stg_suppliers' was properly closed.
[0m12:59:34.834365 [info ] [MainThread]: 
[0m12:59:34.835367 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 5.39 seconds (5.39s).
[0m12:59:34.840858 [debug] [MainThread]: Command end result
[0m12:59:34.903445 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:59:34.910206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:59:34.924710 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:59:34.925692 [info ] [MainThread]: 
[0m12:59:34.928125 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:59:34.929604 [info ] [MainThread]: 
[0m12:59:34.933160 [error] [MainThread]:   Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m12:59:34.935248 [info ] [MainThread]: 
[0m12:59:34.937192 [error] [MainThread]:   Database Error in model mart_inventory_status (models\marts\mart_inventory_status.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_inventory_status.sql
[0m12:59:34.937717 [info ] [MainThread]: 
[0m12:59:34.939648 [error] [MainThread]:   Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_sales_summary.sql
[0m12:59:34.940923 [info ] [MainThread]: 
[0m12:59:34.943197 [error] [MainThread]:   Database Error in model mart_top_customers (models\marts\mart_top_customers.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_top_customers.sql
[0m12:59:34.949408 [info ] [MainThread]: 
[0m12:59:34.951410 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m12:59:34.954761 [debug] [MainThread]: Command `dbt run` failed at 12:59:34.954761 after 9.00 seconds
[0m12:59:34.955767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F8B2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4F8B2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE4ABDEF50>]}
[0m12:59:34.956764 [debug] [MainThread]: Flushing usage events
[0m12:59:36.277666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:24.568060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFB9ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFBF59D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFBF7B90>]}


============================== 13:05:24.577038 | dc31e228-e283-46bb-8ef2-fce170ebc1ae ==============================
[0m13:05:24.577038 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:05:24.579036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:05:25.011667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFB93050>]}
[0m13:05:25.132245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABC87EB10>]}
[0m13:05:25.135418 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:25.966921 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:05:26.433173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m13:05:26.435168 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_inventory_status.sql
[0m13:05:26.436166 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_top_customers.sql
[0m13:05:26.437163 [debug] [MainThread]: Partial parsing: updated file: Propharma://macros\utils.sql
[0m13:05:26.438160 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_sales_summary.sql
[0m13:05:26.994085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC0D90E50>]}
[0m13:05:27.157107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:05:27.168150 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:05:27.232761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC12B1310>]}
[0m13:05:27.234757 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 433 macros
[0m13:05:27.235937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1174F50>]}
[0m13:05:27.240978 [info ] [MainThread]: 
[0m13:05:27.242019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:27.244022 [info ] [MainThread]: 
[0m13:05:27.245019 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:27.259952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:05:27.663487 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:05:27.664496 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:05:27.665505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:27.929188 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.264 seconds
[0m13:05:27.932183 [debug] [ThreadPool]: On list_propharma: Close
[0m13:05:27.937678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m13:05:27.950152 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:05:27.952408 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:05:27.954403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:28.202043 [debug] [ThreadPool]: SQL status: BEGIN in 0.248 seconds
[0m13:05:28.203087 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:05:28.204633 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:05:28.217691 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.012 seconds
[0m13:05:28.220969 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:05:28.222964 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:05:28.225426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m13:05:28.231261 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:05:28.232445 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:05:28.233451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:28.625333 [debug] [ThreadPool]: SQL status: BEGIN in 0.392 seconds
[0m13:05:28.626677 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:05:28.627976 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:28.640053 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.011 seconds
[0m13:05:28.643044 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:05:28.644042 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:05:28.658593 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:28.659591 [debug] [MainThread]: On master: BEGIN
[0m13:05:28.660588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:28.892573 [debug] [MainThread]: SQL status: BEGIN in 0.232 seconds
[0m13:05:28.894566 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:28.895563 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:28.931158 [debug] [MainThread]: SQL status: SELECT 6 in 0.034 seconds
[0m13:05:28.936967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC12A6750>]}
[0m13:05:28.937964 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:28.940319 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:28.941320 [debug] [MainThread]: On master: BEGIN
[0m13:05:28.942551 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:28.943558 [debug] [MainThread]: On master: COMMIT
[0m13:05:28.946060 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:28.948156 [debug] [MainThread]: On master: COMMIT
[0m13:05:28.950417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:28.952485 [debug] [MainThread]: On master: Close
[0m13:05:28.966475 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:05:28.968579 [info ] [Thread-1 (]: 1 of 10 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m13:05:28.971780 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.mart_expired_drugs'
[0m13:05:28.972796 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:05:28.990798 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:05:28.995823 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:05:29.084236 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:05:29.088350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:05:29.089755 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:05:29.090953 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:29.348189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m13:05:29.349248 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:05:29.351250 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    -- filter medicines with expiry_date < current_date
  );
[0m13:05:29.352244 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m13:05:29.355381 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: ROLLBACK
[0m13:05:29.357894 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:05:29.377840 [debug] [Thread-1 (]: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m13:05:29.383825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC158EA90>]}
[0m13:05:29.385819 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.mart_expired_drugs ................ [[31mERROR[0m in 0.41s]
[0m13:05:29.389068 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:05:29.391063 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:05:29.392064 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_expired_drugs' to be skipped because of status 'error'.  Reason: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql.
[0m13:05:29.393062 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m13:05:29.396841 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.stg_inventory)
[0m13:05:29.398836 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:05:29.403824 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:05:29.408431 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:05:29.416527 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:05:29.420957 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.422344 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:05:29.423348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:29.771470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.348 seconds
[0m13:05:29.772544 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.775425 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m13:05:29.785977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:05:29.799891 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.800886 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:05:29.803095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:29.811947 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.812944 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:05:29.814939 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:29.906311 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:05:29.907350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.908345 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:05:29.911202 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:29.923210 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:05:29.933050 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:29.934052 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:05:29.937473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:29.942693 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:05:29.943655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1AD2FD0>]}
[0m13:05:29.945686 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.55s]
[0m13:05:29.949011 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:05:29.950634 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:05:29.952637 [info ] [Thread-1 (]: 3 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m13:05:29.954629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:05:29.955656 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:05:29.959626 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:05:29.963584 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:05:29.970596 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:05:29.974560 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:29.975557 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:05:29.977551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:30.338319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.361 seconds
[0m13:05:30.339496 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:30.341874 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m13:05:30.353907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:05:30.361659 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:30.362659 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m13:05:30.364652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:30.370636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:30.371636 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:05:30.373632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:30.377651 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:05:30.378651 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:30.379646 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:05:30.382868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:30.387745 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:05:30.389744 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:30.390777 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:05:30.394543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:30.397177 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:05:30.399486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1000950>]}
[0m13:05:30.400489 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:05:30.403480 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:05:30.404519 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:05:30.406094 [info ] [Thread-1 (]: 4 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m13:05:30.408604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:05:30.409640 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:05:30.413503 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:05:30.416478 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:05:30.425759 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:05:30.429718 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.430741 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:05:30.431743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:30.649052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m13:05:30.651047 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.652132 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m13:05:30.660396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:05:30.667044 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.668889 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:05:30.670924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:30.676871 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.678902 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:05:30.680875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:30.684273 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:05:30.685233 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.686813 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:05:30.690992 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:05:30.700148 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:05:30.702181 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:30.703178 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:05:30.706369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:30.710096 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:05:30.712244 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC1639CD0>]}
[0m13:05:30.713829 [info ] [Thread-1 (]: 4 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.30s]
[0m13:05:30.716607 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:05:30.717605 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:05:30.719599 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m13:05:30.721678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:05:30.722681 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:05:30.727667 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:05:30.731938 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:05:30.740434 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:05:30.744911 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:30.746902 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:05:30.747902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:31.002108 [debug] [Thread-1 (]: SQL status: BEGIN in 0.254 seconds
[0m13:05:31.003115 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:31.004391 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m13:05:31.013594 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:31.020302 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:31.021306 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:05:31.023918 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.030233 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:31.031640 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:05:31.032911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.036073 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:05:31.037074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:31.039034 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:05:31.041933 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:31.048136 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:05:31.050131 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:31.051128 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:05:31.054428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:31.057537 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:05:31.059532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC0FD7850>]}
[0m13:05:31.061528 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.34s]
[0m13:05:31.063951 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:05:31.064947 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:05:31.066942 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m13:05:31.068939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:05:31.069950 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:05:31.074256 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:05:31.077345 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:05:31.085417 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:05:31.090221 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.091218 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:05:31.092219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:31.424881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.332 seconds
[0m13:05:31.425880 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.426877 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m13:05:31.437847 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:05:31.444825 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.445822 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:05:31.447817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.454800 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.455797 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:05:31.458790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.461783 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:05:31.463918 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.464962 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:05:31.467956 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:31.473939 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:05:31.475934 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:31.477931 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:05:31.480921 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:31.484910 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:05:31.486907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC168AF10>]}
[0m13:05:31.488901 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.42s]
[0m13:05:31.492128 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:05:31.494129 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:05:31.495127 [info ] [Thread-1 (]: 7 of 10 START sql view model public.stg_suppliers .............................. [RUN]
[0m13:05:31.497180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:05:31.498476 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:05:31.506460 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:05:31.511971 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:05:31.520074 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:05:31.523738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.524743 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:05:31.526770 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:31.754320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m13:05:31.756426 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.757467 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m13:05:31.766965 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:31.773572 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.774622 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:05:31.776672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.782889 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.783948 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:05:31.785889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:31.789721 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:05:31.790759 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.791756 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:05:31.796604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:05:31.802521 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:05:31.804837 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:31.805910 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:05:31.808922 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:31.812206 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:05:31.814313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC16935D0>]}
[0m13:05:31.816312 [info ] [Thread-1 (]: 7 of 10 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:05:31.819304 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:05:31.820451 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:05:31.822849 [info ] [Thread-1 (]: 8 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m13:05:31.824363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_inventory_status)
[0m13:05:31.826355 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:05:31.832368 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:05:31.836806 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:05:31.844903 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:05:31.848910 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:31.849937 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:05:31.851871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:32.076174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m13:05:32.077173 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:32.079172 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m13:05:32.089141 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:05:32.095129 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:32.097122 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:05:32.100116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:05:32.104105 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:05:32.105103 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:32.107099 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:05:32.110658 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:05:32.116649 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:05:32.118642 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:32.119639 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:05:32.121632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:05:32.124627 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:05:32.126622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC11992D0>]}
[0m13:05:32.128619 [info ] [Thread-1 (]: 8 of 10 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.30s]
[0m13:05:32.132226 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:05:32.133229 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:05:32.134226 [info ] [Thread-1 (]: 9 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m13:05:32.136221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:05:32.137218 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:05:32.143743 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:05:32.148890 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:05:32.158864 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:05:32.161856 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:32.163633 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:05:32.165075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:32.519131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.355 seconds
[0m13:05:32.521018 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:32.522720 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m13:05:32.542479 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m13:05:32.548775 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:32.549773 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:05:32.551767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:32.558712 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:05:32.559710 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:32.560708 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:05:32.563699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:32.569719 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:05:32.572711 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:32.575110 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:05:32.576113 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:05:32.579582 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:05:32.580608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC0D91F90>]}
[0m13:05:32.582931 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.mart_sales_summary .................... [[32mCREATE VIEW[0m in 0.44s]
[0m13:05:32.584926 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:05:32.587936 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:05:32.588933 [info ] [Thread-1 (]: 10 of 10 START sql view model public.mart_top_customers ........................ [RUN]
[0m13:05:32.591925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:05:32.592924 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:05:32.599201 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:05:32.603161 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:05:32.611369 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:05:32.615792 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:32.616619 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:05:32.618618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:32.844603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m13:05:32.846595 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:32.847596 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m13:05:32.869708 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m13:05:32.876687 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:32.877684 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:05:32.880479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:32.883699 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:05:32.884694 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:32.885700 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:05:32.888686 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:05:32.894674 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:05:32.896951 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:32.896951 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:05:32.898939 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:05:32.903202 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:05:32.904199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc31e228-e283-46bb-8ef2-fce170ebc1ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CAC16F8F90>]}
[0m13:05:32.906194 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:05:32.909705 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:05:32.912829 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:32.914823 [debug] [MainThread]: On master: BEGIN
[0m13:05:32.915820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:05:33.142288 [debug] [MainThread]: SQL status: BEGIN in 0.227 seconds
[0m13:05:33.144286 [debug] [MainThread]: On master: COMMIT
[0m13:05:33.145283 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:33.147286 [debug] [MainThread]: On master: COMMIT
[0m13:05:33.148312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:33.149281 [debug] [MainThread]: On master: Close
[0m13:05:33.150341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:33.151817 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:05:33.152855 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m13:05:33.152855 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:05:33.154814 [info ] [MainThread]: 
[0m13:05:33.156159 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 5.91 seconds (5.91s).
[0m13:05:33.162300 [debug] [MainThread]: Command end result
[0m13:05:33.215850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:05:33.221846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:05:33.236240 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:05:33.238235 [info ] [MainThread]: 
[0m13:05:33.239467 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:05:33.241486 [info ] [MainThread]: 
[0m13:05:33.244293 [error] [MainThread]:   Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m13:05:33.246055 [info ] [MainThread]: 
[0m13:05:33.247553 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m13:05:33.250927 [debug] [MainThread]: Command `dbt run` failed at 13:05:33.250927 after 9.36 seconds
[0m13:05:33.251920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFAD42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABABBEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CABFB9E6D0>]}
[0m13:05:33.253961 [debug] [MainThread]: Flushing usage events
[0m13:05:34.638901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:05:52.279541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9EF5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9F020D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9F036D0>]}


============================== 13:05:52.288065 | 61f5b808-0236-449b-8611-512210f386cb ==============================
[0m13:05:52.288065 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:05:52.290060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:05:52.700545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEA08C810>]}
[0m13:05:52.817158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE6B4D550>]}
[0m13:05:52.820490 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:05:53.662598 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:05:54.086944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:05:54.089206 [debug] [MainThread]: Partial parsing: updated file: Propharma://macros\utils.sql
[0m13:05:54.244245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9E91790>]}
[0m13:05:54.405710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:05:54.418053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:05:54.474135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEA02F8D0>]}
[0m13:05:54.476130 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 433 macros
[0m13:05:54.477932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEB271F10>]}
[0m13:05:54.481962 [info ] [MainThread]: 
[0m13:05:54.482898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:54.484389 [info ] [MainThread]: 
[0m13:05:54.486326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:05:54.499331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:05:54.876929 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:05:54.877927 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:05:54.878925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:55.157371 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.278 seconds
[0m13:05:55.160503 [debug] [ThreadPool]: On list_propharma: Close
[0m13:05:55.165256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m13:05:55.176231 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:05:55.177253 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:05:55.179224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:55.409610 [debug] [ThreadPool]: SQL status: BEGIN in 0.231 seconds
[0m13:05:55.412028 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:05:55.413029 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:05:55.424403 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m13:05:55.426362 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:05:55.428356 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:05:55.430352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m13:05:55.435179 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:05:55.436687 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:05:55.438687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:55.678026 [debug] [ThreadPool]: SQL status: BEGIN in 0.239 seconds
[0m13:05:55.679024 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:05:55.680022 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:05:55.691989 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.010 seconds
[0m13:05:55.694981 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:05:55.696976 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:05:55.715364 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:55.716375 [debug] [MainThread]: On master: BEGIN
[0m13:05:55.717386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:05:55.954661 [debug] [MainThread]: SQL status: BEGIN in 0.237 seconds
[0m13:05:55.955658 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:55.957653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:05:55.996549 [debug] [MainThread]: SQL status: SELECT 12 in 0.037 seconds
[0m13:05:56.003530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE91664D0>]}
[0m13:05:56.004528 [debug] [MainThread]: On master: ROLLBACK
[0m13:05:56.006523 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:56.007520 [debug] [MainThread]: On master: BEGIN
[0m13:05:56.009515 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:05:56.010512 [debug] [MainThread]: On master: COMMIT
[0m13:05:56.011509 [debug] [MainThread]: Using postgres connection "master"
[0m13:05:56.012507 [debug] [MainThread]: On master: COMMIT
[0m13:05:56.013504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:05:56.014501 [debug] [MainThread]: On master: Close
[0m13:05:56.025510 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:05:56.027658 [info ] [Thread-1 (]: 1 of 10 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m13:05:56.029670 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.mart_expired_drugs'
[0m13:05:56.030676 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:05:56.045179 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:05:56.048170 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:05:56.112997 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:05:56.117983 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:05:56.118981 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:05:56.119978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:05:56.459563 [debug] [Thread-1 (]: SQL status: BEGIN in 0.339 seconds
[0m13:05:56.460570 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:05:56.461892 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    -- filter medicines with expiry_date < current_date
  );
[0m13:05:56.463850 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 8:   );
          ^

[0m13:05:56.464935 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: ROLLBACK
[0m13:05:56.466975 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:05:56.482261 [debug] [Thread-1 (]: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m13:05:56.486252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEB7FF5D0>]}
[0m13:05:56.488246 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model public.mart_expired_drugs ................ [[31mERROR[0m in 0.45s]
[0m13:05:56.490631 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:05:56.491627 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:05:56.492625 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_expired_drugs' to be skipped because of status 'error'.  Reason: Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql.
[0m13:05:56.493657 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m13:05:56.497484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.stg_inventory)
[0m13:05:56.499004 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:05:56.503150 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:05:56.507266 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:05:56.516247 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:05:56.520237 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.522660 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:05:56.523660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:56.850040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.326 seconds
[0m13:05:56.852295 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.854331 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m13:05:56.863297 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:05:56.876398 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.877396 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:05:56.879390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:56.885644 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.886641 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:05:56.888636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:56.920551 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:05:56.921549 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.922546 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:05:56.925545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:05:56.937513 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:05:56.946008 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:05:56.948003 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:05:56.951993 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:05:56.956979 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:05:56.957973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEB7E3A50>]}
[0m13:05:56.959971 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.46s]
[0m13:05:56.963393 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:05:56.964394 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:05:56.965395 [info ] [Thread-1 (]: 3 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m13:05:56.967386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:05:56.968387 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:05:56.973373 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:05:56.977359 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:05:56.989092 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:05:56.993492 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:56.994497 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:05:56.995521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:57.226807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m13:05:57.228802 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:57.229799 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m13:05:57.238295 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:57.245280 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:57.246277 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m13:05:57.248272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:57.254256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:57.256250 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:05:57.258245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:57.261237 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:05:57.262234 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:57.263232 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:05:57.266934 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:05:57.272925 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:05:57.274920 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:05:57.275917 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:05:57.278909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:57.281901 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:05:57.283896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEBD58E50>]}
[0m13:05:57.285888 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:05:57.288845 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:05:57.290358 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:05:57.291355 [info ] [Thread-1 (]: 4 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m13:05:57.293347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:05:57.294348 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:05:57.298337 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:05:57.302875 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:05:57.310973 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:05:57.315370 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.316376 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:05:57.317749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:57.565052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m13:05:57.566790 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.567827 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m13:05:57.579171 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:05:57.586327 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.587834 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:05:57.590155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:57.596174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.597174 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:05:57.600683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:57.604680 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:05:57.605677 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.606675 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:05:57.609668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:57.614653 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:05:57.616650 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:05:57.618640 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:05:57.622632 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:05:57.625624 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:05:57.627619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEBD5A290>]}
[0m13:05:57.629936 [info ] [Thread-1 (]: 4 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:05:57.631746 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:05:57.633475 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:05:57.635477 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m13:05:57.637472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:05:57.639003 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:05:57.642994 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:05:57.646496 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:05:57.655477 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:05:57.660464 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:57.661464 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:05:57.663455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:58.048479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.385 seconds
[0m13:05:58.050475 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:58.052468 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m13:05:58.066421 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:05:58.076814 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:58.077822 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:05:58.081952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:05:58.153885 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:58.154937 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:05:58.158161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:58.163837 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:05:58.164866 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:58.166937 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:05:58.171003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:05:58.179226 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:05:58.182471 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:05:58.184995 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:05:58.190413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:05:58.196201 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:05:58.199392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEBD97110>]}
[0m13:05:58.201609 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.56s]
[0m13:05:58.205716 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:05:58.209087 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:05:58.211108 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m13:05:58.213344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:05:58.215687 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:05:58.227026 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:05:58.244502 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:05:58.286392 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:05:58.294829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.297358 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:05:58.301176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:58.689388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.389 seconds
[0m13:05:58.691204 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.692240 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m13:05:58.701111 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:58.708090 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.710054 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:05:58.711078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:58.718064 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.719037 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:05:58.721057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:58.725339 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:05:58.726306 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.727338 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:05:58.731161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:05:58.737207 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:05:58.738204 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:05:58.740133 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:05:58.746260 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:05:58.749256 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:05:58.751210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEBD8CFD0>]}
[0m13:05:58.753596 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.54s]
[0m13:05:58.756894 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:05:58.758371 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:05:58.760377 [info ] [Thread-1 (]: 7 of 10 START sql view model public.stg_suppliers .............................. [RUN]
[0m13:05:58.762367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:05:58.763365 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:05:58.769140 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:05:58.773135 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:05:58.783124 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:05:58.787118 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:58.789113 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:05:58.790110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:59.028522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m13:05:59.030516 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:59.031516 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m13:05:59.041018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:59.047996 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:59.048993 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:05:59.050988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:59.057967 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:59.058964 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:05:59.060959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:59.063951 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:05:59.065947 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:59.066943 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:05:59.077660 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:05:59.085639 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:05:59.086636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:05:59.088632 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:05:59.091623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:05:59.095613 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:05:59.097607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEBD2BB90>]}
[0m13:05:59.098604 [info ] [Thread-1 (]: 7 of 10 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:05:59.101597 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:05:59.103613 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:05:59.104618 [info ] [Thread-1 (]: 8 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m13:05:59.106883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_inventory_status)
[0m13:05:59.107889 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:05:59.114044 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:05:59.118149 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:05:59.126714 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:05:59.130792 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:59.131789 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:05:59.133921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:59.367029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m13:05:59.368984 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:59.369981 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m13:05:59.378997 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:05:59.385974 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:59.386973 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:05:59.388982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:59.392952 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:05:59.393923 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:59.394949 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:05:59.400829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:05:59.406306 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:05:59.407859 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:05:59.409889 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:05:59.410851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:05:59.413878 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:05:59.415836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9EF6D10>]}
[0m13:05:59.417720 [info ] [Thread-1 (]: 8 of 10 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.31s]
[0m13:05:59.420590 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:05:59.422589 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:05:59.423590 [info ] [Thread-1 (]: 9 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m13:05:59.425611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:05:59.427607 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:05:59.433051 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:05:59.437008 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:05:59.447450 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:05:59.452527 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:59.453525 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:05:59.455232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:05:59.770049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.315 seconds
[0m13:05:59.772065 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:59.773147 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m13:05:59.783530 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:05:59.789579 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:59.790586 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:05:59.793694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:05:59.797875 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:05:59.798922 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:59.799929 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:05:59.809258 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:05:59.815479 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:05:59.817535 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:05:59.818546 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:05:59.819593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:05:59.822671 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:05:59.824867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEB54AAD0>]}
[0m13:05:59.826913 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.mart_sales_summary .................... [[32mCREATE VIEW[0m in 0.40s]
[0m13:05:59.829704 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:05:59.832363 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:05:59.834465 [info ] [Thread-1 (]: 10 of 10 START sql view model public.mart_top_customers ........................ [RUN]
[0m13:05:59.836752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:05:59.838951 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:05:59.849025 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:05:59.853014 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:05:59.861755 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:05:59.866275 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:05:59.868274 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:05:59.869272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:00.132597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.263 seconds
[0m13:06:00.133885 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:00.134892 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m13:06:00.147907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:06:00.157142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:00.158141 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:06:00.160105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:00.163779 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:06:00.164775 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:00.166743 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:06:00.168766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:06:00.173750 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:06:00.175716 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:00.177713 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:06:00.179864 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:06:00.182433 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:06:00.183433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61f5b808-0236-449b-8611-512210f386cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE9F75A90>]}
[0m13:06:00.186387 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.35s]
[0m13:06:00.188381 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:06:00.191679 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:00.192713 [debug] [MainThread]: On master: BEGIN
[0m13:06:00.193711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:00.434652 [debug] [MainThread]: SQL status: BEGIN in 0.241 seconds
[0m13:06:00.435649 [debug] [MainThread]: On master: COMMIT
[0m13:06:00.437644 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:00.438641 [debug] [MainThread]: On master: COMMIT
[0m13:06:00.440143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:00.441144 [debug] [MainThread]: On master: Close
[0m13:06:00.443139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:00.444137 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:06:00.445134 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m13:06:00.446586 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:06:00.447585 [info ] [MainThread]: 
[0m13:06:00.450114 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 5.96 seconds (5.96s).
[0m13:06:00.456419 [debug] [MainThread]: Command end result
[0m13:06:00.515612 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:06:00.522696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:06:00.538668 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:06:00.540172 [info ] [MainThread]: 
[0m13:06:00.542532 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:06:00.544702 [info ] [MainThread]: 
[0m13:06:00.545772 [error] [MainThread]:   Database Error in model mart_expired_drugs (models\marts\mart_expired_drugs.sql)
  syntax error at or near ")"
  LINE 8:   );
            ^
  compiled code at target\run\Propharma\models\marts\mart_expired_drugs.sql
[0m13:06:00.548059 [info ] [MainThread]: 
[0m13:06:00.550069 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m13:06:00.553223 [debug] [MainThread]: Command `dbt run` failed at 13:06:00.552225 after 8.96 seconds
[0m13:06:00.553223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE4E8FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AEB4AC0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AE6B34850>]}
[0m13:06:00.555742 [debug] [MainThread]: Flushing usage events
[0m13:06:01.936092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:06:44.603698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07241ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F072454990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F072477950>]}


============================== 13:06:44.611739 | 51755a52-86af-4e2d-9086-10eccdb52dff ==============================
[0m13:06:44.611739 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:06:44.614127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:06:45.019156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0725A8E10>]}
[0m13:06:45.135207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06F07AF50>]}
[0m13:06:45.138202 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:06:45.967076 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:06:46.400135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:06:46.402096 [debug] [MainThread]: Partial parsing: updated file: Propharma://macros\utils.sql
[0m13:06:46.404127 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_expired_drugs.sql
[0m13:06:46.918322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0737C7D50>]}
[0m13:06:47.102182 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:06:47.112806 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:06:47.177413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073A83A10>]}
[0m13:06:47.179464 [info ] [MainThread]: Found 1 snapshot, 1 seed, 10 models, 434 macros
[0m13:06:47.180473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073A79D10>]}
[0m13:06:47.185715 [info ] [MainThread]: 
[0m13:06:47.186724 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:06:47.188776 [info ] [MainThread]: 
[0m13:06:47.190795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:06:47.205124 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:06:47.592285 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:06:47.593318 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:06:47.594284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:47.864556 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.270 seconds
[0m13:06:47.867543 [debug] [ThreadPool]: On list_propharma: Close
[0m13:06:47.871502 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m13:06:47.883472 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:06:47.884469 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:06:47.885466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:06:48.109009 [debug] [ThreadPool]: SQL status: BEGIN in 0.223 seconds
[0m13:06:48.109971 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:06:48.111015 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:06:48.122980 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.011 seconds
[0m13:06:48.125964 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:06:48.127926 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:06:48.128956 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m13:06:48.139029 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:06:48.140026 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:06:48.141023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:06:48.367205 [debug] [ThreadPool]: SQL status: BEGIN in 0.226 seconds
[0m13:06:48.368205 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:06:48.369478 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:06:48.380019 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m13:06:48.383619 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:06:48.384942 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:06:48.394673 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:48.395671 [debug] [MainThread]: On master: BEGIN
[0m13:06:48.396667 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:06:48.618960 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m13:06:48.620885 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:48.622123 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:06:48.659985 [debug] [MainThread]: SQL status: SELECT 12 in 0.037 seconds
[0m13:06:48.667331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073B4C510>]}
[0m13:06:48.669325 [debug] [MainThread]: On master: ROLLBACK
[0m13:06:48.670322 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:48.671571 [debug] [MainThread]: On master: BEGIN
[0m13:06:48.673296 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:06:48.674273 [debug] [MainThread]: On master: COMMIT
[0m13:06:48.674814 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:48.675818 [debug] [MainThread]: On master: COMMIT
[0m13:06:48.677596 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:48.678832 [debug] [MainThread]: On master: Close
[0m13:06:48.688102 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:06:48.689104 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m13:06:48.691606 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m13:06:48.692147 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:06:48.706151 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:06:48.711106 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:06:48.774931 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:06:48.778930 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:48.779927 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:06:48.781923 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:06:49.008874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m13:06:49.010163 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:49.010703 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m13:06:49.019513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:06:49.036435 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:49.038429 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:06:49.040426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.047437 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:49.048447 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:06:49.050137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.081134 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:06:49.083092 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:49.084273 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:06:49.089868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:06:49.162005 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:06:49.171937 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:06:49.172934 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:06:49.179827 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m13:06:49.185248 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:06:49.189213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0737C7ED0>]}
[0m13:06:49.191694 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.50s]
[0m13:06:49.194209 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:06:49.196211 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:06:49.198245 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m13:06:49.199930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:06:49.200938 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:06:49.204609 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:06:49.208712 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:06:49.216045 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:06:49.219684 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.220681 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:06:49.221678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:49.557521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.335 seconds
[0m13:06:49.559516 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.559516 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m13:06:49.568878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:06:49.575864 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.576864 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m13:06:49.578822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.584841 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.585839 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:06:49.587602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.595464 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:06:49.597467 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.598464 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:06:49.600486 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:06:49.605471 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:06:49.607438 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:06:49.608465 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:06:49.612038 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:06:49.614774 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:06:49.616732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073A0AB90>]}
[0m13:06:49.618727 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m13:06:49.621083 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:06:49.623082 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:06:49.625081 [info ] [Thread-1 (]: 3 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m13:06:49.628068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:06:49.628068 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:06:49.633408 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:06:49.637002 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:06:49.644481 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:06:49.647473 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.649466 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:06:49.650495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:49.872102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m13:06:49.873139 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.874103 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m13:06:49.882983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:06:49.888827 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.890789 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:06:49.891827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.898277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.899274 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:06:49.901272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:49.904261 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:06:49.905258 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.906256 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:06:49.918133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m13:06:49.925901 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:06:49.927897 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:06:49.928929 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:06:49.933606 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:06:49.936858 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:06:49.937895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0724241D0>]}
[0m13:06:49.939855 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:06:49.942849 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:06:49.943845 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:06:49.945870 [info ] [Thread-1 (]: 4 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m13:06:49.946840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:06:49.948831 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:06:49.954818 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:06:49.958837 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:06:49.970067 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:06:49.974254 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:49.975284 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:06:49.976280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:50.292701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.316 seconds
[0m13:06:50.293830 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:50.295212 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m13:06:50.303437 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:06:50.310411 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:50.311453 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:06:50.313498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:50.319132 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:50.321287 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:06:50.323014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:50.326647 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:06:50.327624 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:50.328640 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:06:50.340027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m13:06:50.346743 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:06:50.348804 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:06:50.349311 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:06:50.353433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:06:50.356461 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:06:50.358423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07254FE90>]}
[0m13:06:50.360418 [info ] [Thread-1 (]: 4 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.41s]
[0m13:06:50.362413 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:06:50.364547 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:06:50.365607 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m13:06:50.367075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:06:50.368112 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:06:50.373095 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:06:50.376820 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:06:50.384807 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:06:50.388245 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.390257 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:06:50.391254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:50.637507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.246 seconds
[0m13:06:50.639507 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.641515 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m13:06:50.653379 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:06:50.661741 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.662740 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:06:50.664734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:50.671159 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.672165 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:06:50.673573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:50.677020 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:06:50.678106 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.679475 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:06:50.684845 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:06:50.695299 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:06:50.697168 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:06:50.699255 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:06:50.704462 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:06:50.707454 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:06:50.709449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0725AF790>]}
[0m13:06:50.710446 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.34s]
[0m13:06:50.713785 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:06:50.714796 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:06:50.715803 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_suppliers .............................. [RUN]
[0m13:06:50.718301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:06:50.720312 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:06:50.726625 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:06:50.729977 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:06:50.740690 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:06:50.745083 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:50.747163 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:06:50.748190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:50.983766 [debug] [Thread-1 (]: SQL status: BEGIN in 0.235 seconds
[0m13:06:50.984764 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:50.985761 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m13:06:50.995574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:06:51.002494 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:51.003489 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:06:51.006100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:51.012342 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:51.013339 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:06:51.015707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:51.018393 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:06:51.019396 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:51.021040 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:06:51.023308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:06:51.029253 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:06:51.030251 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:06:51.031248 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:06:51.036486 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:06:51.039019 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:06:51.041015 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073EF1310>]}
[0m13:06:51.043010 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:06:51.045004 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:06:51.046001 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:06:51.047996 [info ] [Thread-1 (]: 7 of 10 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m13:06:51.049991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m13:06:51.050988 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:06:51.059764 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:06:51.062209 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:06:51.120772 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:06:51.124212 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:06:51.126238 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:06:51.127445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:51.365433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.238 seconds
[0m13:06:51.366435 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:06:51.368427 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:06:51.383527 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.014 seconds
[0m13:06:51.397650 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:06:51.398647 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m13:06:51.401952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:06:51.406878 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:06:51.407945 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:06:51.410406 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:06:51.414910 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:06:51.421267 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m13:06:51.428239 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:06:51.430235 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m13:06:51.433226 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:06:51.437215 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:06:51.439210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F07173B050>]}
[0m13:06:51.442202 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.39s]
[0m13:06:51.446191 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:06:51.447188 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:06:51.449183 [info ] [Thread-1 (]: 8 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m13:06:51.451178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m13:06:51.453172 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:06:51.461943 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:06:51.466546 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:06:51.474207 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:06:51.478390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:06:51.478390 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:06:51.480873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:51.826835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.346 seconds
[0m13:06:51.828127 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:06:51.829172 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m13:06:51.847104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:06:51.853481 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:06:51.855531 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:06:51.857065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:51.860570 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:06:51.861607 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:06:51.863026 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:06:51.865266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:06:51.873275 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:06:51.875420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:06:51.876460 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:06:51.878041 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:06:51.880920 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:06:51.882920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0738EBA50>]}
[0m13:06:51.884915 [info ] [Thread-1 (]: 8 of 10 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.43s]
[0m13:06:51.887908 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:06:51.889042 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:06:51.890078 [info ] [Thread-1 (]: 9 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m13:06:51.892530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:06:51.893557 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:06:51.899101 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:06:51.903096 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:06:51.912150 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:06:51.916569 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:06:51.917604 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:06:51.919071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:52.147482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m13:06:52.148514 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:06:52.150473 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m13:06:52.160486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:06:52.166468 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:06:52.167429 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:06:52.169460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:52.173447 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:06:52.175407 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:06:52.176441 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:06:52.181697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:06:52.187672 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:06:52.188754 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:06:52.190495 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:06:52.191583 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:06:52.194861 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:06:52.196370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F073B43650>]}
[0m13:06:52.197371 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.mart_sales_summary .................... [[32mCREATE VIEW[0m in 0.30s]
[0m13:06:52.200919 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:06:52.202087 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:06:52.204545 [info ] [Thread-1 (]: 10 of 10 START sql view model public.mart_top_customers ........................ [RUN]
[0m13:06:52.205937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:06:52.207153 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:06:52.214500 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:06:52.218486 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:06:52.226466 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:06:52.229459 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:52.231270 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:06:52.233426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:06:52.559278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.327 seconds
[0m13:06:52.561135 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:52.562874 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m13:06:52.573586 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:06:52.579787 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:52.581745 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:06:52.583215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:06:52.586257 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:06:52.587294 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:52.588291 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:06:52.594949 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:06:52.599532 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:06:52.601524 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:06:52.602525 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:06:52.604485 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:06:52.607511 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:06:52.609103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51755a52-86af-4e2d-9086-10eccdb52dff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0725AA210>]}
[0m13:06:52.611102 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.40s]
[0m13:06:52.614178 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:06:52.616984 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:52.618505 [debug] [MainThread]: On master: BEGIN
[0m13:06:52.619507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:06:52.843749 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m13:06:52.844752 [debug] [MainThread]: On master: COMMIT
[0m13:06:52.847247 [debug] [MainThread]: Using postgres connection "master"
[0m13:06:52.848243 [debug] [MainThread]: On master: COMMIT
[0m13:06:52.849241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:06:52.850476 [debug] [MainThread]: On master: Close
[0m13:06:52.851817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:06:52.853270 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:06:52.855549 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m13:06:52.856579 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:06:52.857624 [info ] [MainThread]: 
[0m13:06:52.859744 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 5.67 seconds (5.67s).
[0m13:06:52.864810 [debug] [MainThread]: Command end result
[0m13:06:52.918973 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:06:52.925951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:06:52.940247 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:06:52.941246 [info ] [MainThread]: 
[0m13:06:52.944366 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:06:52.946027 [info ] [MainThread]: 
[0m13:06:52.948529 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:06:52.951179 [debug] [MainThread]: Command `dbt run` succeeded at 13:06:52.951179 after 9.01 seconds
[0m13:06:52.953175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D39FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D39EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D3A80D0>]}
[0m13:06:52.954171 [debug] [MainThread]: Flushing usage events
[0m13:06:54.306930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:07:15.341866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F63776E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F63775890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F63776010>]}


============================== 13:07:15.350065 | ecef3124-9139-4621-9236-7ccb7205d97a ==============================
[0m13:07:15.350065 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:07:15.352082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:07:15.824579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecef3124-9139-4621-9236-7ccb7205d97a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F638E6FD0>]}
[0m13:07:15.942071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecef3124-9139-4621-9236-7ccb7205d97a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F6037EC90>]}
[0m13:07:15.945014 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:07:16.864260 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:07:17.321035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:07:17.322031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:07:17.426197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecef3124-9139-4621-9236-7ccb7205d97a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F63761690>]}
[0m13:07:17.592310 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:07:17.606053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:07:17.697199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecef3124-9139-4621-9236-7ccb7205d97a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F64E49DD0>]}
[0m13:07:17.698197 [info ] [MainThread]: Found 1 snapshot, 1 seed, 10 models, 434 macros
[0m13:07:17.701185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecef3124-9139-4621-9236-7ccb7205d97a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F64AF7F50>]}
[0m13:07:17.704353 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:07:17.708892 [debug] [MainThread]: Command end result
[0m13:07:17.764976 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:07:17.771995 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:07:17.781036 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:07:17.783242 [debug] [MainThread]: Command `dbt test` succeeded at 13:07:17.783242 after 3.12 seconds
[0m13:07:17.784707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5E67FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5E67EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F5E6880D0>]}
[0m13:07:17.786757 [debug] [MainThread]: Flushing usage events
[0m13:07:18.950692 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:08:14.683554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204422FF8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020441F72250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020442345750>]}


============================== 13:08:14.692047 | 159e365a-3570-4a8c-a5fc-54ba6dd48443 ==============================
[0m13:08:14.692047 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:08:14.694724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:08:15.154578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204424560D0>]}
[0m13:08:15.269921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043EFDF550>]}
[0m13:08:15.272913 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:08:16.165181 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:08:16.622335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:08:16.623621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:08:16.724141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044372C8D0>]}
[0m13:08:16.795095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044392E410>]}
[0m13:08:16.797202 [info ] [MainThread]: Found 1 snapshot, 1 seed, 10 models, 434 macros
[0m13:08:16.798220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044367EED0>]}
[0m13:08:16.803589 [info ] [MainThread]: 
[0m13:08:16.805588 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:08:16.807578 [info ] [MainThread]: 
[0m13:08:16.811569 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:08:16.826774 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m13:08:17.217947 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:08:17.219026 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:08:17.220212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:17.637120 [debug] [ThreadPool]: SQL status: BEGIN in 0.417 seconds
[0m13:08:17.638117 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:08:17.640112 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:08:17.651307 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m13:08:17.653326 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:08:17.655343 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:08:17.656351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m13:08:17.661870 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:08:17.663038 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:08:17.665115 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:08:17.911312 [debug] [ThreadPool]: SQL status: BEGIN in 0.246 seconds
[0m13:08:17.912438 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:08:17.913481 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:08:17.926016 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.011 seconds
[0m13:08:17.929007 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:08:17.931002 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:08:17.946960 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:17.947957 [debug] [MainThread]: On master: BEGIN
[0m13:08:17.948955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:08:18.183519 [debug] [MainThread]: SQL status: BEGIN in 0.235 seconds
[0m13:08:18.185312 [debug] [MainThread]: Using postgres connection "master"
[0m13:08:18.185853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:08:18.248184 [debug] [MainThread]: SQL status: SELECT 12 in 0.060 seconds
[0m13:08:18.264278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159e365a-3570-4a8c-a5fc-54ba6dd48443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044393F5D0>]}
[0m13:08:18.266455 [debug] [MainThread]: On master: ROLLBACK
[0m13:08:18.268450 [debug] [MainThread]: On master: Close
[0m13:08:18.280423 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:08:18.283440 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m13:08:18.284453 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:08:18.298406 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:08:18.303794 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:08:18.305963 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:08:18.307985 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:08:18.310010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:08:18.311021 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:08:18.315440 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:08:18.320879 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:08:18.323005 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:08:18.325021 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:08:18.327419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:08:18.328650 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:08:18.336806 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:08:18.341063 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:08:18.343341 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:08:18.345345 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:08:18.347687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:08:18.348684 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:08:18.354669 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:08:18.359656 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:08:18.362647 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:08:18.364643 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:08:18.365716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:08:18.367776 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:08:18.372763 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:08:18.378121 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:08:18.379134 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:08:18.381545 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:08:18.384050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:08:18.386135 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:08:18.390396 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:08:18.395241 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:08:18.398231 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:08:18.399228 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m13:08:18.401222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m13:08:18.403217 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m13:08:18.408414 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m13:08:18.410955 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m13:08:18.411960 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:08:18.414085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now model.Propharma.mart_expired_drugs)
[0m13:08:18.416087 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:08:18.426522 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:08:18.429709 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:08:18.431723 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:08:18.432728 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:08:18.434749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m13:08:18.435757 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:08:18.441814 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:08:18.446997 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:08:18.449984 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:08:18.451978 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m13:08:18.453972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now snapshot.Propharma.snapshot_prescriptions)
[0m13:08:18.455966 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m13:08:18.463945 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m13:08:18.467076 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m13:08:18.468079 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:08:18.470073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m13:08:18.471070 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:08:18.477875 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:08:18.481974 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:08:18.482984 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:08:18.485337 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:08:18.486346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:08:18.487376 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:08:18.494328 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:08:18.497517 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:08:18.499540 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:08:18.502838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:08:18.504033 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m13:08:18.505149 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:08:18.511084 [debug] [MainThread]: Command end result
[0m13:08:18.682154 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:08:18.695786 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:08:18.714584 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:08:18.729490 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m13:08:18.730639 [info ] [MainThread]: Building catalog
[0m13:08:18.752427 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m13:08:18.766907 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m13:08:18.767948 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m13:08:18.769007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:08:19.010753 [debug] [ThreadPool]: SQL status: BEGIN in 0.241 seconds
[0m13:08:19.011718 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m13:08:19.013713 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m13:08:19.034982 [debug] [ThreadPool]: SQL status: SELECT 53 in 0.021 seconds
[0m13:08:19.046758 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m13:08:19.049013 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m13:08:19.077819 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m13:08:19.130304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:08:19.137371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:08:19.138406 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m13:08:19.141484 [debug] [MainThread]: Command `dbt docs generate` succeeded at 13:08:19.141484 after 5.16 seconds
[0m13:08:19.142021 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m13:08:19.143547 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m13:08:19.144624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204415ED590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020443831C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044230C0D0>]}
[0m13:08:19.146188 [debug] [MainThread]: Flushing usage events
[0m13:08:20.390348 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:09:33.925530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77B1BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77B3B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77B2B10>]}


============================== 13:09:33.933359 | d51086f8-ea80-4f71-abf9-9b62a5aa8edb ==============================
[0m13:09:33.933359 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:09:33.935803 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:09:34.339553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd51086f8-ea80-4f71-abf9-9b62a5aa8edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A796BC90>]}
[0m13:09:34.449570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd51086f8-ea80-4f71-abf9-9b62a5aa8edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A441B390>]}
[0m13:26:25.895470 [error] [MainThread]: Encountered an error:

[0m13:26:25.905991 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:26:25.909981 [debug] [MainThread]: Command `dbt docs serve` failed at 13:26:25.908983 after 1012.65 seconds
[0m13:26:25.911491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A7812290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A74208D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A77B10D0>]}
[0m13:26:25.912542 [debug] [MainThread]: Flushing usage events
[0m13:26:27.162413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:26:40.551302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD36ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD361C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD363D50>]}


============================== 13:26:40.559572 | b54de35b-a8f6-4676-9af8-d03d68aecc9d ==============================
[0m13:26:40.559572 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:26:40.561154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:26:40.980761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD3C5F90>]}
[0m13:26:41.092663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191F9FCD550>]}
[0m13:26:41.096200 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:26:41.933735 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:26:42.120242 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:26:42.121745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FC5CB750>]}
[0m13:26:44.942578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD58FF10>]}
[0m13:26:45.105091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:26:45.116084 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:26:45.185082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FEB49190>]}
[0m13:26:45.187114 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m13:26:45.188079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FEB56090>]}
[0m13:26:45.192619 [info ] [MainThread]: 
[0m13:26:45.194584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:26:45.195583 [info ] [MainThread]: 
[0m13:26:45.198575 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:26:45.205293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:26:45.582445 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:26:45.583441 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:26:45.585045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:45.970338 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.385 seconds
[0m13:26:45.972843 [debug] [ThreadPool]: On list_propharma: Close
[0m13:26:45.974838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma, now create_propharma_snapshots)
[0m13:26:45.976957 [debug] [ThreadPool]: Creating schema "database: "propharma"
schema: "snapshots"
"
[0m13:26:45.986941 [debug] [ThreadPool]: Using postgres connection "create_propharma_snapshots"
[0m13:26:45.987937 [debug] [ThreadPool]: On create_propharma_snapshots: BEGIN
[0m13:26:45.988906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:46.222795 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m13:26:46.223825 [debug] [ThreadPool]: Using postgres connection "create_propharma_snapshots"
[0m13:26:46.225010 [debug] [ThreadPool]: On create_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "create_propharma_snapshots"} */
create schema if not exists "snapshots"
[0m13:26:46.237813 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.011 seconds
[0m13:26:46.239806 [debug] [ThreadPool]: On create_propharma_snapshots: COMMIT
[0m13:26:46.241317 [debug] [ThreadPool]: Using postgres connection "create_propharma_snapshots"
[0m13:26:46.242321 [debug] [ThreadPool]: On create_propharma_snapshots: COMMIT
[0m13:26:46.244315 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m13:26:46.245342 [debug] [ThreadPool]: On create_propharma_snapshots: Close
[0m13:26:46.256663 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m13:26:46.268666 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:26:46.269663 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:26:46.271177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:46.504857 [debug] [ThreadPool]: SQL status: BEGIN in 0.234 seconds
[0m13:26:46.506819 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:26:46.507815 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:26:46.519484 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.010 seconds
[0m13:26:46.522018 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:26:46.524016 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:26:46.525015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m13:26:46.530011 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:26:46.531519 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:26:46.532526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:26:46.759811 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m13:26:46.761380 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:26:46.762382 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:26:46.773707 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m13:26:46.777739 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:26:46.779738 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:26:46.794684 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:46.796193 [debug] [MainThread]: On master: BEGIN
[0m13:26:46.797194 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:47.109754 [debug] [MainThread]: SQL status: BEGIN in 0.312 seconds
[0m13:26:47.111263 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:47.112265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:26:47.155586 [debug] [MainThread]: SQL status: SELECT 12 in 0.041 seconds
[0m13:26:47.163423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FEF40A50>]}
[0m13:26:47.164459 [debug] [MainThread]: On master: ROLLBACK
[0m13:26:47.165455 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:47.167719 [debug] [MainThread]: On master: BEGIN
[0m13:26:47.169900 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:26:47.170417 [debug] [MainThread]: On master: COMMIT
[0m13:26:47.171422 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:47.173416 [debug] [MainThread]: On master: COMMIT
[0m13:26:47.174414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:26:47.175444 [debug] [MainThread]: On master: Close
[0m13:26:47.185038 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m13:26:47.186583 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m13:26:47.188379 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m13:26:47.189955 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m13:26:47.206119 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m13:26:47.329229 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.330699 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id,
        prescribed_date as dbt_updated_at,
        prescribed_date as dbt_valid_from,
        
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
from (
        

select * from "propharma"."public"."stg_prescriptions"
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0

[0m13:26:47.331242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:26:47.594628 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.263 seconds
[0m13:26:47.607523 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.608521 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m13:26:47.611029 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m13:26:47.612053 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m13:26:47.614318 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.619943 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.621341 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m13:26:47.624672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m13:26:47.626755 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.628750 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      
  
    

  create  table "propharma"."snapshots"."snapshot_prescriptions"
  
  
    as
  
  (
    
    

    select *,
        md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id,
        prescribed_date as dbt_updated_at,
        prescribed_date as dbt_valid_from,
        
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
from (
        

select * from "propharma"."public"."stg_prescriptions"
    ) sbq



  );
  
  
[0m13:26:47.657520 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.027 seconds
[0m13:26:47.694750 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m13:26:47.696259 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m13:26:47.697272 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m13:26:47.700301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:26:47.704865 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m13:26:47.709992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b54de35b-a8f6-4676-9af8-d03d68aecc9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FF0A35D0>]}
[0m13:26:47.711303 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mSELECT 10[0m in 0.52s]
[0m13:26:47.714902 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m13:26:47.716954 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:47.717952 [debug] [MainThread]: On master: BEGIN
[0m13:26:47.718949 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:47.958066 [debug] [MainThread]: SQL status: BEGIN in 0.238 seconds
[0m13:26:47.959136 [debug] [MainThread]: On master: COMMIT
[0m13:26:47.960163 [debug] [MainThread]: Using postgres connection "master"
[0m13:26:47.961276 [debug] [MainThread]: On master: COMMIT
[0m13:26:47.963283 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:26:47.964293 [debug] [MainThread]: On master: Close
[0m13:26:47.965355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:47.966397 [debug] [MainThread]: Connection 'create_propharma_snapshots' was properly closed.
[0m13:26:47.967407 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m13:26:47.968425 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m13:26:47.969453 [info ] [MainThread]: 
[0m13:26:47.972308 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m13:26:47.974469 [debug] [MainThread]: Command end result
[0m13:26:48.028446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:26:48.036009 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:26:48.049217 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:26:48.050253 [info ] [MainThread]: 
[0m13:26:48.052273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:26:48.054367 [info ] [MainThread]: 
[0m13:26:48.055722 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:26:48.058888 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:26:48.058382 after 8.16 seconds
[0m13:26:48.059893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FD3CDE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FCFD2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191FCFD2710>]}
[0m13:26:48.059893 [debug] [MainThread]: Flushing usage events
[0m13:26:49.251482 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:08.898605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1175A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1177590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1177090>]}


============================== 13:38:08.907846 | 3d575224-11fa-497f-ad98-4ead5308478a ==============================
[0m13:38:08.907846 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:38:08.910292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:38:09.370621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A130F250>]}
[0m13:38:09.484925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001869DE0D790>]}
[0m13:38:09.487881 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:38:10.376705 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:38:10.802637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:10.803634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:10.900886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A130F250>]}
[0m13:38:11.063943 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:38:11.075315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:38:11.133056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A276B390>]}
[0m13:38:11.135093 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m13:38:11.136496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A24D8910>]}
[0m13:38:11.141009 [info ] [MainThread]: 
[0m13:38:11.143295 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:38:11.144859 [info ] [MainThread]: 
[0m13:38:11.147511 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:11.161508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:38:11.543271 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:38:11.544705 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:38:11.545709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:11.824202 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.278 seconds
[0m13:38:11.827167 [debug] [ThreadPool]: On list_propharma: Close
[0m13:38:11.832780 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m13:38:11.844867 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:38:11.846831 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:38:11.846831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:12.192400 [debug] [ThreadPool]: SQL status: BEGIN in 0.345 seconds
[0m13:38:12.193616 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:38:12.194972 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:38:12.205773 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.010 seconds
[0m13:38:12.208861 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:38:12.210911 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:38:12.212094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m13:38:12.224432 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:38:12.224432 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:38:12.225971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:12.443256 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m13:38:12.445224 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:38:12.446397 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:38:12.458232 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m13:38:12.460962 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:38:12.462398 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:38:12.472444 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:12.474438 [debug] [MainThread]: On master: BEGIN
[0m13:38:12.475402 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:12.798136 [debug] [MainThread]: SQL status: BEGIN in 0.323 seconds
[0m13:38:12.800092 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:12.801086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:12.841852 [debug] [MainThread]: SQL status: SELECT 9 in 0.040 seconds
[0m13:38:12.847974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A24D8910>]}
[0m13:38:12.850020 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:12.851093 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:12.852139 [debug] [MainThread]: On master: BEGIN
[0m13:38:12.853423 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:38:12.855945 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.856985 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:12.858045 [debug] [MainThread]: On master: COMMIT
[0m13:38:12.859053 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:38:12.860083 [debug] [MainThread]: On master: Close
[0m13:38:12.870587 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:38:12.871824 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m13:38:12.874175 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m13:38:12.875216 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:38:12.888993 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:38:12.893073 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:38:12.963218 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:38:12.967608 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:12.968564 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:38:12.969838 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:38:13.194512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m13:38:13.195511 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:13.197506 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m13:38:13.206387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:38:13.219236 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:13.221228 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:38:13.223249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:13.229756 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:13.230752 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:38:13.233021 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:13.263655 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:38:13.264653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:13.266648 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:38:13.269748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:13.282749 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:38:13.291750 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:38:13.293711 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:38:13.298159 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:38:13.302516 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:38:13.307283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A129F550>]}
[0m13:38:13.309494 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m13:38:13.312527 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:38:13.313557 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:38:13.315552 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m13:38:13.316521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:38:13.318511 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:38:13.326076 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:38:13.330108 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:38:13.338119 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:38:13.342076 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:38:13.344071 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:38:13.345070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:13.581808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.237 seconds
[0m13:38:13.583770 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:38:13.584767 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m13:38:13.596482 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:38:13.607257 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:38:13.608254 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:38:13.611617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:13.614654 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:38:13.615689 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:38:13.617794 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:38:13.620292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:13.626245 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:38:13.627755 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:38:13.628790 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:38:13.631265 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:38:13.634452 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:38:13.636842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2AFEE90>]}
[0m13:38:13.638835 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:38:13.644429 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:38:13.646428 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:38:13.649360 [info ] [Thread-1 (]: 3 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m13:38:13.652032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:38:13.654034 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:38:13.658101 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:38:13.662090 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:38:13.670097 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:38:13.674719 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.676724 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:38:13.677716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:13.934274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m13:38:13.935390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.937441 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m13:38:13.946931 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:38:13.956724 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.958850 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:38:13.960844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:13.966828 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.967825 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:38:13.969821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:13.972811 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:38:13.973809 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.976294 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:38:13.978369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:38:13.983573 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:38:13.985636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:38:13.986634 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:38:13.992204 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:38:13.995343 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:38:13.997391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2F88DD0>]}
[0m13:38:13.998432 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.35s]
[0m13:38:14.001482 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:38:14.003321 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:38:14.005504 [info ] [Thread-1 (]: 4 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m13:38:14.007519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:38:14.008544 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:38:14.012301 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:38:14.015352 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:38:14.025254 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:38:14.029752 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.031746 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:38:14.032744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:14.277338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m13:38:14.278299 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.279347 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m13:38:14.288574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:38:14.295555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.296517 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:38:14.298551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.304796 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.305785 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:38:14.307790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.310779 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:38:14.311775 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.312775 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:38:14.315773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:14.320788 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:38:14.322783 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:38:14.323780 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:38:14.326808 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:38:14.330462 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:38:14.332466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2AF70D0>]}
[0m13:38:14.334456 [info ] [Thread-1 (]: 4 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:38:14.336692 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:38:14.338691 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:38:14.339719 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m13:38:14.341682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:38:14.342715 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:38:14.347666 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:38:14.350662 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:38:14.359147 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:38:14.363486 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.364554 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:38:14.366064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:14.607855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.242 seconds
[0m13:38:14.608849 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.609847 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m13:38:14.618831 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:38:14.625812 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.627742 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:38:14.629757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.634930 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.636536 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:38:14.638832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:14.641429 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:38:14.642431 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.644032 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:38:14.647030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:14.655125 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:38:14.656121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:38:14.658117 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:38:14.662106 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:38:14.665098 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:38:14.667095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2FDA810>]}
[0m13:38:14.669133 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m13:38:14.671354 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:38:14.672465 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:38:14.674213 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_suppliers .............................. [RUN]
[0m13:38:14.676215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:38:14.678206 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:38:14.742745 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:38:14.747701 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:38:14.755364 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:38:14.758357 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:14.760353 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:38:14.761349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:15.101723 [debug] [Thread-1 (]: SQL status: BEGIN in 0.341 seconds
[0m13:38:15.103766 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:15.104803 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m13:38:15.114213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:38:15.120688 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:15.122765 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:38:15.124806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:15.130689 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:15.131732 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:38:15.133690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:15.136729 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:38:15.137713 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:15.138680 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:38:15.142666 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:15.147682 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:38:15.148655 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:38:15.149679 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:38:15.153767 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:38:15.157353 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:38:15.158319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2FD3CD0>]}
[0m13:38:15.160347 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.48s]
[0m13:38:15.163037 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:38:15.164040 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:38:15.166078 [info ] [Thread-1 (]: 7 of 10 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m13:38:15.167407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m13:38:15.169078 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:38:15.179723 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:38:15.183712 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:38:15.225616 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:38:15.229579 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.231089 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:38:15.232084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:15.460988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m13:38:15.462982 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.463980 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:38:15.476905 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m13:38:15.490849 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.491809 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m13:38:15.493844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:15.499822 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.501077 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m13:38:15.503965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:15.507959 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:38:15.508988 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.510953 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:38:15.512969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:38:15.518018 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m13:38:15.524002 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:38:15.524999 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m13:38:15.531604 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:38:15.534599 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:38:15.536594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2B058D0>]}
[0m13:38:15.538589 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.37s]
[0m13:38:15.540903 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:38:15.541907 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:38:15.544207 [info ] [Thread-1 (]: 8 of 10 START sql table model public.mart_inventory_status ..................... [RUN]
[0m13:38:15.546586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m13:38:15.548587 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:38:15.557562 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:38:15.562847 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:38:15.570155 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:38:15.574107 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:38:15.576134 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:38:15.577098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:15.837183 [debug] [Thread-1 (]: SQL status: BEGIN in 0.260 seconds
[0m13:38:15.838181 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:38:15.840175 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  
    

  create  table "propharma"."public"."mart_inventory_status__dbt_tmp"
  
  
    as
  
  (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:38:15.854006 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m13:38:15.861988 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:38:15.862985 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:38:15.866216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:15.870819 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:38:15.871884 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:38:15.874068 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:38:15.876581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:15.882971 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:38:15.884964 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:38:15.885961 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop table if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:38:15.887959 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:38:15.890951 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:38:15.892946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2BEA590>]}
[0m13:38:15.895488 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.mart_inventory_status ................ [[32mSELECT 10[0m in 0.35s]
[0m13:38:15.897491 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:38:15.899530 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:38:15.902527 [info ] [Thread-1 (]: 9 of 10 START sql table model public.mart_sales_summary ........................ [RUN]
[0m13:38:15.904523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:38:15.906517 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:38:15.912938 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:38:15.916928 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:38:15.924906 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:38:15.928895 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:38:15.930398 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:38:15.931399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:16.178794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m13:38:16.180054 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:38:16.181056 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  
    

  create  table "propharma"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
  
[0m13:38:16.195992 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m13:38:16.202980 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:38:16.204976 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:38:16.207009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:16.211420 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:38:16.212417 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:38:16.213415 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:38:16.216757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:16.221904 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:38:16.223977 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:38:16.224981 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop table if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:38:16.226079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:38:16.229799 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:38:16.230816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2ACD690>]}
[0m13:38:16.232846 [info ] [Thread-1 (]: 9 of 10 OK created sql table model public.mart_sales_summary ................... [[32mSELECT 10[0m in 0.33s]
[0m13:38:16.236329 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:38:16.237332 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:38:16.238726 [info ] [Thread-1 (]: 10 of 10 START sql table model public.mart_top_customers ....................... [RUN]
[0m13:38:16.240684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:38:16.241710 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:38:16.248494 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:38:16.252780 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:38:16.260870 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:38:16.265166 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:38:16.266169 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:38:16.267165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:16.515176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.248 seconds
[0m13:38:16.516181 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:38:16.517983 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  
    

  create  table "propharma"."public"."mart_top_customers__dbt_tmp"
  
  
    as
  
  (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
[0m13:38:16.533573 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.014 seconds
[0m13:38:16.539552 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:38:16.540548 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:38:16.544502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:16.549737 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:38:16.551738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:38:16.553070 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:38:16.556138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:38:16.561139 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:38:16.562136 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:38:16.564131 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop table if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:38:16.565128 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m13:38:16.568400 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:38:16.569436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d575224-11fa-497f-ad98-4ead5308478a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A2A256D0>]}
[0m13:38:16.572412 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public.mart_top_customers .................. [[32mSELECT 10[0m in 0.33s]
[0m13:38:16.575163 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:38:16.577670 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:16.578695 [debug] [MainThread]: On master: BEGIN
[0m13:38:16.579695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:16.938275 [debug] [MainThread]: SQL status: BEGIN in 0.359 seconds
[0m13:38:16.939772 [debug] [MainThread]: On master: COMMIT
[0m13:38:16.940930 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:16.941969 [debug] [MainThread]: On master: COMMIT
[0m13:38:16.943640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:38:16.944896 [debug] [MainThread]: On master: Close
[0m13:38:16.945437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:16.947451 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:38:16.948457 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m13:38:16.949450 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:38:16.951444 [info ] [MainThread]: 
[0m13:38:16.952943 [info ] [MainThread]: Finished running 4 table models, 6 view models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m13:38:16.959933 [debug] [MainThread]: Command end result
[0m13:38:17.011152 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:38:17.017468 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:38:17.031951 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:38:17.032949 [info ] [MainThread]: 
[0m13:38:17.035429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:17.036949 [info ] [MainThread]: 
[0m13:38:17.040006 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:38:17.043057 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:17.042549 after 8.83 seconds
[0m13:38:17.044057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1180390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1181110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186A1182550>]}
[0m13:38:17.045059 [debug] [MainThread]: Flushing usage events
[0m13:38:18.576436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:41.098149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED724ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED72A6010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED72A7150>]}


============================== 13:38:41.107187 | 4c9575f4-12c8-4a78-9537-6b5cc8d684a4 ==============================
[0m13:38:41.107187 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:38:41.109288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:41.561555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c9575f4-12c8-4a78-9537-6b5cc8d684a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED7440850>]}
[0m13:38:41.699393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c9575f4-12c8-4a78-9537-6b5cc8d684a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED3EAF190>]}
[0m13:38:41.703189 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:38:42.560552 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:38:42.993151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:42.995192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:43.103452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c9575f4-12c8-4a78-9537-6b5cc8d684a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED86EF890>]}
[0m13:38:43.332687 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:38:43.345147 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:38:43.447554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c9575f4-12c8-4a78-9537-6b5cc8d684a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED8976650>]}
[0m13:38:43.449904 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m13:38:43.451899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c9575f4-12c8-4a78-9537-6b5cc8d684a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED8611850>]}
[0m13:38:43.457883 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:38:43.465496 [debug] [MainThread]: Command end result
[0m13:38:43.543041 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:38:43.552370 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:38:43.562168 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:38:43.565433 [debug] [MainThread]: Command `dbt test` succeeded at 13:38:43.565433 after 3.14 seconds
[0m13:38:43.566427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED21EFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED21EEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED21F80D0>]}
[0m13:38:43.567907 [debug] [MainThread]: Flushing usage events
[0m13:38:44.784410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:46.560694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD43D2DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD42F8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD47D5A90>]}


============================== 13:40:46.571793 | f2809b31-38b9-47f7-a425-5ddcefb330ad ==============================
[0m13:40:46.571793 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:40:46.573552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:47.102707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD156F0D0>]}
[0m13:40:47.231776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD4808110>]}
[0m13:40:47.234769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:40:48.113681 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:40:48.617578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:48.618575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:48.723304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5C65490>]}
[0m13:40:48.887471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:40:48.898906 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:40:48.957823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5DCF210>]}
[0m13:40:48.958824 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m13:40:48.960661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5B28F90>]}
[0m13:40:48.964980 [info ] [MainThread]: 
[0m13:40:48.966978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:48.967976 [info ] [MainThread]: 
[0m13:40:48.969873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:48.983338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:40:49.373991 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:40:49.375987 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:40:49.377981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:49.637257 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.260 seconds
[0m13:40:49.640633 [debug] [ThreadPool]: On list_propharma: Close
[0m13:40:49.647544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m13:40:49.660081 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:40:49.661122 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:40:49.662158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:50.009691 [debug] [ThreadPool]: SQL status: BEGIN in 0.347 seconds
[0m13:40:50.010724 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:40:50.011723 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:50.023217 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.011 seconds
[0m13:40:50.026750 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:40:50.028748 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:40:50.030918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m13:40:50.040929 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:40:50.041928 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:40:50.043400 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:50.363673 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m13:40:50.365667 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:40:50.366667 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:40:50.377637 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m13:40:50.380661 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:40:50.381625 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:40:50.394186 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.396178 [debug] [MainThread]: On master: BEGIN
[0m13:40:50.397204 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:50.708631 [debug] [MainThread]: SQL status: BEGIN in 0.312 seconds
[0m13:40:50.709673 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.711166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:50.752616 [debug] [MainThread]: SQL status: SELECT 6 in 0.040 seconds
[0m13:40:50.757856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD40FB490>]}
[0m13:40:50.758858 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:50.760255 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.761719 [debug] [MainThread]: On master: BEGIN
[0m13:40:50.763714 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:40:50.764711 [debug] [MainThread]: On master: COMMIT
[0m13:40:50.765708 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.766705 [debug] [MainThread]: On master: COMMIT
[0m13:40:50.768700 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:50.769697 [debug] [MainThread]: On master: Close
[0m13:40:50.779313 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:40:50.781514 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_inventory .............................. [RUN]
[0m13:40:50.782543 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m13:40:50.784334 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:40:50.798332 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:40:50.802347 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:40:50.867520 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:40:50.871112 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:50.872825 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:40:50.873826 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:51.192325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.319 seconds
[0m13:40:51.194342 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:51.195351 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m13:40:51.204694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:40:51.217797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:51.218807 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:40:51.220864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:51.226940 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:51.227938 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:40:51.229545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:51.260504 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:40:51.262464 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:51.263494 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:40:51.269257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:40:51.281385 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:40:51.292356 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:40:51.293353 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:40:51.296388 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:51.301736 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:40:51.306688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5B73250>]}
[0m13:40:51.308433 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.52s]
[0m13:40:51.310725 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:40:51.311757 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:40:51.313754 [info ] [Thread-1 (]: 2 of 10 START sql view model public.stg_medicines .............................. [RUN]
[0m13:40:51.315262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:40:51.316264 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:40:51.322556 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:40:51.326550 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:40:51.333552 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:40:51.337507 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.338505 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:40:51.339502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:51.652858 [debug] [Thread-1 (]: SQL status: BEGIN in 0.312 seconds
[0m13:40:51.653892 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.654905 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m13:40:51.663829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:40:51.670850 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.671846 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m13:40:51.673735 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:51.680166 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.681161 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:40:51.682786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:51.686111 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:40:51.687146 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.688436 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:40:51.697568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:40:51.703223 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:40:51.704186 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:40:51.705956 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:40:51.709428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:40:51.712238 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:40:51.714460 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5DF3ED0>]}
[0m13:40:51.715468 [info ] [Thread-1 (]: 2 of 10 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.40s]
[0m13:40:51.719005 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:40:51.720963 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:40:51.722964 [info ] [Thread-1 (]: 3 of 10 START sql view model public.stg_patients ............................... [RUN]
[0m13:40:51.724959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:40:51.725959 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:40:51.730237 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:40:51.733480 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:40:51.743610 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:40:51.747599 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:51.748596 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:40:51.749594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:51.985751 [debug] [Thread-1 (]: SQL status: BEGIN in 0.237 seconds
[0m13:40:51.987721 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:51.988758 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m13:40:51.998137 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:40:52.005125 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:52.006122 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:40:52.008176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.014109 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:52.015108 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:40:52.017904 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.020015 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:40:52.021953 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:52.023411 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:40:52.029369 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:40:52.034271 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:40:52.035269 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:40:52.037217 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:40:52.039868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:52.043802 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:40:52.045140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD65DDF50>]}
[0m13:40:52.047141 [info ] [Thread-1 (]: 3 of 10 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:40:52.050422 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:40:52.051418 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:40:52.053414 [info ] [Thread-1 (]: 4 of 10 START sql view model public.stg_prescriptions .......................... [RUN]
[0m13:40:52.054411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:40:52.056406 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:40:52.060394 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:40:52.062683 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:40:52.072013 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:40:52.076261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.077904 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:40:52.078914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:52.323209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m13:40:52.325057 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.327056 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m13:40:52.336031 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:40:52.344012 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.345423 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:40:52.346746 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.354276 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.355272 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:40:52.358269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.362259 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:40:52.363255 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.364253 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:40:52.370286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:40:52.375892 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:40:52.377892 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:40:52.378890 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:40:52.383393 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:52.386445 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:40:52.388439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6180490>]}
[0m13:40:52.389437 [info ] [Thread-1 (]: 4 of 10 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m13:40:52.393251 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:40:52.394260 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:40:52.396278 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_sales .................................. [RUN]
[0m13:40:52.397748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:40:52.399757 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:40:52.403337 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:40:52.408227 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:40:52.420836 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:40:52.426166 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.428161 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:40:52.430156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:52.793252 [debug] [Thread-1 (]: SQL status: BEGIN in 0.363 seconds
[0m13:40:52.795264 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.796261 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m13:40:52.805239 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:40:52.812220 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.813218 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:40:52.815213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.824702 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.825700 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:40:52.827910 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:52.831081 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:40:52.832365 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.833371 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:40:52.839203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:40:52.902791 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:40:52.905347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:40:52.906350 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:40:52.909784 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:52.912742 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:40:52.914736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6618C50>]}
[0m13:40:52.915733 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.52s]
[0m13:40:52.918215 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:40:52.920598 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:40:52.921618 [info ] [Thread-1 (]: 6 of 10 START sql view model public.stg_suppliers .............................. [RUN]
[0m13:40:52.923913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:40:52.925398 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:40:52.929008 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:40:52.933000 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:40:52.943996 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:40:52.948600 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:52.949606 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:40:52.950631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:53.207655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m13:40:53.209650 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:53.211644 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m13:40:53.223614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:40:53.234370 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:53.236387 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:40:53.238399 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:53.246837 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:53.249156 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:40:53.251175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:53.255344 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:40:53.256355 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:53.258370 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:40:53.263844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:40:53.269850 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:40:53.271845 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:40:53.272843 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:40:53.277514 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:40:53.281534 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:40:53.284870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD46B7490>]}
[0m13:40:53.286873 [info ] [Thread-1 (]: 6 of 10 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m13:40:53.290215 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:40:53.293212 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:40:53.295206 [info ] [Thread-1 (]: 7 of 10 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m13:40:53.298435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m13:40:53.299674 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:40:53.312362 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:40:53.317433 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:40:53.359695 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:40:53.363684 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.365678 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:40:53.366677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:53.637382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.271 seconds
[0m13:40:53.639376 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.641667 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:40:53.661621 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m13:40:53.676653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.678666 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m13:40:53.679938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:53.686254 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.688269 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m13:40:53.691585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:53.695986 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:40:53.698176 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.700192 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:40:53.703267 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:40:53.716233 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m13:40:53.723725 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:40:53.724723 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m13:40:53.731790 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:40:53.734819 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:40:53.736827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD61FBB50>]}
[0m13:40:53.738821 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.44s]
[0m13:40:53.741930 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:40:53.744131 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:40:53.746125 [info ] [Thread-1 (]: 8 of 10 START sql table model public.mart_inventory_status ..................... [RUN]
[0m13:40:53.749118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m13:40:53.751113 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:40:53.760111 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:40:53.764307 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:40:53.775555 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:40:53.779772 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:53.781788 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:40:53.782794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:54.040231 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m13:40:54.041228 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:54.043222 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  
    

  create  table "propharma"."public"."mart_inventory_status__dbt_tmp"
  
  
    as
  
  (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:40:54.057184 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m13:40:54.064164 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:54.065201 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status" rename to "mart_inventory_status__dbt_backup"
[0m13:40:54.067190 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:54.073740 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:54.074700 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:40:54.078326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:54.082322 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:40:54.083350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:54.085002 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:40:54.087381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:40:54.092336 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:40:54.094332 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:40:54.095330 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop table if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:40:54.102055 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:40:54.107050 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:40:54.109045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5B71450>]}
[0m13:40:54.111036 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.mart_inventory_status ................ [[32mSELECT 10[0m in 0.36s]
[0m13:40:54.113030 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:40:54.114739 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:40:54.115741 [info ] [Thread-1 (]: 9 of 10 START sql table model public.mart_sales_summary ........................ [RUN]
[0m13:40:54.118253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:40:54.120247 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:40:54.126230 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:40:54.130222 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:40:54.141180 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:40:54.146174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.147772 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:40:54.148777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:54.416991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.268 seconds
[0m13:40:54.417993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.419988 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  
    

  create  table "propharma"."public"."mart_sales_summary__dbt_tmp"
  
  
    as
  
  (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
  
[0m13:40:54.436942 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m13:40:54.443924 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.445918 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m13:40:54.447913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:54.453897 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.455892 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:40:54.459881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:54.463871 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:40:54.465884 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.466889 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:40:54.471498 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:40:54.475894 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:40:54.477905 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:40:54.478912 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop table if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:40:54.487097 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:40:54.492113 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:40:54.494126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD6240490>]}
[0m13:40:54.495135 [info ] [Thread-1 (]: 9 of 10 OK created sql table model public.mart_sales_summary ................... [[32mSELECT 10[0m in 0.37s]
[0m13:40:54.499346 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:40:54.500352 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:40:54.502507 [info ] [Thread-1 (]: 10 of 10 START sql table model public.mart_top_customers ....................... [RUN]
[0m13:40:54.504508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:40:54.506512 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:40:54.515079 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:40:54.519590 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:40:54.530560 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:40:54.534549 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.535547 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:40:54.536544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:54.798109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.261 seconds
[0m13:40:54.800121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.801132 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  
    

  create  table "propharma"."public"."mart_top_customers__dbt_tmp"
  
  
    as
  
  (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
[0m13:40:54.817371 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m13:40:54.823943 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.825086 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers" rename to "mart_top_customers__dbt_backup"
[0m13:40:54.827108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:54.833142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.834149 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:40:54.837628 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:54.842931 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:40:54.844999 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.846004 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:40:54.850053 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:40:54.856073 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:40:54.857039 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:40:54.858520 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop table if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:40:54.864678 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:40:54.867650 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:40:54.869632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2809b31-38b9-47f7-a425-5ddcefb330ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD5DF7A90>]}
[0m13:40:54.871626 [info ] [Thread-1 (]: 10 of 10 OK created sql table model public.mart_top_customers .................. [[32mSELECT 10[0m in 0.37s]
[0m13:40:54.874618 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:40:54.877610 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:54.879604 [debug] [MainThread]: On master: BEGIN
[0m13:40:54.880601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:55.131846 [debug] [MainThread]: SQL status: BEGIN in 0.251 seconds
[0m13:40:55.132843 [debug] [MainThread]: On master: COMMIT
[0m13:40:55.134838 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:55.135836 [debug] [MainThread]: On master: COMMIT
[0m13:40:55.137830 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:55.138827 [debug] [MainThread]: On master: Close
[0m13:40:55.139825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:55.141922 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:40:55.142931 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m13:40:55.144331 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:40:55.145336 [info ] [MainThread]: 
[0m13:40:55.147331 [info ] [MainThread]: Finished running 4 table models, 6 view models in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m13:40:55.154330 [debug] [MainThread]: Command end result
[0m13:40:55.210185 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:40:55.216172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:40:55.230643 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:40:55.231641 [info ] [MainThread]: 
[0m13:40:55.233635 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:55.235630 [info ] [MainThread]: 
[0m13:40:55.237625 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:40:55.241614 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:55.241614 after 9.40 seconds
[0m13:40:55.242611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CD49D04D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCF6AEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CCF6AFBD0>]}
[0m13:40:55.243609 [debug] [MainThread]: Flushing usage events
[0m13:40:56.617263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:08.048603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101E86ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101E8A4F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101E8A5010>]}


============================== 13:41:08.058576 | 0fcbdca4-cb72-47e8-bacb-4276ddecb27b ==============================
[0m13:41:08.058576 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:41:08.060734 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:41:08.490553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101EA60990>]}
[0m13:41:08.620449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101B4CD210>]}
[0m13:41:08.623412 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:09.535767 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:41:09.723120 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:41:09.725115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101FA8E990>]}
[0m13:41:12.341723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101E86DED0>]}
[0m13:41:12.501084 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:41:12.512053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:41:12.572451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101FF99050>]}
[0m13:41:12.573451 [info ] [MainThread]: Found 10 models, 1 snapshot, 1 seed, 434 macros
[0m13:41:12.575443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101FFC4A90>]}
[0m13:41:12.579434 [info ] [MainThread]: 
[0m13:41:12.581429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:12.582427 [info ] [MainThread]: 
[0m13:41:12.584422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:12.598251 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m13:41:12.982474 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m13:41:12.983475 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m13:41:12.984471 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:13.231443 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.247 seconds
[0m13:41:13.234439 [debug] [ThreadPool]: On list_propharma: Close
[0m13:41:13.239939 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m13:41:13.250940 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:41:13.251943 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m13:41:13.252904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:13.470687 [debug] [ThreadPool]: SQL status: BEGIN in 0.217 seconds
[0m13:41:13.471785 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m13:41:13.472950 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:13.484227 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m13:41:13.487452 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m13:41:13.488659 [debug] [ThreadPool]: On list_propharma_public: Close
[0m13:41:13.491070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m13:41:13.501504 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:41:13.502636 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m13:41:13.504156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:13.747596 [debug] [ThreadPool]: SQL status: BEGIN in 0.243 seconds
[0m13:41:13.748101 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m13:41:13.750173 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:41:13.761149 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m13:41:13.763144 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m13:41:13.765139 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m13:41:13.776163 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:13.777171 [debug] [MainThread]: On master: BEGIN
[0m13:41:13.778177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:14.034703 [debug] [MainThread]: SQL status: BEGIN in 0.256 seconds
[0m13:41:14.035208 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.036214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:14.079058 [debug] [MainThread]: SQL status: SELECT 6 in 0.040 seconds
[0m13:41:14.084043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020451950>]}
[0m13:41:14.085041 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:14.086038 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.087187 [debug] [MainThread]: On master: BEGIN
[0m13:41:14.089553 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:41:14.090709 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.091725 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:14.092734 [debug] [MainThread]: On master: COMMIT
[0m13:41:14.094023 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:14.096032 [debug] [MainThread]: On master: Close
[0m13:41:14.105316 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m13:41:14.106372 [info ] [Thread-1 (]: 1 of 10 START sql table model public.stg_inventory ............................. [RUN]
[0m13:41:14.109344 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m13:41:14.110801 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m13:41:14.123405 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m13:41:14.127475 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m13:41:14.213600 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m13:41:14.217805 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.218847 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m13:41:14.220166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:14.485088 [debug] [Thread-1 (]: SQL status: BEGIN in 0.265 seconds
[0m13:41:14.487108 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.488122 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  
    

  create  table "propharma"."public"."stg_inventory__dbt_tmp"
  
  
    as
  
  (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
[0m13:41:14.505266 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.016 seconds
[0m13:41:14.524452 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.526448 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m13:41:14.528446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:14.534430 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.535427 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m13:41:14.538693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:14.571258 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:41:14.572256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.574252 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m13:41:14.579614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:41:14.591873 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m13:41:14.603838 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m13:41:14.604835 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m13:41:14.608428 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:41:14.613449 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m13:41:14.618408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210205EB110>]}
[0m13:41:14.619405 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.stg_inventory ........................ [[32mSELECT 10[0m in 0.51s]
[0m13:41:14.622397 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m13:41:14.623680 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m13:41:14.625185 [info ] [Thread-1 (]: 2 of 10 START sql table model public.stg_medicines ............................. [RUN]
[0m13:41:14.627598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m13:41:14.628631 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m13:41:14.632623 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m13:41:14.635935 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m13:41:14.643822 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m13:41:14.647150 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:14.649179 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m13:41:14.650091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:14.972759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.323 seconds
[0m13:41:14.973805 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:14.975421 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  
    

  create  table "propharma"."public"."stg_medicines__dbt_tmp"
  
  
    as
  
  (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
[0m13:41:14.986355 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m13:41:14.993761 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:14.994752 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m13:41:14.996976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:15.002999 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:15.003964 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m13:41:15.007401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:15.010392 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:41:15.010392 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:15.012859 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m13:41:15.021846 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:41:15.028180 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m13:41:15.029210 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m13:41:15.030613 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m13:41:15.034189 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:15.037410 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m13:41:15.038918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210205EA890>]}
[0m13:41:15.040918 [info ] [Thread-1 (]: 2 of 10 OK created sql table model public.stg_medicines ........................ [[32mSELECT 11[0m in 0.41s]
[0m13:41:15.044204 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m13:41:15.045209 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m13:41:15.047944 [info ] [Thread-1 (]: 3 of 10 START sql table model public.stg_patients .............................. [RUN]
[0m13:41:15.049944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m13:41:15.050974 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m13:41:15.055272 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m13:41:15.058991 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m13:41:15.066347 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m13:41:15.069339 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.071337 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m13:41:15.072875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.291122 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m13:41:15.293117 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.294114 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  
    

  create  table "propharma"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
[0m13:41:15.305120 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.009 seconds
[0m13:41:15.312508 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.313503 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m13:41:15.315497 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:15.321454 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.322453 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m13:41:15.326449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:15.330434 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:41:15.331464 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.332461 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m13:41:15.335424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:41:15.342612 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m13:41:15.344609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m13:41:15.345606 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m13:41:15.349593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:15.352622 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m13:41:15.353619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102062BD10>]}
[0m13:41:15.355369 [info ] [Thread-1 (]: 3 of 10 OK created sql table model public.stg_patients ......................... [[32mSELECT 10[0m in 0.30s]
[0m13:41:15.358973 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m13:41:15.360005 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m13:41:15.361971 [info ] [Thread-1 (]: 4 of 10 START sql table model public.stg_prescriptions ......................... [RUN]
[0m13:41:15.362769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m13:41:15.364343 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m13:41:15.368545 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m13:41:15.372440 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m13:41:15.380112 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m13:41:15.384071 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.385067 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m13:41:15.386065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:15.709518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.323 seconds
[0m13:41:15.711485 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.712483 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  
    

  create  table "propharma"."public"."stg_prescriptions__dbt_tmp"
  
  
    as
  
  (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
[0m13:41:15.723647 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m13:41:15.730214 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.731736 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m13:41:15.733813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:15.739398 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.741401 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m13:41:15.744388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:15.748377 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:41:15.749405 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.750377 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m13:41:15.753366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:41:15.758354 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m13:41:15.760350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m13:41:15.761347 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m13:41:15.764373 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:15.767331 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m13:41:15.769326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210204D3890>]}
[0m13:41:15.771321 [info ] [Thread-1 (]: 4 of 10 OK created sql table model public.stg_prescriptions .................... [[32mSELECT 10[0m in 0.41s]
[0m13:41:15.773650 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m13:41:15.775645 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m13:41:15.776642 [info ] [Thread-1 (]: 5 of 10 START sql table model public.stg_sales ................................. [RUN]
[0m13:41:15.778769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m13:41:15.779305 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m13:41:15.783651 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m13:41:15.787612 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m13:41:15.797584 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m13:41:15.801567 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:15.802572 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m13:41:15.803566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.037899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m13:41:16.038910 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:16.040418 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  
    

  create  table "propharma"."public"."stg_sales__dbt_tmp"
  
  
    as
  
  (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
[0m13:41:16.050812 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m13:41:16.059069 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:16.061142 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m13:41:16.062108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:16.068538 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:16.069529 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m13:41:16.072793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:16.076782 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:41:16.076782 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:16.078775 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m13:41:16.084249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:41:16.089305 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m13:41:16.091271 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m13:41:16.092297 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m13:41:16.095800 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:16.098476 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m13:41:16.100728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002102009EDD0>]}
[0m13:41:16.101743 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.stg_sales ............................ [[32mSELECT 10[0m in 0.32s]
[0m13:41:16.105134 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m13:41:16.106407 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m13:41:16.108037 [info ] [Thread-1 (]: 6 of 10 START sql table model public.stg_suppliers ............................. [RUN]
[0m13:41:16.110137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m13:41:16.110674 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m13:41:16.114832 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m13:41:16.118460 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m13:41:16.129847 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m13:41:16.134058 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.135060 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m13:41:16.136058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.356162 [debug] [Thread-1 (]: SQL status: BEGIN in 0.220 seconds
[0m13:41:16.357677 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.358696 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  
    

  create  table "propharma"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
[0m13:41:16.369873 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m13:41:16.375852 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.377816 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m13:41:16.378845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:16.384833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.386792 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m13:41:16.389786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:16.392780 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:41:16.394774 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.395772 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m13:41:16.397796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:41:16.402780 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m13:41:16.404749 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m13:41:16.405781 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m13:41:16.409770 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:41:16.412758 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m13:41:16.413720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020619710>]}
[0m13:41:16.415716 [info ] [Thread-1 (]: 6 of 10 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 10[0m in 0.30s]
[0m13:41:16.418522 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m13:41:16.419554 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m13:41:16.420861 [info ] [Thread-1 (]: 7 of 10 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m13:41:16.422901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m13:41:16.424215 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m13:41:16.432202 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m13:41:16.436228 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m13:41:16.443421 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m13:41:16.447383 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.448380 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m13:41:16.450252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:16.667867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m13:41:16.668409 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.669458 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m13:41:16.682349 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m13:41:16.688898 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.689930 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m13:41:16.691906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:16.698631 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.699599 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m13:41:16.702865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:16.705600 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:41:16.707631 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.708653 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m13:41:16.714792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:41:16.720429 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m13:41:16.725888 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m13:41:16.726883 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m13:41:16.733364 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:41:16.736362 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m13:41:16.737360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021020081710>]}
[0m13:41:16.739392 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.31s]
[0m13:41:16.741897 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m13:41:16.743892 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m13:41:16.744889 [info ] [Thread-1 (]: 8 of 10 START sql view model public.mart_inventory_status ...................... [RUN]
[0m13:41:16.747068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m13:41:16.748063 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m13:41:16.754548 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m13:41:16.757543 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m13:41:16.795821 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m13:41:16.799553 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:16.800095 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m13:41:16.801772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:17.026997 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m13:41:17.028992 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:17.029989 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m13:41:17.039547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:41:17.045294 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:17.046334 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status" rename to "mart_inventory_status__dbt_backup"
[0m13:41:17.048417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.055021 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:17.055987 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m13:41:17.057986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.060977 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:41:17.061975 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:17.062972 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m13:41:17.072041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:41:17.078454 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m13:41:17.079451 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m13:41:17.081446 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop table if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m13:41:17.086464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:41:17.090453 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m13:41:17.091415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210204F1ED0>]}
[0m13:41:17.093414 [info ] [Thread-1 (]: 8 of 10 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.34s]
[0m13:41:17.096643 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m13:41:17.098065 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m13:41:17.099580 [info ] [Thread-1 (]: 9 of 10 START sql view model public.mart_sales_summary ......................... [RUN]
[0m13:41:17.101119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m13:41:17.103118 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m13:41:17.108140 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m13:41:17.111127 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m13:41:17.119109 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m13:41:17.123068 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.124099 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m13:41:17.125103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:17.356594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m13:41:17.357555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.358592 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m13:41:17.367565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:41:17.374549 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.375506 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m13:41:17.377538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.383527 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.384519 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m13:41:17.386513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.389910 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:41:17.390907 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.391904 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m13:41:17.395276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:41:17.401755 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m13:41:17.403898 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m13:41:17.404404 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop table if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m13:41:17.410000 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:41:17.413979 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m13:41:17.414976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101FCAC850>]}
[0m13:41:17.416971 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.mart_sales_summary .................... [[32mCREATE VIEW[0m in 0.31s]
[0m13:41:17.420143 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m13:41:17.421139 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m13:41:17.423309 [info ] [Thread-1 (]: 10 of 10 START sql view model public.mart_top_customers ........................ [RUN]
[0m13:41:17.424515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m13:41:17.425547 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m13:41:17.432091 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m13:41:17.435084 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m13:41:17.442358 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m13:41:17.447629 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.449662 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m13:41:17.451236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:17.679416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m13:41:17.680423 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.681418 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m13:41:17.692160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:41:17.698263 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.699260 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers" rename to "mart_top_customers__dbt_backup"
[0m13:41:17.701666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.709647 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.711642 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m13:41:17.713674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:17.715669 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:41:17.717626 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.718659 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m13:41:17.724013 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:41:17.729230 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m13:41:17.730272 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m13:41:17.731803 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop table if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m13:41:17.738601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:41:17.741597 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m13:41:17.743104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fcbdca4-cb72-47e8-bacb-4276ddecb27b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210209F0290>]}
[0m13:41:17.744101 [info ] [Thread-1 (]: 10 of 10 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.32s]
[0m13:41:17.747480 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m13:41:17.750481 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:17.751624 [debug] [MainThread]: On master: BEGIN
[0m13:41:17.753828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:17.979449 [debug] [MainThread]: SQL status: BEGIN in 0.227 seconds
[0m13:41:17.981476 [debug] [MainThread]: On master: COMMIT
[0m13:41:17.982714 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:17.984207 [debug] [MainThread]: On master: COMMIT
[0m13:41:17.985540 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:17.986831 [debug] [MainThread]: On master: Close
[0m13:41:17.988339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:17.990640 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m13:41:17.991708 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m13:41:17.993747 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m13:41:17.994745 [info ] [MainThread]: 
[0m13:41:17.997736 [info ] [MainThread]: Finished running 7 table models, 3 view models in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m13:41:18.005521 [debug] [MainThread]: Command end result
[0m13:41:18.058657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m13:41:18.064640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m13:41:18.079706 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m13:41:18.080704 [info ] [MainThread]: 
[0m13:41:18.082963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:18.084501 [info ] [MainThread]: 
[0m13:41:18.085800 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:41:18.088305 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:18.088305 after 10.82 seconds
[0m13:41:18.090300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101E3F8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101979EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002101979FBD0>]}
[0m13:41:18.091297 [debug] [MainThread]: Flushing usage events
[0m13:41:19.450514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:52.198143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00C375D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F008430D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00C36290>]}


============================== 17:12:52.206663 | 9ec38e6d-4c83-408a-baa9-6465c8a27700 ==============================
[0m17:12:52.206663 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:52.209036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:52.627533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00D5CFD0>]}
[0m17:12:52.739727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7D76D490>]}
[0m17:12:52.742719 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:53.544991 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:53.980721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:12:53.981761 [debug] [MainThread]: Partial parsing: added file: Propharma://models\marts\mart_invoice.sql
[0m17:12:54.476974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0208EA10>]}
[0m17:12:54.633312 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:12:54.643286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:12:54.706492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F022F7D50>]}
[0m17:12:54.707869 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 434 macros
[0m17:12:54.710406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00D54D50>]}
[0m17:12:54.714444 [info ] [MainThread]: 
[0m17:12:54.716398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:54.717396 [info ] [MainThread]: 
[0m17:12:54.719391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:54.733569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m17:12:55.199743 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m17:12:55.200741 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m17:12:55.202258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:55.479354 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.278 seconds
[0m17:12:55.482846 [debug] [ThreadPool]: On list_propharma: Close
[0m17:12:55.487879 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m17:12:55.502957 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:12:55.504961 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:12:55.505964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:55.751173 [debug] [ThreadPool]: SQL status: BEGIN in 0.245 seconds
[0m17:12:55.753167 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:12:55.754163 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:12:55.765135 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.010 seconds
[0m17:12:55.768371 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:12:55.769368 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:12:55.771362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m17:12:55.781084 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:12:55.782083 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:12:55.783079 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:55.998381 [debug] [ThreadPool]: SQL status: BEGIN in 0.215 seconds
[0m17:12:55.999410 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:12:56.000375 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:12:56.011367 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m17:12:56.014337 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:12:56.015335 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:12:56.027815 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:56.028886 [debug] [MainThread]: On master: BEGIN
[0m17:12:56.029919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:56.253861 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m17:12:56.255871 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:56.256874 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:56.296881 [debug] [MainThread]: SQL status: SELECT 6 in 0.039 seconds
[0m17:12:56.302017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02737C10>]}
[0m17:12:56.303059 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:56.305127 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:56.306194 [debug] [MainThread]: On master: BEGIN
[0m17:12:56.307191 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:12:56.308617 [debug] [MainThread]: On master: COMMIT
[0m17:12:56.309661 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:56.310668 [debug] [MainThread]: On master: COMMIT
[0m17:12:56.311710 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:56.312717 [debug] [MainThread]: On master: Close
[0m17:12:56.323124 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:12:56.324125 [info ] [Thread-1 (]: 1 of 11 START sql table model public.stg_inventory ............................. [RUN]
[0m17:12:56.325659 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:12:56.328080 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:12:56.344041 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:12:56.348031 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:12:56.419356 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m17:12:56.423312 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.424308 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m17:12:56.425305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:56.644697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m17:12:56.645922 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.647620 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  
    

  create  table "propharma"."public"."stg_inventory__dbt_tmp"
  
  
    as
  
  (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
[0m17:12:56.658403 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m17:12:56.684141 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.685137 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m17:12:56.687133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:56.693124 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.694116 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m17:12:56.697875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:56.728916 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:12:56.730919 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.731909 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:12:56.736861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:12:56.748765 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m17:12:56.758778 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:12:56.759776 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop table if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m17:12:56.767074 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:12:56.771645 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m17:12:56.776017 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02B48110>]}
[0m17:12:56.778048 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.stg_inventory ........................ [[32mSELECT 10[0m in 0.45s]
[0m17:12:56.780581 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:12:56.781688 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:12:56.783774 [info ] [Thread-1 (]: 2 of 11 START sql table model public.stg_medicines ............................. [RUN]
[0m17:12:56.785662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:12:56.786664 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:12:56.795122 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:12:56.799076 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:12:56.867171 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m17:12:56.871640 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:56.872686 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m17:12:56.873692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.089035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.215 seconds
[0m17:12:57.090077 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:57.091511 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  
    

  create  table "propharma"."public"."stg_medicines__dbt_tmp"
  
  
    as
  
  (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
[0m17:12:57.103171 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.010 seconds
[0m17:12:57.109154 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:57.110151 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m17:12:57.113144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:57.121122 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:57.122119 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m17:12:57.125153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:57.129160 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:12:57.130157 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:57.131154 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:12:57.141493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:12:57.147109 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m17:12:57.148073 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:12:57.149102 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop table if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m17:12:57.155868 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:12:57.158860 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m17:12:57.159861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00C88110>]}
[0m17:12:57.161956 [info ] [Thread-1 (]: 2 of 11 OK created sql table model public.stg_medicines ........................ [[32mSELECT 11[0m in 0.38s]
[0m17:12:57.164952 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:12:57.165945 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:12:57.168191 [info ] [Thread-1 (]: 3 of 11 START sql table model public.stg_patients .............................. [RUN]
[0m17:12:57.170298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:12:57.171810 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:12:57.175798 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:12:57.180784 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:12:57.189793 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m17:12:57.193463 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.195765 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m17:12:57.196763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.426989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m17:12:57.429164 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.430219 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  
    

  create  table "propharma"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
[0m17:12:57.441697 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m17:12:57.447688 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.449683 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m17:12:57.450680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:57.456842 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.458838 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m17:12:57.461343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:57.464335 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:12:57.466330 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.467329 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:12:57.477168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:12:57.482744 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m17:12:57.483714 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:12:57.485750 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop table if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m17:12:57.491896 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:12:57.495650 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m17:12:57.496689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02B8BA90>]}
[0m17:12:57.498649 [info ] [Thread-1 (]: 3 of 11 OK created sql table model public.stg_patients ......................... [[32mSELECT 10[0m in 0.33s]
[0m17:12:57.501043 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:12:57.502848 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:12:57.503386 [info ] [Thread-1 (]: 4 of 11 START sql table model public.stg_prescriptions ......................... [RUN]
[0m17:12:57.506422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:12:57.506928 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:12:57.511951 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:12:57.514946 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:12:57.527166 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m17:12:57.530980 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.530980 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m17:12:57.532421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:57.862378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.329 seconds
[0m17:12:57.863375 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.865336 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  
    

  create  table "propharma"."public"."stg_prescriptions__dbt_tmp"
  
  
    as
  
  (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
[0m17:12:57.875924 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m17:12:57.881907 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.882915 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m17:12:57.885786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:57.891732 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.892739 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m17:12:57.895855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:57.899928 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:12:57.901451 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.902483 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:12:57.905323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:12:57.910540 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m17:12:57.912535 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:12:57.913532 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop table if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m17:12:57.919684 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:12:57.922843 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m17:12:57.923883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02B503D0>]}
[0m17:12:57.926016 [info ] [Thread-1 (]: 4 of 11 OK created sql table model public.stg_prescriptions .................... [[32mSELECT 10[0m in 0.42s]
[0m17:12:57.929312 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:12:57.930352 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:12:57.931315 [info ] [Thread-1 (]: 5 of 11 START sql table model public.stg_sales ................................. [RUN]
[0m17:12:57.933440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:12:57.934466 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:12:57.938849 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:12:57.943325 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:12:57.950557 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m17:12:57.954658 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:57.955743 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m17:12:57.956791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.175525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.218 seconds
[0m17:12:58.176522 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:58.177519 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  
    

  create  table "propharma"."public"."stg_sales__dbt_tmp"
  
  
    as
  
  (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
[0m17:12:58.188727 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.010 seconds
[0m17:12:58.195600 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:58.196598 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:12:58.198561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:58.204581 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:58.205575 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:12:58.208566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:58.213013 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:12:58.214056 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:58.215961 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:12:58.226085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:12:58.231536 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m17:12:58.233528 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:12:58.234528 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop table if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m17:12:58.242870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:12:58.245862 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m17:12:58.247858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02023890>]}
[0m17:12:58.250853 [info ] [Thread-1 (]: 5 of 11 OK created sql table model public.stg_sales ............................ [[32mSELECT 10[0m in 0.31s]
[0m17:12:58.253332 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:12:58.255439 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:12:58.257438 [info ] [Thread-1 (]: 6 of 11 START sql table model public.stg_suppliers ............................. [RUN]
[0m17:12:58.259433 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:12:58.260433 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:12:58.264449 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:12:58.268773 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:12:58.275759 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m17:12:58.279752 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.281745 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m17:12:58.282743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.500102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m17:12:58.501106 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.502825 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  
    

  create  table "propharma"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
[0m17:12:58.515465 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m17:12:58.521397 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.523357 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m17:12:58.524390 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:58.533197 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.534195 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m17:12:58.537986 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:58.541973 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:12:58.543106 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.544248 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:12:58.546405 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:12:58.551827 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m17:12:58.552833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:12:58.553870 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop table if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m17:12:58.560466 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:12:58.563456 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m17:12:58.564424 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F01DC80D0>]}
[0m17:12:58.566433 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 10[0m in 0.30s]
[0m17:12:58.569940 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:12:58.571935 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:12:58.573054 [info ] [Thread-1 (]: 7 of 11 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m17:12:58.575907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m17:12:58.576936 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:12:58.586877 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:12:58.590403 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:12:58.598057 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m17:12:58.602160 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.603422 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m17:12:58.604845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:58.833773 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m17:12:58.834769 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.835767 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m17:12:58.848919 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m17:12:58.855864 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.856861 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m17:12:58.858891 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:58.864603 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.865603 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m17:12:58.869110 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:58.873141 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:12:58.874139 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.875931 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:12:58.878789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:12:58.884036 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m17:12:58.885033 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:12:58.886553 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m17:12:58.892110 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:12:58.895575 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m17:12:58.897625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F022FB6D0>]}
[0m17:12:58.898622 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.32s]
[0m17:12:58.901615 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:12:58.903694 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:12:58.904691 [info ] [Thread-1 (]: 8 of 11 START sql view model public.mart_inventory_status ...................... [RUN]
[0m17:12:58.906703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:12:58.907700 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:12:58.913684 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:12:58.917064 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:12:58.955047 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m17:12:58.958040 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:12:58.960034 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m17:12:58.961031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:59.184124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m17:12:59.185429 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:12:59.186470 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m17:12:59.195864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:12:59.201812 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:12:59.203807 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m17:12:59.204804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:59.208062 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:12:59.209060 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:12:59.210057 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:12:59.213698 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:12:59.218583 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m17:12:59.226560 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:12:59.227556 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m17:12:59.229940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:12:59.233056 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m17:12:59.234020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F0270F550>]}
[0m17:12:59.235514 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.33s]
[0m17:12:59.239432 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:12:59.240428 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:12:59.242477 [info ] [Thread-1 (]: 9 of 11 START sql view model public.mart_invoice ............................... [RUN]
[0m17:12:59.244101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m17:12:59.245097 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:12:59.251081 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:12:59.255112 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:12:59.266347 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m17:12:59.269849 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:12:59.271844 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m17:12:59.272922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:59.501208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m17:12:59.502461 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:12:59.503517 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

  create view "propharma"."public"."mart_invoice__dbt_tmp"
    
    
  as (
    select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
[0m17:12:59.517386 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:12:59.523461 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:12:59.524458 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice__dbt_tmp" rename to "mart_invoice"
[0m17:12:59.526630 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:59.528714 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:12:59.531056 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:12:59.532053 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:12:59.534169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:12:59.539701 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_invoice__dbt_backup"
[0m17:12:59.540760 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:12:59.542864 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
drop view if exists "propharma"."public"."mart_invoice__dbt_backup" cascade
[0m17:12:59.543868 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:12:59.547141 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m17:12:59.548197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F02B4FB50>]}
[0m17:12:59.550534 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.mart_invoice .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m17:12:59.553530 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:12:59.554676 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:12:59.556054 [info ] [Thread-1 (]: 10 of 11 START sql view model public.mart_sales_summary ........................ [RUN]
[0m17:12:59.558075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m17:12:59.560152 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:12:59.565335 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:12:59.568376 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:12:59.578066 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m17:12:59.582056 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:12:59.583052 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m17:12:59.584049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:59.813719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m17:12:59.814758 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:12:59.815763 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m17:12:59.825729 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:12:59.832006 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:12:59.833003 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m17:12:59.835053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:59.837558 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:12:59.838555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:12:59.840549 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:12:59.850308 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:12:59.855477 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m17:12:59.856518 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:12:59.857564 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m17:12:59.859752 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:12:59.862946 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m17:12:59.863943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00DD9F10>]}
[0m17:12:59.865938 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.mart_sales_summary ................... [[32mCREATE VIEW[0m in 0.31s]
[0m17:12:59.868395 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:12:59.869443 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:12:59.870780 [info ] [Thread-1 (]: 11 of 11 START sql view model public.mart_top_customers ........................ [RUN]
[0m17:12:59.873183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:12:59.874420 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:12:59.880622 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:12:59.885046 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:12:59.893217 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m17:12:59.896221 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:12:59.898212 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m17:12:59.899371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:00.144616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.245 seconds
[0m17:13:00.145707 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:13:00.146738 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m17:13:00.160718 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m17:13:00.167802 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:13:00.169305 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m17:13:00.171684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:00.176683 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:13:00.177681 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:13:00.180046 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:13:00.185422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:13:00.189716 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m17:13:00.192094 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:13:00.193097 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m17:13:00.194164 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:13:00.197499 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m17:13:00.199505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ec38e6d-4c83-408a-baa9-6465c8a27700', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F023BD290>]}
[0m17:13:00.200925 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.33s]
[0m17:13:00.203398 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:13:00.206586 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:00.208588 [debug] [MainThread]: On master: BEGIN
[0m17:13:00.209586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:00.441623 [debug] [MainThread]: SQL status: BEGIN in 0.232 seconds
[0m17:13:00.442793 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.443831 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:00.445398 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.446436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:13:00.447785 [debug] [MainThread]: On master: Close
[0m17:13:00.448824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:00.450800 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m17:13:00.451818 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m17:13:00.453776 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m17:13:00.454782 [info ] [MainThread]: 
[0m17:13:00.456206 [info ] [MainThread]: Finished running 7 table models, 4 view models in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m17:13:00.461252 [debug] [MainThread]: Command end result
[0m17:13:00.514065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:13:00.520052 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:13:00.535012 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:13:00.536010 [info ] [MainThread]: 
[0m17:13:00.538256 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:00.539747 [info ] [MainThread]: 
[0m17:13:00.540865 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:13:00.544305 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:00.544305 after 9.04 seconds
[0m17:13:00.545303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F00DA9290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7BA5EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F7BA5EDD0>]}
[0m17:13:00.547298 [debug] [MainThread]: Flushing usage events
[0m17:13:01.900090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:33:02.292429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA621310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA665010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA686B90>]}


============================== 17:33:02.301289 | 06db8684-dd49-4477-b1dd-a93ad5bbb5f9 ==============================
[0m17:33:02.301289 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:02.304024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:02.719272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA81D3D0>]}
[0m17:33:02.831826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA731D710>]}
[0m17:33:02.834818 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:33:03.680457 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:33:04.096715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:33:04.097710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:33:04.197227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABA2AF90>]}
[0m17:33:04.359282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:33:04.370615 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:33:04.428711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABC24B50>]}
[0m17:33:04.430705 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 434 macros
[0m17:33:04.432775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA686050>]}
[0m17:33:04.436549 [info ] [MainThread]: 
[0m17:33:04.438508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:33:04.440633 [info ] [MainThread]: 
[0m17:33:04.442573 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:33:04.455678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m17:33:04.837562 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m17:33:04.838558 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m17:33:04.840253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:05.354848 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.515 seconds
[0m17:33:05.357548 [debug] [ThreadPool]: On list_propharma: Close
[0m17:33:05.362066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m17:33:05.374446 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:33:05.375443 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:33:05.376441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:05.616431 [debug] [ThreadPool]: SQL status: BEGIN in 0.240 seconds
[0m17:33:05.617428 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:33:05.618425 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:33:05.630408 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:33:05.633399 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:33:05.634396 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:33:05.636390 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m17:33:05.646705 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:33:05.647703 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:33:05.649699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:05.900335 [debug] [ThreadPool]: SQL status: BEGIN in 0.251 seconds
[0m17:33:05.901578 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:33:05.902888 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:33:05.915046 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m17:33:05.919035 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:33:05.921030 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:33:05.938543 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:05.940631 [debug] [MainThread]: On master: BEGIN
[0m17:33:05.942144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:06.216641 [debug] [MainThread]: SQL status: BEGIN in 0.274 seconds
[0m17:33:06.217639 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:06.220783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:33:06.278248 [debug] [MainThread]: SQL status: SELECT 9 in 0.056 seconds
[0m17:33:06.288342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABF97610>]}
[0m17:33:06.290335 [debug] [MainThread]: On master: ROLLBACK
[0m17:33:06.291333 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:06.292793 [debug] [MainThread]: On master: BEGIN
[0m17:33:06.295447 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:33:06.296913 [debug] [MainThread]: On master: COMMIT
[0m17:33:06.298909 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:06.299906 [debug] [MainThread]: On master: COMMIT
[0m17:33:06.301901 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:06.302898 [debug] [MainThread]: On master: Close
[0m17:33:06.313869 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:33:06.316860 [info ] [Thread-1 (]: 1 of 11 START sql table model public.stg_inventory ............................. [RUN]
[0m17:33:06.320105 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:33:06.322340 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:33:06.343545 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:33:06.347712 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:33:06.436174 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m17:33:06.440310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.442311 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m17:33:06.442818 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:33:06.707963 [debug] [Thread-1 (]: SQL status: BEGIN in 0.265 seconds
[0m17:33:06.710020 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.711029 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  
    

  create  table "propharma"."public"."stg_inventory__dbt_tmp"
  
  
    as
  
  (
    with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
[0m17:33:06.723763 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m17:33:06.744127 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.745139 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m17:33:06.747153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:06.753461 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.755888 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m17:33:06.759297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:06.793231 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:33:06.795246 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.796253 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:33:06.801464 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:33:06.822137 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m17:33:06.835997 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:33:06.836997 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop table if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m17:33:06.846359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:33:06.852765 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m17:33:06.858444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABF9B910>]}
[0m17:33:06.861213 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.stg_inventory ........................ [[32mSELECT 10[0m in 0.53s]
[0m17:33:06.870021 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:33:06.872193 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:33:06.875186 [info ] [Thread-1 (]: 2 of 11 START sql table model public.stg_medicines ............................. [RUN]
[0m17:33:06.893694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:33:06.895177 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:33:06.904073 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:33:06.910061 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:33:06.924024 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m17:33:06.930014 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:06.932009 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m17:33:06.934004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:07.332631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.398 seconds
[0m17:33:07.334623 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:07.336620 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  
    

  create  table "propharma"."public"."stg_medicines__dbt_tmp"
  
  
    as
  
  (
    with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
[0m17:33:07.355097 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.016 seconds
[0m17:33:07.366068 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:07.368063 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m17:33:07.371055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:07.382498 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:07.384501 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m17:33:07.389488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:33:07.395473 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:33:07.397468 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:07.399461 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:33:07.403451 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:33:07.412427 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m17:33:07.415420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:33:07.417418 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop table if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m17:33:07.428390 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m17:33:07.433377 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m17:33:07.436368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABF9A110>]}
[0m17:33:07.438363 [info ] [Thread-1 (]: 2 of 11 OK created sql table model public.stg_medicines ........................ [[32mSELECT 11[0m in 0.54s]
[0m17:33:07.444861 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:33:07.446856 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:33:07.449850 [info ] [Thread-1 (]: 3 of 11 START sql table model public.stg_patients .............................. [RUN]
[0m17:33:07.455832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:33:07.457826 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:33:07.464792 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:33:07.472772 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:33:07.492075 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m17:33:07.497592 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:07.499586 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m17:33:07.501904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:08.114387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.612 seconds
[0m17:33:08.116385 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:08.128351 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  
    

  create  table "propharma"."public"."stg_patients__dbt_tmp"
  
  
    as
  
  (
    with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
[0m17:33:08.141986 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m17:33:08.152482 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:08.153479 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m17:33:08.155965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:08.165954 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:08.167949 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m17:33:08.171205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:08.175936 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:33:08.178210 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:08.179728 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:33:08.185548 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:33:08.193616 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m17:33:08.196609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:33:08.198603 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop table if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m17:33:08.220543 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m17:33:08.225528 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m17:33:08.227526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC4631D0>]}
[0m17:33:08.230522 [info ] [Thread-1 (]: 3 of 11 OK created sql table model public.stg_patients ......................... [[32mSELECT 10[0m in 0.77s]
[0m17:33:08.236505 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:33:08.238501 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:33:08.240495 [info ] [Thread-1 (]: 4 of 11 START sql table model public.stg_prescriptions ......................... [RUN]
[0m17:33:08.243488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:33:08.244991 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:33:08.252976 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:33:08.259958 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:33:08.273443 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m17:33:08.277912 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.280850 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m17:33:08.282850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:08.790730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.508 seconds
[0m17:33:08.792726 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.794719 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  
    

  create  table "propharma"."public"."stg_prescriptions__dbt_tmp"
  
  
    as
  
  (
    with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
[0m17:33:08.810678 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.014 seconds
[0m17:33:08.820648 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.822643 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m17:33:08.825639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:08.837611 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.839607 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m17:33:08.843779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:08.848673 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:33:08.850668 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.853039 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:33:08.860601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:33:08.868144 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m17:33:08.870626 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:33:08.871633 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop table if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m17:33:08.878263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:33:08.883871 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m17:33:08.886872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC4548D0>]}
[0m17:33:08.889861 [info ] [Thread-1 (]: 4 of 11 OK created sql table model public.stg_prescriptions .................... [[32mSELECT 10[0m in 0.64s]
[0m17:33:08.895234 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:33:08.896491 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:33:08.898509 [info ] [Thread-1 (]: 5 of 11 START sql table model public.stg_sales ................................. [RUN]
[0m17:33:08.900523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:33:08.902517 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:33:08.907089 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:33:08.914929 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:33:08.931693 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m17:33:08.936722 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:08.939716 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m17:33:08.941709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:09.260238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.319 seconds
[0m17:33:09.262937 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:09.265293 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  
    

  create  table "propharma"."public"."stg_sales__dbt_tmp"
  
  
    as
  
  (
    with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
[0m17:33:09.277622 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.011 seconds
[0m17:33:09.288458 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:09.289456 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:33:09.291683 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:09.368779 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:09.370774 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:33:09.374182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:09.379029 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:33:09.381212 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:09.383207 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:33:09.385585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:33:09.392827 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m17:33:09.394307 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:33:09.396204 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop table if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m17:33:09.404507 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:33:09.407682 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m17:33:09.411462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAA721190>]}
[0m17:33:09.414055 [info ] [Thread-1 (]: 5 of 11 OK created sql table model public.stg_sales ............................ [[32mSELECT 10[0m in 0.51s]
[0m17:33:09.416149 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:33:09.418665 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:33:09.420740 [info ] [Thread-1 (]: 6 of 11 START sql table model public.stg_suppliers ............................. [RUN]
[0m17:33:09.423163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:33:09.425163 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:33:09.432153 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:33:09.437141 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:33:09.445653 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m17:33:09.450498 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.451496 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m17:33:09.452989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:09.731165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m17:33:09.732457 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.734854 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  
    

  create  table "propharma"."public"."stg_suppliers__dbt_tmp"
  
  
    as
  
  (
    with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
[0m17:33:09.749058 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.012 seconds
[0m17:33:09.757142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.758253 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m17:33:09.759512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:09.767310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.770224 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m17:33:09.775214 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:33:09.779648 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:33:09.786769 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.788404 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:33:09.791853 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:33:09.797843 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m17:33:09.799334 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:33:09.800337 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop table if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m17:33:09.806756 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:33:09.810957 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m17:33:09.813126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC490B90>]}
[0m17:33:09.815121 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public.stg_suppliers ........................ [[32mSELECT 10[0m in 0.39s]
[0m17:33:09.817266 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:33:09.819628 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:33:09.821124 [info ] [Thread-1 (]: 7 of 11 START sql table model public.mart_expired_drugs ........................ [RUN]
[0m17:33:09.822189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m17:33:09.824310 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:33:09.835054 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:33:09.839859 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:33:09.848973 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m17:33:09.853698 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:09.854705 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m17:33:09.855969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:10.132653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m17:33:10.133817 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:10.136425 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  
    

  create  table "propharma"."public"."mart_expired_drugs__dbt_tmp"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
[0m17:33:10.151097 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m17:33:10.159481 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:10.160530 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m17:33:10.162790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:10.171962 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:10.173314 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m17:33:10.176492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:33:10.180930 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:33:10.181939 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:10.184453 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:33:10.188085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:33:10.195276 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m17:33:10.197272 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:33:10.199317 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m17:33:10.205826 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m17:33:10.208817 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m17:33:10.210812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBABC7E7D0>]}
[0m17:33:10.212910 [info ] [Thread-1 (]: 7 of 11 OK created sql table model public.mart_expired_drugs ................... [[32mSELECT 10[0m in 0.39s]
[0m17:33:10.216461 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:33:10.217545 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:33:10.219882 [info ] [Thread-1 (]: 8 of 11 START sql view model public.mart_inventory_status ...................... [RUN]
[0m17:33:10.221877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:33:10.223872 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:33:10.230556 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:33:10.235022 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:33:10.273672 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m17:33:10.277946 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:33:10.279249 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m17:33:10.280254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:10.558552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.278 seconds
[0m17:33:10.561168 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:33:10.562578 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m17:33:10.573483 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:33:10.579587 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:33:10.580590 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m17:33:10.582974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:10.585985 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:33:10.586982 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:33:10.588977 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:33:10.593730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:33:10.598863 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m17:33:10.604908 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:33:10.605916 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m17:33:10.609027 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m17:33:10.612040 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m17:33:10.614135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC0A6310>]}
[0m17:33:10.615132 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.39s]
[0m17:33:10.618412 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:33:10.619571 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:33:10.621596 [info ] [Thread-1 (]: 9 of 11 START sql view model public.mart_invoice ............................... [RUN]
[0m17:33:10.623048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m17:33:10.625003 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:33:10.632427 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:33:10.637592 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:33:10.646736 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m17:33:10.650731 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:33:10.651727 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m17:33:10.653722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:10.936317 [debug] [Thread-1 (]: SQL status: BEGIN in 0.282 seconds
[0m17:33:10.937337 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:33:10.938499 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

  create view "propharma"."public"."mart_invoice__dbt_tmp"
    
    
  as (
    select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
[0m17:33:10.951412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:33:10.958420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:33:10.959417 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice__dbt_tmp" rename to "mart_invoice"
[0m17:33:10.962050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:10.964297 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:33:10.966602 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:33:10.967607 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:33:10.977567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:33:10.982621 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_invoice__dbt_backup"
[0m17:33:10.985370 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:33:10.986376 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
drop view if exists "propharma"."public"."mart_invoice__dbt_backup" cascade
[0m17:33:10.988601 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:33:10.991593 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m17:33:10.993022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC0D6050>]}
[0m17:33:10.995270 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.mart_invoice .......................... [[32mCREATE VIEW[0m in 0.37s]
[0m17:33:10.998533 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:33:11.000661 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:33:11.002741 [info ] [Thread-1 (]: 10 of 11 START sql view model public.mart_sales_summary ........................ [RUN]
[0m17:33:11.004944 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m17:33:11.006944 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:33:11.014194 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:33:11.018682 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:33:11.028814 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m17:33:11.033178 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:33:11.034332 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m17:33:11.035335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:11.273749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m17:33:11.276091 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:33:11.277088 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m17:33:11.287551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:33:11.293540 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:33:11.294538 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m17:33:11.297112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:11.300109 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:33:11.301105 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:33:11.302227 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:33:11.313194 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m17:33:11.318179 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m17:33:11.319177 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:33:11.321577 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m17:33:11.322746 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:33:11.326006 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m17:33:11.328001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC0FA1D0>]}
[0m17:33:11.329996 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.mart_sales_summary ................... [[32mCREATE VIEW[0m in 0.32s]
[0m17:33:11.332991 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:33:11.333989 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:33:11.337063 [info ] [Thread-1 (]: 11 of 11 START sql view model public.mart_top_customers ........................ [RUN]
[0m17:33:11.339064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:33:11.341059 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:33:11.348548 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:33:11.352549 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:33:11.361021 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m17:33:11.365010 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:33:11.366370 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m17:33:11.368381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:11.644982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m17:33:11.647492 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:33:11.648489 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m17:33:11.660418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:33:11.666899 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:33:11.668405 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m17:33:11.670401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:33:11.673489 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:33:11.674492 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:33:11.676487 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:33:11.681807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:33:11.686801 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m17:33:11.688794 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:33:11.689794 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m17:33:11.691666 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:33:11.694787 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m17:33:11.696782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06db8684-dd49-4477-b1dd-a93ad5bbb5f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBAC0F8610>]}
[0m17:33:11.699775 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.36s]
[0m17:33:11.703317 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:33:11.706077 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:11.707584 [debug] [MainThread]: On master: BEGIN
[0m17:33:11.708582 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:11.992760 [debug] [MainThread]: SQL status: BEGIN in 0.284 seconds
[0m17:33:11.993757 [debug] [MainThread]: On master: COMMIT
[0m17:33:11.995752 [debug] [MainThread]: Using postgres connection "master"
[0m17:33:11.996751 [debug] [MainThread]: On master: COMMIT
[0m17:33:11.997747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:33:11.999741 [debug] [MainThread]: On master: Close
[0m17:33:12.000739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:12.002164 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m17:33:12.003173 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m17:33:12.005175 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m17:33:12.007394 [info ] [MainThread]: 
[0m17:33:12.009390 [info ] [MainThread]: Finished running 7 table models, 4 view models in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m17:33:12.016078 [debug] [MainThread]: Command end result
[0m17:33:12.070867 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:33:12.077849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:33:12.095725 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:33:12.097718 [info ] [MainThread]: 
[0m17:33:12.099714 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:12.102779 [info ] [MainThread]: 
[0m17:33:12.104790 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:33:12.109329 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:12.108125 after 10.49 seconds
[0m17:33:12.110340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA565EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA565FA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EBA56680D0>]}
[0m17:33:12.111580 [debug] [MainThread]: Flushing usage events
[0m17:33:13.448042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:57.020544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC712790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC7550D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC777690>]}


============================== 17:39:57.032638 | b9411da7-f054-41bb-aa93-f269d029de0c ==============================
[0m17:39:57.032638 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:39:57.034795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:39:57.607670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC895350>]}
[0m17:39:57.739291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0D93AD750>]}
[0m17:39:57.742503 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:39:58.580136 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:39:58.758345 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:39:58.760245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC08B050>]}
[0m17:40:01.352348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DDE736D0>]}
[0m17:40:01.518562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:40:01.529041 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:40:01.585990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DDF16550>]}
[0m17:40:01.586988 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 434 macros
[0m17:40:01.588624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DDC05050>]}
[0m17:40:01.593795 [info ] [MainThread]: 
[0m17:40:01.594810 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:40:01.596815 [info ] [MainThread]: 
[0m17:40:01.599223 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:40:01.612370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m17:40:01.988017 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m17:40:01.989014 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m17:40:01.990011 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:02.247030 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.257 seconds
[0m17:40:02.250033 [debug] [ThreadPool]: On list_propharma: Close
[0m17:40:02.254975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m17:40:02.266941 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:40:02.267938 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:40:02.268935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:02.488793 [debug] [ThreadPool]: SQL status: BEGIN in 0.219 seconds
[0m17:40:02.489789 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:40:02.490787 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:40:02.501487 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m17:40:02.504481 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:40:02.505479 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:40:02.507435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m17:40:02.512450 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:40:02.514783 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:40:02.515785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:02.840525 [debug] [ThreadPool]: SQL status: BEGIN in 0.325 seconds
[0m17:40:02.842519 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:40:02.843518 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:40:02.854484 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:40:02.857514 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:40:02.859507 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:40:02.874083 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:02.875081 [debug] [MainThread]: On master: BEGIN
[0m17:40:02.876079 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:03.124783 [debug] [MainThread]: SQL status: BEGIN in 0.248 seconds
[0m17:40:03.125781 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:03.126777 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:40:03.173648 [debug] [MainThread]: SQL status: SELECT 9 in 0.046 seconds
[0m17:40:03.180293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DDD1B950>]}
[0m17:40:03.181332 [debug] [MainThread]: On master: ROLLBACK
[0m17:40:03.183395 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:03.184438 [debug] [MainThread]: On master: BEGIN
[0m17:40:03.185468 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:40:03.187611 [debug] [MainThread]: On master: COMMIT
[0m17:40:03.188619 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:03.189625 [debug] [MainThread]: On master: COMMIT
[0m17:40:03.190635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:03.191676 [debug] [MainThread]: On master: Close
[0m17:40:03.201746 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:40:03.202750 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public.stg_inventory ....................... [RUN]
[0m17:40:03.204821 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:40:03.205859 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:40:03.220515 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:40:03.224584 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:40:03.331546 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.332543 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

    
  
    

  create temporary table "stg_inventory__dbt_tmp174003280154"
  
  
    as
  
  (
    

with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
  
[0m17:40:03.333541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:40:03.559967 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.227 seconds
[0m17:40:03.584970 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.586964 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m17:40:03.588928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:03.589924 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.590924 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory__dbt_tmp174003280154'
        
      order by ordinal_position

  
[0m17:40:03.628025 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.035 seconds
[0m17:40:03.638376 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.639373 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:03.646361 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m17:40:03.660324 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.662283 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:03.668300 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m17:40:03.695860 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m17:40:03.701279 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.703528 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      
        
        
        delete from "propharma"."public"."stg_inventory" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_inventory__dbt_tmp174003280154" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_inventory" ("medicine_id", "stock_qty", "last_updated")
    (
        select "medicine_id", "stock_qty", "last_updated"
        from "stg_inventory__dbt_tmp174003280154"
    )
  
[0m17:40:03.707760 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:40:03.734726 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:40:03.735727 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:40:03.737286 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:40:03.739321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:40:03.743839 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m17:40:03.748129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC8959D0>]}
[0m17:40:03.750364 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public.stg_inventory .................. [[32mINSERT 0 10[0m in 0.54s]
[0m17:40:03.753358 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:40:03.755349 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:40:03.756805 [info ] [Thread-1 (]: 2 of 11 START sql incremental model public.stg_medicines ....................... [RUN]
[0m17:40:03.759245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:40:03.761768 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:40:03.768074 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:40:03.770932 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:40:03.779915 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:03.781910 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

    
  
    

  create temporary table "stg_medicines__dbt_tmp174003775923"
  
  
    as
  
  (
    

with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
  
[0m17:40:03.782907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:04.029489 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.247 seconds
[0m17:40:04.035473 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.036471 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m17:40:04.038939 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:04.040182 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.041226 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines__dbt_tmp174003775923'
        
      order by ordinal_position

  
[0m17:40:04.064855 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m17:40:04.072047 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.073045 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.080265 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m17:40:04.086618 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.088051 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.094583 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m17:40:04.098607 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m17:40:04.109809 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.110859 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      
        
        
        delete from "propharma"."public"."stg_medicines" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_medicines__dbt_tmp174003775923" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_medicines" ("medicine_id", "name", "category", "price", "expiry_date")
    (
        select "medicine_id", "name", "category", "price", "expiry_date"
        from "stg_medicines__dbt_tmp174003775923"
    )
  
[0m17:40:04.114835 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.003 seconds
[0m17:40:04.117825 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:40:04.118820 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:40:04.120785 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:40:04.123513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:04.124553 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m17:40:04.126615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE019950>]}
[0m17:40:04.128978 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model public.stg_medicines .................. [[32mINSERT 0 11[0m in 0.37s]
[0m17:40:04.132711 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:40:04.134705 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:40:04.136132 [info ] [Thread-1 (]: 3 of 11 START sql incremental model public.stg_patients ........................ [RUN]
[0m17:40:04.138663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:40:04.139935 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:40:04.144957 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:40:04.149538 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:40:04.160341 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.162337 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

    
  
    

  create temporary table "stg_patients__dbt_tmp174004157349"
  
  
    as
  
  (
    

with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
  
[0m17:40:04.164331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:04.394277 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.230 seconds
[0m17:40:04.400261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.401258 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m17:40:04.403253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:04.405248 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.406278 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients__dbt_tmp174004157349'
        
      order by ordinal_position

  
[0m17:40:04.430544 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m17:40:04.436528 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.438523 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.445694 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:40:04.452392 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.453387 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.460471 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:40:04.464470 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m17:40:04.474946 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.477001 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      
        
        
        delete from "propharma"."public"."stg_patients" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "stg_patients__dbt_tmp174004157349" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_patients" ("patient_id", "name", "dob", "gender")
    (
        select "patient_id", "name", "dob", "gender"
        from "stg_patients__dbt_tmp174004157349"
    )
  
[0m17:40:04.481028 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m17:40:04.484020 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:40:04.485017 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:40:04.486982 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:40:04.489017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:04.491001 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m17:40:04.493539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE4E0110>]}
[0m17:40:04.494546 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model public.stg_patients ................... [[32mINSERT 0 10[0m in 0.35s]
[0m17:40:04.498233 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:40:04.500547 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:40:04.501572 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public.stg_prescriptions ................... [RUN]
[0m17:40:04.503711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:40:04.505766 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:40:04.511757 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:40:04.514750 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:40:04.526413 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.528377 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

    
  
    

  create temporary table "stg_prescriptions__dbt_tmp174004521654"
  
  
    as
  
  (
    

with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date::date as prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
  
[0m17:40:04.529405 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:04.762074 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.232 seconds
[0m17:40:04.767284 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.769241 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m17:40:04.771239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:04.772239 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.774233 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions__dbt_tmp174004521654'
        
      order by ordinal_position

  
[0m17:40:04.796803 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m17:40:04.803784 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.804781 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.811763 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m17:40:04.817745 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.818747 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:04.825723 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m17:40:04.829711 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m17:40:04.833456 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.834461 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      
        
        
        delete from "propharma"."public"."stg_prescriptions" as DBT_INTERNAL_DEST
        where (prescription_id) in (
            select distinct prescription_id
            from "stg_prescriptions__dbt_tmp174004521654" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity")
    (
        select "prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity"
        from "stg_prescriptions__dbt_tmp174004521654"
    )
  
[0m17:40:04.839001 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:40:04.841992 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:40:04.842989 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:40:04.843990 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:40:04.850547 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:40:04.852438 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m17:40:04.854841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE470C50>]}
[0m17:40:04.855893 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public.stg_prescriptions .............. [[32mINSERT 0 10[0m in 0.35s]
[0m17:40:04.859017 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:40:04.861011 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:40:04.863498 [info ] [Thread-1 (]: 5 of 11 START sql incremental model public.stg_sales ........................... [RUN]
[0m17:40:04.864532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:40:04.866178 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:40:04.871682 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:40:04.874674 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:40:04.889314 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:04.890313 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

    
  
    

  create temporary table "stg_sales__dbt_tmp174004882530"
  
  
    as
  
  (
    


with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
  
[0m17:40:04.892276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:05.226345 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.334 seconds
[0m17:40:05.232333 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.233330 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m17:40:05.235715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:05.237014 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.238163 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales__dbt_tmp174004882530'
        
      order by ordinal_position

  
[0m17:40:05.262605 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.023 seconds
[0m17:40:05.268636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.269622 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:05.276581 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m17:40:05.283566 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.284563 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:05.291545 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m17:40:05.296050 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m17:40:05.300038 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.301207 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      
        
        
        delete from "propharma"."public"."stg_sales" as DBT_INTERNAL_DEST
        where (sale_id) in (
            select distinct sale_id
            from "stg_sales__dbt_tmp174004882530" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_sales" ("sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount")
    (
        select "sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount"
        from "stg_sales__dbt_tmp174004882530"
    )
  
[0m17:40:05.305244 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:40:05.307265 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:40:05.309284 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:40:05.310293 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:40:05.312329 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:40:05.314347 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m17:40:05.316476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE4EDBD0>]}
[0m17:40:05.318885 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model public.stg_sales ...................... [[32mINSERT 0 10[0m in 0.45s]
[0m17:40:05.321311 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:40:05.323728 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:40:05.325729 [info ] [Thread-1 (]: 6 of 11 START sql incremental model public.stg_suppliers ....................... [RUN]
[0m17:40:05.328168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:40:05.329392 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:40:05.336205 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:40:05.339322 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:40:05.349236 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.351231 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

    
  
    

  create temporary table "stg_suppliers__dbt_tmp174005345239"
  
  
    as
  
  (
    


with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
  
[0m17:40:05.352232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:05.608272 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.256 seconds
[0m17:40:05.614225 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.615222 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m17:40:05.617219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:40:05.618809 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.619846 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers__dbt_tmp174005345239'
        
      order by ordinal_position

  
[0m17:40:05.644919 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m17:40:05.650891 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.651889 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:05.659088 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:40:05.665036 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.666034 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:40:05.673441 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m17:40:05.677429 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m17:40:05.681896 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.683255 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      
        
        
        delete from "propharma"."public"."stg_suppliers" as DBT_INTERNAL_DEST
        where (supplier_id) in (
            select distinct supplier_id
            from "stg_suppliers__dbt_tmp174005345239" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_suppliers" ("supplier_id", "supplier_name", "medicine_id", "last_supplied_date")
    (
        select "supplier_id", "supplier_name", "medicine_id", "last_supplied_date"
        from "stg_suppliers__dbt_tmp174005345239"
    )
  
[0m17:40:05.686560 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:40:05.690665 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:40:05.691707 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:40:05.692713 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:40:05.695318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:05.697418 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m17:40:05.699467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE367BD0>]}
[0m17:40:05.701462 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model public.stg_suppliers .................. [[32mINSERT 0 10[0m in 0.37s]
[0m17:40:05.704686 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:40:05.705784 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:40:05.708089 [info ] [Thread-1 (]: 7 of 11 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m17:40:05.710264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m17:40:05.711298 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:40:05.717734 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:40:05.721856 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:40:05.758168 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m17:40:05.762097 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:05.764087 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m17:40:05.765086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:05.996867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m17:40:05.997830 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:05.998827 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m17:40:06.009798 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:40:06.023760 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:06.024757 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m17:40:06.026795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.032735 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:06.033734 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m17:40:06.035731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.042747 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:40:06.043747 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:06.045192 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:40:06.048456 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:06.061086 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m17:40:06.071060 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:40:06.072057 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop table if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m17:40:06.078179 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:40:06.081768 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m17:40:06.082933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE02C3D0>]}
[0m17:40:06.084934 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.mart_expired_drugs .................... [[32mCREATE VIEW[0m in 0.37s]
[0m17:40:06.087859 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:40:06.088963 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:40:06.090471 [info ] [Thread-1 (]: 8 of 11 START sql view model public.mart_inventory_status ...................... [RUN]
[0m17:40:06.092501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:40:06.093007 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:40:06.100138 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:40:06.102918 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:40:06.110905 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m17:40:06.114782 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.115288 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m17:40:06.117289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:06.334502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m17:40:06.335506 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.336500 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m17:40:06.345476 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:40:06.353174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.354172 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status" rename to "mart_inventory_status__dbt_backup"
[0m17:40:06.356168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.362149 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.364143 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m17:40:06.366142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.369133 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:40:06.370131 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.371152 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:40:06.373168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:40:06.378140 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m17:40:06.384169 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:40:06.385165 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m17:40:06.388162 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:40:06.391148 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m17:40:06.393107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE2D5ED0>]}
[0m17:40:06.395628 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.30s]
[0m17:40:06.397716 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:40:06.400052 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:40:06.401541 [info ] [Thread-1 (]: 9 of 11 START sql view model public.mart_invoice ............................... [RUN]
[0m17:40:06.403561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m17:40:06.404865 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:40:06.411583 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:40:06.414542 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:40:06.422447 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m17:40:06.426302 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.427335 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m17:40:06.428331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:06.647811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m17:40:06.649240 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.650629 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

  create view "propharma"."public"."mart_invoice__dbt_tmp"
    
    
  as (
    select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
[0m17:40:06.661869 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m17:40:06.671698 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.672740 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice" rename to "mart_invoice__dbt_backup"
[0m17:40:06.674822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.680519 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.682480 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice__dbt_tmp" rename to "mart_invoice"
[0m17:40:06.683513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.687032 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:40:06.688451 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.689570 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:40:06.692988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:06.698166 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_invoice__dbt_backup"
[0m17:40:06.699165 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:40:06.701107 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
drop view if exists "propharma"."public"."mart_invoice__dbt_backup" cascade
[0m17:40:06.704454 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:40:06.707581 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m17:40:06.708588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE425290>]}
[0m17:40:06.710774 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.mart_invoice .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m17:40:06.712947 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:40:06.714968 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:40:06.715977 [info ] [Thread-1 (]: 10 of 11 START sql view model public.mart_sales_summary ........................ [RUN]
[0m17:40:06.718082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m17:40:06.719079 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:40:06.724066 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:40:06.728271 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:40:06.737536 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m17:40:06.740847 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:06.741854 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m17:40:06.743049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:06.963157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.220 seconds
[0m17:40:06.965639 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:06.966736 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m17:40:06.976156 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:40:06.982568 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:06.984563 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m17:40:06.985560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.992696 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:06.993703 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m17:40:06.995249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:06.997722 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:40:06.998798 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:06.999805 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:40:07.003302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:07.008528 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m17:40:07.009525 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:40:07.010820 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m17:40:07.014770 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:40:07.017347 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m17:40:07.019684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE899E90>]}
[0m17:40:07.020686 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.mart_sales_summary ................... [[32mCREATE VIEW[0m in 0.30s]
[0m17:40:07.023679 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:40:07.025677 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:40:07.026674 [info ] [Thread-1 (]: 11 of 11 START sql view model public.mart_top_customers ........................ [RUN]
[0m17:40:07.028665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:40:07.030664 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:40:07.036462 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:40:07.040420 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:40:07.048996 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m17:40:07.052995 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.053991 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m17:40:07.054988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:07.281565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m17:40:07.282561 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.283558 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m17:40:07.295293 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m17:40:07.302634 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.303633 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers" rename to "mart_top_customers__dbt_backup"
[0m17:40:07.305632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:07.311613 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.312607 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m17:40:07.314606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:40:07.320586 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:40:07.321583 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.322584 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:40:07.325428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:40:07.330676 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m17:40:07.332764 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:40:07.333720 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m17:40:07.337238 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:40:07.340238 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m17:40:07.342232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b9411da7-f054-41bb-aa93-f269d029de0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DE8F3F50>]}
[0m17:40:07.344228 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.31s]
[0m17:40:07.348007 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:40:07.350340 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:07.352349 [debug] [MainThread]: On master: BEGIN
[0m17:40:07.353346 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:07.575404 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m17:40:07.576872 [debug] [MainThread]: On master: COMMIT
[0m17:40:07.578059 [debug] [MainThread]: Using postgres connection "master"
[0m17:40:07.578564 [debug] [MainThread]: On master: COMMIT
[0m17:40:07.580736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:40:07.581826 [debug] [MainThread]: On master: Close
[0m17:40:07.582367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:07.583660 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m17:40:07.584663 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m17:40:07.585659 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m17:40:07.587657 [info ] [MainThread]: 
[0m17:40:07.589007 [info ] [MainThread]: Finished running 6 incremental models, 5 view models in 0 hours 0 minutes and 5.99 seconds (5.99s).
[0m17:40:07.594865 [debug] [MainThread]: Command end result
[0m17:40:07.646033 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:40:07.652018 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:40:07.667005 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:40:07.668003 [info ] [MainThread]: 
[0m17:40:07.670576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:07.672129 [info ] [MainThread]: 
[0m17:40:07.674298 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:40:07.677311 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:07.677311 after 11.48 seconds
[0m17:40:07.678308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC7775D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC775B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0DC262DD0>]}
[0m17:40:07.679305 [debug] [MainThread]: Flushing usage events
[0m17:40:09.077887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:36.566140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54587F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54565790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54521A90>]}


============================== 17:45:36.573758 | 724daa50-30bc-4c47-bb0b-a51ebcfdb282 ==============================
[0m17:45:36.573758 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:45:36.576059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m17:45:37.006848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C546A6710>]}
[0m17:45:37.115561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C5118D550>]}
[0m17:45:37.118806 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:45:37.923952 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:45:38.337540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:38.338534 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:38.434156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C559D5690>]}
[0m17:45:38.500996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C55B48810>]}
[0m17:45:38.507444 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 434 macros
[0m17:45:38.508988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C55925090>]}
[0m17:45:38.513235 [info ] [MainThread]: 
[0m17:45:38.515192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:45:38.517440 [info ] [MainThread]: 
[0m17:45:38.520432 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:45:38.533828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m17:45:38.922552 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:45:38.923549 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:45:38.924548 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:39.287019 [debug] [ThreadPool]: SQL status: BEGIN in 0.362 seconds
[0m17:45:39.288015 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:45:39.289013 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:45:39.300867 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m17:45:39.303558 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:45:39.304594 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:45:39.306796 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m17:45:39.311816 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:45:39.313810 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:45:39.313810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:39.640076 [debug] [ThreadPool]: SQL status: BEGIN in 0.326 seconds
[0m17:45:39.641408 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:45:39.642459 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:45:39.653178 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:45:39.656040 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:45:39.657083 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:45:39.672983 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:39.673985 [debug] [MainThread]: On master: BEGIN
[0m17:45:39.675941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:39.917717 [debug] [MainThread]: SQL status: BEGIN in 0.242 seconds
[0m17:45:39.918714 [debug] [MainThread]: Using postgres connection "master"
[0m17:45:39.919710 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:45:39.963082 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m17:45:39.969785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724daa50-30bc-4c47-bb0b-a51ebcfdb282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C55A16410>]}
[0m17:45:39.971328 [debug] [MainThread]: On master: ROLLBACK
[0m17:45:39.972749 [debug] [MainThread]: On master: Close
[0m17:45:39.982749 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:45:39.983751 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:45:39.984749 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:45:40.000706 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:45:40.005149 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:45:40.006686 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:45:40.008392 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:45:40.009803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:45:40.010837 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:45:40.016933 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:45:40.020304 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:45:40.022323 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:45:40.023324 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:45:40.025130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:45:40.027154 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:45:40.031889 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:45:40.035878 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:45:40.038659 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:45:40.039167 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:45:40.040546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:45:40.042380 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:45:40.049371 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:45:40.053330 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:45:40.055498 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:45:40.056578 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:45:40.058908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:45:40.060933 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:45:40.067120 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:45:40.070077 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:45:40.072649 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:45:40.073616 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:45:40.075412 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:45:40.076412 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:45:40.081523 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:45:40.085477 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:45:40.086476 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:45:40.088248 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m17:45:40.089808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m17:45:40.091054 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m17:45:40.094552 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m17:45:40.097098 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m17:45:40.097639 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:45:40.099426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now model.Propharma.mart_expired_drugs)
[0m17:45:40.100463 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:45:40.108793 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:45:40.112210 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:45:40.114350 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:45:40.114890 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:45:40.117406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:45:40.118408 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:45:40.124253 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:45:40.127685 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:45:40.129775 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:45:40.130315 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:45:40.132125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m17:45:40.133224 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:45:40.139964 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:45:40.142922 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:45:40.145161 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:45:40.146211 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m17:45:40.147712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now snapshot.Propharma.snapshot_prescriptions)
[0m17:45:40.148713 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m17:45:40.154993 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m17:45:40.157186 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m17:45:40.157726 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:45:40.159766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m17:45:40.160767 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:45:40.166751 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:45:40.169744 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:45:40.172243 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:45:40.173244 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:45:40.174242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:45:40.176242 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:45:40.181837 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:45:40.186073 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:45:40.188582 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:45:40.190975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:40.192085 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m17:45:40.192591 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m17:45:40.198554 [debug] [MainThread]: Command end result
[0m17:45:40.368327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:45:40.379152 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:45:40.395462 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:45:40.405622 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:45:40.406628 [info ] [MainThread]: Building catalog
[0m17:45:40.425528 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m17:45:40.439506 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:45:40.441501 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m17:45:40.442498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:40.673233 [debug] [ThreadPool]: SQL status: BEGIN in 0.231 seconds
[0m17:45:40.674227 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:45:40.675227 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_invoice')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:45:40.690183 [debug] [ThreadPool]: SQL status: SELECT 70 in 0.014 seconds
[0m17:45:40.701154 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m17:45:40.702159 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m17:45:40.732794 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:45:40.784186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:45:40.790171 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:45:40.792342 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:45:40.795162 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:45:40.795162 after 4.91 seconds
[0m17:45:40.796166 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:45:40.797156 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m17:45:40.798157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54192E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C54192650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C5458CE90>]}
[0m17:45:40.799152 [debug] [MainThread]: Flushing usage events
[0m17:45:41.922225 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:46:00.353429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2628DDBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C262933010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C262933E10>]}


============================== 17:46:00.361414 | 0fc774ee-7d42-404d-a504-c68d7eb63481 ==============================
[0m17:46:00.361414 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:46:00.363409 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:46:00.768427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fc774ee-7d42-404d-a504-c68d7eb63481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C262ACC810>]}
[0m17:46:00.881621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fc774ee-7d42-404d-a504-c68d7eb63481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C25F52D2D0>]}
[0m18:10:51.999143 [error] [MainThread]: Encountered an error:

[0m18:10:52.017732 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:10:52.022464 [debug] [MainThread]: Command `dbt docs serve` failed at 18:10:52.021954 after 1492.34 seconds
[0m18:10:52.024468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2628D2A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2628D0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2628D2B10>]}
[0m18:10:52.025465 [debug] [MainThread]: Flushing usage events
[0m18:11:09.235088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DCC6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DC61A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DCC6450>]}


============================== 18:11:09.246048 | 754d8d0a-d489-4271-9a74-a4d1a78e9d75 ==============================
[0m18:11:09.246048 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:11:09.248483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:11:09.724959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958AAFFA90>]}
[0m18:11:09.946484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958A8DED10>]}
[0m18:11:09.951471 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:11:10.938990 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:11:11.380629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:11:11.381809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:11:11.480296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958F156310>]}
[0m18:11:11.648694 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:11:11.658666 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:11:11.737653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958F076950>]}
[0m18:11:11.739647 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 434 macros
[0m18:11:11.740644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958F01D250>]}
[0m18:11:11.745631 [info ] [MainThread]: 
[0m18:11:11.747626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:11:11.748624 [info ] [MainThread]: 
[0m18:11:11.751615 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:11:11.760001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:11:12.249445 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:11:12.250442 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:11:12.251466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:12.662290 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.411 seconds
[0m18:11:12.666587 [debug] [ThreadPool]: On list_propharma: Close
[0m18:11:12.677405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m18:11:12.692528 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:11:12.693525 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:11:12.694030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:11:13.055780 [debug] [ThreadPool]: SQL status: BEGIN in 0.361 seconds
[0m18:11:13.056814 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:11:13.058176 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:11:13.070833 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m18:11:13.074829 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:11:13.075827 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:11:13.077818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m18:11:13.083225 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:11:13.085533 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:11:13.086551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:11:13.331286 [debug] [ThreadPool]: SQL status: BEGIN in 0.245 seconds
[0m18:11:13.332282 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:11:13.333278 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:11:13.344596 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:11:13.348098 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:11:13.349095 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:11:13.364589 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:13.365968 [debug] [MainThread]: On master: BEGIN
[0m18:11:13.367042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:11:13.614515 [debug] [MainThread]: SQL status: BEGIN in 0.248 seconds
[0m18:11:13.615518 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:13.617513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:11:13.660255 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m18:11:13.667223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958F301E10>]}
[0m18:11:13.669189 [debug] [MainThread]: On master: ROLLBACK
[0m18:11:13.670188 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:13.672179 [debug] [MainThread]: On master: BEGIN
[0m18:11:13.673179 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:11:13.674179 [debug] [MainThread]: On master: COMMIT
[0m18:11:13.676170 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:13.677169 [debug] [MainThread]: On master: COMMIT
[0m18:11:13.678168 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:13.680098 [debug] [MainThread]: On master: Close
[0m18:11:13.692456 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m18:11:13.694476 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m18:11:13.696914 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m18:11:13.698915 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m18:11:13.724198 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m18:11:13.846480 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:13.848471 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m18:11:13.849467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:11:14.089970 [debug] [Thread-1 (]: SQL status: BEGIN in 0.241 seconds
[0m18:11:14.091962 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.094778 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:11:14.133664 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.037 seconds
[0m18:11:14.240539 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.242754 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp181114224402"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:11:14.264106 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.020 seconds
[0m18:11:14.272597 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.273963 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181114224402'
        
      order by ordinal_position

  
[0m18:11:14.284573 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.009 seconds
[0m18:11:14.295812 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.297861 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:11:14.306110 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m18:11:14.314113 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.315110 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181114224402'
        
      order by ordinal_position

  
[0m18:11:14.326587 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.009 seconds
[0m18:11:14.333569 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.334566 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:11:14.342544 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m18:11:14.359314 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.361018 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181114224402'
        
      order by ordinal_position

  
[0m18:11:14.371289 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.009 seconds
[0m18:11:14.408755 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.409769 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:11:14.413048 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:11:14.423665 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.425686 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:11:14.428020 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:11:14.429034 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m18:11:14.431482 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.435532 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.437576 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp181114224402" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp181114224402" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:11:14.440872 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m18:11:14.474608 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:11:14.475612 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:11:14.477761 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:11:14.480947 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:11:14.489447 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m18:11:14.496995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '754d8d0a-d489-4271-9a74-a4d1a78e9d75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DE0C2D0>]}
[0m18:11:14.499986 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 0[0m in 0.80s]
[0m18:11:14.502804 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m18:11:14.505930 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:14.506938 [debug] [MainThread]: On master: BEGIN
[0m18:11:14.508765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:11:14.784641 [debug] [MainThread]: SQL status: BEGIN in 0.276 seconds
[0m18:11:14.786468 [debug] [MainThread]: On master: COMMIT
[0m18:11:14.787471 [debug] [MainThread]: Using postgres connection "master"
[0m18:11:14.789804 [debug] [MainThread]: On master: COMMIT
[0m18:11:14.791804 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:11:14.793980 [debug] [MainThread]: On master: Close
[0m18:11:14.795497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:11:14.797589 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:11:14.799583 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m18:11:14.800580 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m18:11:14.803060 [info ] [MainThread]: 
[0m18:11:14.805144 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m18:11:14.807578 [debug] [MainThread]: Command end result
[0m18:11:14.870479 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:11:14.876833 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:11:14.890063 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:11:14.891061 [info ] [MainThread]: 
[0m18:11:14.893295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:11:14.895981 [info ] [MainThread]: 
[0m18:11:14.897976 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:11:14.902382 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:11:14.902382 after 6.43 seconds
[0m18:11:14.903379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DCC6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958DCA5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001958F5F8210>]}
[0m18:11:14.905490 [debug] [MainThread]: Flushing usage events
[0m18:11:15.971542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:09.897316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7A0BCB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7A117F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7A0B2710>]}


============================== 18:14:09.905536 | e3bc4f6d-7377-4ead-a57b-95c3643bce88 ==============================
[0m18:14:09.905536 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:14:09.908168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:14:10.338521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7A26EB10>]}
[0m18:14:10.472286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF76D6D610>]}
[0m18:14:10.475812 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:14:11.343728 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:14:11.769051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:11.770048 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m18:14:12.286266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B6B0790>]}
[0m18:14:12.443760 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:14:12.455183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:14:12.514991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B856850>]}
[0m18:14:12.515988 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:14:12.518013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7A0B1450>]}
[0m18:14:12.521591 [info ] [MainThread]: 
[0m18:14:12.522960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:12.524144 [info ] [MainThread]: 
[0m18:14:12.526990 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:12.533221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:14:12.900999 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:14:12.901997 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:14:12.903987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:13.426598 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.523 seconds
[0m18:14:13.429749 [debug] [ThreadPool]: On list_propharma: Close
[0m18:14:13.441634 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m18:14:13.454149 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:14:13.455602 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:14:13.456158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:13.690591 [debug] [ThreadPool]: SQL status: BEGIN in 0.234 seconds
[0m18:14:13.692177 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:14:13.693223 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:14:13.704230 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:14:13.707261 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:14:13.709220 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:14:13.710863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m18:14:13.720462 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:14:13.721460 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:14:13.722457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:14:14.061604 [debug] [ThreadPool]: SQL status: BEGIN in 0.339 seconds
[0m18:14:14.063634 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:14:14.063634 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:14:14.075140 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m18:14:14.078094 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:14:14.080126 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:14:14.090031 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:14.092058 [debug] [MainThread]: On master: BEGIN
[0m18:14:14.093024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:14.328337 [debug] [MainThread]: SQL status: BEGIN in 0.236 seconds
[0m18:14:14.330396 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:14.332429 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:14.375637 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m18:14:14.382839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7B8AA750>]}
[0m18:14:14.384851 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:14.385847 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:14.386895 [debug] [MainThread]: On master: BEGIN
[0m18:14:14.389008 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:14:14.390012 [debug] [MainThread]: On master: COMMIT
[0m18:14:14.391009 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:14.392006 [debug] [MainThread]: On master: COMMIT
[0m18:14:14.393004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:14:14.394357 [debug] [MainThread]: On master: Close
[0m18:14:14.403924 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m18:14:14.405940 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m18:14:14.406945 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m18:14:14.408940 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m18:14:14.427889 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m18:14:14.531210 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:14.532219 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m18:14:14.533229 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:14.885076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.352 seconds
[0m18:14:14.886622 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:14.887626 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:14:14.915655 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.026 seconds
[0m18:14:15.012702 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.014697 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp181414996759"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select *,cast(prescribed_date as timestamp) as prescribed_timestamp from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_timestamp, prescribed_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            prescribed_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:14:15.033615 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m18:14:15.042341 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.043339 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181414996759'
        
      order by ordinal_position

  
[0m18:14:15.051301 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.007 seconds
[0m18:14:15.120771 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.121808 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:14:15.132346 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.009 seconds
[0m18:14:15.139414 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.140422 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181414996759'
        
      order by ordinal_position

  
[0m18:14:15.150363 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.008 seconds
[0m18:14:15.156345 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.158340 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:14:15.165930 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m18:14:15.177902 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.178901 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      alter table "propharma"."snapshots"."snapshot_prescriptions" add column "prescribed_timestamp" timestamp without time zone;
    
[0m18:14:15.180894 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:14:15.187391 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.188396 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp181414996759'
        
      order by ordinal_position

  
[0m18:14:15.197173 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.007 seconds
[0m18:14:15.236249 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.237242 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select *,cast(prescribed_date as timestamp) as prescribed_timestamp from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_timestamp, prescribed_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            prescribed_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:14:15.239691 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:14:15.258175 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.259980 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:14:15.262981 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:14:15.265972 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.271443 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.273474 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp181414996759" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "prescribed_timestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."prescribed_timestamp",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp181414996759" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:14:15.278701 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.003 seconds
[0m18:14:15.315427 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:14:15.317755 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:14:15.319951 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:14:15.323062 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:14:15.330043 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m18:14:15.336027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bc4f6d-7377-4ead-a57b-95c3643bce88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF7C0062D0>]}
[0m18:14:15.340018 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 0[0m in 0.93s]
[0m18:14:15.343009 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m18:14:15.345296 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:15.347723 [debug] [MainThread]: On master: BEGIN
[0m18:14:15.348876 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:15.716530 [debug] [MainThread]: SQL status: BEGIN in 0.368 seconds
[0m18:14:15.718489 [debug] [MainThread]: On master: COMMIT
[0m18:14:15.719486 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:15.720483 [debug] [MainThread]: On master: COMMIT
[0m18:14:15.722477 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:14:15.723475 [debug] [MainThread]: On master: Close
[0m18:14:15.724473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:15.725471 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:14:15.727339 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m18:14:15.728341 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m18:14:15.730339 [info ] [MainThread]: 
[0m18:14:15.731944 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m18:14:15.734518 [debug] [MainThread]: Command end result
[0m18:14:15.785931 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:14:15.793427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:14:15.808099 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:14:15.809066 [info ] [MainThread]: 
[0m18:14:15.811064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:15.813092 [info ] [MainThread]: 
[0m18:14:15.814055 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:14:15.817047 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:14:15.817047 after 6.59 seconds
[0m18:14:15.819042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF750AFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF750AEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF750B80D0>]}
[0m18:14:15.820039 [debug] [MainThread]: Flushing usage events
[0m18:14:16.955699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:20:53.712371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C10F250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C144390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C144110>]}


============================== 18:20:53.720843 | 7267a0ad-3028-4225-be54-f7da0576938f ==============================
[0m18:20:53.720843 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:20:53.722806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:20:54.349202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C287110>]}
[0m18:20:54.482554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D498DEED50>]}
[0m18:20:54.485542 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:20:55.396887 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:20:56.000824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:20:56.003405 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m18:20:56.817695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D799790>]}
[0m18:20:57.006581 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:20:57.021202 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:20:57.086212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D827E50>]}
[0m18:20:57.088174 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:20:57.090169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D7FF950>]}
[0m18:20:57.095160 [info ] [MainThread]: 
[0m18:20:57.097501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:20:57.099145 [info ] [MainThread]: 
[0m18:20:57.100710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:20:57.115619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:20:57.563917 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:20:57.564949 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:20:57.566950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:58.061666 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.495 seconds
[0m18:20:58.067200 [debug] [ThreadPool]: On list_propharma: Close
[0m18:20:58.073792 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m18:20:58.088101 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:20:58.089098 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:20:58.090096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:20:58.438917 [debug] [ThreadPool]: SQL status: BEGIN in 0.348 seconds
[0m18:20:58.440277 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:20:58.441333 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:20:58.452346 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:20:58.455481 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:20:58.457524 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:20:58.458508 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m18:20:58.468742 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:20:58.469741 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:20:58.471137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:20:58.700159 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m18:20:58.701160 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:20:58.702257 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:20:58.713495 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m18:20:58.716489 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:20:58.717632 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:20:58.730531 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:58.731514 [debug] [MainThread]: On master: BEGIN
[0m18:20:58.732950 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:20:58.952499 [debug] [MainThread]: SQL status: BEGIN in 0.220 seconds
[0m18:20:58.954540 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:58.955603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:20:58.998433 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m18:20:59.005145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D4D4F10>]}
[0m18:20:59.006188 [debug] [MainThread]: On master: ROLLBACK
[0m18:20:59.008180 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:59.009276 [debug] [MainThread]: On master: BEGIN
[0m18:20:59.010790 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:20:59.011787 [debug] [MainThread]: On master: COMMIT
[0m18:20:59.012785 [debug] [MainThread]: Using postgres connection "master"
[0m18:20:59.013782 [debug] [MainThread]: On master: COMMIT
[0m18:20:59.015776 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:20:59.016779 [debug] [MainThread]: On master: Close
[0m18:20:59.026059 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m18:20:59.028241 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public.stg_inventory ....................... [RUN]
[0m18:20:59.030299 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m18:20:59.031335 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m18:20:59.046558 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m18:20:59.051409 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m18:20:59.159010 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.160975 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

    
  
    

  create temporary table "stg_inventory__dbt_tmp182059108677"
  
  
    as
  
  (
    

with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
  
[0m18:20:59.162013 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:20:59.395456 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.233 seconds
[0m18:20:59.425612 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.426610 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m18:20:59.428926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:20:59.430057 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.431100 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory__dbt_tmp182059108677'
        
      order by ordinal_position

  
[0m18:20:59.455723 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.023 seconds
[0m18:20:59.523511 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.525631 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:59.531762 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m18:20:59.546306 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.547302 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:59.555246 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.006 seconds
[0m18:20:59.583171 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m18:20:59.587950 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.588987 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      
        
        
        delete from "propharma"."public"."stg_inventory" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_inventory__dbt_tmp182059108677" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_inventory" ("medicine_id", "stock_qty", "last_updated")
    (
        select "medicine_id", "stock_qty", "last_updated"
        from "stg_inventory__dbt_tmp182059108677"
    )
  
[0m18:20:59.592717 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m18:20:59.620866 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m18:20:59.622830 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:20:59.623967 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m18:20:59.634753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m18:20:59.638758 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m18:20:59.643289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49D78F490>]}
[0m18:20:59.645357 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public.stg_inventory .................. [[32mINSERT 0 10[0m in 0.61s]
[0m18:20:59.649027 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m18:20:59.650034 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m18:20:59.651059 [info ] [Thread-1 (]: 2 of 11 START sql incremental model public.stg_medicines ....................... [RUN]
[0m18:20:59.653056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m18:20:59.655020 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m18:20:59.660034 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m18:20:59.664990 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m18:20:59.674966 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.675964 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

    
  
    

  create temporary table "stg_medicines__dbt_tmp182059671975"
  
  
    as
  
  (
    

with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
  
[0m18:20:59.677956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:20:59.909113 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.231 seconds
[0m18:20:59.914696 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.915734 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m18:20:59.917832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:20:59.919009 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.920470 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines__dbt_tmp182059671975'
        
      order by ordinal_position

  
[0m18:20:59.944287 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m18:20:59.950228 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.952191 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:59.959005 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:20:59.965208 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.967203 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:20:59.973783 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:20:59.977954 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m18:20:59.981358 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.982679 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      
        
        
        delete from "propharma"."public"."stg_medicines" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_medicines__dbt_tmp182059671975" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_medicines" ("medicine_id", "name", "category", "price", "expiry_date")
    (
        select "medicine_id", "name", "category", "price", "expiry_date"
        from "stg_medicines__dbt_tmp182059671975"
    )
  
[0m18:20:59.986084 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.003 seconds
[0m18:20:59.990342 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m18:20:59.991383 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:20:59.992427 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m18:20:59.998257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:21:00.000799 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m18:21:00.002799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DBAB2D0>]}
[0m18:21:00.004796 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model public.stg_medicines .................. [[32mINSERT 0 11[0m in 0.35s]
[0m18:21:00.008784 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m18:21:00.010780 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m18:21:00.014181 [info ] [Thread-1 (]: 3 of 11 START sql incremental model public.stg_patients ........................ [RUN]
[0m18:21:00.017235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m18:21:00.020375 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m18:21:00.027049 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m18:21:00.031081 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m18:21:00.041283 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.043789 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

    
  
    

  create temporary table "stg_patients__dbt_tmp182100038274"
  
  
    as
  
  (
    

with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
  
[0m18:21:00.044791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:00.271530 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.227 seconds
[0m18:21:00.280298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.282343 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m18:21:00.283792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:21:00.285977 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.285977 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients__dbt_tmp182100038274'
        
      order by ordinal_position

  
[0m18:21:00.309458 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m18:21:00.316756 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.317758 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:00.324124 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:21:00.331130 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.332127 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:00.339108 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:21:00.342100 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m18:21:00.347311 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.348305 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      
        
        
        delete from "propharma"."public"."stg_patients" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "stg_patients__dbt_tmp182100038274" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_patients" ("patient_id", "name", "dob", "gender")
    (
        select "patient_id", "name", "dob", "gender"
        from "stg_patients__dbt_tmp182100038274"
    )
  
[0m18:21:00.352310 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m18:21:00.354806 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m18:21:00.355829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:21:00.357662 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m18:21:00.366844 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m18:21:00.368885 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m18:21:00.370839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C2D1CD0>]}
[0m18:21:00.371834 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model public.stg_patients ................... [[32mINSERT 0 10[0m in 0.35s]
[0m18:21:00.376061 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m18:21:00.377980 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m18:21:00.379281 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public.stg_prescriptions ................... [RUN]
[0m18:21:00.381541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m18:21:00.382962 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m18:21:00.389428 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m18:21:00.393798 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m18:21:00.401551 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.403515 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

    
  
    

  create temporary table "stg_prescriptions__dbt_tmp182100398559"
  
  
    as
  
  (
    

with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
  
[0m18:21:00.404544 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:00.637258 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.232 seconds
[0m18:21:00.642324 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.644289 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m18:21:00.645867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:21:00.646861 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.648826 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions__dbt_tmp182100398559'
        
      order by ordinal_position

  
[0m18:21:00.671798 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m18:21:00.677788 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.678780 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:00.685765 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m18:21:00.692203 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.694196 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:00.701213 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m18:21:00.705171 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m18:21:00.709161 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.710158 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      
        
        
        delete from "propharma"."public"."stg_prescriptions" as DBT_INTERNAL_DEST
        where (prescription_id) in (
            select distinct prescription_id
            from "stg_prescriptions__dbt_tmp182100398559" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity")
    (
        select "prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity"
        from "stg_prescriptions__dbt_tmp182100398559"
    )
  
[0m18:21:00.715145 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:21:00.718137 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m18:21:00.719134 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:21:00.721128 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m18:21:00.723123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:21:00.725117 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m18:21:00.727112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C353F50>]}
[0m18:21:00.729107 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public.stg_prescriptions .............. [[32mINSERT 0 10[0m in 0.35s]
[0m18:21:00.732176 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m18:21:00.734170 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m18:21:00.737002 [info ] [Thread-1 (]: 5 of 11 START sql incremental model public.stg_sales ........................... [RUN]
[0m18:21:00.738518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m18:21:00.740922 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m18:21:00.749225 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m18:21:00.753219 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m18:21:00.762194 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:00.763188 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

    
  
    

  create temporary table "stg_sales__dbt_tmp182100759198"
  
  
    as
  
  (
    


with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
  
[0m18:21:00.765186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:01.114075 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.349 seconds
[0m18:21:01.123054 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.124018 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m18:21:01.126043 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:21:01.127008 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.129002 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales__dbt_tmp182100759198'
        
      order by ordinal_position

  
[0m18:21:01.152709 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.023 seconds
[0m18:21:01.158277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.160238 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:01.167146 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:21:01.173131 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.174127 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:01.180857 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:21:01.185881 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m18:21:01.189406 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.190342 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      
        
        
        delete from "propharma"."public"."stg_sales" as DBT_INTERNAL_DEST
        where (sale_id) in (
            select distinct sale_id
            from "stg_sales__dbt_tmp182100759198" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_sales" ("sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount")
    (
        select "sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount"
        from "stg_sales__dbt_tmp182100759198"
    )
  
[0m18:21:01.194370 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:21:01.197328 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m18:21:01.199322 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:21:01.200319 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m18:21:01.205769 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:21:01.208180 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m18:21:01.209263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DC3D1D0>]}
[0m18:21:01.211577 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model public.stg_sales ...................... [[32mINSERT 0 10[0m in 0.47s]
[0m18:21:01.214843 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m18:21:01.216824 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m18:21:01.218206 [info ] [Thread-1 (]: 6 of 11 START sql incremental model public.stg_suppliers ....................... [RUN]
[0m18:21:01.220231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m18:21:01.223120 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m18:21:01.230190 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m18:21:01.234352 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m18:21:01.241369 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.243332 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

    
  
    

  create temporary table "stg_suppliers__dbt_tmp182101239367"
  
  
    as
  
  (
    


with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
  
[0m18:21:01.245382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:01.486072 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.241 seconds
[0m18:21:01.492612 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.493614 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m18:21:01.495589 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:21:01.496626 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.497626 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers__dbt_tmp182101239367'
        
      order by ordinal_position

  
[0m18:21:01.521541 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m18:21:01.527799 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.529674 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:01.536545 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m18:21:01.542808 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.543799 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:21:01.550368 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:21:01.554818 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m18:21:01.565639 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.566637 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      
        
        
        delete from "propharma"."public"."stg_suppliers" as DBT_INTERNAL_DEST
        where (supplier_id) in (
            select distinct supplier_id
            from "stg_suppliers__dbt_tmp182101239367" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_suppliers" ("supplier_id", "supplier_name", "medicine_id", "last_supplied_date")
    (
        select "supplier_id", "supplier_name", "medicine_id", "last_supplied_date"
        from "stg_suppliers__dbt_tmp182101239367"
    )
  
[0m18:21:01.570653 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:21:01.573617 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m18:21:01.575612 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:21:01.576609 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m18:21:01.578927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:01.581377 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m18:21:01.583381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DC19C10>]}
[0m18:21:01.585371 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model public.stg_suppliers .................. [[32mINSERT 0 10[0m in 0.36s]
[0m18:21:01.588879 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m18:21:01.589875 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m18:21:01.591871 [info ] [Thread-1 (]: 7 of 11 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m18:21:01.593870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m18:21:01.594867 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m18:21:01.603468 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m18:21:01.607462 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m18:21:01.642372 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m18:21:01.646506 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.647508 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m18:21:01.649273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:01.873961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m18:21:01.875005 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.877055 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m18:21:01.886536 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:21:01.901254 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.903304 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m18:21:01.905342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:01.910325 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.912287 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m18:21:01.913320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:01.920300 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m18:21:01.921299 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.923262 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m18:21:01.932615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m18:21:01.944745 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m18:21:01.954297 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:21:01.956273 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop view if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m18:21:01.959284 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:21:01.962246 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m18:21:01.964197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DD67550>]}
[0m18:21:01.966193 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.mart_expired_drugs .................... [[32mCREATE VIEW[0m in 0.37s]
[0m18:21:01.969311 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m18:21:01.970633 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m18:21:01.971169 [info ] [Thread-1 (]: 8 of 11 START sql view model public.mart_inventory_status ...................... [RUN]
[0m18:21:01.973189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m18:21:01.974224 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m18:21:01.980960 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m18:21:01.985004 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m18:21:01.992485 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m18:21:01.998155 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.000152 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m18:21:02.001145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:02.222572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m18:21:02.223534 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.225329 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m18:21:02.234307 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:21:02.242286 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.243283 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status" rename to "mart_inventory_status__dbt_backup"
[0m18:21:02.244282 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.250854 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.252848 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m18:21:02.253811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.257486 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m18:21:02.258483 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.259636 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m18:21:02.265444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:21:02.270472 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m18:21:02.272543 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:21:02.273624 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m18:21:02.276344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:21:02.280381 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m18:21:02.281379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C338190>]}
[0m18:21:02.283320 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.31s]
[0m18:21:02.286340 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m18:21:02.288078 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m18:21:02.289079 [info ] [Thread-1 (]: 9 of 11 START sql view model public.mart_invoice ............................... [RUN]
[0m18:21:02.291406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m18:21:02.292408 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m18:21:02.299025 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m18:21:02.302363 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m18:21:02.311472 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m18:21:02.315108 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.316111 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m18:21:02.317108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:02.538514 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m18:21:02.539511 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.540508 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

  create view "propharma"."public"."mart_invoice__dbt_tmp"
    
    
  as (
    select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
[0m18:21:02.553382 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m18:21:02.560773 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.561771 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice" rename to "mart_invoice__dbt_backup"
[0m18:21:02.563906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.569428 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.570432 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice__dbt_tmp" rename to "mart_invoice"
[0m18:21:02.572160 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.578184 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m18:21:02.579184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.581050 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m18:21:02.583875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:02.589457 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_invoice__dbt_backup"
[0m18:21:02.590419 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:21:02.592413 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
drop view if exists "propharma"."public"."mart_invoice__dbt_backup" cascade
[0m18:21:02.595407 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:21:02.599396 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m18:21:02.601391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DD70610>]}
[0m18:21:02.603385 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.mart_invoice .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m18:21:02.605670 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m18:21:02.607256 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m18:21:02.608259 [info ] [Thread-1 (]: 10 of 11 START sql view model public.mart_sales_summary ........................ [RUN]
[0m18:21:02.609882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m18:21:02.610886 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m18:21:02.616966 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m18:21:02.620987 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m18:21:02.628083 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m18:21:02.633250 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.634252 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m18:21:02.635249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:02.850507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.215 seconds
[0m18:21:02.851474 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.852473 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m18:21:02.862480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m18:21:02.869440 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.870423 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m18:21:02.872970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.878959 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.879956 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m18:21:02.881952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:02.885053 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m18:21:02.886051 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.888044 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m18:21:02.890706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:21:02.895697 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m18:21:02.897691 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:21:02.898688 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m18:21:02.902678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:21:02.904672 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m18:21:02.906666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49DD1FBD0>]}
[0m18:21:02.908662 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.mart_sales_summary ................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:21:02.911521 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m18:21:02.912517 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m18:21:02.913551 [info ] [Thread-1 (]: 11 of 11 START sql view model public.mart_top_customers ........................ [RUN]
[0m18:21:02.916040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m18:21:02.917593 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m18:21:02.924024 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m18:21:02.928691 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m18:21:02.936697 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m18:21:02.939689 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:02.940687 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m18:21:02.942792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:21:03.156595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.214 seconds
[0m18:21:03.158588 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:03.159585 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m18:21:03.171589 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m18:21:03.178570 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:03.179574 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers" rename to "mart_top_customers__dbt_backup"
[0m18:21:03.181527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:03.187453 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:03.188461 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m18:21:03.190413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:21:03.193435 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m18:21:03.194436 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:03.195397 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m18:21:03.198389 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:21:03.203409 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m18:21:03.205370 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:21:03.206367 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m18:21:03.210359 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:21:03.213891 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m18:21:03.215224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7267a0ad-3028-4225-be54-f7da0576938f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49C2D3C50>]}
[0m18:21:03.217224 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.30s]
[0m18:21:03.220215 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m18:21:03.222304 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:03.224107 [debug] [MainThread]: On master: BEGIN
[0m18:21:03.225112 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:21:03.439380 [debug] [MainThread]: SQL status: BEGIN in 0.214 seconds
[0m18:21:03.440512 [debug] [MainThread]: On master: COMMIT
[0m18:21:03.441514 [debug] [MainThread]: Using postgres connection "master"
[0m18:21:03.442550 [debug] [MainThread]: On master: COMMIT
[0m18:21:03.443546 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:21:03.444507 [debug] [MainThread]: On master: Close
[0m18:21:03.445504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:03.447013 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:21:03.449012 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m18:21:03.450009 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m18:21:03.451007 [info ] [MainThread]: 
[0m18:21:03.453143 [info ] [MainThread]: Finished running 6 incremental models, 5 view models in 0 hours 0 minutes and 6.35 seconds (6.35s).
[0m18:21:03.461951 [debug] [MainThread]: Command end result
[0m18:21:03.520797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:21:03.527183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:21:03.541198 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:21:03.542170 [info ] [MainThread]: 
[0m18:21:03.544162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:21:03.546344 [info ] [MainThread]: 
[0m18:21:03.548418 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:21:03.551414 [debug] [MainThread]: Command `dbt run` succeeded at 18:21:03.550417 after 10.51 seconds
[0m18:21:03.552411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49712FBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D49712EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4971380D0>]}
[0m18:21:03.553408 [debug] [MainThread]: Flushing usage events
[0m18:21:04.896761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:03.616849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489ED85F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489ED71A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489ED71E50>]}


============================== 18:22:03.626475 | 48879d8d-c893-4b44-95e0-f2eb39468823 ==============================
[0m18:22:03.626475 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:22:03.627477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:22:04.060133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489EF70690>]}
[0m18:22:04.171369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489BA3D2D0>]}
[0m18:22:04.174362 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:22:05.023783 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:22:05.449367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:22:05.450363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:22:05.546312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A02664D0>]}
[0m18:22:05.712063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:22:05.723359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:22:05.784315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489EF1DF50>]}
[0m18:22:05.785313 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:22:05.787502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A026D210>]}
[0m18:22:05.792080 [info ] [MainThread]: 
[0m18:22:05.794430 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:22:05.796218 [info ] [MainThread]: 
[0m18:22:05.797458 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:22:05.803972 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:22:06.198375 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:22:06.199373 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:22:06.200370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:06.598618 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.398 seconds
[0m18:22:06.601580 [debug] [ThreadPool]: On list_propharma: Close
[0m18:22:06.612441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m18:22:06.624127 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:22:06.625144 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:22:06.626170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:22:06.850312 [debug] [ThreadPool]: SQL status: BEGIN in 0.225 seconds
[0m18:22:06.852267 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:22:06.853330 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:22:06.863604 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:22:06.867870 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:22:06.868870 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:22:06.870052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m18:22:06.880711 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:22:06.881708 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:22:06.883703 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:22:07.204141 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m18:22:07.205138 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:22:07.207102 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:22:07.217680 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m18:22:07.219674 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:22:07.221669 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:22:07.232174 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:07.233171 [debug] [MainThread]: On master: BEGIN
[0m18:22:07.234169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:22:07.458401 [debug] [MainThread]: SQL status: BEGIN in 0.225 seconds
[0m18:22:07.460118 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:07.461151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:22:07.504654 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m18:22:07.511672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A04177D0>]}
[0m18:22:07.512212 [debug] [MainThread]: On master: ROLLBACK
[0m18:22:07.514263 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:07.515212 [debug] [MainThread]: On master: BEGIN
[0m18:22:07.516241 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:22:07.517203 [debug] [MainThread]: On master: COMMIT
[0m18:22:07.519197 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:07.520194 [debug] [MainThread]: On master: COMMIT
[0m18:22:07.522189 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:22:07.523223 [debug] [MainThread]: On master: Close
[0m18:22:07.532555 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m18:22:07.534404 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m18:22:07.537431 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m18:22:07.538398 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m18:22:07.553211 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m18:22:07.653037 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:07.655032 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m18:22:07.656030 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:22:07.882303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m18:22:07.883315 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:07.884488 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:22:07.913594 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.027 seconds
[0m18:22:08.010093 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.011102 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp182207995374"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select *,cast(prescribed_date as timestamp) as prescribed_timestamp from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_timestamp, prescribed_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            prescribed_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:22:08.032162 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.019 seconds
[0m18:22:08.039577 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.040586 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182207995374'
        
      order by ordinal_position

  
[0m18:22:08.047885 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.006 seconds
[0m18:22:08.054891 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.055888 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:22:08.062901 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:22:08.069846 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.070844 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182207995374'
        
      order by ordinal_position

  
[0m18:22:08.077861 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.006 seconds
[0m18:22:08.084807 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.085804 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:22:08.092731 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:22:08.105325 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.106836 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182207995374'
        
      order by ordinal_position

  
[0m18:22:08.113047 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.006 seconds
[0m18:22:08.146925 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.147922 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select *,cast(prescribed_date as timestamp) as prescribed_timestamp from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_timestamp, prescribed_timestamp), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_timestamp as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_timestamp as dbt_updated_at,
            prescribed_timestamp as dbt_valid_from,
            prescribed_timestamp as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_timestamp)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:22:08.150440 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:22:08.160923 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.161920 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:22:08.164300 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:22:08.165344 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.168933 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.170298 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp182207995374" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "prescribed_timestamp", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."prescribed_timestamp",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp182207995374" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:22:08.174752 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:22:08.200799 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:22:08.201840 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:22:08.202882 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:22:08.208828 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:22:08.216324 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m18:22:08.220761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48879d8d-c893-4b44-95e0-f2eb39468823', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000148A06B7410>]}
[0m18:22:08.222958 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 10[0m in 0.68s]
[0m18:22:08.225955 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m18:22:08.229229 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:08.230957 [debug] [MainThread]: On master: BEGIN
[0m18:22:08.232345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:22:08.452136 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m18:22:08.454774 [debug] [MainThread]: On master: COMMIT
[0m18:22:08.455775 [debug] [MainThread]: Using postgres connection "master"
[0m18:22:08.455775 [debug] [MainThread]: On master: COMMIT
[0m18:22:08.457587 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:22:08.459086 [debug] [MainThread]: On master: Close
[0m18:22:08.460087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:22:08.461086 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:22:08.462083 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m18:22:08.463081 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m18:22:08.465075 [info ] [MainThread]: 
[0m18:22:08.467148 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.67 seconds (2.67s).
[0m18:22:08.470276 [debug] [MainThread]: Command end result
[0m18:22:08.523780 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:22:08.529771 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:22:08.542863 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:22:08.542863 [info ] [MainThread]: 
[0m18:22:08.545723 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:22:08.547691 [info ] [MainThread]: 
[0m18:22:08.549074 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:22:08.552927 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:22:08.551439 after 5.63 seconds
[0m18:22:08.553468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489E9D28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001489E9D2E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014899D7EDD0>]}
[0m18:22:08.554470 [debug] [MainThread]: Flushing usage events
[0m18:22:09.635347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:22:44.847625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3524CA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D352A6390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D352A74D0>]}


============================== 18:22:44.855238 | fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0 ==============================
[0m18:22:44.855238 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:23:08.381480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:23:08.812036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D353C2990>]}
[0m18:23:08.922404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D31EBED10>]}
[0m18:23:08.925396 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:23:09.741224 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:23:10.157826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:10.159605 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m18:23:10.682952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3680AA90>]}
[0m18:23:10.844172 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:23:10.855219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:23:10.913130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D369DC4D0>]}
[0m18:23:10.915254 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:23:10.916267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36912BD0>]}
[0m18:23:10.921289 [info ] [MainThread]: 
[0m18:23:10.923220 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:10.924254 [info ] [MainThread]: 
[0m18:23:10.926338 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:23:10.940254 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:23:11.338131 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:23:11.339136 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:23:11.341131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:11.724752 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.384 seconds
[0m18:23:11.727751 [debug] [ThreadPool]: On list_propharma: Close
[0m18:23:11.732144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m18:23:11.749080 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:23:11.751076 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:23:11.752104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:11.988770 [debug] [ThreadPool]: SQL status: BEGIN in 0.236 seconds
[0m18:23:11.989741 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:23:11.990994 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:23:12.001720 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m18:23:12.004901 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:23:12.005902 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:23:12.007398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m18:23:12.012868 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:23:12.013885 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:23:12.014863 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:12.230981 [debug] [ThreadPool]: SQL status: BEGIN in 0.215 seconds
[0m18:23:12.231978 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:23:12.233972 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:23:12.245320 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:23:12.248316 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:23:12.250313 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:23:12.265776 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:12.266807 [debug] [MainThread]: On master: BEGIN
[0m18:23:12.267810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:23:12.490402 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m18:23:12.492100 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:12.493333 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:23:12.535197 [debug] [MainThread]: SQL status: SELECT 11 in 0.040 seconds
[0m18:23:12.542275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D368325D0>]}
[0m18:23:12.543271 [debug] [MainThread]: On master: ROLLBACK
[0m18:23:12.544269 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:12.545268 [debug] [MainThread]: On master: BEGIN
[0m18:23:12.547105 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:23:12.548145 [debug] [MainThread]: On master: COMMIT
[0m18:23:12.549138 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:12.550467 [debug] [MainThread]: On master: COMMIT
[0m18:23:12.551008 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:12.552810 [debug] [MainThread]: On master: Close
[0m18:23:12.561384 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m18:23:12.563050 [info ] [Thread-1 (]: 1 of 11 START sql incremental model public.stg_inventory ....................... [RUN]
[0m18:23:12.565081 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m18:23:12.567043 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m18:23:12.581669 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m18:23:12.586178 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m18:23:12.691244 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:12.692245 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

    
  
    

  create temporary table "stg_inventory__dbt_tmp182312642071"
  
  
    as
  
  (
    

with raw_inventory as (
    select * from public.inventory
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
  
  
[0m18:23:12.693273 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:23:12.921323 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.228 seconds
[0m18:23:12.948101 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:12.949141 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m18:23:12.950147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:12.952543 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:12.953591 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory__dbt_tmp182312642071'
        
      order by ordinal_position

  
[0m18:23:12.976542 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.023 seconds
[0m18:23:12.988235 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:12.990447 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:12.996754 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m18:23:13.070042 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:13.071051 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_inventory'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:13.078238 [debug] [Thread-1 (]: SQL status: SELECT 3 in 0.005 seconds
[0m18:23:13.106284 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m18:23:13.109285 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:13.110242 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

      
        
        
        delete from "propharma"."public"."stg_inventory" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_inventory__dbt_tmp182312642071" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_inventory" ("medicine_id", "stock_qty", "last_updated")
    (
        select "medicine_id", "stock_qty", "last_updated"
        from "stg_inventory__dbt_tmp182312642071"
    )
  
[0m18:23:13.114603 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m18:23:13.141325 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m18:23:13.142324 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m18:23:13.144463 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m18:23:13.146842 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:23:13.150309 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m18:23:13.154744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36CFB450>]}
[0m18:23:13.156738 [info ] [Thread-1 (]: 1 of 11 OK created sql incremental model public.stg_inventory .................. [[32mINSERT 0 10[0m in 0.59s]
[0m18:23:13.159730 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m18:23:13.161725 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m18:23:13.162762 [info ] [Thread-1 (]: 2 of 11 START sql incremental model public.stg_medicines ....................... [RUN]
[0m18:23:13.163751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m18:23:13.165709 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m18:23:13.170733 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m18:23:13.176024 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m18:23:13.184015 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.186011 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

    
  
    

  create temporary table "stg_medicines__dbt_tmp182313181024"
  
  
    as
  
  (
    

with raw_medicines as (
    select * from public.medicines
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
  
  
[0m18:23:13.187519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:13.416953 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.230 seconds
[0m18:23:13.422174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.423449 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m18:23:13.426218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:13.427256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.428253 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines__dbt_tmp182313181024'
        
      order by ordinal_position

  
[0m18:23:13.452179 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m18:23:13.457892 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.459977 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:13.465542 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:23:13.472442 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.474487 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_medicines'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:13.480951 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:23:13.485202 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m18:23:13.489472 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.490518 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

      
        
        
        delete from "propharma"."public"."stg_medicines" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "stg_medicines__dbt_tmp182313181024" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_medicines" ("medicine_id", "name", "category", "price", "expiry_date")
    (
        select "medicine_id", "name", "category", "price", "expiry_date"
        from "stg_medicines__dbt_tmp182313181024"
    )
  
[0m18:23:13.494685 [debug] [Thread-1 (]: SQL status: INSERT 0 11 in 0.003 seconds
[0m18:23:13.497676 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m18:23:13.498673 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m18:23:13.500668 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m18:23:13.506454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:23:13.508815 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m18:23:13.510809 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36E72810>]}
[0m18:23:13.512804 [info ] [Thread-1 (]: 2 of 11 OK created sql incremental model public.stg_medicines .................. [[32mINSERT 0 11[0m in 0.35s]
[0m18:23:13.515937 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m18:23:13.517932 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m18:23:13.519960 [info ] [Thread-1 (]: 3 of 11 START sql incremental model public.stg_patients ........................ [RUN]
[0m18:23:13.521921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m18:23:13.522918 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m18:23:13.529320 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m18:23:13.533465 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m18:23:13.541442 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.542440 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

    
  
    

  create temporary table "stg_patients__dbt_tmp182313538450"
  
  
    as
  
  (
    

with raw_patients as (
    select * from public.patients
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
  
  
[0m18:23:13.544434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:13.765589 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.222 seconds
[0m18:23:13.771777 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.772778 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m18:23:13.774776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:13.775807 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.777764 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients__dbt_tmp182313538450'
        
      order by ordinal_position

  
[0m18:23:13.800780 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m18:23:13.810055 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.811052 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:13.817960 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m18:23:13.824941 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.825939 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_patients'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:13.832920 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:23:13.836449 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m18:23:13.840590 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.840590 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

      
        
        
        delete from "propharma"."public"."stg_patients" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "stg_patients__dbt_tmp182313538450" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_patients" ("patient_id", "name", "dob", "gender")
    (
        select "patient_id", "name", "dob", "gender"
        from "stg_patients__dbt_tmp182313538450"
    )
  
[0m18:23:13.845275 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:23:13.848365 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m18:23:13.849406 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m18:23:13.850447 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m18:23:13.861155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m18:23:13.863364 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m18:23:13.864409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D353C2090>]}
[0m18:23:13.866482 [info ] [Thread-1 (]: 3 of 11 OK created sql incremental model public.stg_patients ................... [[32mINSERT 0 10[0m in 0.34s]
[0m18:23:13.869901 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m18:23:13.871113 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m18:23:13.872446 [info ] [Thread-1 (]: 4 of 11 START sql incremental model public.stg_prescriptions ................... [RUN]
[0m18:23:13.874815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m18:23:13.876337 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m18:23:13.882606 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m18:23:13.885906 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m18:23:13.893682 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:13.895643 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

    
  
    

  create temporary table "stg_prescriptions__dbt_tmp182313890650"
  
  
    as
  
  (
    

with raw_prescriptions as (
    select * from public.prescriptions
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
  
  
[0m18:23:13.896675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:14.211785 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.315 seconds
[0m18:23:14.217778 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.218771 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m18:23:14.220480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:14.222412 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.223453 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions__dbt_tmp182313890650'
        
      order by ordinal_position

  
[0m18:23:14.247192 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m18:23:14.253959 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.254956 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:14.261938 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m18:23:14.268175 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.269171 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_prescriptions'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:14.276120 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m18:23:14.280072 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m18:23:14.284677 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.285682 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

      
        
        
        delete from "propharma"."public"."stg_prescriptions" as DBT_INTERNAL_DEST
        where (prescription_id) in (
            select distinct prescription_id
            from "stg_prescriptions__dbt_tmp182313890650" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity")
    (
        select "prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity"
        from "stg_prescriptions__dbt_tmp182313890650"
    )
  
[0m18:23:14.289180 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:23:14.292657 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m18:23:14.293694 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m18:23:14.294780 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m18:23:14.302549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m18:23:14.305581 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m18:23:14.306536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D353C1590>]}
[0m18:23:14.308414 [info ] [Thread-1 (]: 4 of 11 OK created sql incremental model public.stg_prescriptions .............. [[32mINSERT 0 10[0m in 0.43s]
[0m18:23:14.311473 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m18:23:14.313468 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m18:23:14.314469 [info ] [Thread-1 (]: 5 of 11 START sql incremental model public.stg_sales ........................... [RUN]
[0m18:23:14.317477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m18:23:14.318479 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m18:23:14.323528 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m18:23:14.327492 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m18:23:14.336499 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.337496 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

    
  
    

  create temporary table "stg_sales__dbt_tmp182314332508"
  
  
    as
  
  (
    


with raw_sales as (
    select * from sales
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
  
  
[0m18:23:14.338494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:14.683684 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.345 seconds
[0m18:23:14.689484 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.691441 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m18:23:14.692479 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:14.694821 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.695818 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales__dbt_tmp182314332508'
        
      order by ordinal_position

  
[0m18:23:14.726691 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.029 seconds
[0m18:23:14.732707 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.734711 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:14.741685 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.006 seconds
[0m18:23:14.751659 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.752626 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_sales'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:14.759604 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.005 seconds
[0m18:23:14.764618 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m18:23:14.768609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.769604 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

      
        
        
        delete from "propharma"."public"."stg_sales" as DBT_INTERNAL_DEST
        where (sale_id) in (
            select distinct sale_id
            from "stg_sales__dbt_tmp182314332508" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_sales" ("sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount")
    (
        select "sale_id", "prescription_id", "medicine_id", "sale_date", "quantity_sold", "amount"
        from "stg_sales__dbt_tmp182314332508"
    )
  
[0m18:23:14.773602 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:23:14.776595 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m18:23:14.777592 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m18:23:14.779238 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m18:23:14.785900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m18:23:14.787897 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m18:23:14.789409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36D191D0>]}
[0m18:23:14.792357 [info ] [Thread-1 (]: 5 of 11 OK created sql incremental model public.stg_sales ...................... [[32mINSERT 0 10[0m in 0.47s]
[0m18:23:14.795225 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m18:23:14.795734 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m18:23:14.797474 [info ] [Thread-1 (]: 6 of 11 START sql incremental model public.stg_suppliers ....................... [RUN]
[0m18:23:14.800084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m18:23:14.802314 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m18:23:14.810516 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m18:23:14.814503 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m18:23:14.823488 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:14.825477 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

    
  
    

  create temporary table "stg_suppliers__dbt_tmp182314819490"
  
  
    as
  
  (
    


with raw_suppliers as (
    select * from public.suppliers
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
  
  
[0m18:23:14.826499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:15.066016 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.240 seconds
[0m18:23:15.072000 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.074002 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m18:23:15.076032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:23:15.077030 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.077994 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers__dbt_tmp182314819490'
        
      order by ordinal_position

  
[0m18:23:15.101548 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m18:23:15.107826 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.108778 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:15.116188 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:23:15.123164 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.124160 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'stg_suppliers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m18:23:15.131142 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m18:23:15.135131 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m18:23:15.139090 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.140084 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

      
        
        
        delete from "propharma"."public"."stg_suppliers" as DBT_INTERNAL_DEST
        where (supplier_id) in (
            select distinct supplier_id
            from "stg_suppliers__dbt_tmp182314819490" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."stg_suppliers" ("supplier_id", "supplier_name", "medicine_id", "last_supplied_date")
    (
        select "supplier_id", "supplier_name", "medicine_id", "last_supplied_date"
        from "stg_suppliers__dbt_tmp182314819490"
    )
  
[0m18:23:15.145057 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m18:23:15.148048 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m18:23:15.149057 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m18:23:15.150043 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m18:23:15.153189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:15.155880 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m18:23:15.156421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36D91050>]}
[0m18:23:15.158895 [info ] [Thread-1 (]: 6 of 11 OK created sql incremental model public.stg_suppliers .................. [[32mINSERT 0 10[0m in 0.36s]
[0m18:23:15.162081 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m18:23:15.163078 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m18:23:15.165636 [info ] [Thread-1 (]: 7 of 11 START sql view model public.mart_expired_drugs ......................... [RUN]
[0m18:23:15.167434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m18:23:15.167970 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m18:23:15.176564 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m18:23:15.180633 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m18:23:15.218342 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m18:23:15.222365 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.223329 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m18:23:15.225323 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:15.492805 [debug] [Thread-1 (]: SQL status: BEGIN in 0.268 seconds
[0m18:23:15.494808 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.495805 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

  create view "propharma"."public"."mart_expired_drugs__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m18:23:15.504994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:23:15.518674 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.519960 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs" rename to "mart_expired_drugs__dbt_backup"
[0m18:23:15.521960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:15.532212 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.533210 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
alter table "propharma"."public"."mart_expired_drugs__dbt_tmp" rename to "mart_expired_drugs"
[0m18:23:15.535797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:15.545176 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m18:23:15.546389 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.548566 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m18:23:15.551107 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:15.563993 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_expired_drugs__dbt_backup"
[0m18:23:15.574886 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m18:23:15.575901 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */
drop view if exists "propharma"."public"."mart_expired_drugs__dbt_backup" cascade
[0m18:23:15.578918 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:15.582511 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m18:23:15.584518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36CF4F10>]}
[0m18:23:15.586799 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.mart_expired_drugs .................... [[32mCREATE VIEW[0m in 0.42s]
[0m18:23:15.590045 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m18:23:15.591132 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m18:23:15.592631 [info ] [Thread-1 (]: 8 of 11 START sql view model public.mart_inventory_status ...................... [RUN]
[0m18:23:15.595311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m18:23:15.596856 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m18:23:15.605244 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m18:23:15.609240 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m18:23:15.616808 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m18:23:15.621074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.622549 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m18:23:15.623551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:15.853060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m18:23:15.855016 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.856012 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

  create view "propharma"."public"."mart_inventory_status__dbt_tmp"
    
    
  as (
    select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
[0m18:23:15.865985 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m18:23:15.873003 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.874003 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status" rename to "mart_inventory_status__dbt_backup"
[0m18:23:15.875999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:15.882018 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.884030 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
alter table "propharma"."public"."mart_inventory_status__dbt_tmp" rename to "mart_inventory_status"
[0m18:23:15.886008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:15.888516 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m18:23:15.889555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.891348 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m18:23:15.893887 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:23:15.898912 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_inventory_status__dbt_backup"
[0m18:23:15.900874 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m18:23:15.901908 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */
drop view if exists "propharma"."public"."mart_inventory_status__dbt_backup" cascade
[0m18:23:15.905860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:15.909886 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m18:23:15.911844 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D369DE210>]}
[0m18:23:15.913838 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.mart_inventory_status ................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:15.916829 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m18:23:15.919106 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m18:23:15.920616 [info ] [Thread-1 (]: 9 of 11 START sql view model public.mart_invoice ............................... [RUN]
[0m18:23:15.923714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m18:23:15.924728 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m18:23:15.934268 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m18:23:15.938469 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m18:23:15.945847 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m18:23:15.949807 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:15.950841 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m18:23:15.952010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:16.276103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.324 seconds
[0m18:23:16.277213 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:16.278710 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

  create view "propharma"."public"."mart_invoice__dbt_tmp"
    
    
  as (
    select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
[0m18:23:16.290051 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m18:23:16.298035 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:16.299607 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice" rename to "mart_invoice__dbt_backup"
[0m18:23:16.301798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.308467 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:16.309494 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
alter table "propharma"."public"."mart_invoice__dbt_tmp" rename to "mart_invoice"
[0m18:23:16.311488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.314450 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m18:23:16.315480 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:16.317095 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m18:23:16.326606 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m18:23:16.334900 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_invoice__dbt_backup"
[0m18:23:16.336895 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m18:23:16.337892 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */
drop view if exists "propharma"."public"."mart_invoice__dbt_backup" cascade
[0m18:23:16.341650 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:16.344257 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m18:23:16.345347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36E8F190>]}
[0m18:23:16.348781 [info ] [Thread-1 (]: 9 of 11 OK created sql view model public.mart_invoice .......................... [[32mCREATE VIEW[0m in 0.42s]
[0m18:23:16.351654 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m18:23:16.353087 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m18:23:16.354172 [info ] [Thread-1 (]: 10 of 11 START sql view model public.mart_sales_summary ........................ [RUN]
[0m18:23:16.356182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m18:23:16.357208 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m18:23:16.363406 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m18:23:16.368224 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m18:23:16.375272 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m18:23:16.379402 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.380403 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m18:23:16.381827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:16.620682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m18:23:16.621692 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.623804 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

  create view "propharma"."public"."mart_sales_summary__dbt_tmp"
    
    
  as (
    select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
[0m18:23:16.633158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:23:16.639845 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.640980 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary" rename to "mart_sales_summary__dbt_backup"
[0m18:23:16.643048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.649298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.650296 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
alter table "propharma"."public"."mart_sales_summary__dbt_tmp" rename to "mart_sales_summary"
[0m18:23:16.652327 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.654318 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m18:23:16.656275 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.657273 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m18:23:16.659911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:23:16.665077 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_sales_summary__dbt_backup"
[0m18:23:16.666073 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m18:23:16.667072 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */
drop view if exists "propharma"."public"."mart_sales_summary__dbt_backup" cascade
[0m18:23:16.670745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:16.673778 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m18:23:16.676050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36D5EA90>]}
[0m18:23:16.677053 [info ] [Thread-1 (]: 10 of 11 OK created sql view model public.mart_sales_summary ................... [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:16.680048 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m18:23:16.682320 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m18:23:16.683316 [info ] [Thread-1 (]: 11 of 11 START sql view model public.mart_top_customers ........................ [RUN]
[0m18:23:16.685750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m18:23:16.686746 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m18:23:16.693337 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m18:23:16.696995 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m18:23:16.705069 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m18:23:16.708030 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.709027 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m18:23:16.710788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:16.937988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m18:23:16.939777 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.940809 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

  create view "propharma"."public"."mart_top_customers__dbt_tmp"
    
    
  as (
    select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
[0m18:23:16.952784 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m18:23:16.960096 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.961096 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers" rename to "mart_top_customers__dbt_backup"
[0m18:23:16.963275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.969941 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.970938 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
alter table "propharma"."public"."mart_top_customers__dbt_tmp" rename to "mart_top_customers"
[0m18:23:16.972933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:23:16.975929 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m18:23:16.978121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.980139 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m18:23:16.985593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m18:23:16.991020 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."mart_top_customers__dbt_backup"
[0m18:23:16.992032 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m18:23:16.993133 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */
drop view if exists "propharma"."public"."mart_top_customers__dbt_backup" cascade
[0m18:23:16.997346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:23:16.999798 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m18:23:17.001846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd8c6ea4-f1db-4e67-91a2-c04b3ff97fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D36E8FA90>]}
[0m18:23:17.002843 [info ] [Thread-1 (]: 11 of 11 OK created sql view model public.mart_top_customers ................... [[32mCREATE VIEW[0m in 0.32s]
[0m18:23:17.005835 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m18:23:17.009201 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:17.010221 [debug] [MainThread]: On master: BEGIN
[0m18:23:17.011240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:23:17.362410 [debug] [MainThread]: SQL status: BEGIN in 0.351 seconds
[0m18:23:17.363443 [debug] [MainThread]: On master: COMMIT
[0m18:23:17.365402 [debug] [MainThread]: Using postgres connection "master"
[0m18:23:17.366439 [debug] [MainThread]: On master: COMMIT
[0m18:23:17.367398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:23:17.368394 [debug] [MainThread]: On master: Close
[0m18:23:17.370579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:17.371586 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:23:17.372582 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m18:23:17.373575 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m18:23:17.375642 [info ] [MainThread]: 
[0m18:23:17.378097 [info ] [MainThread]: Finished running 6 incremental models, 5 view models in 0 hours 0 minutes and 6.45 seconds (6.45s).
[0m18:23:17.384929 [debug] [MainThread]: Command end result
[0m18:23:17.439385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:23:17.446819 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:23:17.460582 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:23:17.461673 [info ] [MainThread]: 
[0m18:23:17.463902 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:17.465916 [info ] [MainThread]: 
[0m18:23:17.468145 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m18:23:17.470615 [debug] [MainThread]: Command `dbt run` succeeded at 18:23:17.470615 after 33.32 seconds
[0m18:23:17.471618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D345B34D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D301FEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D301FFBD0>]}
[0m18:23:17.472610 [debug] [MainThread]: Flushing usage events
[0m18:23:18.897513 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:00.086978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0E156510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0E1575D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0E157B90>]}


============================== 18:24:00.094960 | 4f43d6f7-a660-40cc-bb34-ba711ca23361 ==============================
[0m18:24:00.094960 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:24:00.096820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:00.515939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0E2ED590>]}
[0m18:24:00.640631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0AD5D750>]}
[0m18:24:00.643789 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:24:01.483320 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:24:01.906061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:01.907061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:02.002353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0F5A0250>]}
[0m18:24:02.165858 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:24:02.177839 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:24:02.241978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0F4F8410>]}
[0m18:24:02.242974 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:24:02.244969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0F4C53D0>]}
[0m18:24:02.249473 [info ] [MainThread]: 
[0m18:24:02.251469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:02.252465 [info ] [MainThread]: 
[0m18:24:02.254460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:02.260446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:24:02.679781 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:24:02.680288 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:24:02.682289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:02.972969 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.291 seconds
[0m18:24:02.976128 [debug] [ThreadPool]: On list_propharma: Close
[0m18:24:02.989094 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m18:24:03.002058 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:24:03.003056 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:24:03.005051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:03.258992 [debug] [ThreadPool]: SQL status: BEGIN in 0.254 seconds
[0m18:24:03.259999 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:24:03.261386 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:24:03.272823 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m18:24:03.275944 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:24:03.277939 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:24:03.279934 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m18:24:03.285058 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:24:03.286076 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:24:03.288570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:03.549475 [debug] [ThreadPool]: SQL status: BEGIN in 0.261 seconds
[0m18:24:03.550479 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:24:03.552473 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:24:03.565159 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m18:24:03.568348 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:24:03.570368 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:24:03.588025 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:03.589024 [debug] [MainThread]: On master: BEGIN
[0m18:24:03.591018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:03.841429 [debug] [MainThread]: SQL status: BEGIN in 0.250 seconds
[0m18:24:03.842425 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:03.843649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:03.892980 [debug] [MainThread]: SQL status: SELECT 11 in 0.048 seconds
[0m18:24:03.903985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0FAEA610>]}
[0m18:24:03.905980 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:03.907975 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:03.908972 [debug] [MainThread]: On master: BEGIN
[0m18:24:03.911456 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:24:03.913481 [debug] [MainThread]: On master: COMMIT
[0m18:24:03.914478 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:03.915771 [debug] [MainThread]: On master: COMMIT
[0m18:24:03.917787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:03.918795 [debug] [MainThread]: On master: Close
[0m18:24:03.929150 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m18:24:03.930156 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m18:24:03.932166 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m18:24:03.933416 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m18:24:03.949133 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m18:24:04.059803 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.061796 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m18:24:04.062793 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:04.331730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.269 seconds
[0m18:24:04.334069 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.336069 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:24:04.380755 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.043 seconds
[0m18:24:04.480610 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.482936 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp182404466056"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_date)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:24:04.502163 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.017 seconds
[0m18:24:04.508891 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.509889 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182404466056'
        
      order by ordinal_position

  
[0m18:24:04.519233 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.008 seconds
[0m18:24:04.526214 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.527208 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:24:04.535469 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m18:24:04.541983 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.544573 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182404466056'
        
      order by ordinal_position

  
[0m18:24:04.552471 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m18:24:04.559644 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.560641 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:24:04.568619 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m18:24:04.581503 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.582500 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182404466056'
        
      order by ordinal_position

  
[0m18:24:04.590478 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.007 seconds
[0m18:24:04.624036 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.625131 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.prescribed_date))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.prescribed_date)
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:24:04.628131 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:24:04.638113 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.639111 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:24:04.641105 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:24:04.642103 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m18:24:04.644215 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.648205 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.649717 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp182404466056" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp182404466056" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:24:04.653715 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m18:24:04.680920 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:24:04.681918 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:24:04.682915 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:24:04.692975 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m18:24:04.700995 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m18:24:04.704982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f43d6f7-a660-40cc-bb34-ba711ca23361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0FAC2750>]}
[0m18:24:04.708608 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 0[0m in 0.77s]
[0m18:24:04.712189 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m18:24:04.715332 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:04.716843 [debug] [MainThread]: On master: BEGIN
[0m18:24:04.719047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:24:04.943709 [debug] [MainThread]: SQL status: BEGIN in 0.225 seconds
[0m18:24:04.944737 [debug] [MainThread]: On master: COMMIT
[0m18:24:04.945737 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:04.946698 [debug] [MainThread]: On master: COMMIT
[0m18:24:04.947729 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:24:04.949744 [debug] [MainThread]: On master: Close
[0m18:24:04.950786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:04.951327 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:24:04.952331 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m18:24:04.953325 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m18:24:04.955509 [info ] [MainThread]: 
[0m18:24:04.956512 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m18:24:04.959538 [debug] [MainThread]: Command end result
[0m18:24:05.016424 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:24:05.022413 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:24:05.035398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:24:05.036359 [info ] [MainThread]: 
[0m18:24:05.038710 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:05.040756 [info ] [MainThread]: 
[0m18:24:05.041965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:24:05.044996 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:24:05.044996 after 5.64 seconds
[0m18:24:05.045998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0FA48F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0908EDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E0908FBD0>]}
[0m18:24:05.046999 [debug] [MainThread]: Flushing usage events
[0m18:24:06.123637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:32.626025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F26B5B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F2698090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F26B7790>]}


============================== 18:26:32.636542 | 7d038d9c-695d-4fb6-9c54-cf636dd005be ==============================
[0m18:26:32.636542 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:26:32.638537 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:26:33.063528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d038d9c-695d-4fb6-9c54-cf636dd005be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F27DBAD0>]}
[0m18:26:33.179382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d038d9c-695d-4fb6-9c54-cf636dd005be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213EF2AD3D0>]}
[0m18:26:33.182984 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:26:34.001596 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:26:34.422969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:34.423972 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m18:26:34.814839 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot snapshot_prescriptions (snapshots\snapshot_prescriptions.sql)
  expected token ',', got 'updated_at'
    line 8
      updated_at='prescribed_date'
[0m18:26:34.817796 [debug] [MainThread]: Command `dbt snapshot` failed at 18:26:34.817796 after 2.87 seconds
[0m18:26:34.819791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F26C7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F26C4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F26C46D0>]}
[0m18:26:34.820787 [debug] [MainThread]: Flushing usage events
[0m18:26:35.973872 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:57.707401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C499ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C49D45D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C49D4C10>]}


============================== 18:26:57.715384 | 1068dee4-cc60-4e76-81b6-8b6ebfbfe206 ==============================
[0m18:26:57.715384 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:26:57.717844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:26:58.179842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C4B903D0>]}
[0m18:26:58.305384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C168D590>]}
[0m18:26:58.308375 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:26:59.164066 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:26:59.595881 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:59.598257 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m18:27:00.151204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C48BC390>]}
[0m18:27:00.319842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:27:00.332748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:27:00.408111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C60E4050>]}
[0m18:27:00.410104 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 434 macros
[0m18:27:00.413096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C6023B90>]}
[0m18:27:00.418344 [info ] [MainThread]: 
[0m18:27:00.420338 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:00.422332 [info ] [MainThread]: 
[0m18:27:00.425343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:00.434323 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m18:27:00.910947 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m18:27:00.911955 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m18:27:00.913946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:01.236734 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.322 seconds
[0m18:27:01.239760 [debug] [ThreadPool]: On list_propharma: Close
[0m18:27:01.253024 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m18:27:01.264602 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:27:01.265609 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m18:27:01.267039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:01.588839 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m18:27:01.590984 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m18:27:01.592999 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:27:01.605203 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m18:27:01.608789 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m18:27:01.610832 [debug] [ThreadPool]: On list_propharma_public: Close
[0m18:27:01.613246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m18:27:01.629652 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:27:01.631647 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m18:27:01.632645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:01.891508 [debug] [ThreadPool]: SQL status: BEGIN in 0.259 seconds
[0m18:27:01.893891 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m18:27:01.894896 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:27:01.908859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m18:27:01.911932 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m18:27:01.914136 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m18:27:01.926911 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:01.929088 [debug] [MainThread]: On master: BEGIN
[0m18:27:01.930341 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:02.285611 [debug] [MainThread]: SQL status: BEGIN in 0.355 seconds
[0m18:27:02.287605 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:02.288603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:02.347901 [debug] [MainThread]: SQL status: SELECT 11 in 0.057 seconds
[0m18:27:02.354889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C6085110>]}
[0m18:27:02.356391 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:02.357804 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:02.360068 [debug] [MainThread]: On master: BEGIN
[0m18:27:02.361063 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:27:02.363704 [debug] [MainThread]: On master: COMMIT
[0m18:27:02.364700 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:02.366097 [debug] [MainThread]: On master: COMMIT
[0m18:27:02.368300 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:02.369305 [debug] [MainThread]: On master: Close
[0m18:27:02.380276 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m18:27:02.383268 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m18:27:02.385583 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m18:27:02.386621 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m18:27:02.402640 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m18:27:02.507042 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:02.508039 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select prescribed_date from (
                

select * from "propharma"."public"."stg_prescriptions"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m18:27:02.509036 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:02.804513 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.295 seconds
[0m18:27:02.834129 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:02.835135 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m18:27:02.837148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m18:27:02.839184 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:02.840179 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:27:02.873908 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.032 seconds
[0m18:27:02.889184 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:02.890184 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:27:02.897786 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:27:02.992365 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:02.994360 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp182702978440"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m18:27:03.014047 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m18:27:03.083399 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.084397 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182702978440'
        
      order by ordinal_position

  
[0m18:27:03.092010 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m18:27:03.103983 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.106006 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:27:03.114825 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.007 seconds
[0m18:27:03.122964 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.125959 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182702978440'
        
      order by ordinal_position

  
[0m18:27:03.134152 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m18:27:03.141136 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.143164 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m18:27:03.151243 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m18:27:03.165115 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.167111 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp182702978440'
        
      order by ordinal_position

  
[0m18:27:03.177207 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.009 seconds
[0m18:27:03.211021 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.212027 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            
  
  coalesce(nullif(prescribed_date, prescribed_date), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(prescribed_date as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            prescribed_date as dbt_updated_at,
            prescribed_date as dbt_valid_from,
            prescribed_date as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m18:27:03.215117 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:27:03.226663 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.228710 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m18:27:03.230758 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m18:27:03.232965 [warn ] [Thread-1 (]: Data type of snapshot table timestamp columns (DATETIME) doesn't match derived column 'updated_at' (DATE). Please update snapshot config 'updated_at'.
[0m18:27:03.236026 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.241862 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.244859 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp182702978440" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp182702978440" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m18:27:03.250078 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.003 seconds
[0m18:27:03.279625 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:27:03.281621 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m18:27:03.282617 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m18:27:03.285991 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:27:03.294201 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m18:27:03.299583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1068dee4-cc60-4e76-81b6-8b6ebfbfe206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7C4B518D0>]}
[0m18:27:03.302584 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 1[0m in 0.91s]
[0m18:27:03.306572 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m18:27:03.310562 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:03.311559 [debug] [MainThread]: On master: BEGIN
[0m18:27:03.314245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:03.564490 [debug] [MainThread]: SQL status: BEGIN in 0.251 seconds
[0m18:27:03.566484 [debug] [MainThread]: On master: COMMIT
[0m18:27:03.567482 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:03.568479 [debug] [MainThread]: On master: COMMIT
[0m18:27:03.570473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:27:03.571471 [debug] [MainThread]: On master: Close
[0m18:27:03.573466 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:03.574519 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m18:27:03.575529 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m18:27:03.577900 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m18:27:03.578912 [info ] [MainThread]: 
[0m18:27:03.581015 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m18:27:03.584452 [debug] [MainThread]: Command end result
[0m18:27:03.646175 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m18:27:03.652669 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m18:27:03.666206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m18:27:03.668209 [info ] [MainThread]: 
[0m18:27:03.670495 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:03.672549 [info ] [MainThread]: 
[0m18:27:03.674869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:27:03.679594 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:27:03.678596 after 6.65 seconds
[0m18:27:03.682843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BF9CFBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BF9CEDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7BF9D80D0>]}
[0m18:27:03.684857 [debug] [MainThread]: Flushing usage events
[0m18:27:04.830079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:38:25.324623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC5DE2990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC61E2690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC618D190>]}


============================== 11:38:25.334370 | c72a47e1-01c8-498b-85be-d1b3f19a4688 ==============================
[0m11:38:25.334370 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:38:25.337093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:38:25.963706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c72a47e1-01c8-498b-85be-d1b3f19a4688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC637CD10>]}
[0m11:38:26.099743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c72a47e1-01c8-498b-85be-d1b3f19a4688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC2DDD290>]}
[0m15:14:37.950785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85DE02490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85DE67790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85DE65D50>]}


============================== 15:14:37.961442 | 11a914f5-ba62-4be7-b7f1-1d2566ab49dc ==============================
[0m15:14:37.961442 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:14:37.962979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:14:38.424690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11a914f5-ba62-4be7-b7f1-1d2566ab49dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85E005D50>]}
[0m15:14:38.552985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11a914f5-ba62-4be7-b7f1-1d2566ab49dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C85AA675D0>]}
[0m15:14:38.556973 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:14:39.476227 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:14:39.707577 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading Propharma: raw_data.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         identifier: inventory
    8  |         columns:
    9  |           -name: inventory_id
    10 |            tests:
    11 |               - not null
    12 |               - string_not_empty
    13 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 10, column 17
[0m15:14:39.713303 [debug] [MainThread]: Command `dbt test` failed at 15:14:39.713303 after 2.03 seconds
[0m15:14:39.715351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8574FFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C857799650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C857799510>]}
[0m15:14:39.716358 [debug] [MainThread]: Flushing usage events
[0m15:14:41.859437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:24.593034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5C487390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5C465ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5C486250>]}


============================== 15:15:24.601210 | 3394fb28-cb19-4de1-9df7-84aa71bb5873 ==============================
[0m15:15:24.601210 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:15:24.603640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:15:25.012319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3394fb28-cb19-4de1-9df7-84aa71bb5873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE5C48D210>]}
[0m15:15:25.123411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3394fb28-cb19-4de1-9df7-84aa71bb5873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE590D5F10>]}
[0m15:15:25.126407 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:15:25.961219 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:15:26.201767 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading Propharma: raw_data.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         identifier: inventory
    8  |         columns:
    9  |           -name: inventory_id
    10 |            tests:
    11 |               - not null
    12 | 
    13 |       - name: med
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 10, column 17
[0m15:15:26.208022 [debug] [MainThread]: Command `dbt test` failed at 15:15:26.208022 after 1.87 seconds
[0m15:15:26.209032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE55B7FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE55E19510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE55E19590>]}
[0m15:15:26.210043 [debug] [MainThread]: Flushing usage events
[0m15:15:27.584071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:12.283493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C5DE6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C59F2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C5D818D0>]}


============================== 15:18:12.291955 | 6f6e744d-a3b2-4368-8cb6-bb3937ccb69b ==============================
[0m15:18:12.291955 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:18:12.294439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:18:12.748760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f6e744d-a3b2-4368-8cb6-bb3937ccb69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C59F26D0>]}
[0m15:18:12.869280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f6e744d-a3b2-4368-8cb6-bb3937ccb69b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C2A074D0>]}
[0m15:18:12.872453 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:18:13.733853 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:18:13.967286 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading Propharma: raw_data.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         identifier: inventory
    8  |         columns:
    9  |           -name: inventory_id
    10 |            tests:
    11 |               - not null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 10, column 17
[0m15:18:13.972507 [debug] [MainThread]: Command `dbt test` failed at 15:18:13.972507 after 2.01 seconds
[0m15:18:13.974473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203BF4AFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203BF4AFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203C7273550>]}
[0m15:18:13.975504 [debug] [MainThread]: Flushing usage events
[0m15:18:15.621347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:19:08.199752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE4A66750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE4A0F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE4A01D90>]}


============================== 15:19:08.209017 | 585b88fd-c510-4ff8-83d3-7ade0e0699b9 ==============================
[0m15:19:08.209017 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:19:08.210892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:19:08.793033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '585b88fd-c510-4ff8-83d3-7ade0e0699b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE4B83190>]}
[0m15:19:08.919922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '585b88fd-c510-4ff8-83d3-7ade0e0699b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE16FB750>]}
[0m15:19:08.923211 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:19:09.762154 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:19:10.007254 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'get'
[0m15:19:10.023338 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 327, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 351, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 2069, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 312, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\manifest.py", line 359, in load
    file_reader.read_files()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\read_files.py", line 212, in read_files
    self.read_files_for_project(project, file_types)
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\read_files.py", line 219, in read_files_for_project
    project_files[file_type_info["parser"]] = read_files_for_parser(
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\read_files.py", line 167, in read_files_for_parser
    source_files = get_source_files(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\read_files.py", line 156, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\read_files.py", line 89, in load_source_file
    dfy = yaml_from_file(source_file)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\parser\schemas.py", line 125, in yaml_from_file
    for table in source.get("tables", []):
                 ^^^^^^^^^^
AttributeError: 'str' object has no attribute 'get'

[0m15:19:10.043164 [debug] [MainThread]: Command `dbt test` failed at 15:19:10.042167 after 2.12 seconds
[0m15:19:10.045159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BDE19FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BE4563250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014BDE439590>]}
[0m15:19:10.048150 [debug] [MainThread]: Flushing usage events
[0m15:19:11.590300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:21:31.552123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214559020D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021455949C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021455948F90>]}


============================== 15:21:31.561519 | 414de093-4adc-4619-9e5c-d3036adde7f7 ==============================
[0m15:21:31.561519 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:21:31.563898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:32.035463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '414de093-4adc-4619-9e5c-d3036adde7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002145596D350>]}
[0m15:21:32.149850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '414de093-4adc-4619-9e5c-d3036adde7f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000214525668D0>]}
[0m15:21:32.152843 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:21:32.994989 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:21:33.501942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 7 files changed.
[0m15:21:33.504330 [debug] [MainThread]: Partial parsing: added file: Propharma://models\raw_data.yml
[0m15:21:33.505336 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_suppliers.sql
[0m15:21:33.507347 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m15:21:33.508351 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_medicines.sql
[0m15:21:33.509355 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_sales.sql
[0m15:21:33.510976 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m15:21:33.513426 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_inventory.sql
[0m15:21:33.514427 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_patients.sql
[0m15:21:34.688604 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.Propharma.stg_suppliers' (models\staging\stg_suppliers.sql) depends on a source named 'raw_tables.sup' which was not found
[0m15:21:34.693295 [debug] [MainThread]: Command `dbt test` failed at 15:21:34.693295 after 3.42 seconds
[0m15:21:34.694678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002145596C150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002144EF2FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002144F1C9510>]}
[0m15:21:34.697155 [debug] [MainThread]: Flushing usage events
[0m15:21:36.710485 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:22:39.562755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD26ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD2A6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD2A4310>]}


============================== 15:22:39.570800 | 6d80239e-ed0b-41ac-a24d-6d69eb12b5c6 ==============================
[0m15:22:39.570800 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:22:39.572835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:22:40.009686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d80239e-ed0b-41ac-a24d-6d69eb12b5c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD3B4A10>]}
[0m15:22:40.129863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d80239e-ed0b-41ac-a24d-6d69eb12b5c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD9EB7B10>]}
[0m15:22:40.132842 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:22:41.047793 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:22:41.296352 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading Propharma: raw_data.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  |         identifier: inventory
    8  |         columns:
    9  |           -name: inventory_id
    10 |            tests:
    11 |               - not null
    12 |               - string_not_empty
    13 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 10, column 17
[0m15:22:41.302747 [debug] [MainThread]: Command `dbt test` failed at 15:22:41.301749 after 2.01 seconds
[0m15:22:41.303708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD690FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD6BA9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBD6BA9510>]}
[0m15:22:41.304745 [debug] [MainThread]: Flushing usage events
[0m15:22:42.791479 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:26.050574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1D576F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1D558F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1D51CBD0>]}


============================== 15:23:26.060571 | 96238011-1d47-4ee0-8dac-5742b203f02c ==============================
[0m15:23:26.060571 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:23:26.062702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:23:26.493996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1D715B10>]}
[0m15:23:26.606046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1A1E7790>]}
[0m15:23:26.609038 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:23:27.514057 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:23:27.964717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 7 files changed.
[0m15:23:27.965723 [debug] [MainThread]: Partial parsing: added file: Propharma://models\raw_data.yml
[0m15:23:27.967723 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_inventory.sql
[0m15:23:27.969007 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_medicines.sql
[0m15:23:27.971307 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m15:23:27.973388 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_patients.sql
[0m15:23:27.974479 [debug] [MainThread]: Partial parsing: updated file: Propharma://snapshots\snapshot_prescriptions.sql
[0m15:23:27.977568 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_suppliers.sql
[0m15:23:27.980565 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_sales.sql
[0m15:23:29.545239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1EDC2950>]}
[0m15:23:29.827863 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:23:29.847140 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:23:29.941696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1EBB7BD0>]}
[0m15:23:29.942692 [info ] [MainThread]: Found 11 models, 1 seed, 1 snapshot, 2 data tests, 6 sources, 434 macros
[0m15:23:29.944865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1EED1E10>]}
[0m15:23:29.950880 [info ] [MainThread]: 
[0m15:23:29.952855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:23:29.954827 [info ] [MainThread]: 
[0m15:23:29.958501 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:29.974526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:23:30.556430 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:23:30.558008 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:23:30.558974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:30.824182 [debug] [ThreadPool]: SQL status: BEGIN in 0.266 seconds
[0m15:23:30.826422 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:23:30.827430 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:23:30.839044 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m15:23:30.843041 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:23:30.845096 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:23:30.846099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:23:30.857902 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:23:30.860048 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:23:30.861083 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:31.188703 [debug] [ThreadPool]: SQL status: BEGIN in 0.328 seconds
[0m15:23:31.189741 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:23:31.191696 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:23:31.202343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:23:31.205374 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:23:31.206371 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:23:31.218804 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:31.219801 [debug] [MainThread]: On master: BEGIN
[0m15:23:31.220798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:31.562362 [debug] [MainThread]: SQL status: BEGIN in 0.341 seconds
[0m15:23:31.564357 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:31.566352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:31.628554 [debug] [MainThread]: SQL status: SELECT 11 in 0.060 seconds
[0m15:23:31.637258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96238011-1d47-4ee0-8dac-5742b203f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1EBA5CD0>]}
[0m15:23:31.638266 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:31.640302 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:31.641298 [debug] [MainThread]: On master: BEGIN
[0m15:23:31.642609 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:31.645064 [debug] [MainThread]: On master: COMMIT
[0m15:23:31.646464 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:31.647961 [debug] [MainThread]: On master: COMMIT
[0m15:23:31.650373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:31.652492 [debug] [MainThread]: On master: Close
[0m15:23:31.664810 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:23:31.666975 [info ] [Thread-1 (]: 1 of 2 START test source_not_raw_tables_inv_inventory_id ....................... [RUN]
[0m15:23:31.669591 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a'
[0m15:23:31.671590 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:23:31.717753 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:31.720197 [error] [Thread-1 (]: 1 of 2 ERROR source_not_raw_tables_inv_inventory_id ............................ [[31mERROR[0m in 0.05s]
[0m15:23:31.723727 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:23:31.724733 [debug] [Thread-1 (]: Began running node test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c
[0m15:23:31.725760 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:23:31.726768 [info ] [Thread-1 (]: 2 of 2 START test source_string_not_empty_raw_tables_inv_inventory_id .......... [RUN]
[0m15:23:31.731566 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a, now test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c)
[0m15:23:31.732572 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c
[0m15:23:31.745324 [debug] [Thread-1 (]: Compilation Error in test source_string_not_empty_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_string_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:31.746325 [error] [Thread-1 (]: 2 of 2 ERROR source_string_not_empty_raw_tables_inv_inventory_id ............... [[31mERROR[0m in 0.02s]
[0m15:23:31.749704 [debug] [Thread-1 (]: Finished running node test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c
[0m15:23:31.752288 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c' to be skipped because of status 'error'.  Reason: Compilation Error in test source_string_not_empty_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_string_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:23:31.754377 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:31.756443 [debug] [MainThread]: On master: BEGIN
[0m15:23:31.757440 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:32.059080 [debug] [MainThread]: SQL status: BEGIN in 0.302 seconds
[0m15:23:32.060078 [debug] [MainThread]: On master: COMMIT
[0m15:23:32.061075 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:32.062504 [debug] [MainThread]: On master: COMMIT
[0m15:23:32.063510 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:23:32.065749 [debug] [MainThread]: On master: Close
[0m15:23:32.066746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:32.068255 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:23:32.069259 [debug] [MainThread]: Connection 'test.Propharma.source_string_not_empty_raw_tables_inv_inventory_id.7acf21109c' was properly closed.
[0m15:23:32.072061 [info ] [MainThread]: 
[0m15:23:32.073336 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m15:23:32.076620 [debug] [MainThread]: Command end result
[0m15:23:32.140881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:23:32.148442 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:23:32.166239 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:23:32.167446 [info ] [MainThread]: 
[0m15:23:32.169394 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:23:32.171492 [info ] [MainThread]: 
[0m15:23:32.173503 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:32.175514 [info ] [MainThread]: 
[0m15:23:32.177749 [error] [MainThread]:   Compilation Error in test source_string_not_empty_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_string_not_empty' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:23:32.181145 [info ] [MainThread]: 
[0m15:23:32.183337 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:23:32.187082 [debug] [MainThread]: Command `dbt test` failed at 15:23:32.187082 after 6.41 seconds
[0m15:23:32.189541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D16C8FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1D51F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D1EDA9290>]}
[0m15:23:32.190892 [debug] [MainThread]: Flushing usage events
[0m15:23:34.020799 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:43.829912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F88824E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F88845D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F88846010>]}


============================== 15:28:43.837925 | ac745d4d-f08d-4e34-8582-44d9f52afa92 ==============================
[0m15:28:43.837925 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:28:43.840358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:28:44.247053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac745d4d-f08d-4e34-8582-44d9f52afa92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F8896E050>]}
[0m15:28:44.367984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac745d4d-f08d-4e34-8582-44d9f52afa92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F854477D0>]}
[0m15:28:44.370976 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:28:45.211263 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:28:45.723114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:28:45.726112 [debug] [MainThread]: Partial parsing: added file: Propharma://tests\empty_string.sql
[0m15:28:45.730756 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:28:46.863036 [error] [MainThread]: Encountered an error:
Compilation Error in test empty_string (tests\empty_string.sql)
  unexpected '}'
    line 5
      {% endtest }
[0m15:28:46.866990 [debug] [MainThread]: Command `dbt test` failed at 15:28:46.865992 after 3.29 seconds
[0m15:28:46.867987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F88452810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F81E9FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F82139510>]}
[0m15:28:46.869597 [debug] [MainThread]: Flushing usage events
[0m15:28:48.411294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:50.934774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE598D6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE59878A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE59878FD0>]}


============================== 15:29:50.943185 | b9c3a70b-da5e-477a-96e5-5064004ba016 ==============================
[0m15:29:50.943185 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:29:50.945704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:51.370470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE59A75ED0>]}
[0m15:29:51.487124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE565277D0>]}
[0m15:29:51.490117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:29:52.295164 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:29:52.788086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:29:52.790082 [debug] [MainThread]: Partial parsing: added file: Propharma://tests\empty_string.sql
[0m15:29:52.792075 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:29:54.582274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5B30F8D0>]}
[0m15:29:54.826708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:29:54.837983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:29:54.916230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5AF96950>]}
[0m15:29:54.917228 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 3 data tests, 6 sources, 434 macros
[0m15:29:54.919701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5AFC0690>]}
[0m15:29:54.924283 [info ] [MainThread]: 
[0m15:29:54.926071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:29:54.927329 [info ] [MainThread]: 
[0m15:29:54.929626 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:29:54.944307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m15:29:55.320541 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:29:55.322081 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:29:55.323082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:55.570846 [debug] [ThreadPool]: SQL status: BEGIN in 0.248 seconds
[0m15:29:55.571855 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:29:55.572858 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:29:55.584897 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.011 seconds
[0m15:29:55.588002 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:29:55.590018 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:29:55.591022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m15:29:55.598559 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:29:55.599555 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:29:55.601684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:29:55.844305 [debug] [ThreadPool]: SQL status: BEGIN in 0.243 seconds
[0m15:29:55.846339 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:29:55.847271 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:29:55.858411 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:29:55.862399 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:29:55.864396 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:29:55.881515 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:55.882512 [debug] [MainThread]: On master: BEGIN
[0m15:29:55.884507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:29:56.125027 [debug] [MainThread]: SQL status: BEGIN in 0.241 seconds
[0m15:29:56.126024 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:56.127021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:29:56.175716 [debug] [MainThread]: SQL status: SELECT 11 in 0.047 seconds
[0m15:29:56.182696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9c3a70b-da5e-477a-96e5-5064004ba016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE5AC63390>]}
[0m15:29:56.183697 [debug] [MainThread]: On master: ROLLBACK
[0m15:29:56.186083 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:56.187086 [debug] [MainThread]: On master: BEGIN
[0m15:29:56.189081 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:29:56.190078 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.191075 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:56.192072 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.194067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:56.195065 [debug] [MainThread]: On master: Close
[0m15:29:56.204040 [debug] [Thread-1 (]: Began running node test.Propharma.empty_string
[0m15:29:56.206035 [info ] [Thread-1 (]: 1 of 3 START test empty_string ................................................. [RUN]
[0m15:29:56.208030 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.empty_string'
[0m15:29:56.209031 [debug] [Thread-1 (]: Began compiling node test.Propharma.empty_string
[0m15:29:56.226284 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.empty_string"
[0m15:29:56.227280 [debug] [Thread-1 (]: Began executing node test.Propharma.empty_string
[0m15:29:56.259904 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.empty_string"
[0m15:29:56.265828 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.empty_string"
[0m15:29:56.267282 [debug] [Thread-1 (]: On test.Propharma.empty_string: BEGIN
[0m15:29:56.269861 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:56.493719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m15:29:56.494259 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.empty_string"
[0m15:29:56.495297 [debug] [Thread-1 (]: On test.Propharma.empty_string: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.empty_string"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
      
    ) dbt_internal_test
[0m15:29:56.497807 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:     ) dbt_internal_test
            ^

[0m15:29:56.498954 [debug] [Thread-1 (]: On test.Propharma.empty_string: ROLLBACK
[0m15:29:56.500266 [debug] [Thread-1 (]: On test.Propharma.empty_string: Close
[0m15:29:56.520743 [debug] [Thread-1 (]: Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled code at target\run\Propharma\tests\empty_string.sql
[0m15:29:56.521741 [error] [Thread-1 (]: 1 of 3 ERROR empty_string ...................................................... [[31mERROR[0m in 0.31s]
[0m15:29:56.525155 [debug] [Thread-1 (]: Finished running node test.Propharma.empty_string
[0m15:29:56.525691 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:29:56.526723 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.empty_string' to be skipped because of status 'error'.  Reason: Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled code at target\run\Propharma\tests\empty_string.sql.
[0m15:29:56.528481 [info ] [Thread-1 (]: 2 of 3 START test source_empty_string_raw_tables_inv_inventory_id .............. [RUN]
[0m15:29:56.531524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.empty_string, now test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d)
[0m15:29:56.532908 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:29:56.548922 [debug] [Thread-1 (]: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:29:56.550921 [error] [Thread-1 (]: 2 of 3 ERROR source_empty_string_raw_tables_inv_inventory_id ................... [[31mERROR[0m in 0.02s]
[0m15:29:56.552920 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:29:56.555131 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:29:56.556128 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:29:56.557601 [info ] [Thread-1 (]: 3 of 3 START test source_not_raw_tables_inv_inventory_id ....................... [RUN]
[0m15:29:56.559835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d, now test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a)
[0m15:29:56.561829 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:29:56.573076 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:29:56.575516 [error] [Thread-1 (]: 3 of 3 ERROR source_not_raw_tables_inv_inventory_id ............................ [[31mERROR[0m in 0.01s]
[0m15:29:56.578681 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:29:56.580717 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:29:56.583705 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:56.585699 [debug] [MainThread]: On master: BEGIN
[0m15:29:56.586698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:29:56.823974 [debug] [MainThread]: SQL status: BEGIN in 0.238 seconds
[0m15:29:56.825963 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.826965 [debug] [MainThread]: Using postgres connection "master"
[0m15:29:56.828385 [debug] [MainThread]: On master: COMMIT
[0m15:29:56.829392 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:29:56.831375 [debug] [MainThread]: On master: Close
[0m15:29:56.832444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:56.834011 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m15:29:56.835192 [debug] [MainThread]: Connection 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' was properly closed.
[0m15:29:56.836289 [info ] [MainThread]: 
[0m15:29:56.839584 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m15:29:56.842576 [debug] [MainThread]: Command end result
[0m15:29:56.918969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:29:56.926048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:29:56.950417 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:29:56.951422 [info ] [MainThread]: 
[0m15:29:56.953686 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:29:56.955704 [info ] [MainThread]: 
[0m15:29:56.957773 [error] [MainThread]:   Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 9:     ) dbt_internal_test
              ^
  compiled code at target\run\Propharma\tests\empty_string.sql
[0m15:29:56.961041 [info ] [MainThread]: 
[0m15:29:56.963078 [error] [MainThread]:   Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:29:56.965112 [info ] [MainThread]: 
[0m15:29:56.967107 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:29:56.969102 [info ] [MainThread]: 
[0m15:29:56.971097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m15:29:56.975278 [debug] [MainThread]: Command `dbt test` failed at 15:29:56.974088 after 6.30 seconds
[0m15:29:56.977280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE598E2290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE52FCFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BE594E2F90>]}
[0m15:29:56.979394 [debug] [MainThread]: Flushing usage events
[0m15:29:58.557926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:14.976189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270DB7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2709C2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2709C2650>]}


============================== 15:33:14.984588 | 3d70011e-00a7-4a95-8df2-0ce820a9ec1b ==============================
[0m15:33:14.984588 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:33:14.986553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:33:15.400309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270F54910>]}
[0m15:33:15.509642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26DA17D50>]}
[0m15:33:15.512635 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:16.365508 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:33:16.894915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:16.896951 [debug] [MainThread]: Partial parsing: updated file: Propharma://tests\empty_string.sql
[0m15:33:17.488070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2721976D0>]}
[0m15:33:17.763570 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:33:17.774935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:33:17.865719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2725D7F90>]}
[0m15:33:17.866714 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 3 data tests, 6 sources, 434 macros
[0m15:33:17.869169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270F52F10>]}
[0m15:33:17.873579 [info ] [MainThread]: 
[0m15:33:17.875444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:17.876989 [info ] [MainThread]: 
[0m15:33:17.878367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:17.892538 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:33:18.284610 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:33:18.286579 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:33:18.287576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:18.559121 [debug] [ThreadPool]: SQL status: BEGIN in 0.272 seconds
[0m15:33:18.561142 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:33:18.562177 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:33:18.572974 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:33:18.575965 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:33:18.577925 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:33:18.579924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:33:18.590921 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:33:18.591920 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:33:18.592917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:18.815640 [debug] [ThreadPool]: SQL status: BEGIN in 0.222 seconds
[0m15:33:18.816637 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:33:18.817639 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:33:18.828608 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m15:33:18.832240 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:33:18.834240 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:33:18.846196 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.848195 [debug] [MainThread]: On master: BEGIN
[0m15:33:18.849193 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:19.174007 [debug] [MainThread]: SQL status: BEGIN in 0.325 seconds
[0m15:33:19.175008 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:19.177002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:19.218913 [debug] [MainThread]: SQL status: SELECT 11 in 0.041 seconds
[0m15:33:19.225930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d70011e-00a7-4a95-8df2-0ce820a9ec1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270E00150>]}
[0m15:33:19.226924 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:19.228932 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:19.229879 [debug] [MainThread]: On master: BEGIN
[0m15:33:19.231874 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:33:19.233389 [debug] [MainThread]: On master: COMMIT
[0m15:33:19.234395 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:19.235392 [debug] [MainThread]: On master: COMMIT
[0m15:33:19.236389 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:19.237388 [debug] [MainThread]: On master: Close
[0m15:33:19.246546 [debug] [Thread-1 (]: Began running node test.Propharma.empty_string
[0m15:33:19.248548 [info ] [Thread-1 (]: 1 of 3 START test empty_string ................................................. [RUN]
[0m15:33:19.250738 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.empty_string'
[0m15:33:19.251274 [debug] [Thread-1 (]: Began compiling node test.Propharma.empty_string
[0m15:33:19.269455 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.empty_string"
[0m15:33:19.274443 [debug] [Thread-1 (]: Began executing node test.Propharma.empty_string
[0m15:33:19.310239 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.empty_string"
[0m15:33:19.314632 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.empty_string"
[0m15:33:19.316905 [debug] [Thread-1 (]: On test.Propharma.empty_string: BEGIN
[0m15:33:19.319607 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:33:19.540525 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m15:33:19.542496 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.empty_string"
[0m15:33:19.543537 [debug] [Thread-1 (]: On test.Propharma.empty_string: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.empty_string"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      empty_string.sql

      
    ) dbt_internal_test
[0m15:33:19.545625 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:     ) dbt_internal_test
             ^

[0m15:33:19.547192 [debug] [Thread-1 (]: On test.Propharma.empty_string: ROLLBACK
[0m15:33:19.548485 [debug] [Thread-1 (]: On test.Propharma.empty_string: Close
[0m15:33:19.563443 [debug] [Thread-1 (]: Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 10:     ) dbt_internal_test
               ^
  compiled code at target\run\Propharma\tests\empty_string.sql
[0m15:33:19.564434 [error] [Thread-1 (]: 1 of 3 ERROR empty_string ...................................................... [[31mERROR[0m in 0.31s]
[0m15:33:19.567103 [debug] [Thread-1 (]: Finished running node test.Propharma.empty_string
[0m15:33:19.568761 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:33:19.569800 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.empty_string' to be skipped because of status 'error'.  Reason: Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 10:     ) dbt_internal_test
               ^
  compiled code at target\run\Propharma\tests\empty_string.sql.
[0m15:33:19.571135 [info ] [Thread-1 (]: 2 of 3 START test source_empty_string_raw_tables_inv_inventory_id .............. [RUN]
[0m15:33:19.575182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.empty_string, now test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d)
[0m15:33:19.578183 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:33:19.664634 [debug] [Thread-1 (]: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:33:19.666630 [error] [Thread-1 (]: 2 of 3 ERROR source_empty_string_raw_tables_inv_inventory_id ................... [[31mERROR[0m in 0.09s]
[0m15:33:19.669719 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:33:19.670257 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:33:19.671865 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:33:19.672906 [info ] [Thread-1 (]: 3 of 3 START test source_not_raw_tables_inv_inventory_id ....................... [RUN]
[0m15:33:19.674784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d, now test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a)
[0m15:33:19.677023 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:33:19.689064 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:33:19.690712 [error] [Thread-1 (]: 3 of 3 ERROR source_not_raw_tables_inv_inventory_id ............................ [[31mERROR[0m in 0.02s]
[0m15:33:19.693904 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:33:19.694900 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:33:19.698123 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:19.699634 [debug] [MainThread]: On master: BEGIN
[0m15:33:19.701632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:19.940213 [debug] [MainThread]: SQL status: BEGIN in 0.239 seconds
[0m15:33:19.941214 [debug] [MainThread]: On master: COMMIT
[0m15:33:19.942211 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:19.943208 [debug] [MainThread]: On master: COMMIT
[0m15:33:19.945201 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:19.946197 [debug] [MainThread]: On master: Close
[0m15:33:19.947563 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:19.949115 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:33:19.950413 [debug] [MainThread]: Connection 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' was properly closed.
[0m15:33:19.951660 [info ] [MainThread]: 
[0m15:33:19.953664 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m15:33:19.956730 [debug] [MainThread]: Command end result
[0m15:33:20.013011 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:33:20.019335 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:33:20.035931 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:33:20.038481 [info ] [MainThread]: 
[0m15:33:20.040500 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:33:20.043112 [info ] [MainThread]: 
[0m15:33:20.045614 [error] [MainThread]:   Database Error in test empty_string (tests\empty_string.sql)
  syntax error at or near ")"
  LINE 10:     ) dbt_internal_test
               ^
  compiled code at target\run\Propharma\tests\empty_string.sql
[0m15:33:20.047411 [info ] [MainThread]: 
[0m15:33:20.049847 [error] [MainThread]:   Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_empty_string' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:33:20.051860 [info ] [MainThread]: 
[0m15:33:20.053268 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:33:20.056817 [info ] [MainThread]: 
[0m15:33:20.058809 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=0 TOTAL=3
[0m15:33:20.062641 [debug] [MainThread]: Command `dbt test` failed at 15:33:20.062641 after 5.36 seconds
[0m15:33:20.064636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B26A4BFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270D65310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B270D81E50>]}
[0m15:33:20.065632 [debug] [MainThread]: Flushing usage events
[0m15:33:21.710656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:37:42.167078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244920F7390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244920D9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244920D8F90>]}


============================== 15:37:42.175214 | ccd3a607-124d-4b19-8aee-2923f45a7385 ==============================
[0m15:37:42.175214 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:37:42.177265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:37:42.633167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244920FD210>]}
[0m15:37:42.748007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448ED07B90>]}
[0m15:37:42.751767 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:37:43.816363 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:37:44.587631 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:37:44.588636 [debug] [MainThread]: Partial parsing: added file: Propharma://tests\generic\empty_string.sql
[0m15:37:44.589642 [debug] [MainThread]: Partial parsing: deleted file: Propharma://tests\empty_string.sql
[0m15:37:44.920557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244920F6ED0>]}
[0m15:37:45.253893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:37:45.267861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:37:45.360370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024493873DD0>]}
[0m15:37:45.361367 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 2 data tests, 6 sources, 435 macros
[0m15:37:45.363560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002449225DF10>]}
[0m15:37:45.367711 [info ] [MainThread]: 
[0m15:37:45.369912 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:37:45.371060 [info ] [MainThread]: 
[0m15:37:45.373077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:37:45.387088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:37:45.851178 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:37:45.852339 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:37:45.853350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:37:46.251696 [debug] [ThreadPool]: SQL status: BEGIN in 0.398 seconds
[0m15:37:46.252841 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:37:46.253843 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:37:46.266219 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m15:37:46.269274 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:37:46.271292 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:37:46.272467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:37:46.285132 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:37:46.286141 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:37:46.287151 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:37:46.520295 [debug] [ThreadPool]: SQL status: BEGIN in 0.232 seconds
[0m15:37:46.521299 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:37:46.522801 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:37:46.533985 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:37:46.537949 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:37:46.538945 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:37:46.549960 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.550960 [debug] [MainThread]: On master: BEGIN
[0m15:37:46.552658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:37:46.854281 [debug] [MainThread]: SQL status: BEGIN in 0.301 seconds
[0m15:37:46.855359 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.856363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:37:46.908390 [debug] [MainThread]: SQL status: SELECT 11 in 0.050 seconds
[0m15:37:46.921354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd3a607-124d-4b19-8aee-2923f45a7385', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024491A91F10>]}
[0m15:37:46.923870 [debug] [MainThread]: On master: ROLLBACK
[0m15:37:46.925999 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.927001 [debug] [MainThread]: On master: BEGIN
[0m15:37:46.930710 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:37:46.932900 [debug] [MainThread]: On master: COMMIT
[0m15:37:46.934895 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:46.935892 [debug] [MainThread]: On master: COMMIT
[0m15:37:46.936890 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:46.938935 [debug] [MainThread]: On master: Close
[0m15:37:46.952694 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:37:46.953696 [info ] [Thread-1 (]: 1 of 2 START test source_empty_string_raw_tables_inv_inventory_id .............. [RUN]
[0m15:37:46.956073 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d'
[0m15:37:46.958121 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:37:47.040829 [debug] [Thread-1 (]: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  macro 'dbt_macro__test_empty_string' takes no keyword argument 'column_name'
[0m15:37:47.047930 [error] [Thread-1 (]: 1 of 2 ERROR source_empty_string_raw_tables_inv_inventory_id ................... [[31mERROR[0m in 0.09s]
[0m15:37:47.051839 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d
[0m15:37:47.054468 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:37:47.058673 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  macro 'dbt_macro__test_empty_string' takes no keyword argument 'column_name'.
[0m15:37:47.063330 [info ] [Thread-1 (]: 2 of 2 START test source_not_raw_tables_inv_inventory_id ....................... [RUN]
[0m15:37:47.075848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_inv_inventory_id.3522fd943d, now test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a)
[0m15:37:47.083775 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:37:47.149597 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:47.168265 [error] [Thread-1 (]: 2 of 2 ERROR source_not_raw_tables_inv_inventory_id ............................ [[31mERROR[0m in 0.08s]
[0m15:37:47.171532 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:37:47.173687 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:37:47.177408 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:47.179470 [debug] [MainThread]: On master: BEGIN
[0m15:37:47.180465 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:37:47.470822 [debug] [MainThread]: SQL status: BEGIN in 0.290 seconds
[0m15:37:47.472300 [debug] [MainThread]: On master: COMMIT
[0m15:37:47.473305 [debug] [MainThread]: Using postgres connection "master"
[0m15:37:47.474958 [debug] [MainThread]: On master: COMMIT
[0m15:37:47.476299 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:37:47.478610 [debug] [MainThread]: On master: Close
[0m15:37:47.480729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:37:47.482108 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:37:47.483116 [debug] [MainThread]: Connection 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' was properly closed.
[0m15:37:47.484313 [info ] [MainThread]: 
[0m15:37:47.486552 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.11 seconds (2.11s).
[0m15:37:47.488771 [debug] [MainThread]: Command end result
[0m15:37:47.551679 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:37:47.557664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:37:47.575370 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:37:47.579363 [info ] [MainThread]: 
[0m15:37:47.582352 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:37:47.584346 [info ] [MainThread]: 
[0m15:37:47.586342 [error] [MainThread]:   Compilation Error in test source_empty_string_raw_tables_inv_inventory_id (models\raw_data.yml)
  macro 'dbt_macro__test_empty_string' takes no keyword argument 'column_name'
[0m15:37:47.588723 [info ] [MainThread]: 
[0m15:37:47.590717 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:37:47.591835 [info ] [MainThread]: 
[0m15:37:47.595856 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m15:37:47.598808 [debug] [MainThread]: Command `dbt test` failed at 15:37:47.598808 after 5.72 seconds
[0m15:37:47.599844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244934542D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448B7AFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024491FD4510>]}
[0m15:37:47.601416 [debug] [MainThread]: Flushing usage events
[0m15:37:49.053960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:31.790387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C253D12090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C253D55ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C253D11ED0>]}


============================== 15:44:31.798369 | 691b00e6-aab9-4021-9d20-32915698237b ==============================
[0m15:44:31.798369 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:44:31.801358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:32.215579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '691b00e6-aab9-4021-9d20-32915698237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C253D7D210>]}
[0m15:44:32.331428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '691b00e6-aab9-4021-9d20-32915698237b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C250997C10>]}
[0m15:44:32.335420 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:33.172818 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:44:33.671625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:44:33.675060 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:44:35.173247 [error] [MainThread]: Encountered an error:
Compilation Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  macro 'dbt_macro__test_empty_string' takes no keyword argument 'column_name'
[0m15:44:35.177236 [debug] [MainThread]: Command `dbt test` failed at 15:44:35.176695 after 3.65 seconds
[0m15:44:35.178236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C24D43FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2556F8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C24D6D9650>]}
[0m15:44:35.179554 [debug] [MainThread]: Flushing usage events
[0m15:44:36.860780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:47.256285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6F01B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6F66890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6F65F50>]}


============================== 15:45:47.265257 | e6dc5af5-0fd8-4a77-848b-037ab6970eb0 ==============================
[0m15:45:47.265257 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:45:47.267252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:45:47.722624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6F66C90>]}
[0m15:45:47.842720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB3B74350>]}
[0m15:45:47.845715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:45:48.723654 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:45:49.338712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:45:49.343704 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:45:49.346696 [debug] [MainThread]: Partial parsing: updated file: Propharma://tests\generic\empty_string.sql
[0m15:45:50.999653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB89098D0>]}
[0m15:45:51.219841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:45:51.231818 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:45:51.307808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB86980D0>]}
[0m15:45:51.309803 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 4 data tests, 6 sources, 435 macros
[0m15:45:51.311798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB88E8990>]}
[0m15:45:51.316788 [info ] [MainThread]: 
[0m15:45:51.318917 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:45:51.321356 [info ] [MainThread]: 
[0m15:45:51.323367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:45:51.338293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:45:51.755715 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:45:51.757735 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:45:51.758742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:52.135147 [debug] [ThreadPool]: SQL status: BEGIN in 0.377 seconds
[0m15:45:52.137179 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:45:52.138176 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:45:52.149659 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:45:52.153342 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:45:52.154376 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:45:52.156397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:45:52.171785 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:45:52.172783 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:45:52.175202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:52.423913 [debug] [ThreadPool]: SQL status: BEGIN in 0.249 seconds
[0m15:45:52.425914 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:45:52.426912 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:45:52.438624 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:45:52.441661 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:45:52.443727 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:45:52.453464 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.455609 [debug] [MainThread]: On master: BEGIN
[0m15:45:52.456606 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:52.704960 [debug] [MainThread]: SQL status: BEGIN in 0.248 seconds
[0m15:45:52.706332 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.707823 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:45:52.756158 [debug] [MainThread]: SQL status: SELECT 11 in 0.046 seconds
[0m15:45:52.763201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6dc5af5-0fd8-4a77-848b-037ab6970eb0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB87D2BD0>]}
[0m15:45:52.764205 [debug] [MainThread]: On master: ROLLBACK
[0m15:45:52.766205 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.767539 [debug] [MainThread]: On master: BEGIN
[0m15:45:52.769540 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:45:52.770906 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.772906 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:52.774014 [debug] [MainThread]: On master: COMMIT
[0m15:45:52.776027 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:52.778085 [debug] [MainThread]: On master: Close
[0m15:45:52.788884 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:45:52.790878 [info ] [Thread-1 (]: 1 of 4 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:45:52.793179 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:45:52.794448 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:45:52.816720 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:45:52.822248 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:45:52.855305 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:45:52.861261 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:45:52.862257 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:45:52.864787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:45:53.235436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.370 seconds
[0m15:45:53.236432 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:45:53.237429 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT 
        FROM "propharma"."public"."medicines"
        WHERE TRIM() = ''

      
    ) dbt_internal_test
[0m15:45:53.238937 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:         WHERE TRIM() = ''
                            ^

[0m15:45:53.241419 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:45:53.242579 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:45:53.257712 [debug] [Thread-1 (]: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:45:53.258712 [error] [Thread-1 (]: 1 of 4 ERROR source_empty_string_raw_tables_med_name ........................... [[31mERROR[0m in 0.47s]
[0m15:45:53.261863 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:45:53.262864 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:45:53.263862 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4' to be skipped because of status 'error'.  Reason: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql.
[0m15:45:53.265857 [info ] [Thread-1 (]: 2 of 4 START test source_not_raw_tables_inv_inventory_id ....................... [RUN]
[0m15:45:53.269405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a)
[0m15:45:53.271738 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:45:53.288841 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.290799 [error] [Thread-1 (]: 2 of 4 ERROR source_not_raw_tables_inv_inventory_id ............................ [[31mERROR[0m in 0.02s]
[0m15:45:53.293992 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a
[0m15:45:53.294989 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d
[0m15:45:53.295986 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:45:53.296985 [info ] [Thread-1 (]: 3 of 4 START test source_not_raw_tables_med_medicine_id ........................ [RUN]
[0m15:45:53.300453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_raw_tables_inv_inventory_id.f91c96634a, now test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d)
[0m15:45:53.309423 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d
[0m15:45:53.321993 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_med_medicine_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.322990 [error] [Thread-1 (]: 3 of 4 ERROR source_not_raw_tables_med_medicine_id ............................. [[31mERROR[0m in 0.02s]
[0m15:45:53.326113 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d
[0m15:45:53.327590 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_raw_tables_med_name.fe553ad056
[0m15:45:53.328099 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_med_medicine_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:45:53.330080 [info ] [Thread-1 (]: 4 of 4 START test source_not_raw_tables_med_name ............................... [RUN]
[0m15:45:53.333257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_raw_tables_med_medicine_id.6cc603395d, now test.Propharma.source_not_raw_tables_med_name.fe553ad056)
[0m15:45:53.334905 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_raw_tables_med_name.fe553ad056
[0m15:45:53.345832 [debug] [Thread-1 (]: Compilation Error in test source_not_raw_tables_med_name (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.349037 [error] [Thread-1 (]: 4 of 4 ERROR source_not_raw_tables_med_name .................................... [[31mERROR[0m in 0.01s]
[0m15:45:53.352226 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_raw_tables_med_name.fe553ad056
[0m15:45:53.353184 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_raw_tables_med_name.fe553ad056' to be skipped because of status 'error'.  Reason: Compilation Error in test source_not_raw_tables_med_name (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:45:53.355179 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:53.357175 [debug] [MainThread]: On master: BEGIN
[0m15:45:53.358274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:53.585846 [debug] [MainThread]: SQL status: BEGIN in 0.228 seconds
[0m15:45:53.586810 [debug] [MainThread]: On master: COMMIT
[0m15:45:53.587806 [debug] [MainThread]: Using postgres connection "master"
[0m15:45:53.588804 [debug] [MainThread]: On master: COMMIT
[0m15:45:53.590798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:45:53.591830 [debug] [MainThread]: On master: Close
[0m15:45:53.592829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:53.593824 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:45:53.595781 [debug] [MainThread]: Connection 'test.Propharma.source_not_raw_tables_med_name.fe553ad056' was properly closed.
[0m15:45:53.597276 [info ] [MainThread]: 
[0m15:45:53.598378 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m15:45:53.601378 [debug] [MainThread]: Command end result
[0m15:45:53.660136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:45:53.668029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:45:53.684605 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:45:53.685627 [info ] [MainThread]: 
[0m15:45:53.687970 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m15:45:53.689703 [info ] [MainThread]: 
[0m15:45:53.692034 [error] [MainThread]:   Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:45:53.693676 [info ] [MainThread]: 
[0m15:45:53.695677 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_inv_inventory_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.697769 [info ] [MainThread]: 
[0m15:45:53.700208 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_med_medicine_id (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.702617 [info ] [MainThread]: 
[0m15:45:53.704501 [error] [MainThread]:   Compilation Error in test source_not_raw_tables_med_name (models\raw_data.yml)
  'test_not' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:45:53.706635 [info ] [MainThread]: 
[0m15:45:53.708634 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m15:45:53.712045 [debug] [MainThread]: Command `dbt test` failed at 15:45:53.712045 after 6.72 seconds
[0m15:45:53.714033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB05EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB0889590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026BB6A94390>]}
[0m15:45:53.715030 [debug] [MainThread]: Flushing usage events
[0m15:45:55.291678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:55.536800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34662090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34661150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34661650>]}


============================== 15:46:55.547154 | d6f709e5-f2a8-4c56-af5e-70793c6483a1 ==============================
[0m15:46:55.547154 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:55.549172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:55.984544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A34661B50>]}
[0m15:46:56.115399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A312B7FD0>]}
[0m15:46:56.117418 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:46:56.993940 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:57.626453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:57.631766 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:46:59.208037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A35FD1AD0>]}
[0m15:46:59.422623 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:46:59.433849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:46:59.510772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A347EDD90>]}
[0m15:46:59.511773 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 4 data tests, 6 sources, 435 macros
[0m15:46:59.514145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A35DB7850>]}
[0m15:46:59.518669 [info ] [MainThread]: 
[0m15:46:59.520607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:59.523107 [info ] [MainThread]: 
[0m15:46:59.525778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:46:59.539440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:46:59.924254 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:46:59.926278 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:46:59.927290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:00.199984 [debug] [ThreadPool]: SQL status: BEGIN in 0.273 seconds
[0m15:47:00.201013 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:47:00.202010 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:47:00.213016 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:47:00.216973 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:47:00.217970 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:47:00.219965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:47:00.229806 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:47:00.230803 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:47:00.232830 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:00.456564 [debug] [ThreadPool]: SQL status: BEGIN in 0.224 seconds
[0m15:47:00.457603 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:47:00.458591 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:47:00.469530 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:47:00.472496 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:47:00.474382 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:47:00.484854 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:00.485852 [debug] [MainThread]: On master: BEGIN
[0m15:47:00.487847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:00.705804 [debug] [MainThread]: SQL status: BEGIN in 0.219 seconds
[0m15:47:00.708035 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:00.709078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:47:00.750489 [debug] [MainThread]: SQL status: SELECT 11 in 0.041 seconds
[0m15:47:00.757777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6f709e5-f2a8-4c56-af5e-70793c6483a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A35D75710>]}
[0m15:47:00.758778 [debug] [MainThread]: On master: ROLLBACK
[0m15:47:00.761126 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:00.762130 [debug] [MainThread]: On master: BEGIN
[0m15:47:00.763302 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:47:00.764623 [debug] [MainThread]: On master: COMMIT
[0m15:47:00.765628 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:00.766625 [debug] [MainThread]: On master: COMMIT
[0m15:47:00.767623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:00.769020 [debug] [MainThread]: On master: Close
[0m15:47:00.778110 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:47:00.780144 [info ] [Thread-1 (]: 1 of 4 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:47:00.782201 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:47:00.783240 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:47:00.801624 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:47:00.806613 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:47:00.839923 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:47:00.844237 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:47:00.846262 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:47:00.848230 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:47:01.182411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.335 seconds
[0m15:47:01.183906 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:47:01.184949 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT 
        FROM "propharma"."public"."medicines"
        WHERE TRIM() = ''

      
    ) dbt_internal_test
[0m15:47:01.187115 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:         WHERE TRIM() = ''
                            ^

[0m15:47:01.189136 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:47:01.190146 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:47:01.204604 [debug] [Thread-1 (]: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:47:01.206150 [error] [Thread-1 (]: 1 of 4 ERROR source_empty_string_raw_tables_med_name ........................... [[31mERROR[0m in 0.42s]
[0m15:47:01.209181 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:47:01.210163 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:47:01.211174 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4' to be skipped because of status 'error'.  Reason: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql.
[0m15:47:01.212140 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m15:47:01.215967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m15:47:01.218471 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:47:01.232842 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:47:01.237956 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:47:01.243970 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:47:01.251257 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:47:01.257250 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m15:47:01.259243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:01.540310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.281 seconds
[0m15:47:01.542305 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:47:01.544300 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m15:47:01.547292 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "inventory_id" does not exist
LINE 13: select inventory_id
                ^

[0m15:47:01.549389 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m15:47:01.551405 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m15:47:01.559679 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_inv_inventory_id (models\raw_data.yml)
  column "inventory_id" does not exist
  LINE 13: select inventory_id
                  ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_inv_inventory_id.sql
[0m15:47:01.562040 [error] [Thread-1 (]: 2 of 4 ERROR source_not_null_raw_tables_inv_inventory_id ....................... [[31mERROR[0m in 0.35s]
[0m15:47:01.565032 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:47:01.567027 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:47:01.568024 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_inv_inventory_id (models\raw_data.yml)
  column "inventory_id" does not exist
  LINE 13: select inventory_id
                  ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_inv_inventory_id.sql.
[0m15:47:01.569021 [info ] [Thread-1 (]: 3 of 4 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:47:01.572116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:47:01.574127 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:47:01.583092 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:47:01.591581 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:47:01.597181 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:47:01.602384 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:47:01.602890 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:47:01.604228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:01.843584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m15:47:01.845699 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:47:01.846665 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:47:01.850698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:47:01.861927 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:47:01.863931 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:47:01.865926 [info ] [Thread-1 (]: 3 of 4 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.29s]
[0m15:47:01.868914 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:47:01.869909 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:47:01.872161 [info ] [Thread-1 (]: 4 of 4 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:47:01.874158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:47:01.875155 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:47:01.883805 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:47:01.889289 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:47:01.895355 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:47:01.901360 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:47:01.901869 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:47:01.903533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:02.267762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.364 seconds
[0m15:47:02.269814 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:47:02.270823 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:47:02.275060 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:47:02.278194 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:47:02.280277 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:47:02.281319 [info ] [Thread-1 (]: 4 of 4 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.41s]
[0m15:47:02.284353 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:47:02.287363 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:02.289838 [debug] [MainThread]: On master: BEGIN
[0m15:47:02.291361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:02.521313 [debug] [MainThread]: SQL status: BEGIN in 0.230 seconds
[0m15:47:02.523307 [debug] [MainThread]: On master: COMMIT
[0m15:47:02.524305 [debug] [MainThread]: Using postgres connection "master"
[0m15:47:02.525302 [debug] [MainThread]: On master: COMMIT
[0m15:47:02.526807 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:47:02.527809 [debug] [MainThread]: On master: Close
[0m15:47:02.528807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:02.529807 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:47:02.531797 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_med_name.01052fa279' was properly closed.
[0m15:47:02.531797 [info ] [MainThread]: 
[0m15:47:02.534802 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m15:47:02.538790 [debug] [MainThread]: Command end result
[0m15:47:02.598101 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:47:02.606541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:47:02.623641 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:47:02.626147 [info ] [MainThread]: 
[0m15:47:02.627509 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:47:02.630795 [info ] [MainThread]: 
[0m15:47:02.631803 [error] [MainThread]:   Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:47:02.634706 [info ] [MainThread]: 
[0m15:47:02.637190 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_inv_inventory_id (models\raw_data.yml)
  column "inventory_id" does not exist
  LINE 13: select inventory_id
                  ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_inv_inventory_id.sql
[0m15:47:02.640189 [info ] [MainThread]: 
[0m15:47:02.642184 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m15:47:02.647625 [debug] [MainThread]: Command `dbt test` failed at 15:47:02.646256 after 7.41 seconds
[0m15:47:02.648639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2DC7FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A2DF19590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A367F4910>]}
[0m15:47:02.649776 [debug] [MainThread]: Flushing usage events
[0m15:47:04.110752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:44.757825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED56706ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED56707150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED56707E90>]}


============================== 15:48:44.767831 | 74f78e41-1e90-4344-95c0-30b2e13129d5 ==============================
[0m15:48:44.767831 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:44.769859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:45.221246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5670D210>]}
[0m15:48:45.341809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED532F7790>]}
[0m15:48:45.344802 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:48:46.190833 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:46.735629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:48:46.738625 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:48:48.309216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED58011690>]}
[0m15:48:48.529334 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:48:48.540784 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:48:48.621727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED5683F850>]}
[0m15:48:48.622729 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 4 data tests, 6 sources, 435 macros
[0m15:48:48.624689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED57AB2B90>]}
[0m15:48:48.629969 [info ] [MainThread]: 
[0m15:48:48.631931 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:48.634274 [info ] [MainThread]: 
[0m15:48:48.636387 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:48:48.650905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:48:49.060403 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:48:49.061371 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:48:49.062397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:49.452865 [debug] [ThreadPool]: SQL status: BEGIN in 0.390 seconds
[0m15:48:49.453862 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:48:49.454859 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:48:49.466374 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:48:49.469371 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:48:49.471365 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:48:49.473361 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:48:49.483099 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:48:49.485094 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:48:49.486091 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:49.720068 [debug] [ThreadPool]: SQL status: BEGIN in 0.234 seconds
[0m15:48:49.722159 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:48:49.723125 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:48:49.734323 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:48:49.737433 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:48:49.739432 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:48:49.753205 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:49.755227 [debug] [MainThread]: On master: BEGIN
[0m15:48:49.756224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:49.983347 [debug] [MainThread]: SQL status: BEGIN in 0.227 seconds
[0m15:48:49.985347 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:49.987341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:48:50.030857 [debug] [MainThread]: SQL status: SELECT 11 in 0.043 seconds
[0m15:48:50.039332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74f78e41-1e90-4344-95c0-30b2e13129d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED583E9B90>]}
[0m15:48:50.040330 [debug] [MainThread]: On master: ROLLBACK
[0m15:48:50.042324 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:50.043322 [debug] [MainThread]: On master: BEGIN
[0m15:48:50.045317 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:48:50.046315 [debug] [MainThread]: On master: COMMIT
[0m15:48:50.049303 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:50.050814 [debug] [MainThread]: On master: COMMIT
[0m15:48:50.052997 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:50.053999 [debug] [MainThread]: On master: Close
[0m15:48:50.064622 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:48:50.065620 [info ] [Thread-1 (]: 1 of 4 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:48:50.068607 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:48:50.069604 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:48:50.089698 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:48:50.093725 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:48:50.139884 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:48:50.145106 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:48:50.146505 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:48:50.147514 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:50.413203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.265 seconds
[0m15:48:50.414209 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:48:50.415215 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT 
        FROM "propharma"."public"."medicines"
        WHERE TRIM() = ''

      
    ) dbt_internal_test
[0m15:48:50.418237 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 10:         WHERE TRIM() = ''
                            ^

[0m15:48:50.419246 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:48:50.421259 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:48:50.439135 [debug] [Thread-1 (]: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:48:50.440166 [error] [Thread-1 (]: 1 of 4 ERROR source_empty_string_raw_tables_med_name ........................... [[31mERROR[0m in 0.37s]
[0m15:48:50.442590 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:48:50.444610 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:48:50.445616 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4' to be skipped because of status 'error'.  Reason: Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql.
[0m15:48:50.446758 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_raw_tables_inv_medicine_id ................... [RUN]
[0m15:48:50.450948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8)
[0m15:48:50.453266 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:48:50.467469 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:48:50.472570 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:48:50.480095 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:48:50.489331 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:48:50.491374 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: BEGIN
[0m15:48:50.492369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:50.821436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.329 seconds
[0m15:48:50.822440 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:48:50.824434 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."inventory"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:48:50.829522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:48:50.838357 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: ROLLBACK
[0m15:48:50.839354 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: Close
[0m15:48:50.841390 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_raw_tables_inv_medicine_id ......................... [[32mPASS[0m in 0.39s]
[0m15:48:50.844778 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:48:50.846773 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:48:50.848142 [info ] [Thread-1 (]: 3 of 4 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:48:50.849649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:48:50.852655 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:48:50.865314 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:48:50.869841 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:48:50.878474 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:48:50.883802 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:48:50.885207 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:48:50.887361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:51.240975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.353 seconds
[0m15:48:51.243002 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:48:51.243997 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:48:51.248698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:48:51.252206 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:48:51.253202 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:48:51.255197 [info ] [Thread-1 (]: 3 of 4 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.41s]
[0m15:48:51.258453 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:48:51.260453 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:48:51.261478 [info ] [Thread-1 (]: 4 of 4 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:48:51.263439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:48:51.264438 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:48:51.276466 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:48:51.280456 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:48:51.285441 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:48:51.289744 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:48:51.293126 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:48:51.295121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:51.647977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.353 seconds
[0m15:48:51.648983 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:48:51.650494 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:48:51.654524 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:48:51.657536 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:48:51.659543 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:48:51.661727 [info ] [Thread-1 (]: 4 of 4 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.40s]
[0m15:48:51.664766 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:48:51.666821 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:51.668951 [debug] [MainThread]: On master: BEGIN
[0m15:48:51.669981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:48:51.912704 [debug] [MainThread]: SQL status: BEGIN in 0.243 seconds
[0m15:48:51.914225 [debug] [MainThread]: On master: COMMIT
[0m15:48:51.915261 [debug] [MainThread]: Using postgres connection "master"
[0m15:48:51.916259 [debug] [MainThread]: On master: COMMIT
[0m15:48:51.918219 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:48:51.919216 [debug] [MainThread]: On master: Close
[0m15:48:51.920217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:51.921649 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:48:51.922651 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_med_name.01052fa279' was properly closed.
[0m15:48:51.924681 [info ] [MainThread]: 
[0m15:48:51.926097 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m15:48:51.930431 [debug] [MainThread]: Command end result
[0m15:48:51.988279 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:48:51.994453 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:48:52.012707 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:48:52.014165 [info ] [MainThread]: 
[0m15:48:52.016739 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:52.019550 [info ] [MainThread]: 
[0m15:48:52.021814 [error] [MainThread]:   Database Error in test source_empty_string_raw_tables_med_name (models\raw_data.yml)
  syntax error at or near ")"
  LINE 10:         WHERE TRIM() = ''
                              ^
  compiled code at target\run\Propharma\models\raw_data.yml\source_empty_string_raw_tables_med_name.sql
[0m15:48:52.024322 [info ] [MainThread]: 
[0m15:48:52.026639 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:48:52.029869 [debug] [MainThread]: Command `dbt test` failed at 15:48:52.029869 after 7.53 seconds
[0m15:48:52.031603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED4FD9FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED50039510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED50039590>]}
[0m15:48:52.033603 [debug] [MainThread]: Flushing usage events
[0m15:48:53.556101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:50.135908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8D92710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8DD8E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8DF6F90>]}


============================== 15:49:50.145849 | 37ce5dae-8db1-45b3-ad6e-e7cbce7febee ==============================
[0m15:49:50.145849 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:49:50.147914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:49:50.580339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8DFD210>]}
[0m15:49:50.710100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B59F5F10>]}
[0m15:49:50.713092 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:49:51.549942 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:49:52.124056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:52.129305 [debug] [MainThread]: Partial parsing: updated file: Propharma://tests\generic\empty_string.sql
[0m15:49:53.706286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BA6B0850>]}
[0m15:49:53.925589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:49:53.936559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:49:54.013705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BA79AC90>]}
[0m15:49:54.016699 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 4 data tests, 6 sources, 435 macros
[0m15:49:54.018690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BA6A31D0>]}
[0m15:49:54.024704 [info ] [MainThread]: 
[0m15:49:54.026061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:54.028873 [info ] [MainThread]: 
[0m15:49:54.031343 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:49:54.044981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m15:49:54.420303 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:49:54.421300 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:49:54.422300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:54.665736 [debug] [ThreadPool]: SQL status: BEGIN in 0.244 seconds
[0m15:49:54.667995 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:49:54.669040 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:49:54.679534 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:49:54.682888 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:49:54.683896 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:49:54.685946 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m15:49:54.690443 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:49:54.692508 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:49:54.693950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:49:54.926180 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m15:49:54.927836 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:49:54.928872 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:49:54.939574 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:49:54.943046 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:49:54.944082 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:49:54.962491 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:54.964490 [debug] [MainThread]: On master: BEGIN
[0m15:49:54.965487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:55.288712 [debug] [MainThread]: SQL status: BEGIN in 0.323 seconds
[0m15:49:55.290767 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:55.291816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:49:55.334688 [debug] [MainThread]: SQL status: SELECT 11 in 0.041 seconds
[0m15:49:55.341634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37ce5dae-8db1-45b3-ad6e-e7cbce7febee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4BA2F9DD0>]}
[0m15:49:55.343629 [debug] [MainThread]: On master: ROLLBACK
[0m15:49:55.344626 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:55.345660 [debug] [MainThread]: On master: BEGIN
[0m15:49:55.347552 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:49:55.349551 [debug] [MainThread]: On master: COMMIT
[0m15:49:55.350548 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:55.351545 [debug] [MainThread]: On master: COMMIT
[0m15:49:55.352892 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:55.353894 [debug] [MainThread]: On master: Close
[0m15:49:55.364308 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:49:55.365349 [info ] [Thread-1 (]: 1 of 4 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:49:55.368133 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:49:55.369135 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:49:55.387902 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:49:55.392071 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:49:55.424945 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:49:55.429011 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:49:55.431004 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:49:55.432379 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:55.656867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m15:49:55.658896 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:49:55.659861 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m15:49:55.674055 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m15:49:55.686534 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:49:55.688529 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:49:55.691522 [info ] [Thread-1 (]: 1 of 4 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.32s]
[0m15:49:55.694795 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:49:55.695797 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:49:55.697790 [info ] [Thread-1 (]: 2 of 4 START test source_not_null_raw_tables_inv_medicine_id ................... [RUN]
[0m15:49:55.699785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8)
[0m15:49:55.701440 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:49:55.715729 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:49:55.719715 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:49:55.726014 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:49:55.730452 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:49:55.732453 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: BEGIN
[0m15:49:55.733450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:56.078336 [debug] [Thread-1 (]: SQL status: BEGIN in 0.345 seconds
[0m15:49:56.079855 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"
[0m15:49:56.080861 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."inventory"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:49:56.084847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:49:56.087748 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: ROLLBACK
[0m15:49:56.090015 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8: Close
[0m15:49:56.092042 [info ] [Thread-1 (]: 2 of 4 PASS source_not_null_raw_tables_inv_medicine_id ......................... [[32mPASS[0m in 0.39s]
[0m15:49:56.096031 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8
[0m15:49:56.098026 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:49:56.100020 [info ] [Thread-1 (]: 3 of 4 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:49:56.102027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_medicine_id.6e8998cac8, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:49:56.103547 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:49:56.111534 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:49:56.116223 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:49:56.124997 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:49:56.129099 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:49:56.130451 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:49:56.132151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:56.465593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.333 seconds
[0m15:49:56.466589 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:49:56.467587 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:49:56.471610 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:49:56.475566 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:49:56.476563 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:49:56.478559 [info ] [Thread-1 (]: 3 of 4 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.38s]
[0m15:49:56.481950 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:49:56.482956 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:49:56.484950 [info ] [Thread-1 (]: 4 of 4 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:49:56.486419 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:49:56.487723 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:49:56.497287 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:49:56.500282 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:49:56.506593 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:49:56.510581 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:49:56.511581 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:49:56.513575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:56.739875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m15:49:56.741559 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:49:56.742595 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:49:56.746572 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:49:56.750103 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:49:56.751141 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:49:56.753461 [info ] [Thread-1 (]: 4 of 4 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.27s]
[0m15:49:56.756462 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:49:56.759660 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:56.761599 [debug] [MainThread]: On master: BEGIN
[0m15:49:56.762632 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:49:56.991372 [debug] [MainThread]: SQL status: BEGIN in 0.229 seconds
[0m15:49:56.993317 [debug] [MainThread]: On master: COMMIT
[0m15:49:56.994276 [debug] [MainThread]: Using postgres connection "master"
[0m15:49:56.995308 [debug] [MainThread]: On master: COMMIT
[0m15:49:56.996303 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:49:56.997920 [debug] [MainThread]: On master: Close
[0m15:49:56.998926 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:57.000938 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m15:49:57.001940 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_med_name.01052fa279' was properly closed.
[0m15:49:57.002953 [info ] [MainThread]: 
[0m15:49:57.004826 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m15:49:57.008399 [debug] [MainThread]: Command end result
[0m15:49:57.070710 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:49:57.077053 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:49:57.095416 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:49:57.096725 [info ] [MainThread]: 
[0m15:49:57.098747 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:49:57.101386 [info ] [MainThread]: 
[0m15:49:57.103120 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:49:57.106118 [debug] [MainThread]: Command `dbt test` succeeded at 15:49:57.106118 after 7.23 seconds
[0m15:49:57.108314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8DFE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B8DFE990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4B80FFE10>]}
[0m15:49:57.109281 [debug] [MainThread]: Flushing usage events
[0m15:49:58.826249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:57:13.062187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154E7ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154E72CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154ED6810>]}


============================== 15:57:13.070263 | 737b629d-dfe5-496a-9730-16cfa63385f7 ==============================
[0m15:57:13.070263 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:57:13.073462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m15:57:13.529815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154FC6C90>]}
[0m15:57:13.645982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B151B65BD0>]}
[0m15:57:13.649976 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:57:14.535587 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:57:15.136078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:15.140580 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:57:16.880231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B15684F4D0>]}
[0m15:57:17.104817 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:57:17.117373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:57:17.206239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1564C4610>]}
[0m15:57:17.207237 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 8 data tests, 6 sources, 435 macros
[0m15:57:17.208711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1567707D0>]}
[0m15:57:17.213998 [info ] [MainThread]: 
[0m15:57:17.216282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:57:17.217293 [info ] [MainThread]: 
[0m15:57:17.221103 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:57:17.235234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:57:17.645311 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:57:17.646309 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:57:17.647309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:17.908075 [debug] [ThreadPool]: SQL status: BEGIN in 0.260 seconds
[0m15:57:17.909072 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:57:17.910070 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:57:17.922038 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:57:17.926027 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:57:17.927024 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:57:17.929027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:57:17.939392 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:57:17.940389 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:57:17.941897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:18.302456 [debug] [ThreadPool]: SQL status: BEGIN in 0.361 seconds
[0m15:57:18.303546 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:57:18.304547 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:57:18.315477 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:57:18.318512 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:57:18.320530 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:57:18.331440 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:18.333629 [debug] [MainThread]: On master: BEGIN
[0m15:57:18.334645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:18.681120 [debug] [MainThread]: SQL status: BEGIN in 0.346 seconds
[0m15:57:18.682159 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:18.683155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:57:18.726611 [debug] [MainThread]: SQL status: SELECT 11 in 0.042 seconds
[0m15:57:18.733055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737b629d-dfe5-496a-9730-16cfa63385f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B15626FC50>]}
[0m15:57:18.735114 [debug] [MainThread]: On master: ROLLBACK
[0m15:57:18.736234 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:18.737455 [debug] [MainThread]: On master: BEGIN
[0m15:57:18.739511 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:57:18.740507 [debug] [MainThread]: On master: COMMIT
[0m15:57:18.741505 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:18.743008 [debug] [MainThread]: On master: COMMIT
[0m15:57:18.744009 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:18.745368 [debug] [MainThread]: On master: Close
[0m15:57:18.754170 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:57:18.756415 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:57:18.758734 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:57:18.760821 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:57:18.778216 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:57:18.783436 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:57:18.817962 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:57:18.821959 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:57:18.823951 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:57:18.824980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:57:19.149888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.324 seconds
[0m15:57:19.150436 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:57:19.151477 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m15:57:19.156505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:57:19.164173 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:57:19.166166 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:57:19.167163 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.41s]
[0m15:57:19.170119 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:57:19.172386 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:57:19.173387 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m15:57:19.176918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m15:57:19.178917 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:57:19.194284 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:57:19.199456 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:57:19.207433 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:57:19.211423 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:57:19.212419 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m15:57:19.214693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:19.450600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.235 seconds
[0m15:57:19.451597 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:57:19.453591 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m15:57:19.457580 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:57:19.461054 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m15:57:19.462054 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m15:57:19.463840 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.29s]
[0m15:57:19.467925 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:57:19.469919 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:57:19.471993 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:57:19.474986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:57:19.477299 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:57:19.486697 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:57:19.490141 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:57:19.497612 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:57:19.503080 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:57:19.505421 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:57:19.507759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:19.747194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m15:57:19.748237 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:57:19.749278 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:57:19.753293 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:57:19.756496 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:57:19.758906 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:57:19.761030 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.29s]
[0m15:57:19.764022 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:57:19.766161 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:57:19.767346 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:57:19.769836 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:57:19.772177 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:57:19.782603 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:57:19.788601 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:57:19.794080 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:57:19.798410 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:57:19.800404 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:57:19.802398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:20.089191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.287 seconds
[0m15:57:20.090681 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:57:20.091688 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:57:20.096552 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:57:20.099666 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:57:20.101711 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:57:20.103089 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.33s]
[0m15:57:20.106207 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:57:20.108543 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a
[0m15:57:20.109549 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patients_id ................... [RUN]
[0m15:57:20.112041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a)
[0m15:57:20.113234 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a
[0m15:57:20.121398 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a"
[0m15:57:20.125869 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a
[0m15:57:20.133862 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a"
[0m15:57:20.140187 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a"
[0m15:57:20.142922 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a: BEGIN
[0m15:57:20.144435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:20.398517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.254 seconds
[0m15:57:20.399616 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a"
[0m15:57:20.400654 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patients_id
from "propharma"."public"."patients"
where patients_id is null



      
    ) dbt_internal_test
[0m15:57:20.403153 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patients_id" does not exist
LINE 13: select patients_id
                ^
HINT:  Perhaps you meant to reference the column "patients.patient_id".

[0m15:57:20.404187 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a: ROLLBACK
[0m15:57:20.405485 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a: Close
[0m15:57:20.425159 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_pat_patients_id (models\raw_data.yml)
  column "patients_id" does not exist
  LINE 13: select patients_id
                  ^
  HINT:  Perhaps you meant to reference the column "patients.patient_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pat_patients_id.sql
[0m15:57:20.426697 [error] [Thread-1 (]: 5 of 8 ERROR source_not_null_raw_tables_pat_patients_id ........................ [[31mERROR[0m in 0.32s]
[0m15:57:20.429690 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a
[0m15:57:20.430725 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af
[0m15:57:20.431890 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_pat_patients_id (models\raw_data.yml)
  column "patients_id" does not exist
  LINE 13: select patients_id
                  ^
  HINT:  Perhaps you meant to reference the column "patients.patient_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pat_patients_id.sql.
[0m15:57:20.432895 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescriptions_id .............. [RUN]
[0m15:57:20.436964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patients_id.40b3f8422a, now test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af)
[0m15:57:20.438958 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af
[0m15:57:20.448446 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af"
[0m15:57:20.453731 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af
[0m15:57:20.459850 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af"
[0m15:57:20.465058 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af"
[0m15:57:20.466054 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af: BEGIN
[0m15:57:20.468049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:20.800976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.333 seconds
[0m15:57:20.802100 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af"
[0m15:57:20.804119 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescriptions_id
from "propharma"."public"."prescriptions"
where prescriptions_id is null



      
    ) dbt_internal_test
[0m15:57:20.806136 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "prescriptions_id" does not exist
LINE 13: select prescriptions_id
                ^
HINT:  Perhaps you meant to reference the column "prescriptions.prescription_id".

[0m15:57:20.807145 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af: ROLLBACK
[0m15:57:20.809150 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af: Close
[0m15:57:20.818400 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_pre_prescriptions_id (models\raw_data.yml)
  column "prescriptions_id" does not exist
  LINE 13: select prescriptions_id
                  ^
  HINT:  Perhaps you meant to reference the column "prescriptions.prescription_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pre_prescriptions_id.sql
[0m15:57:20.819397 [error] [Thread-1 (]: 6 of 8 ERROR source_not_null_raw_tables_pre_prescriptions_id ................... [[31mERROR[0m in 0.38s]
[0m15:57:20.822390 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af
[0m15:57:20.823387 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:57:20.825386 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_pre_prescriptions_id (models\raw_data.yml)
  column "prescriptions_id" does not exist
  LINE 13: select prescriptions_id
                  ^
  HINT:  Perhaps you meant to reference the column "prescriptions.prescription_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pre_prescriptions_id.sql.
[0m15:57:20.827379 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sales_id ...................... [RUN]
[0m15:57:20.829619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescriptions_id.eca951d2af, now test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046)
[0m15:57:20.831632 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:57:20.841379 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:57:20.846885 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:57:20.856860 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:57:20.862772 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:57:20.864649 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: BEGIN
[0m15:57:20.867016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:21.122759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m15:57:21.124927 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:57:21.126105 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_id
from "propharma"."public"."sales"
where sales_id is null



      
    ) dbt_internal_test
[0m15:57:21.128559 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sales_id" does not exist
LINE 13: select sales_id
                ^
HINT:  Perhaps you meant to reference the column "sales.sale_id".

[0m15:57:21.129594 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: ROLLBACK
[0m15:57:21.131601 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: Close
[0m15:57:21.142839 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql
[0m15:57:21.144862 [error] [Thread-1 (]: 7 of 8 ERROR source_not_null_raw_tables_sal_sales_id ........................... [[31mERROR[0m in 0.31s]
[0m15:57:21.147012 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:57:21.148024 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e
[0m15:57:21.149419 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql.
[0m15:57:21.150425 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_suppliers_id .................. [RUN]
[0m15:57:21.154756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046, now test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e)
[0m15:57:21.155766 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e
[0m15:57:21.164200 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e"
[0m15:57:21.169912 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e
[0m15:57:21.179654 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e"
[0m15:57:21.185753 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e"
[0m15:57:21.187070 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e: BEGIN
[0m15:57:21.189119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:21.427349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.238 seconds
[0m15:57:21.428355 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e"
[0m15:57:21.430387 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select suppliers_id
from "propharma"."public"."suppliers"
where suppliers_id is null



      
    ) dbt_internal_test
[0m15:57:21.432432 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "suppliers_id" does not exist
LINE 13: select suppliers_id
                ^
HINT:  Perhaps you meant to reference the column "suppliers.supplier_id".

[0m15:57:21.433520 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e: ROLLBACK
[0m15:57:21.435533 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e: Close
[0m15:57:21.442745 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_sup_suppliers_id (models\raw_data.yml)
  column "suppliers_id" does not exist
  LINE 13: select suppliers_id
                  ^
  HINT:  Perhaps you meant to reference the column "suppliers.supplier_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sup_suppliers_id.sql
[0m15:57:21.444755 [error] [Thread-1 (]: 8 of 8 ERROR source_not_null_raw_tables_sup_suppliers_id ....................... [[31mERROR[0m in 0.29s]
[0m15:57:21.447543 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e
[0m15:57:21.449713 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_sup_suppliers_id (models\raw_data.yml)
  column "suppliers_id" does not exist
  LINE 13: select suppliers_id
                  ^
  HINT:  Perhaps you meant to reference the column "suppliers.supplier_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sup_suppliers_id.sql.
[0m15:57:21.453268 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:21.454289 [debug] [MainThread]: On master: BEGIN
[0m15:57:21.455299 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:57:21.690837 [debug] [MainThread]: SQL status: BEGIN in 0.236 seconds
[0m15:57:21.692848 [debug] [MainThread]: On master: COMMIT
[0m15:57:21.693851 [debug] [MainThread]: Using postgres connection "master"
[0m15:57:21.694995 [debug] [MainThread]: On master: COMMIT
[0m15:57:21.696004 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:57:21.698016 [debug] [MainThread]: On master: Close
[0m15:57:21.699020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:57:21.700047 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:57:21.702184 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_suppliers_id.b3f703712e' was properly closed.
[0m15:57:21.703628 [info ] [MainThread]: 
[0m15:57:21.704637 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m15:57:21.709960 [debug] [MainThread]: Command end result
[0m15:57:21.777428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:57:21.785218 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:57:21.802839 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:57:21.804835 [info ] [MainThread]: 
[0m15:57:21.807187 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m15:57:21.809246 [info ] [MainThread]: 
[0m15:57:21.810525 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_pat_patients_id (models\raw_data.yml)
  column "patients_id" does not exist
  LINE 13: select patients_id
                  ^
  HINT:  Perhaps you meant to reference the column "patients.patient_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pat_patients_id.sql
[0m15:57:21.814711 [info ] [MainThread]: 
[0m15:57:21.815716 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_pre_prescriptions_id (models\raw_data.yml)
  column "prescriptions_id" does not exist
  LINE 13: select prescriptions_id
                  ^
  HINT:  Perhaps you meant to reference the column "prescriptions.prescription_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_pre_prescriptions_id.sql
[0m15:57:21.819771 [info ] [MainThread]: 
[0m15:57:21.820922 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql
[0m15:57:21.823468 [info ] [MainThread]: 
[0m15:57:21.826182 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_sup_suppliers_id (models\raw_data.yml)
  column "suppliers_id" does not exist
  LINE 13: select suppliers_id
                  ^
  HINT:  Perhaps you meant to reference the column "suppliers.supplier_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sup_suppliers_id.sql
[0m15:57:21.829183 [info ] [MainThread]: 
[0m15:57:21.831178 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=4 SKIP=0 TOTAL=8
[0m15:57:21.835295 [debug] [MainThread]: Command `dbt test` failed at 15:57:21.835295 after 9.05 seconds
[0m15:57:21.837616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B14E60FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154EDEA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B154EDEDD0>]}
[0m15:57:21.838625 [debug] [MainThread]: Flushing usage events
[0m15:57:23.297329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:17.998531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1442DED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1442DC690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1442DC390>]}


============================== 15:59:18.007118 | a1335d7f-a279-4dcf-b33b-0b3972f7ad1c ==============================
[0m15:59:18.007118 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:59:18.009657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:18.490081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D1444D6390>]}
[0m15:59:18.612049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D140F58110>]}
[0m15:59:18.616048 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:59:19.553391 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:59:20.289982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:20.293398 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:59:21.961094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D145CD7E50>]}
[0m15:59:22.200201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:59:22.212722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:59:22.307550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D145944A10>]}
[0m15:59:22.309253 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 8 data tests, 6 sources, 435 macros
[0m15:59:22.311826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D145CD7850>]}
[0m15:59:22.316517 [info ] [MainThread]: 
[0m15:59:22.318483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:22.320477 [info ] [MainThread]: 
[0m15:59:22.322469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:22.336088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m15:59:22.853166 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:59:22.855166 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:59:22.856170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:23.252872 [debug] [ThreadPool]: SQL status: BEGIN in 0.397 seconds
[0m15:59:23.253868 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:59:23.254865 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:59:23.266716 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:59:23.269800 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:59:23.272033 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:59:23.274340 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m15:59:23.283886 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:59:23.285881 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:59:23.286878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:23.626336 [debug] [ThreadPool]: SQL status: BEGIN in 0.340 seconds
[0m15:59:23.628580 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:59:23.630775 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:59:23.642321 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m15:59:23.645382 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:59:23.647382 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:59:23.658980 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:23.660231 [debug] [MainThread]: On master: BEGIN
[0m15:59:23.661536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:23.904160 [debug] [MainThread]: SQL status: BEGIN in 0.243 seconds
[0m15:59:23.905182 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:23.907277 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:23.962849 [debug] [MainThread]: SQL status: SELECT 11 in 0.055 seconds
[0m15:59:23.970293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1335d7f-a279-4dcf-b33b-0b3972f7ad1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D145CF38D0>]}
[0m15:59:23.971311 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:23.972725 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:23.974743 [debug] [MainThread]: On master: BEGIN
[0m15:59:23.976794 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:59:23.977792 [debug] [MainThread]: On master: COMMIT
[0m15:59:23.979028 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:23.981207 [debug] [MainThread]: On master: COMMIT
[0m15:59:23.982204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:23.984250 [debug] [MainThread]: On master: Close
[0m15:59:23.995678 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:23.997894 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:59:24.000289 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:59:24.003592 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:24.021263 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:24.025942 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:24.064416 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:24.069797 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:24.071792 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:59:24.073061 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:24.426647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.352 seconds
[0m15:59:24.427651 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:24.430061 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m15:59:24.434768 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:24.444106 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:59:24.445111 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:59:24.447817 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.45s]
[0m15:59:24.451027 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:24.453026 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:24.454023 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m15:59:24.456446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m15:59:24.457448 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:24.472895 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:24.476534 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:24.488338 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:24.493751 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:24.495746 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m15:59:24.498008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:24.754511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m15:59:24.756024 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:24.758545 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m15:59:24.763068 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:24.766064 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m15:59:24.768062 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m15:59:24.770058 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.31s]
[0m15:59:24.771794 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:24.774299 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:24.776812 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:59:24.779585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:59:24.780592 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:24.790794 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:24.794524 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:24.802280 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:24.806500 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:24.808491 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:59:24.810486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:25.167037 [debug] [Thread-1 (]: SQL status: BEGIN in 0.357 seconds
[0m15:59:25.168346 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:25.169473 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:59:25.174563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:25.177554 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:59:25.178552 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:59:25.182108 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.40s]
[0m15:59:25.185116 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:25.186292 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:25.188881 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:59:25.190547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:59:25.192222 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:25.200494 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:25.206628 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:25.214200 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:25.219787 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:25.221933 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:59:25.223161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:25.508885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.286 seconds
[0m15:59:25.510062 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:25.512099 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:59:25.515990 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:25.519979 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:59:25.520976 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:59:25.523349 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.33s]
[0m15:59:25.526822 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:25.529191 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:25.530281 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patient_id .................... [RUN]
[0m15:59:25.533844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m15:59:25.535846 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:25.547772 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:25.553270 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:25.562626 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:25.567938 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:25.569982 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: BEGIN
[0m15:59:25.572339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:25.833872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.262 seconds
[0m15:59:25.834878 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:25.836872 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "propharma"."public"."patients"
where patient_id is null



      
    ) dbt_internal_test
[0m15:59:25.841400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:25.845389 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: ROLLBACK
[0m15:59:25.847384 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: Close
[0m15:59:25.848381 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_raw_tables_pat_patient_id .......................... [[32mPASS[0m in 0.32s]
[0m15:59:25.852111 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:25.853689 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:25.854870 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescription_id ............... [RUN]
[0m15:59:25.858237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m15:59:25.860030 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:25.869911 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:25.874866 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:25.882839 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:25.886846 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:25.889148 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: BEGIN
[0m15:59:25.891410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:26.243837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.352 seconds
[0m15:59:26.244859 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:26.245870 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescription_id
from "propharma"."public"."prescriptions"
where prescription_id is null



      
    ) dbt_internal_test
[0m15:59:26.251260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:26.255491 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: ROLLBACK
[0m15:59:26.256489 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: Close
[0m15:59:26.257926 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_raw_tables_pre_prescription_id ..................... [[32mPASS[0m in 0.40s]
[0m15:59:26.262342 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:26.263349 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:59:26.264478 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sales_id ...................... [RUN]
[0m15:59:26.265872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046)
[0m15:59:26.268429 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:59:26.278634 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:59:26.283759 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:59:26.291799 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:59:26.297263 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:59:26.299271 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: BEGIN
[0m15:59:26.301285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:26.551948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.251 seconds
[0m15:59:26.552956 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"
[0m15:59:26.553964 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sales_id
from "propharma"."public"."sales"
where sales_id is null



      
    ) dbt_internal_test
[0m15:59:26.556975 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sales_id" does not exist
LINE 13: select sales_id
                ^
HINT:  Perhaps you meant to reference the column "sales.sale_id".

[0m15:59:26.558968 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: ROLLBACK
[0m15:59:26.559967 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046: Close
[0m15:59:26.575072 [debug] [Thread-1 (]: Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql
[0m15:59:26.577307 [error] [Thread-1 (]: 7 of 8 ERROR source_not_null_raw_tables_sal_sales_id ........................... [[31mERROR[0m in 0.31s]
[0m15:59:26.579308 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046
[0m15:59:26.580558 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:26.581563 [debug] [Thread-4 (]: Marking all children of 'test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046' to be skipped because of status 'error'.  Reason: Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql.
[0m15:59:26.582910 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_supplier_id ................... [RUN]
[0m15:59:26.586803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sales_id.da574e3046, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m15:59:26.588971 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:26.602792 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:26.608018 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:26.613414 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:26.618419 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:26.620654 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: BEGIN
[0m15:59:26.621912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:26.861905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m15:59:26.862911 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:26.864905 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from "propharma"."public"."suppliers"
where supplier_id is null



      
    ) dbt_internal_test
[0m15:59:26.868976 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:26.872007 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: ROLLBACK
[0m15:59:26.874026 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: Close
[0m15:59:26.876044 [info ] [Thread-1 (]: 8 of 8 PASS source_not_null_raw_tables_sup_supplier_id ......................... [[32mPASS[0m in 0.29s]
[0m15:59:26.879432 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:26.881450 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:26.884401 [debug] [MainThread]: On master: BEGIN
[0m15:59:26.886401 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:27.136539 [debug] [MainThread]: SQL status: BEGIN in 0.250 seconds
[0m15:59:27.138590 [debug] [MainThread]: On master: COMMIT
[0m15:59:27.139924 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:27.141504 [debug] [MainThread]: On master: COMMIT
[0m15:59:27.143504 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:27.144777 [debug] [MainThread]: On master: Close
[0m15:59:27.145778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:27.147775 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m15:59:27.149063 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd' was properly closed.
[0m15:59:27.150882 [info ] [MainThread]: 
[0m15:59:27.152816 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m15:59:27.157696 [debug] [MainThread]: Command end result
[0m15:59:27.223839 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:59:27.231361 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:59:27.249238 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:59:27.250235 [info ] [MainThread]: 
[0m15:59:27.252396 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:59:27.254443 [info ] [MainThread]: 
[0m15:59:27.256440 [error] [MainThread]:   Database Error in test source_not_null_raw_tables_sal_sales_id (models\raw_data.yml)
  column "sales_id" does not exist
  LINE 13: select sales_id
                  ^
  HINT:  Perhaps you meant to reference the column "sales.sale_id".
  compiled code at target\run\Propharma\models\raw_data.yml\source_not_null_raw_tables_sal_sales_id.sql
[0m15:59:27.260401 [info ] [MainThread]: 
[0m15:59:27.261868 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m15:59:27.267023 [debug] [MainThread]: Command `dbt test` failed at 15:59:27.266019 after 9.55 seconds
[0m15:59:27.268361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D13D9EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14433C690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D14433E3D0>]}
[0m15:59:27.270564 [debug] [MainThread]: Flushing usage events
[0m15:59:28.844571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:59:46.033662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CED3275D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CED30BBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CED3084D0>]}


============================== 15:59:46.042159 | f4ce7b09-bc16-43ed-8a8d-57fff31e8418 ==============================
[0m15:59:46.042159 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:59:46.045382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:59:46.653311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CED32D210>]}
[0m15:59:46.799857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE9F25E90>]}
[0m15:59:46.802849 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:59:47.736052 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:59:48.439739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:48.444871 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\raw_data.yml
[0m15:59:50.135282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CEECC6750>]}
[0m15:59:50.410123 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:59:50.423405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:59:50.532033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CEE9308D0>]}
[0m15:59:50.534202 [info ] [MainThread]: Found 1 seed, 11 models, 1 snapshot, 8 data tests, 6 sources, 435 macros
[0m15:59:50.536219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CEECE8610>]}
[0m15:59:50.542604 [info ] [MainThread]: 
[0m15:59:50.545598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:59:50.547592 [info ] [MainThread]: 
[0m15:59:50.551385 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:50.574268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m15:59:51.232246 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:59:51.234246 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m15:59:51.236240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:51.563785 [debug] [ThreadPool]: SQL status: BEGIN in 0.327 seconds
[0m15:59:51.565780 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m15:59:51.566776 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m15:59:51.584948 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.015 seconds
[0m15:59:51.588944 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m15:59:51.590938 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m15:59:51.594137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m15:59:51.603112 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:59:51.605107 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m15:59:51.606616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:59:51.875462 [debug] [ThreadPool]: SQL status: BEGIN in 0.270 seconds
[0m15:59:51.877460 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m15:59:51.878457 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:59:51.889465 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m15:59:51.892499 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m15:59:51.894463 [debug] [ThreadPool]: On list_propharma_public: Close
[0m15:59:51.910033 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:51.911030 [debug] [MainThread]: On master: BEGIN
[0m15:59:51.912993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:59:52.238522 [debug] [MainThread]: SQL status: BEGIN in 0.326 seconds
[0m15:59:52.240525 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:52.242554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:59:52.293902 [debug] [MainThread]: SQL status: SELECT 11 in 0.049 seconds
[0m15:59:52.301897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ce7b09-bc16-43ed-8a8d-57fff31e8418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CEEFEBFD0>]}
[0m15:59:52.305359 [debug] [MainThread]: On master: ROLLBACK
[0m15:59:52.307859 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:52.308861 [debug] [MainThread]: On master: BEGIN
[0m15:59:52.311852 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:59:52.312850 [debug] [MainThread]: On master: COMMIT
[0m15:59:52.314845 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:52.316840 [debug] [MainThread]: On master: COMMIT
[0m15:59:52.318834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:52.320835 [debug] [MainThread]: On master: Close
[0m15:59:52.331034 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:52.333486 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m15:59:52.335530 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m15:59:52.336534 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:52.355748 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:52.358739 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:52.399628 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:52.403663 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:52.405141 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m15:59:52.408300 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:52.686267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.279 seconds
[0m15:59:52.688396 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m15:59:52.689399 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m15:59:52.694611 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:52.702736 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m15:59:52.703734 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m15:59:52.705729 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.37s]
[0m15:59:52.709238 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m15:59:52.711233 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:52.712506 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m15:59:52.715850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m15:59:52.717828 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:52.733519 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:52.737771 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:52.747852 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:52.754005 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:52.756009 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m15:59:52.758704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:53.156127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.398 seconds
[0m15:59:53.158121 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m15:59:53.159200 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m15:59:53.163694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:53.169247 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m15:59:53.171484 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m15:59:53.173169 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.46s]
[0m15:59:53.176789 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m15:59:53.177795 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:53.180008 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m15:59:53.182484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m15:59:53.183715 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:53.196242 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:53.200744 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:53.207560 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:53.212922 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:53.213933 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m15:59:53.215919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:53.567640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.351 seconds
[0m15:59:53.569640 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m15:59:53.570637 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m15:59:53.575672 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:53.581024 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m15:59:53.583747 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m15:59:53.586036 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.40s]
[0m15:59:53.589104 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m15:59:53.591098 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:53.593454 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m15:59:53.596324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m15:59:53.598833 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:53.608572 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:53.611648 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:53.616841 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:53.621183 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:53.623181 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m15:59:53.625287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:53.876445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.251 seconds
[0m15:59:53.878438 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m15:59:53.880434 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m15:59:53.885574 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:53.888921 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m15:59:53.890947 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m15:59:53.892965 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.30s]
[0m15:59:53.895824 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m15:59:53.898070 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:53.900065 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patient_id .................... [RUN]
[0m15:59:53.902238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m15:59:53.904265 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:53.912591 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:53.915621 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:53.922135 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:53.928117 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:53.930426 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: BEGIN
[0m15:59:53.932443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:54.183553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.252 seconds
[0m15:59:54.185636 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m15:59:54.186680 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "propharma"."public"."patients"
where patient_id is null



      
    ) dbt_internal_test
[0m15:59:54.191332 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:54.194463 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: ROLLBACK
[0m15:59:54.196513 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: Close
[0m15:59:54.197630 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_raw_tables_pat_patient_id .......................... [[32mPASS[0m in 0.30s]
[0m15:59:54.201645 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m15:59:54.202641 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:54.203639 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescription_id ............... [RUN]
[0m15:59:54.206000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m15:59:54.207995 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:54.219345 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:54.222692 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:54.229092 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:54.234457 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:54.236541 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: BEGIN
[0m15:59:54.237552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:54.495025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m15:59:54.496316 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m15:59:54.498315 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescription_id
from "propharma"."public"."prescriptions"
where prescription_id is null



      
    ) dbt_internal_test
[0m15:59:54.503579 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:54.506577 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: ROLLBACK
[0m15:59:54.508084 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: Close
[0m15:59:54.510084 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_raw_tables_pre_prescription_id ..................... [[32mPASS[0m in 0.30s]
[0m15:59:54.513076 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m15:59:54.514328 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m15:59:54.516327 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sale_id ....................... [RUN]
[0m15:59:54.518323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m15:59:54.519320 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m15:59:54.529660 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m15:59:54.537181 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m15:59:54.545975 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m15:59:54.550961 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m15:59:54.552956 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: BEGIN
[0m15:59:54.553953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:54.787856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m15:59:54.789051 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m15:59:54.790076 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "propharma"."public"."sales"
where sale_id is null



      
    ) dbt_internal_test
[0m15:59:54.795352 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:54.798312 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: ROLLBACK
[0m15:59:54.800304 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: Close
[0m15:59:54.802299 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_raw_tables_sal_sale_id ............................. [[32mPASS[0m in 0.28s]
[0m15:59:54.805387 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m15:59:54.806696 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:54.808697 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_supplier_id ................... [RUN]
[0m15:59:54.811698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m15:59:54.812693 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:54.826028 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:54.830018 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:54.835758 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:54.839754 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:54.841754 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: BEGIN
[0m15:59:54.843039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:59:55.178405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.335 seconds
[0m15:59:55.180399 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m15:59:55.181397 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from "propharma"."public"."suppliers"
where supplier_id is null



      
    ) dbt_internal_test
[0m15:59:55.185386 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:59:55.188378 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: ROLLBACK
[0m15:59:55.190373 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: Close
[0m15:59:55.192650 [info ] [Thread-1 (]: 8 of 8 PASS source_not_null_raw_tables_sup_supplier_id ......................... [[32mPASS[0m in 0.38s]
[0m15:59:55.194900 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m15:59:55.198353 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:55.200606 [debug] [MainThread]: On master: BEGIN
[0m15:59:55.201601 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:59:55.564171 [debug] [MainThread]: SQL status: BEGIN in 0.362 seconds
[0m15:59:55.565168 [debug] [MainThread]: On master: COMMIT
[0m15:59:55.566164 [debug] [MainThread]: Using postgres connection "master"
[0m15:59:55.567163 [debug] [MainThread]: On master: COMMIT
[0m15:59:55.569160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:59:55.570196 [debug] [MainThread]: On master: Close
[0m15:59:55.572324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:55.573326 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m15:59:55.574324 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd' was properly closed.
[0m15:59:55.575321 [info ] [MainThread]: 
[0m15:59:55.578246 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m15:59:55.585100 [debug] [MainThread]: Command end result
[0m15:59:55.646031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m15:59:55.653316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m15:59:55.676098 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m15:59:55.678093 [info ] [MainThread]: 
[0m15:59:55.680088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:55.682082 [info ] [MainThread]: 
[0m15:59:55.684077 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m15:59:55.688066 [debug] [MainThread]: Command `dbt test` succeeded at 15:59:55.687070 after 9.94 seconds
[0m15:59:55.689063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CECDE7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE69AFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024CE69AF390>]}
[0m15:59:55.690726 [debug] [MainThread]: Flushing usage events
[0m15:59:57.214258 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:42.710508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025731557050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257314F2CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025731534A90>]}


============================== 16:31:42.718492 | 2ad29b3c-7ef0-4249-8a5b-c9cadad892bf ==============================
[0m16:31:42.718492 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:31:42.720489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:43.169186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025731678150>]}
[0m16:31:43.302954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002572E187A90>]}
[0m16:31:43.307907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:44.246686 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:31:44.914994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 11 files changed.
[0m16:31:44.915991 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_expired_drugs.sql
[0m16:31:44.917876 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_inventory.sql
[0m16:31:44.920084 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_inventory_status.sql
[0m16:31:44.921080 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_invoice.sql
[0m16:31:44.924242 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_prescriptions.sql
[0m16:31:44.926246 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_top_customers.sql
[0m16:31:44.928240 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_patients.sql
[0m16:31:44.930701 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_medicines.sql
[0m16:31:44.933701 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_sales.sql
[0m16:31:44.935695 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\staging\stg_suppliers.sql
[0m16:31:44.937690 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_sales_summary.sql
[0m16:31:45.768980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025732B57FD0>]}
[0m16:31:46.024875 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:31:46.040320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:31:46.117393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025732BAD2D0>]}
[0m16:31:46.120104 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m16:31:46.122224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257329C56D0>]}
[0m16:31:46.130443 [info ] [MainThread]: 
[0m16:31:46.132251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:31:46.134265 [info ] [MainThread]: 
[0m16:31:46.137367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:46.153077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m16:31:46.634214 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m16:31:46.635616 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m16:31:46.636619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:47.028543 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.392 seconds
[0m16:31:47.031498 [debug] [ThreadPool]: On list_propharma: Close
[0m16:31:47.035583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m16:31:47.047536 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:31:47.049498 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m16:31:47.050536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:47.282738 [debug] [ThreadPool]: SQL status: BEGIN in 0.232 seconds
[0m16:31:47.283743 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:31:47.285252 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:31:47.297383 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m16:31:47.301373 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m16:31:47.302371 [debug] [ThreadPool]: On list_propharma_public: Close
[0m16:31:47.304859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m16:31:47.319753 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:31:47.321824 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m16:31:47.323467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:47.557072 [debug] [ThreadPool]: SQL status: BEGIN in 0.234 seconds
[0m16:31:47.558549 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:31:47.559585 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:31:47.570595 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m16:31:47.573587 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m16:31:47.574609 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m16:31:47.651114 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:47.652115 [debug] [MainThread]: On master: BEGIN
[0m16:31:47.654091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:47.893296 [debug] [MainThread]: SQL status: BEGIN in 0.240 seconds
[0m16:31:47.895317 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:47.897171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:47.942266 [debug] [MainThread]: SQL status: SELECT 11 in 0.043 seconds
[0m16:31:47.949689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257330FCD10>]}
[0m16:31:47.950733 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:47.951773 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:47.953822 [debug] [MainThread]: On master: BEGIN
[0m16:31:47.954829 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:31:47.955840 [debug] [MainThread]: On master: COMMIT
[0m16:31:47.957862 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:47.958873 [debug] [MainThread]: On master: COMMIT
[0m16:31:47.959881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:47.960921 [debug] [MainThread]: On master: Close
[0m16:31:47.971264 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m16:31:47.972265 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_inventory .............................. [RUN]
[0m16:31:47.974772 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m16:31:47.975775 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m16:31:47.991241 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m16:31:47.996039 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m16:31:48.072714 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m16:31:48.077056 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.078718 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m16:31:48.079720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:48.335560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m16:31:48.336760 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.338759 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m16:31:48.350961 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m16:31:48.364019 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.365474 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m16:31:48.368781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:48.374834 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.376846 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m16:31:48.378858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:48.411942 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m16:31:48.413954 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.414959 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m16:31:48.421044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:31:48.436237 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m16:31:48.450680 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m16:31:48.452770 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop table if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m16:31:48.462312 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:31:48.468439 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m16:31:48.475055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025732AFF410>]}
[0m16:31:48.477049 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.50s]
[0m16:31:48.480517 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m16:31:48.481526 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m16:31:48.483548 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_medicines .............................. [RUN]
[0m16:31:48.486102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m16:31:48.488344 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m16:31:48.497828 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m16:31:48.502952 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m16:31:48.520188 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m16:31:48.525310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.527474 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m16:31:48.529673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:48.778036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.249 seconds
[0m16:31:48.780157 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.781155 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m16:31:48.791647 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:31:48.797628 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.799625 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m16:31:48.802817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:48.809064 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.811061 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m16:31:48.812531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:48.816950 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m16:31:48.818027 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.820026 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m16:31:48.829752 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:31:48.835327 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m16:31:48.836326 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m16:31:48.838288 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop table if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m16:31:48.845342 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m16:31:48.848577 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m16:31:48.850572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025731750650>]}
[0m16:31:48.852567 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.36s]
[0m16:31:48.854518 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m16:31:48.856352 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m16:31:48.857889 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_patients ............................... [RUN]
[0m16:31:48.860620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m16:31:48.861877 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m16:31:48.869223 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m16:31:48.874280 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m16:31:48.882398 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m16:31:48.885429 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:48.887973 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m16:31:48.889013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:49.122568 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m16:31:49.124585 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:49.125582 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m16:31:49.136210 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m16:31:49.143683 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:49.145677 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m16:31:49.147931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.154642 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:49.156744 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m16:31:49.157739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.161989 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m16:31:49.162986 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:49.163984 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m16:31:49.173891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:31:49.180328 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m16:31:49.181325 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m16:31:49.182990 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop table if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m16:31:49.192632 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:31:49.195622 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m16:31:49.198762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025731647C50>]}
[0m16:31:49.201207 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m16:31:49.205678 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m16:31:49.207701 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m16:31:49.209704 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_prescriptions .......................... [RUN]
[0m16:31:49.212011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m16:31:49.213011 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m16:31:49.221482 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m16:31:49.226419 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m16:31:49.239642 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m16:31:49.245159 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.247233 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m16:31:49.249605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:49.478691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m16:31:49.479731 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.480689 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m16:31:49.490439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:31:49.496422 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.498415 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m16:31:49.499414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.509580 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.510576 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m16:31:49.512814 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.516316 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m16:31:49.518311 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.519307 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m16:31:49.529344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:31:49.535440 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m16:31:49.537432 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m16:31:49.538429 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop table if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m16:31:49.545410 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:31:49.548404 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m16:31:49.550397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573121F890>]}
[0m16:31:49.552393 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.34s]
[0m16:31:49.556015 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m16:31:49.557031 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m16:31:49.558036 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m16:31:49.561199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m16:31:49.563277 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m16:31:49.571492 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m16:31:49.575642 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m16:31:49.584984 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m16:31:49.589949 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.591703 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m16:31:49.593703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:49.850219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m16:31:49.852213 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.854208 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m16:31:49.865177 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m16:31:49.871161 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.873160 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m16:31:49.874157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.881138 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.882135 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m16:31:49.884131 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:49.887637 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m16:31:49.888634 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.889632 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m16:31:49.900155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:31:49.905145 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m16:31:49.907141 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m16:31:49.908138 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop table if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m16:31:49.916116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m16:31:49.919109 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m16:31:49.921104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573163BE90>]}
[0m16:31:49.923099 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.36s]
[0m16:31:49.926431 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m16:31:49.928488 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m16:31:49.929536 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_suppliers .............................. [RUN]
[0m16:31:49.931579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m16:31:49.933830 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m16:31:49.942760 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m16:31:49.947006 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m16:31:49.956466 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m16:31:49.960723 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:49.961736 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m16:31:49.962913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:50.211285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.248 seconds
[0m16:31:50.213368 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:50.214381 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m16:31:50.222718 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:31:50.229182 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:50.230227 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m16:31:50.232310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:50.239664 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:50.240700 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m16:31:50.241707 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:50.244964 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m16:31:50.246006 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:50.247015 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m16:31:50.257631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:31:50.265302 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m16:31:50.267703 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m16:31:50.268736 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop table if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m16:31:50.275430 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m16:31:50.278248 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m16:31:50.280641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002572ECFB9D0>]}
[0m16:31:50.283028 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m16:31:50.286056 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m16:31:50.287053 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m16:31:50.289124 [info ] [Thread-1 (]: 7 of 11 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m16:31:50.291343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m16:31:50.293199 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m16:31:50.303515 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m16:31:50.307509 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m16:31:50.387171 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m16:31:50.391438 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m16:31:50.393428 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m16:31:50.394425 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:50.671620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.277 seconds
[0m16:31:50.672870 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m16:31:50.673874 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
  
    

  create  table "propharma"."public"."mart_expired_drugs"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m16:31:50.689532 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.013 seconds
[0m16:31:50.698586 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m16:31:50.700598 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m16:31:50.701604 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m16:31:50.708181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:31:50.710196 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m16:31:50.712214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025732ADDA10>]}
[0m16:31:50.714238 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model public.mart_expired_drugs ............. [[32mSELECT 10[0m in 0.42s]
[0m16:31:50.717278 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m16:31:50.720270 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m16:31:50.722265 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m16:31:50.725736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m16:31:50.727749 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m16:31:50.737305 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m16:31:50.740393 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m16:31:50.748965 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m16:31:50.754270 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m16:31:50.755266 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m16:31:50.757260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:51.001642 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m16:31:51.002643 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m16:31:51.003641 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
  
    

  create  table "propharma"."public"."mart_inventory_status"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m16:31:51.022318 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.017 seconds
[0m16:31:51.026281 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m16:31:51.027278 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m16:31:51.029472 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m16:31:51.039409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:31:51.041400 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m16:31:51.043394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257328D62D0>]}
[0m16:31:51.046386 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.mart_inventory_status .......... [[32mSELECT 10[0m in 0.32s]
[0m16:31:51.050087 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m16:31:51.052086 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m16:31:51.054084 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public.mart_invoice ........................ [RUN]
[0m16:31:51.056076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m16:31:51.058514 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m16:31:51.071582 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m16:31:51.076868 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m16:31:51.107679 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m16:31:51.114346 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m16:31:51.117339 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m16:31:51.119334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:51.450301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.331 seconds
[0m16:31:51.451298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m16:31:51.452298 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
  
    

  create  table "propharma"."public"."mart_invoice"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
  );
  
  
[0m16:31:51.483830 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.030 seconds
[0m16:31:51.488290 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m16:31:51.490289 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m16:31:51.493281 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m16:31:51.496274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m16:31:51.499266 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m16:31:51.501425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025732BE5A50>]}
[0m16:31:51.504670 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public.mart_invoice ................... [[32mSELECT 10[0m in 0.45s]
[0m16:31:51.507788 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m16:31:51.509789 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m16:31:51.511914 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m16:31:51.515184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now model.Propharma.mart_sales_summary)
[0m16:31:51.517185 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m16:31:51.527895 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m16:31:51.531960 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m16:31:51.547609 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m16:31:51.551791 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m16:31:51.554248 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m16:31:51.555261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:51.955100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.400 seconds
[0m16:31:51.956121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m16:31:51.958325 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      
  
    

  create  table "propharma"."public"."mart_sales_summary"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
  
  
[0m16:31:51.975363 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.015 seconds
[0m16:31:51.978659 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m16:31:51.979881 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m16:31:51.981210 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m16:31:51.991967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m16:31:51.993980 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m16:31:51.994989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573317DED0>]}
[0m16:31:51.997340 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public.mart_sales_summary ............ [[32mSELECT 10[0m in 0.48s]
[0m16:31:51.999780 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m16:31:52.001796 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m16:31:52.002802 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public.mart_top_customers ................. [RUN]
[0m16:31:52.004815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m16:31:52.006028 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m16:31:52.014731 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m16:31:52.019452 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m16:31:52.032432 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m16:31:52.036871 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m16:31:52.038468 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m16:31:52.039508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:52.283087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.243 seconds
[0m16:31:52.284049 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m16:31:52.286044 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
  
    

  create  table "propharma"."public"."mart_top_customers"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m16:31:52.300391 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.014 seconds
[0m16:31:52.304388 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m16:31:52.305385 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m16:31:52.306383 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m16:31:52.316703 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:31:52.318702 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m16:31:52.320697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ad29b3c-7ef0-4249-8a5b-c9cadad892bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002573317FE10>]}
[0m16:31:52.321694 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public.mart_top_customers ............ [[32mSELECT 10[0m in 0.31s]
[0m16:31:52.325250 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m16:31:52.327901 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:52.328973 [debug] [MainThread]: On master: BEGIN
[0m16:31:52.330557 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:52.683296 [debug] [MainThread]: SQL status: BEGIN in 0.353 seconds
[0m16:31:52.684311 [debug] [MainThread]: On master: COMMIT
[0m16:31:52.685320 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:52.686330 [debug] [MainThread]: On master: COMMIT
[0m16:31:52.689875 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:31:52.690887 [debug] [MainThread]: On master: Close
[0m16:31:52.692906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:52.693932 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m16:31:52.696249 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m16:31:52.698407 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m16:31:52.699429 [info ] [MainThread]: 
[0m16:31:52.700435 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m16:31:52.708714 [debug] [MainThread]: Command end result
[0m16:31:52.785841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:31:52.793407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:31:52.809159 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m16:31:52.810159 [info ] [MainThread]: 
[0m16:31:52.812468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:52.814721 [info ] [MainThread]: 
[0m16:31:52.816911 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:31:52.819545 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:52.819545 after 10.37 seconds
[0m16:31:52.821548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002572AEC9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257316FADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000257310844D0>]}
[0m16:31:52.822543 [debug] [MainThread]: Flushing usage events
[0m16:31:54.326397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:02.923484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202F496F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202F092650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202F092B90>]}


============================== 16:32:02.932460 | c0a5dd0c-be18-48cf-8b64-f0f2aca55dab ==============================
[0m16:32:02.932460 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:32:02.934749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:03.385753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202F49D210>]}
[0m16:32:03.499805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202C0E7E10>]}
[0m16:32:03.502834 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:32:04.355563 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:32:04.896199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:04.897229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:05.092977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002202F5CE050>]}
[0m16:32:05.369272 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:32:05.384158 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:32:05.473428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022030BFBE50>]}
[0m16:32:05.474425 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m16:32:05.476420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220309AB590>]}
[0m16:32:05.481571 [info ] [MainThread]: 
[0m16:32:05.483925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:05.488564 [info ] [MainThread]: 
[0m16:32:05.494856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:05.510366 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m16:32:05.930680 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:32:05.931677 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m16:32:05.933672 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:06.317898 [debug] [ThreadPool]: SQL status: BEGIN in 0.384 seconds
[0m16:32:06.318434 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:32:06.319443 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:32:06.331274 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:32:06.335298 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m16:32:06.336678 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m16:32:06.338741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m16:32:06.343090 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:32:06.344955 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m16:32:06.345958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:06.574430 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m16:32:06.574967 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:32:06.576965 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:32:06.588143 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m16:32:06.591134 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m16:32:06.593134 [debug] [ThreadPool]: On list_propharma_public: Close
[0m16:32:06.608749 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:06.609752 [debug] [MainThread]: On master: BEGIN
[0m16:32:06.610748 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:06.946959 [debug] [MainThread]: SQL status: BEGIN in 0.336 seconds
[0m16:32:06.947948 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:06.948910 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:06.990586 [debug] [MainThread]: SQL status: SELECT 6 in 0.040 seconds
[0m16:32:06.995963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0a5dd0c-be18-48cf-8b64-f0f2aca55dab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022030F4F810>]}
[0m16:32:06.996961 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:06.997959 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:06.999503 [debug] [MainThread]: On master: BEGIN
[0m16:32:07.001001 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:32:07.002695 [debug] [MainThread]: On master: COMMIT
[0m16:32:07.003733 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:07.005035 [debug] [MainThread]: On master: COMMIT
[0m16:32:07.006089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:07.007451 [debug] [MainThread]: On master: Close
[0m16:32:07.016628 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m16:32:07.018325 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m16:32:07.020845 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m16:32:07.021851 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m16:32:07.050156 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m16:32:07.053114 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m16:32:07.085458 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m16:32:07.089638 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m16:32:07.091190 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m16:32:07.094310 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:07.314687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.220 seconds
[0m16:32:07.315683 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m16:32:07.316681 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m16:32:07.320707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:07.328649 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m16:32:07.330643 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m16:32:07.332726 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.31s]
[0m16:32:07.335824 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m16:32:07.337007 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m16:32:07.338359 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m16:32:07.340360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m16:32:07.341839 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m16:32:07.354870 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m16:32:07.360600 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m16:32:07.368584 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m16:32:07.372662 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m16:32:07.374763 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m16:32:07.375835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:07.726972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.350 seconds
[0m16:32:07.727972 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m16:32:07.728968 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m16:32:07.732958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:07.735951 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m16:32:07.737910 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m16:32:07.738943 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.40s]
[0m16:32:07.743520 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m16:32:07.745541 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m16:32:07.746538 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m16:32:07.749050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m16:32:07.751013 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m16:32:07.761174 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m16:32:07.765163 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m16:32:07.770150 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m16:32:07.774140 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m16:32:07.776135 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m16:32:07.778154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:08.014621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.236 seconds
[0m16:32:08.015583 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m16:32:08.017577 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m16:32:08.021567 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:08.024558 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m16:32:08.025555 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m16:32:08.027553 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.28s]
[0m16:32:08.030552 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m16:32:08.032450 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m16:32:08.033881 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m16:32:08.035573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m16:32:08.038104 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m16:32:08.046118 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m16:32:08.050076 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m16:32:08.055316 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m16:32:08.059976 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m16:32:08.061969 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m16:32:08.062999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:08.311281 [debug] [Thread-1 (]: SQL status: BEGIN in 0.248 seconds
[0m16:32:08.313286 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m16:32:08.314281 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m16:32:08.318834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:08.322823 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m16:32:08.323820 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m16:32:08.325925 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.29s]
[0m16:32:08.329251 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m16:32:08.330425 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m16:32:08.331675 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patient_id .................... [RUN]
[0m16:32:08.334135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m16:32:08.336158 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m16:32:08.345757 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m16:32:08.349783 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m16:32:08.356388 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m16:32:08.361328 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m16:32:08.363322 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: BEGIN
[0m16:32:08.364520 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:08.583369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.218 seconds
[0m16:32:08.584578 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m16:32:08.586128 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "propharma"."public"."patients"
where patient_id is null



      
    ) dbt_internal_test
[0m16:32:08.589873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:08.592960 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: ROLLBACK
[0m16:32:08.593996 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: Close
[0m16:32:08.595955 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_raw_tables_pat_patient_id .......................... [[32mPASS[0m in 0.26s]
[0m16:32:08.599692 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m16:32:08.599692 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m16:32:08.601771 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescription_id ............... [RUN]
[0m16:32:08.604273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m16:32:08.605343 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m16:32:08.613838 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m16:32:08.617925 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m16:32:08.622506 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m16:32:08.627523 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m16:32:08.628714 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: BEGIN
[0m16:32:08.630303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:08.859427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m16:32:08.860437 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m16:32:08.861434 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescription_id
from "propharma"."public"."prescriptions"
where prescription_id is null



      
    ) dbt_internal_test
[0m16:32:08.866389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:08.869415 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: ROLLBACK
[0m16:32:08.871375 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: Close
[0m16:32:08.872372 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_raw_tables_pre_prescription_id ..................... [[32mPASS[0m in 0.27s]
[0m16:32:08.876110 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m16:32:08.877902 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m16:32:08.879394 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sale_id ....................... [RUN]
[0m16:32:08.881440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m16:32:08.883580 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m16:32:08.893093 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m16:32:08.897941 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m16:32:08.902449 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m16:32:08.906441 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m16:32:08.908434 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: BEGIN
[0m16:32:08.909432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:09.133759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m16:32:09.135017 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m16:32:09.135558 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "propharma"."public"."sales"
where sale_id is null



      
    ) dbt_internal_test
[0m16:32:09.139888 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:09.143479 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: ROLLBACK
[0m16:32:09.145671 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: Close
[0m16:32:09.147779 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_raw_tables_sal_sale_id ............................. [[32mPASS[0m in 0.27s]
[0m16:32:09.150902 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m16:32:09.153073 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m16:32:09.154189 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_supplier_id ................... [RUN]
[0m16:32:09.156698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m16:32:09.158692 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m16:32:09.166510 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m16:32:09.171399 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m16:32:09.179790 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m16:32:09.183102 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m16:32:09.185101 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: BEGIN
[0m16:32:09.186098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:32:09.418911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m16:32:09.420597 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m16:32:09.421634 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from "propharma"."public"."suppliers"
where supplier_id is null



      
    ) dbt_internal_test
[0m16:32:09.426502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:32:09.429493 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: ROLLBACK
[0m16:32:09.430491 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: Close
[0m16:32:09.432486 [info ] [Thread-1 (]: 8 of 8 PASS source_not_null_raw_tables_sup_supplier_id ......................... [[32mPASS[0m in 0.28s]
[0m16:32:09.436183 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m16:32:09.438231 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:09.440445 [debug] [MainThread]: On master: BEGIN
[0m16:32:09.441887 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:09.672254 [debug] [MainThread]: SQL status: BEGIN in 0.229 seconds
[0m16:32:09.673250 [debug] [MainThread]: On master: COMMIT
[0m16:32:09.674248 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:09.675246 [debug] [MainThread]: On master: COMMIT
[0m16:32:09.677241 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:09.678274 [debug] [MainThread]: On master: Close
[0m16:32:09.680234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:09.681262 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m16:32:09.682627 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd' was properly closed.
[0m16:32:09.684166 [info ] [MainThread]: 
[0m16:32:09.686191 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 4.19 seconds (4.19s).
[0m16:32:09.690194 [debug] [MainThread]: Command end result
[0m16:32:09.822316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:32:09.829298 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:32:09.849439 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m16:32:09.851431 [info ] [MainThread]: 
[0m16:32:09.853651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:09.855647 [info ] [MainThread]: 
[0m16:32:09.857641 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:32:09.860508 [debug] [MainThread]: Command `dbt test` succeeded at 16:32:09.860508 after 7.22 seconds
[0m16:32:09.862511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022028B8FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022028B8F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022028B8F390>]}
[0m16:32:09.864311 [debug] [MainThread]: Flushing usage events
[0m16:32:11.239281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:27.259443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FDA2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FE068D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FE06810>]}


============================== 16:32:27.268419 | 883d9c20-b8e2-47c7-a031-47d6133aa5a5 ==============================
[0m16:32:27.268419 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:32:27.270414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:32:27.692764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FF2A690>]}
[0m16:32:27.804757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544CA36950>]}
[0m16:32:27.807739 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:32:28.644133 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:32:29.159877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:29.162869 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:29.325577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FA12E50>]}
[0m16:32:29.612727 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:32:29.623201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:32:29.714044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254514B3E50>]}
[0m16:32:29.716038 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m16:32:29.721029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025451197C10>]}
[0m16:32:29.728010 [info ] [MainThread]: 
[0m16:32:29.731003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:32:29.738504 [info ] [MainThread]: 
[0m16:32:29.742493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:32:29.751700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m16:32:30.214751 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m16:32:30.216745 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m16:32:30.217744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:30.641674 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.423 seconds
[0m16:32:30.643685 [debug] [ThreadPool]: On list_propharma: Close
[0m16:32:30.658473 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m16:32:30.669671 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:32:30.670682 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m16:32:30.672704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:31.019685 [debug] [ThreadPool]: SQL status: BEGIN in 0.347 seconds
[0m16:32:31.021685 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m16:32:31.023679 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:32:31.035633 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m16:32:31.039740 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m16:32:31.041742 [debug] [ThreadPool]: On list_propharma_public: Close
[0m16:32:31.042740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m16:32:31.058450 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:32:31.060459 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m16:32:31.061787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:32:31.304946 [debug] [ThreadPool]: SQL status: BEGIN in 0.243 seconds
[0m16:32:31.306059 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m16:32:31.307083 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:32:31.317705 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m16:32:31.320213 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m16:32:31.322264 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m16:32:31.336657 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:31.337657 [debug] [MainThread]: On master: BEGIN
[0m16:32:31.339618 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:31.563157 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m16:32:31.564873 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:31.565978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:32:31.607815 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m16:32:31.613563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FEF6D50>]}
[0m16:32:31.615614 [debug] [MainThread]: On master: ROLLBACK
[0m16:32:31.616648 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:31.617722 [debug] [MainThread]: On master: BEGIN
[0m16:32:31.619431 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:32:31.620893 [debug] [MainThread]: On master: COMMIT
[0m16:32:31.621934 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:31.622928 [debug] [MainThread]: On master: COMMIT
[0m16:32:31.623926 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:31.625886 [debug] [MainThread]: On master: Close
[0m16:32:31.635089 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m16:32:31.636133 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m16:32:31.638901 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m16:32:31.639945 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m16:32:31.657755 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m16:32:31.766903 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:31.768758 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select prescribed_date from (
                

select * from "propharma"."public"."stg_prescriptions"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m16:32:31.769763 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:32.005999 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.236 seconds
[0m16:32:32.031482 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.033188 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m16:32:32.034227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:32:32.035770 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.036824 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:32:32.072988 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.035 seconds
[0m16:32:32.088547 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.089591 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:32:32.096629 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m16:32:32.186172 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.188173 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp163232172210"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:32:32.210891 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.021 seconds
[0m16:32:32.215882 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.217877 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp163232172210'
        
      order by ordinal_position

  
[0m16:32:32.225711 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m16:32:32.232695 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.233693 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:32:32.241196 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m16:32:32.247180 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.248178 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp163232172210'
        
      order by ordinal_position

  
[0m16:32:32.255157 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m16:32:32.262140 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.263138 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:32:32.270116 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m16:32:32.282087 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.284082 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp163232172210'
        
      order by ordinal_position

  
[0m16:32:32.291062 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m16:32:32.318988 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.320983 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m16:32:32.322985 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:32:32.329965 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.330962 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m16:32:32.332959 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m16:32:32.333957 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.338468 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.339472 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp163232172210" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp163232172210" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:32:32.343408 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.003 seconds
[0m16:32:32.370332 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m16:32:32.371333 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m16:32:32.372329 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m16:32:32.378137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:32:32.385159 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m16:32:32.391150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883d9c20-b8e2-47c7-a031-47d6133aa5a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544FDAFC50>]}
[0m16:32:32.393144 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 1[0m in 0.75s]
[0m16:32:32.397133 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m16:32:32.400125 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:32.401122 [debug] [MainThread]: On master: BEGIN
[0m16:32:32.402119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:32:32.639689 [debug] [MainThread]: SQL status: BEGIN in 0.237 seconds
[0m16:32:32.640713 [debug] [MainThread]: On master: COMMIT
[0m16:32:32.641711 [debug] [MainThread]: Using postgres connection "master"
[0m16:32:32.642707 [debug] [MainThread]: On master: COMMIT
[0m16:32:32.643704 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:32:32.645672 [debug] [MainThread]: On master: Close
[0m16:32:32.646669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:32.647667 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m16:32:32.648664 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m16:32:32.649661 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m16:32:32.651462 [info ] [MainThread]: 
[0m16:32:32.653523 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m16:32:32.655624 [debug] [MainThread]: Command end result
[0m16:32:32.775223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m16:32:32.782793 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m16:32:32.795934 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m16:32:32.796936 [info ] [MainThread]: 
[0m16:32:32.799307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:32.802294 [info ] [MainThread]: 
[0m16:32:32.804066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:32:32.807111 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:32:32.807111 after 5.82 seconds
[0m16:32:32.808108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254494DFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254494DF390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002544EC60ED0>]}
[0m16:32:32.809105 [debug] [MainThread]: Flushing usage events
[0m16:32:34.280304 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:32.484188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043E1F3CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043E135B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043E134B90>]}


============================== 17:02:32.494162 | b7b1e10a-1954-4152-a769-91742950c04d ==============================
[0m17:02:32.494162 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:02:32.497154 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:02:32.944200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043E3F0C10>]}
[0m17:02:33.059658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043AE45E10>]}
[0m17:02:33.063647 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:02:33.946973 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:02:34.508774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:34.511083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:34.718018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043F610A90>]}
[0m17:02:35.006013 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:02:35.020973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:02:35.097473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043F8EBF10>]}
[0m17:02:35.099512 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m17:02:35.101534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043E3EED10>]}
[0m17:02:35.105574 [info ] [MainThread]: 
[0m17:02:35.107590 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:02:35.110246 [info ] [MainThread]: 
[0m17:02:35.112932 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:02:35.120220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m17:02:35.679476 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m17:02:35.680485 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m17:02:35.681494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:35.972354 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.291 seconds
[0m17:02:35.975787 [debug] [ThreadPool]: On list_propharma: Close
[0m17:02:35.987994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m17:02:35.999539 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:02:36.000541 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:02:36.002757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:36.242043 [debug] [ThreadPool]: SQL status: BEGIN in 0.240 seconds
[0m17:02:36.243439 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:02:36.244527 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:02:36.256058 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m17:02:36.259069 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:02:36.260463 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:02:36.262474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m17:02:36.267976 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:02:36.269970 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:02:36.272319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:02:36.498830 [debug] [ThreadPool]: SQL status: BEGIN in 0.226 seconds
[0m17:02:36.499827 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:02:36.500825 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:02:36.511794 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:02:36.514787 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:02:36.515784 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:02:36.530895 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:36.531893 [debug] [MainThread]: On master: BEGIN
[0m17:02:36.533857 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:36.756487 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m17:02:36.757480 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:36.759444 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:02:36.802326 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m17:02:36.807348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043F563090>]}
[0m17:02:36.808344 [debug] [MainThread]: On master: ROLLBACK
[0m17:02:36.810345 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:36.811303 [debug] [MainThread]: On master: BEGIN
[0m17:02:36.813297 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:02:36.814328 [debug] [MainThread]: On master: COMMIT
[0m17:02:36.815292 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:36.816291 [debug] [MainThread]: On master: COMMIT
[0m17:02:36.817289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:02:36.818318 [debug] [MainThread]: On master: Close
[0m17:02:36.829190 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m17:02:36.830209 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.snapshot_prescriptions ......................... [RUN]
[0m17:02:36.833354 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.Propharma.snapshot_prescriptions'
[0m17:02:36.833897 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m17:02:36.856427 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m17:02:36.970447 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:36.971445 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select prescribed_date from (
                

select * from "propharma"."public"."stg_prescriptions"
            ) subq
    ) as __dbt_sbq
    where false
    limit 0

    
[0m17:02:36.973440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:02:37.298278 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.326 seconds
[0m17:02:37.325258 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.327221 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: BEGIN
[0m17:02:37.329427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:02:37.331059 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.332090 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:02:37.360862 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.027 seconds
[0m17:02:37.376181 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.377178 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:02:37.385845 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m17:02:37.482854 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.484621 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

        
  
    

  create temporary table "snapshot_prescriptions__dbt_tmp170237465570"
  
  
    as
  
  (
    
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:02:37.503361 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.017 seconds
[0m17:02:37.510108 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.511106 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp170237465570'
        
      order by ordinal_position

  
[0m17:02:37.519104 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m17:02:37.526072 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.527032 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:02:37.534048 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m17:02:37.541397 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.542479 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp170237465570'
        
      order by ordinal_position

  
[0m17:02:37.549499 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m17:02:37.556600 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.557816 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:02:37.565130 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.006 seconds
[0m17:02:37.577088 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.579049 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'snapshot_prescriptions__dbt_tmp170237465570'
        
      order by ordinal_position

  
[0m17:02:37.586191 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.006 seconds
[0m17:02:37.614013 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.615963 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        
    
    with snapshot_query as (

        

select * from "propharma"."public"."stg_prescriptions"

    ),

    snapshotted_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    

        from "propharma"."snapshots"."snapshot_prescriptions"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            
  
  coalesce(nullif(now()::timestamp without time zone, now()::timestamp without time zone), null)
  as dbt_valid_to
,
            md5(coalesce(cast(prescription_id as varchar ), '')
         || '|' || coalesce(cast(now()::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        prescription_id as dbt_unique_key
    
,
            now()::timestamp without time zone as dbt_updated_at,
            now()::timestamp without time zone as dbt_valid_from,
            now()::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        )))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."prescribed_date" != source_data."prescribed_date"
        or
        (
            ((snapshotted_data."prescribed_date" is null) and not (source_data."prescribed_date" is null))
            or
            ((not snapshotted_data."prescribed_date" is null) and (source_data."prescribed_date" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0

[0m17:02:37.617991 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.001 seconds
[0m17:02:37.624973 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.625970 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */
select * from (
        select now()::timestamp without time zone as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0

[0m17:02:37.627965 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.000 seconds
[0m17:02:37.629928 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.633873 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.635872 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "snapshot.Propharma.snapshot_prescriptions"} */

      update "propharma"."snapshots"."snapshot_prescriptions"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "snapshot_prescriptions__dbt_tmp170237465570" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "propharma"."snapshots"."snapshot_prescriptions".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      
        and "propharma"."snapshots"."snapshot_prescriptions".dbt_valid_to is null;
      


    insert into "propharma"."snapshots"."snapshot_prescriptions" ("prescription_id", "patient_id", "medicine_id", "prescribed_date", "quantity", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prescription_id",DBT_INTERNAL_SOURCE."patient_id",DBT_INTERNAL_SOURCE."medicine_id",DBT_INTERNAL_SOURCE."prescribed_date",DBT_INTERNAL_SOURCE."quantity",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "snapshot_prescriptions__dbt_tmp170237465570" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:02:37.639202 [debug] [Thread-1 (]: SQL status: INSERT 0 1 in 0.002 seconds
[0m17:02:37.666796 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m17:02:37.668791 [debug] [Thread-1 (]: Using postgres connection "snapshot.Propharma.snapshot_prescriptions"
[0m17:02:37.669788 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: COMMIT
[0m17:02:37.672963 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:02:37.680457 [debug] [Thread-1 (]: On snapshot.Propharma.snapshot_prescriptions: Close
[0m17:02:37.685444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7b1e10a-1954-4152-a769-91742950c04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043AF2BAD0>]}
[0m17:02:37.688436 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.snapshot_prescriptions ......................... [[32mINSERT 0 1[0m in 0.85s]
[0m17:02:37.691428 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m17:02:37.694419 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:37.696415 [debug] [MainThread]: On master: BEGIN
[0m17:02:37.697411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:38.033134 [debug] [MainThread]: SQL status: BEGIN in 0.336 seconds
[0m17:02:38.035093 [debug] [MainThread]: On master: COMMIT
[0m17:02:38.036091 [debug] [MainThread]: Using postgres connection "master"
[0m17:02:38.037095 [debug] [MainThread]: On master: COMMIT
[0m17:02:38.038135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:02:38.040090 [debug] [MainThread]: On master: Close
[0m17:02:38.041086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:38.042084 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m17:02:38.044078 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m17:02:38.045520 [debug] [MainThread]: Connection 'snapshot.Propharma.snapshot_prescriptions' was properly closed.
[0m17:02:38.047029 [info ] [MainThread]: 
[0m17:02:38.049716 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 2.93 seconds (2.93s).
[0m17:02:38.052216 [debug] [MainThread]: Command end result
[0m17:02:38.182408 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:02:38.188402 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:02:38.202381 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:02:38.203362 [info ] [MainThread]: 
[0m17:02:38.205689 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:38.207838 [info ] [MainThread]: 
[0m17:02:38.209251 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:02:38.213440 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:02:38.213440 after 6.00 seconds
[0m17:02:38.214437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043782F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020437838510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020437838590>]}
[0m17:02:38.216431 [debug] [MainThread]: Flushing usage events
[0m17:02:39.544427 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:53.689039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB729ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB72919D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB7291650>]}


============================== 17:03:53.698020 | b8b0944c-0cd0-4c04-8325-c07ca57024cf ==============================
[0m17:03:53.698020 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:03:53.700725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:03:54.179646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB7419D90>]}
[0m17:03:54.306478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB3F57650>]}
[0m17:03:54.310470 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:03:55.169481 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:03:55.822203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:55.824197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:56.005992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB87A36D0>]}
[0m17:03:56.091566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB892BFD0>]}
[0m17:03:56.092563 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m17:03:56.095517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB7453F50>]}
[0m17:03:56.100965 [info ] [MainThread]: 
[0m17:03:56.103044 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:56.106360 [info ] [MainThread]: 
[0m17:03:56.109888 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:56.129927 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m17:03:56.581152 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:03:56.582154 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:03:56.583151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:56.861782 [debug] [ThreadPool]: SQL status: BEGIN in 0.278 seconds
[0m17:03:56.862778 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:03:56.863775 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:03:56.875082 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:03:56.878616 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:03:56.880707 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:03:56.881749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m17:03:56.893269 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:03:56.895263 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:03:56.896264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:57.244589 [debug] [ThreadPool]: SQL status: BEGIN in 0.349 seconds
[0m17:03:57.246582 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:03:57.247579 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:03:57.257962 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m17:03:57.260952 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:03:57.262950 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:03:57.274351 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:57.276346 [debug] [MainThread]: On master: BEGIN
[0m17:03:57.277344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:57.500945 [debug] [MainThread]: SQL status: BEGIN in 0.223 seconds
[0m17:03:57.501455 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:57.503278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:57.545196 [debug] [MainThread]: SQL status: SELECT 6 in 0.040 seconds
[0m17:03:57.550432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8b0944c-0cd0-4c04-8325-c07ca57024cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB8806BD0>]}
[0m17:03:57.551429 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:57.553523 [debug] [MainThread]: On master: Close
[0m17:03:57.562796 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:03:57.564212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:03:57.566725 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:03:57.582755 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:03:57.585798 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:03:57.587883 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:03:57.588889 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:03:57.591085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:03:57.592090 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:03:57.598056 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:03:57.602042 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:03:57.604067 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:03:57.605038 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:03:57.606503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:03:57.608046 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:03:57.613660 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:03:57.617612 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:03:57.619817 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:03:57.620814 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:03:57.621812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:03:57.623806 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:03:57.629794 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:03:57.632786 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:03:57.635119 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:03:57.636120 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:03:57.638167 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:03:57.639168 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:03:57.644669 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:03:57.648926 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:03:57.650921 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:03:57.651917 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:03:57.653449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:03:57.654456 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:03:57.660746 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:03:57.664869 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:03:57.666929 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:03:57.667934 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m17:03:57.668984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m17:03:57.671029 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m17:03:57.675091 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m17:03:57.676409 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m17:03:57.678451 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:03:57.679542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4)
[0m17:03:57.680549 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:03:57.695361 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m17:03:57.699476 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:03:57.701471 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:03:57.702734 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:03:57.703777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m17:03:57.704819 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:03:57.723672 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m17:03:57.726769 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:03:57.728759 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:03:57.730039 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:03:57.732090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m17:03:57.733247 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:03:57.740374 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m17:03:57.743926 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:03:57.745921 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:03:57.746919 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:03:57.748913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m17:03:57.749910 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:03:57.756891 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m17:03:57.760882 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:03:57.762875 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:03:57.763910 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:03:57.765872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m17:03:57.766901 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:03:57.773894 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m17:03:57.777836 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:03:57.779831 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:03:57.780829 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:03:57.782822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m17:03:57.783819 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:03:57.791802 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m17:03:57.794790 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:03:57.796785 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:03:57.798779 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:03:57.799776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m17:03:57.800774 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:03:57.808754 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m17:03:57.813549 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:03:57.815549 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:03:57.816546 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:03:57.817543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m17:03:57.818541 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:03:57.826519 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m17:03:57.830514 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:03:57.832509 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:03:57.833506 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:03:57.835534 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd, now model.Propharma.mart_expired_drugs)
[0m17:03:57.836530 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:03:57.845209 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:03:57.849330 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:03:57.851423 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:03:57.852428 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:03:57.853520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:03:57.854526 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:03:57.861506 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:03:57.865649 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:03:57.866914 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:03:57.869025 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:03:57.869978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_invoice)
[0m17:03:57.871297 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:03:57.877528 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:03:57.881610 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:03:57.883744 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:03:57.884785 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m17:03:57.885828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_invoice, now snapshot.Propharma.snapshot_prescriptions)
[0m17:03:57.886870 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m17:03:57.893898 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m17:03:57.895890 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m17:03:57.896850 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:03:57.898507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m17:03:57.899508 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:03:57.905591 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:03:57.908547 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:03:57.910541 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:03:57.912536 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:03:57.913533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:03:57.914530 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:03:57.924504 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:03:57.927495 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:03:57.929494 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:03:57.932593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:57.933596 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m17:03:57.934593 [debug] [MainThread]: Connection 'model.Propharma.mart_top_customers' was properly closed.
[0m17:03:57.941574 [debug] [MainThread]: Command end result
[0m17:03:58.159417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:03:58.170388 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:03:58.245045 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:03:58.254924 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:03:58.255895 [info ] [MainThread]: Building catalog
[0m17:03:58.279566 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m17:03:58.293560 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:03:58.294557 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m17:03:58.296970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:58.632416 [debug] [ThreadPool]: SQL status: BEGIN in 0.336 seconds
[0m17:03:58.632956 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:03:58.635286 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_invoice')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:03:58.653404 [debug] [ThreadPool]: SQL status: SELECT 99 in 0.016 seconds
[0m17:03:58.667719 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m17:03:58.668718 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m17:03:58.701968 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:03:58.762636 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:03:58.768731 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:03:58.769809 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:03:58.773203 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:03:58.773203 after 5.52 seconds
[0m17:03:58.774238 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:03:58.775630 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m17:03:58.775630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB86F5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB86CFD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EB09FF410>]}
[0m17:03:58.778532 [debug] [MainThread]: Flushing usage events
[0m17:03:59.959189 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:22.682122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78943D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78920690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C788E3950>]}


============================== 17:04:22.691103 | b3194e34-f97b-4c9c-b285-ee6f3c3ab24a ==============================
[0m17:04:22.691103 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:04:22.693520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:23.189877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3194e34-f97b-4c9c-b285-ee6f3c3ab24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78AEE110>]}
[0m17:04:23.340296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3194e34-f97b-4c9c-b285-ee6f3c3ab24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C75549AD0>]}
[0m17:04:24.233387 [error] [MainThread]: Encountered an error:
[WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted
[0m17:04:24.249860 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 24, in run
    with socketserver.TCPServer((host, port), SimpleHTTPRequestHandler) as httpd:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 456, in __init__
    self.server_bind()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 472, in server_bind
    self.socket.bind(self.server_address)
OSError: [WinError 10048] Only one usage of each socket address (protocol/network address/port) is normally permitted

[0m17:04:24.261919 [debug] [MainThread]: Command `dbt docs serve` failed at 17:04:24.260912 after 1.96 seconds
[0m17:04:24.263913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78942310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78921490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C78A36C50>]}
[0m17:04:24.265909 [debug] [MainThread]: Flushing usage events
[0m17:04:25.514362 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:44.022248 [error] [MainThread]: Encountered an error:

[0m17:06:44.069455 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:06:44.085440 [debug] [MainThread]: Command `dbt docs serve` failed at 17:06:44.084442 after 19699.60 seconds
[0m17:06:44.092428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC61E3FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6180ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DC6182B10>]}
[0m17:06:44.097144 [debug] [MainThread]: Flushing usage events
[0m17:06:45.321974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:54.271275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAD4ADC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBA96B5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAD503010>]}


============================== 17:06:54.283353 | 176cf469-707d-4292-9f16-ff9c31d318e0 ==============================
[0m17:06:54.283353 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:06:54.286404 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:54.932950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176cf469-707d-4292-9f16-ff9c31d318e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAD6ACC90>]}
[0m17:06:55.049024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '176cf469-707d-4292-9f16-ff9c31d318e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAA107450>]}
[0m17:27:09.795792 [error] [MainThread]: Encountered an error:

[0m17:27:09.809117 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:27:09.822995 [debug] [MainThread]: Command `dbt docs serve` failed at 17:27:09.821990 after 1216.05 seconds
[0m17:27:09.824988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAD503010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAC80F8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBAD4A10D0>]}
[0m17:27:09.827503 [debug] [MainThread]: Flushing usage events
[0m17:27:11.022502 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:21.116872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368B74E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368B74E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368B744D0>]}


============================== 17:27:21.125298 | fed78384-ceb4-4e58-aaf0-9066410be775 ==============================
[0m17:27:21.125298 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:21.127294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:27:21.635037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368B32010>]}
[0m17:27:21.755002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026365797B90>]}
[0m17:27:21.757993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:22.614373 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:23.329741 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:23.336712 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_invoice.sql
[0m17:27:24.468934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026369F05690>]}
[0m17:27:24.721431 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:27:24.732922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:27:24.813774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A36FE10>]}
[0m17:27:24.814801 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m17:27:24.817692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026369F444D0>]}
[0m17:27:24.822192 [info ] [MainThread]: 
[0m17:27:24.824593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:24.826930 [info ] [MainThread]: 
[0m17:27:24.829294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:24.841721 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m17:27:25.338550 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m17:27:25.339565 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m17:27:25.340574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:25.726670 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.385 seconds
[0m17:27:25.729666 [debug] [ThreadPool]: On list_propharma: Close
[0m17:27:25.734882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m17:27:25.746657 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:27:25.748733 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:27:25.749760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:26.106342 [debug] [ThreadPool]: SQL status: BEGIN in 0.356 seconds
[0m17:27:26.107345 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:27:26.109339 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:27:26.127556 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.016 seconds
[0m17:27:26.132550 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:27:26.134543 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:27:26.137536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m17:27:26.146031 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:27:26.148030 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:27:26.149531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:26.495199 [debug] [ThreadPool]: SQL status: BEGIN in 0.346 seconds
[0m17:27:26.497193 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:27:26.499188 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:27:26.516263 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.015 seconds
[0m17:27:26.522060 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:27:26.524459 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:27:26.549174 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:26.550550 [debug] [MainThread]: On master: BEGIN
[0m17:27:26.553610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:26.872545 [debug] [MainThread]: SQL status: BEGIN in 0.320 seconds
[0m17:27:26.874931 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:26.876271 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:26.930186 [debug] [MainThread]: SQL status: SELECT 6 in 0.052 seconds
[0m17:27:26.936621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A172F90>]}
[0m17:27:26.938936 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:26.941443 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:26.942446 [debug] [MainThread]: On master: BEGIN
[0m17:27:26.944441 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:27:26.945439 [debug] [MainThread]: On master: COMMIT
[0m17:27:26.946436 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:26.948431 [debug] [MainThread]: On master: COMMIT
[0m17:27:26.949935 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:26.951444 [debug] [MainThread]: On master: Close
[0m17:27:26.964674 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:27:26.967008 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_inventory .............................. [RUN]
[0m17:27:26.970928 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:27:26.973064 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:27:27.001288 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:27:27.005870 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:27:27.182517 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m17:27:27.186506 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.187505 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m17:27:27.189498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:27.539259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.349 seconds
[0m17:27:27.540788 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.541791 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m17:27:27.551783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:27:27.566361 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.568606 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m17:27:27.570647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:27.577058 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.579109 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m17:27:27.580107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:27.614593 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:27:27.616592 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.618063 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m17:27:27.621567 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:27.634417 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m17:27:27.645257 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m17:27:27.646267 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m17:27:27.650869 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:27:27.656103 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m17:27:27.662372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A04B510>]}
[0m17:27:27.664376 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.69s]
[0m17:27:27.667427 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:27:27.668423 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:27:27.670510 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_medicines .............................. [RUN]
[0m17:27:27.672752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:27:27.675199 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:27:27.686926 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:27:27.692487 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:27:27.706047 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m17:27:27.712476 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:27.713476 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m17:27:27.715574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:28.007518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.291 seconds
[0m17:27:28.008521 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:28.009519 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m17:27:28.022984 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m17:27:28.032618 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:28.034090 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m17:27:28.037656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.046271 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:28.048461 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m17:27:28.052255 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.056250 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:27:28.058625 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:28.059944 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m17:27:28.063538 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:27:28.072477 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m17:27:28.075475 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m17:27:28.077582 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m17:27:28.082446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:27:28.086456 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m17:27:28.089729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368D9DE90>]}
[0m17:27:28.092283 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m17:27:28.095378 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:27:28.097713 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:27:28.099749 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_patients ............................... [RUN]
[0m17:27:28.103295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:27:28.105686 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:27:28.118343 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:27:28.124422 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:27:28.137271 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m17:27:28.142719 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.144711 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m17:27:28.146706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:28.462333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.315 seconds
[0m17:27:28.463337 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.465335 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m17:27:28.479544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m17:27:28.491659 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.493682 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m17:27:28.496679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.507653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.508651 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m17:27:28.511643 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.517143 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:27:28.518197 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.519544 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m17:27:28.522579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:28.531266 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m17:27:28.533262 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m17:27:28.534259 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m17:27:28.539554 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:27:28.543952 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m17:27:28.546041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368D50B50>]}
[0m17:27:28.548882 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m17:27:28.552409 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:27:28.554282 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:27:28.556763 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_prescriptions .......................... [RUN]
[0m17:27:28.559050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:27:28.561455 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:27:28.571277 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:27:28.577072 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:27:28.594344 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m17:27:28.599785 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.601294 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m17:27:28.604111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:28.875256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.272 seconds
[0m17:27:28.876721 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.878820 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m17:27:28.888216 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:27:28.896780 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.897872 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m17:27:28.900522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.907914 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.908917 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m17:27:28.910102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:28.914628 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:27:28.915625 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.917620 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m17:27:28.919871 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:28.926378 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m17:27:28.928709 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m17:27:28.929711 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m17:27:28.934420 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:27:28.938775 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m17:27:28.941283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A68B8D0>]}
[0m17:27:28.943776 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.38s]
[0m17:27:28.947157 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:27:28.949448 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:27:28.950949 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m17:27:28.953309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:27:28.954813 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:27:28.965915 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:27:28.970188 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:27:28.984666 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m17:27:28.988968 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:28.989970 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m17:27:28.992525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:29.400729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.409 seconds
[0m17:27:29.402764 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:29.403799 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m17:27:29.414213 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:27:29.421368 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:29.422387 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m17:27:29.424470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:29.431717 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:29.432725 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m17:27:29.434084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:29.438138 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:27:29.439175 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:29.440179 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m17:27:29.443735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:27:29.449204 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m17:27:29.450712 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m17:27:29.452221 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m17:27:29.456593 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:27:29.460002 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m17:27:29.461545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A3C7090>]}
[0m17:27:29.463887 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.51s]
[0m17:27:29.466878 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:27:29.468947 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:27:29.469998 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_suppliers .............................. [RUN]
[0m17:27:29.472532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:27:29.474533 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:27:29.484955 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:27:29.490592 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:27:29.501312 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m17:27:29.507954 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.509270 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m17:27:29.511297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:29.781412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.270 seconds
[0m17:27:29.782592 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.783773 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m17:27:29.793222 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:27:29.800555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.801553 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m17:27:29.802944 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:29.809917 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.811437 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m17:27:29.813594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:29.816893 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:27:29.819116 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.820138 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m17:27:29.823252 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:29.828959 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m17:27:29.829997 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m17:27:29.832619 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m17:27:29.835995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:27:29.839051 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m17:27:29.841588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A05EAD0>]}
[0m17:27:29.842630 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.37s]
[0m17:27:29.846384 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:27:29.848575 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:27:29.849572 [info ] [Thread-1 (]: 7 of 11 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m17:27:29.852440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m17:27:29.854804 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:27:29.869253 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:27:29.873497 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:27:29.968837 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:29.969856 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp172729934764"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m17:27:29.972377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:30.226295 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.254 seconds
[0m17:27:30.253829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.254369 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m17:27:30.257026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:27:30.258810 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.260113 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp172729934764'
        
      order by ordinal_position

  
[0m17:27:30.286359 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m17:27:30.296843 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.297841 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:30.305594 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m17:27:30.320036 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.321595 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:30.329989 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m17:27:30.360724 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m17:27:30.364717 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.366711 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp172729934764" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp172729934764"
    )
  
[0m17:27:30.370701 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:27:30.373448 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:27:30.375471 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m17:27:30.376467 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m17:27:30.378749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:30.381376 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m17:27:30.383344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A3B3BD0>]}
[0m17:27:30.385427 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.53s]
[0m17:27:30.389701 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:27:30.391786 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:27:30.392782 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m17:27:30.395455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:27:30.398016 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:27:30.407344 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:27:30.411514 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:27:30.424748 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.425913 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp172730419283"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m17:27:30.427964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:30.751441 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.323 seconds
[0m17:27:30.757448 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.758446 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m17:27:30.761438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:27:30.761943 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.763942 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp172730419283'
        
      order by ordinal_position

  
[0m17:27:30.788425 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m17:27:30.794916 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.797424 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:30.804915 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m17:27:30.812410 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.813408 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:30.820427 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m17:27:30.825481 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m17:27:30.829690 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.831668 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp172730419283" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp172730419283"
    )
  
[0m17:27:30.835848 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:27:30.839004 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:27:30.840037 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m17:27:30.842032 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m17:27:30.844747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:27:30.847042 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m17:27:30.849035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026368B75C10>]}
[0m17:27:30.851544 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.45s]
[0m17:27:30.855646 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:27:30.857646 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:27:30.860474 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public.mart_sales_summary .................. [RUN]
[0m17:27:30.862528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m17:27:30.864809 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:27:30.875520 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:27:30.881270 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:27:30.896376 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:30.898467 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp172730891614"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
  
  
[0m17:27:30.900617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:31.206378 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.306 seconds
[0m17:27:31.215683 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.216687 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m17:27:31.220019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:27:31.221534 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.223550 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp172730891614'
        
      order by ordinal_position

  
[0m17:27:31.274849 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.050 seconds
[0m17:27:31.306343 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.335972 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:31.354987 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.010 seconds
[0m17:27:31.366971 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.369391 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:31.380673 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.009 seconds
[0m17:27:31.401508 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m17:27:31.407184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.409179 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp172730891614"
    )


  
[0m17:27:31.413655 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m17:27:31.419150 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:27:31.422678 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m17:27:31.424081 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m17:27:31.428638 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:31.432541 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m17:27:31.434931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636855D8D0>]}
[0m17:27:31.437690 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public.mart_sales_summary ............. [[32mINSERT 0 10[0m in 0.57s]
[0m17:27:31.441639 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:27:31.443644 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:27:31.444838 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public.mart_top_customers ................. [RUN]
[0m17:27:31.456772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:27:31.458774 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:27:31.472418 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:27:31.477958 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:27:31.493746 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.495745 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp172731487174"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m17:27:31.498737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:31.876422 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.378 seconds
[0m17:27:31.885066 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.887676 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m17:27:31.890165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:27:31.892201 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.894200 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp172731487174'
        
      order by ordinal_position

  
[0m17:27:31.922231 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.026 seconds
[0m17:27:31.928934 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.929929 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:31.939404 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.007 seconds
[0m17:27:31.945779 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.947798 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:31.956247 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m17:27:31.960242 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m17:27:31.964076 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.966416 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp172731487174" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp172731487174"
    )
  
[0m17:27:31.970405 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m17:27:31.974144 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:27:31.975504 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m17:27:31.976577 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m17:27:31.978628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:31.982963 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m17:27:31.983960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A7B9D10>]}
[0m17:27:31.986421 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.53s]
[0m17:27:31.990929 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:27:31.992520 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:27:31.994994 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public.mart_invoice ....................... [RUN]
[0m17:27:31.998316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m17:27:32.001428 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:27:32.012768 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:27:32.018271 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:27:32.037174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.038193 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp172732026305"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m17:27:32.039360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:32.325240 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.285 seconds
[0m17:27:32.331700 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.333775 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m17:27:32.336654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m17:27:32.337681 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.338679 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp172732026305'
        
      order by ordinal_position

  
[0m17:27:32.365388 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.025 seconds
[0m17:27:32.372377 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.373374 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:32.380387 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m17:27:32.387831 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.389007 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m17:27:32.396307 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m17:27:32.400409 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m17:27:32.404683 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.405685 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp172732026305" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp172732026305"
    )
  
[0m17:27:32.410234 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m17:27:32.413297 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:27:32.415291 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m17:27:32.416293 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m17:27:32.419320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:32.421288 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m17:27:32.422851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fed78384-ceb4-4e58-aaf0-9066410be775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002636A813650>]}
[0m17:27:32.425273 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.42s]
[0m17:27:32.428992 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:27:32.432404 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:32.433972 [debug] [MainThread]: On master: BEGIN
[0m17:27:32.436098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:32.702938 [debug] [MainThread]: SQL status: BEGIN in 0.266 seconds
[0m17:27:32.704112 [debug] [MainThread]: On master: COMMIT
[0m17:27:32.704650 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:32.706309 [debug] [MainThread]: On master: COMMIT
[0m17:27:32.707448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:32.709493 [debug] [MainThread]: On master: Close
[0m17:27:32.711189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:32.711698 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m17:27:32.713717 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m17:27:32.714714 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m17:27:32.716714 [info ] [MainThread]: 
[0m17:27:32.719031 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m17:27:32.725753 [debug] [MainThread]: Command end result
[0m17:27:32.793892 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:27:32.800315 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:27:32.818191 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:27:32.819191 [info ] [MainThread]: 
[0m17:27:32.821189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:32.823183 [info ] [MainThread]: 
[0m17:27:32.825178 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m17:27:32.829389 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:32.827992 after 12.02 seconds
[0m17:27:32.831436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263621DFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263621DF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263621DF390>]}
[0m17:27:32.832569 [debug] [MainThread]: Flushing usage events
[0m17:27:34.185719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:53.404671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D05BFA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D06166D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D06168D0>]}


============================== 17:27:53.412729 | 102b9047-0a8a-40ff-b300-b4d804f66f0a ==============================
[0m17:27:53.412729 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:53.414730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:27:53.853018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D07B4E50>]}
[0m17:27:53.968159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1CD207510>]}
[0m17:27:53.971158 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:54.849653 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:55.424920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:55.427730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:55.652057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D0756490>]}
[0m17:27:55.749812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D1C47F90>]}
[0m17:27:55.752356 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m17:27:55.754829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D1AB78D0>]}
[0m17:27:55.761244 [info ] [MainThread]: 
[0m17:27:55.764814 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:55.767323 [info ] [MainThread]: 
[0m17:27:55.769860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:55.784951 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m17:27:56.384335 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:27:56.385386 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m17:27:56.386582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:56.709655 [debug] [ThreadPool]: SQL status: BEGIN in 0.322 seconds
[0m17:27:56.711165 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m17:27:56.713567 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:27:56.728379 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.013 seconds
[0m17:27:56.730698 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m17:27:56.733183 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m17:27:56.734192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m17:27:56.742399 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:27:56.744958 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m17:27:56.746006 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:57.035480 [debug] [ThreadPool]: SQL status: BEGIN in 0.289 seconds
[0m17:27:57.037473 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m17:27:57.038713 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:27:57.049462 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m17:27:57.052992 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m17:27:57.055350 [debug] [ThreadPool]: On list_propharma_public: Close
[0m17:27:57.070548 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:57.072050 [debug] [MainThread]: On master: BEGIN
[0m17:27:57.073051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:57.310456 [debug] [MainThread]: SQL status: BEGIN in 0.237 seconds
[0m17:27:57.311958 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:57.313957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:57.362668 [debug] [MainThread]: SQL status: SELECT 6 in 0.046 seconds
[0m17:27:57.368157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '102b9047-0a8a-40ff-b300-b4d804f66f0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D0617C50>]}
[0m17:27:57.369665 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:57.371270 [debug] [MainThread]: On master: Close
[0m17:27:57.383406 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m17:27:57.384421 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m17:27:57.385424 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m17:27:57.402851 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m17:27:57.407401 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m17:27:57.409421 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m17:27:57.410417 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m17:27:57.412650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m17:27:57.413850 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m17:27:57.419841 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m17:27:57.425185 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m17:27:57.427235 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m17:27:57.428313 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m17:27:57.429326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m17:27:57.431622 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m17:27:57.438296 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m17:27:57.441323 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m17:27:57.443444 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m17:27:57.444656 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m17:27:57.446935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m17:27:57.447932 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m17:27:57.455312 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m17:27:57.458705 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m17:27:57.461216 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m17:27:57.462232 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m17:27:57.463414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m17:27:57.464851 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m17:27:57.473927 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m17:27:57.477918 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m17:27:57.481421 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m17:27:57.482423 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m17:27:57.484417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m17:27:57.485414 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m17:27:57.493148 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m17:27:57.498141 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m17:27:57.500135 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m17:27:57.502679 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m17:27:57.504797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m17:27:57.507839 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m17:27:57.514346 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m17:27:57.517338 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m17:27:57.519332 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:27:57.521833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4)
[0m17:27:57.523866 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:27:57.543086 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m17:27:57.546132 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:27:57.548615 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m17:27:57.549626 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:27:57.551642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m17:27:57.553151 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:27:57.572497 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m17:27:57.576400 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:27:57.578395 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m17:27:57.579643 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:27:57.580636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m17:27:57.581647 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:27:57.590046 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m17:27:57.593613 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:27:57.596942 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m17:27:57.597939 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:27:57.598936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m17:27:57.600306 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:27:57.608596 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m17:27:57.612292 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:27:57.614422 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m17:27:57.616451 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:27:57.617456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m17:27:57.618701 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:27:57.626687 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m17:27:57.631863 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:27:57.634620 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m17:27:57.636622 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:27:57.638073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m17:27:57.639070 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:27:57.647192 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m17:27:57.651182 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:27:57.653687 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m17:27:57.654688 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:27:57.655686 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m17:27:57.657180 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:27:57.665205 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m17:27:57.668198 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:27:57.671252 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m17:27:57.672274 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:27:57.673271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m17:27:57.675267 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:27:57.682761 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m17:27:57.687017 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:27:57.689044 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m17:27:57.691337 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m17:27:57.692673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd, now model.Propharma.mart_expired_drugs)
[0m17:27:57.694686 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m17:27:57.705701 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m17:27:57.709660 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m17:27:57.712164 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m17:27:57.713165 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m17:27:57.715239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m17:27:57.716240 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m17:27:57.723420 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m17:27:57.726486 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m17:27:57.728624 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m17:27:57.729631 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m17:27:57.731462 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now snapshot.Propharma.snapshot_prescriptions)
[0m17:27:57.732497 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m17:27:57.739839 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m17:27:57.741348 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m17:27:57.743672 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m17:27:57.744723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m17:27:57.745752 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m17:27:57.752651 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m17:27:57.756078 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m17:27:57.758374 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m17:27:57.759378 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m17:27:57.760375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m17:27:57.761375 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m17:27:57.768446 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m17:27:57.772519 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m17:27:57.774816 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m17:27:57.776863 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m17:27:57.777883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m17:27:57.779227 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m17:27:57.789258 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m17:27:57.793493 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m17:27:57.795626 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m17:27:57.796918 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:57.798827 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m17:27:57.799829 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m17:27:57.807476 [debug] [MainThread]: Command end result
[0m17:27:58.029946 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:27:58.041472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:27:58.116842 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m17:27:58.126356 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:27:58.128351 [info ] [MainThread]: Building catalog
[0m17:27:58.155397 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m17:27:58.172247 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:27:58.174243 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m17:27:58.175268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:58.424386 [debug] [ThreadPool]: SQL status: BEGIN in 0.249 seconds
[0m17:27:58.425648 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m17:27:58.426677 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_invoice')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:27:58.443543 [debug] [ThreadPool]: SQL status: SELECT 99 in 0.015 seconds
[0m17:27:58.458374 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m17:27:58.460522 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m17:27:58.499486 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:27:58.570140 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m17:27:58.577706 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m17:27:58.579044 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m17:27:58.582333 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:27:58.582333 after 5.45 seconds
[0m17:27:58.583335 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:27:58.584336 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m17:27:58.586331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1CD31C450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1D19EFA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B1C9C4F290>]}
[0m17:27:58.587329 [debug] [MainThread]: Flushing usage events
[0m17:27:59.694788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:08.684675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002201682E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220168608D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220164929D0>]}


============================== 17:28:08.692689 | 10b26a3a-06d5-4eba-b8e8-5faa3791a016 ==============================
[0m17:28:08.692689 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:28:08.694691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:28:09.294143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10b26a3a-06d5-4eba-b8e8-5faa3791a016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220169EDB10>]}
[0m17:28:09.410521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10b26a3a-06d5-4eba-b8e8-5faa3791a016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022013485F10>]}
[0m12:08:25.531272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142517E6ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142517C4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142517E7550>]}


============================== 12:08:25.542659 | 17007a13-b637-469e-ad8d-12cea5a1c080 ==============================
[0m12:08:25.542659 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:08:25.543812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:26.125756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001425194B0D0>]}
[0m12:08:26.291086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424E477750>]}
[0m12:08:26.296080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:27.233643 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:08:27.865915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:27.867073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:28.015865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142517B2410>]}
[0m12:08:28.259982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:08:28.273555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:08:28.369580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014252E1B390>]}
[0m12:08:28.371576 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m12:08:28.372573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142517E6650>]}
[0m12:08:28.378075 [info ] [MainThread]: 
[0m12:08:28.380073 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:28.381074 [info ] [MainThread]: 
[0m12:08:28.383069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:28.400114 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m12:08:29.036753 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m12:08:29.037722 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m12:08:29.038714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:29.301756 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.263 seconds
[0m12:08:29.305315 [debug] [ThreadPool]: On list_propharma: Close
[0m12:08:29.310992 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m12:08:29.327685 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:08:29.329680 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:08:29.330678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:29.566604 [debug] [ThreadPool]: SQL status: BEGIN in 0.236 seconds
[0m12:08:29.567612 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:08:29.568609 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:08:29.586975 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.017 seconds
[0m12:08:29.590934 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:08:29.592928 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:08:29.594440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m12:08:29.604959 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:08:29.605961 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:08:29.606958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:29.851370 [debug] [ThreadPool]: SQL status: BEGIN in 0.244 seconds
[0m12:08:29.852470 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:08:29.853474 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:08:29.865824 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m12:08:29.868824 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:08:29.870815 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:08:29.884677 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:29.886933 [debug] [MainThread]: On master: BEGIN
[0m12:08:29.888763 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:30.152769 [debug] [MainThread]: SQL status: BEGIN in 0.264 seconds
[0m12:08:30.154768 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:30.156818 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:30.221934 [debug] [MainThread]: SQL status: SELECT 6 in 0.063 seconds
[0m12:08:30.227311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014253181990>]}
[0m12:08:30.229306 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:30.231298 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:30.232296 [debug] [MainThread]: On master: BEGIN
[0m12:08:30.234406 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:08:30.235439 [debug] [MainThread]: On master: COMMIT
[0m12:08:30.236441 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:30.238435 [debug] [MainThread]: On master: COMMIT
[0m12:08:30.240434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:30.241436 [debug] [MainThread]: On master: Close
[0m12:08:30.255445 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m12:08:30.257444 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_inventory .............................. [RUN]
[0m12:08:30.260431 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m12:08:30.262426 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m12:08:30.280323 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m12:08:30.285364 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m12:08:30.365970 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m12:08:30.371597 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.373845 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m12:08:30.374847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:30.631791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m12:08:30.632803 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.635334 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m12:08:30.664793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m12:08:30.677995 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.679481 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m12:08:30.681785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:30.687833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.690557 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m12:08:30.692647 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:30.728264 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m12:08:30.729263 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.731224 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m12:08:30.734231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:30.747738 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m12:08:30.758018 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m12:08:30.759015 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m12:08:30.768508 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m12:08:30.774996 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m12:08:30.781199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001425177EF10>]}
[0m12:08:30.783203 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.52s]
[0m12:08:30.785774 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m12:08:30.787891 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m12:08:30.788766 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_medicines .............................. [RUN]
[0m12:08:30.790770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m12:08:30.793065 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m12:08:30.805229 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m12:08:30.811381 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m12:08:30.824894 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m12:08:30.829881 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:30.830878 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m12:08:30.831875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:31.078473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.246 seconds
[0m12:08:31.080912 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:31.081968 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m12:08:31.097650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m12:08:31.104486 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:31.106556 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m12:08:31.107740 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.114490 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:31.115523 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m12:08:31.119096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.121684 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m12:08:31.122767 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:31.124890 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m12:08:31.127817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:31.132804 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m12:08:31.135375 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m12:08:31.137370 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m12:08:31.140737 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:31.144528 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m12:08:31.145587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142532A8A10>]}
[0m12:08:31.147566 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m12:08:31.150679 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m12:08:31.152193 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m12:08:31.153296 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_patients ............................... [RUN]
[0m12:08:31.155814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m12:08:31.156810 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m12:08:31.164587 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m12:08:31.169608 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m12:08:31.180233 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m12:08:31.184454 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.185937 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m12:08:31.186940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:31.431718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.245 seconds
[0m12:08:31.433712 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.434711 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m12:08:31.445514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:08:31.452774 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.454775 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m12:08:31.456770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.462753 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.464748 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m12:08:31.466254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.470248 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m12:08:31.471246 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.472242 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m12:08:31.475799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:31.481362 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m12:08:31.482377 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m12:08:31.484402 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m12:08:31.488989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:08:31.492039 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m12:08:31.493056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142532CF6D0>]}
[0m12:08:31.495596 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m12:08:31.499376 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m12:08:31.500390 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m12:08:31.502558 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_prescriptions .......................... [RUN]
[0m12:08:31.504592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m12:08:31.507102 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m12:08:31.514939 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m12:08:31.519029 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m12:08:31.531825 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m12:08:31.537477 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.540848 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m12:08:31.543793 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:31.817954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.275 seconds
[0m12:08:31.820462 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.821458 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m12:08:31.840481 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m12:08:31.909176 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.910190 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m12:08:31.913260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.919462 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.920499 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m12:08:31.923635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:31.927187 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m12:08:31.929261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.930274 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m12:08:31.933365 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:31.938019 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m12:08:31.941302 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m12:08:31.943317 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m12:08:31.947820 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:31.952254 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m12:08:31.954763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001425192E090>]}
[0m12:08:31.958018 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m12:08:31.962212 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m12:08:31.963280 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m12:08:31.965916 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m12:08:31.969410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m12:08:31.971404 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m12:08:31.980063 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m12:08:31.982842 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m12:08:31.994844 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m12:08:32.000828 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.002824 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m12:08:32.004335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:32.264132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.260 seconds
[0m12:08:32.266134 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.268394 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m12:08:32.281278 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m12:08:32.291351 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.293814 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m12:08:32.295961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:32.302323 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.304327 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m12:08:32.305852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:32.310008 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:08:32.311019 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.312233 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m12:08:32.314749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:32.321209 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m12:08:32.322215 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m12:08:32.324526 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m12:08:32.329636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:08:32.332462 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m12:08:32.334982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014253306990>]}
[0m12:08:32.335993 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m12:08:32.340290 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m12:08:32.342285 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m12:08:32.343283 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_suppliers .............................. [RUN]
[0m12:08:32.346834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m12:08:32.347832 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m12:08:32.355880 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m12:08:32.360391 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m12:08:32.369390 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m12:08:32.374478 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.376644 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m12:08:32.377711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:32.622166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m12:08:32.623271 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.625310 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m12:08:32.635423 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:08:32.643411 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.644925 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m12:08:32.646924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:32.656419 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.657416 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m12:08:32.659411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:32.662403 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m12:08:32.664398 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.664904 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m12:08:32.667899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:32.674421 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m12:08:32.676656 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m12:08:32.677698 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m12:08:32.681357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:08:32.684786 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m12:08:32.686755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001425296C450>]}
[0m12:08:32.688770 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m12:08:32.691836 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m12:08:32.694672 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m12:08:32.696290 [info ] [Thread-1 (]: 7 of 11 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m12:08:32.698505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m12:08:32.701021 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m12:08:32.713619 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m12:08:32.718498 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m12:08:32.806993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:32.808027 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp120832772027"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m12:08:32.810146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:33.169143 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.359 seconds
[0m12:08:33.195905 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.197419 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m12:08:33.199443 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:08:33.201407 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.203402 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp120832772027'
        
      order by ordinal_position

  
[0m12:08:33.243033 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.039 seconds
[0m12:08:33.255834 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.256842 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:33.264393 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m12:08:33.281254 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.282292 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:33.289395 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m12:08:33.321977 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m12:08:33.326853 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.327891 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp120832772027" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp120832772027"
    )
  
[0m12:08:33.334669 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.005 seconds
[0m12:08:33.338568 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m12:08:33.339611 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m12:08:33.340651 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m12:08:33.343906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:33.345996 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m12:08:33.348057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014253300790>]}
[0m12:08:33.351111 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.65s]
[0m12:08:33.354526 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m12:08:33.355033 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m12:08:33.358806 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m12:08:33.361799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m12:08:33.363794 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m12:08:33.376781 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m12:08:33.382250 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m12:08:33.399106 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.401329 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp120833389805"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m12:08:33.402574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:33.662912 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.261 seconds
[0m12:08:33.670331 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.671327 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m12:08:33.673329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:08:33.675331 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.676328 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp120833389805'
        
      order by ordinal_position

  
[0m12:08:33.701894 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m12:08:33.708883 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.709880 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:33.717809 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m12:08:33.724905 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.725902 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:33.734240 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m12:08:33.739232 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m12:08:33.743634 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.744649 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp120833389805" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp120833389805"
    )
  
[0m12:08:33.749666 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m12:08:33.752658 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m12:08:33.754651 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m12:08:33.756163 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m12:08:33.759305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:33.761535 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m12:08:33.763363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142518C88D0>]}
[0m12:08:33.765363 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.40s]
[0m12:08:33.768649 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m12:08:33.770643 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m12:08:33.772459 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public.mart_sales_summary .................. [RUN]
[0m12:08:33.774464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m12:08:33.776995 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m12:08:33.785288 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m12:08:33.790321 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m12:08:33.803350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:33.805864 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp120833796969"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by sales_day, sales_month
order by sales_day
  );
  
  
[0m12:08:33.808356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:34.072933 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.264 seconds
[0m12:08:34.079134 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.080137 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m12:08:34.082132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:08:34.083129 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.084638 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp120833796969'
        
      order by ordinal_position

  
[0m12:08:34.110812 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m12:08:34.117493 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.118491 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.126511 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:08:34.133958 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.134572 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.141701 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m12:08:34.154447 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m12:08:34.159445 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.160467 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp120833796969"
    )


  
[0m12:08:34.163459 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m12:08:34.167000 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m12:08:34.169074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m12:08:34.170590 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m12:08:34.173579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:34.175086 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m12:08:34.177088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142518C88D0>]}
[0m12:08:34.180170 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public.mart_sales_summary ............. [[32mINSERT 0 10[0m in 0.40s]
[0m12:08:34.183692 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m12:08:34.185691 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m12:08:34.187686 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public.mart_top_customers ................. [RUN]
[0m12:08:34.189885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m12:08:34.192178 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m12:08:34.201130 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m12:08:34.205688 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m12:08:34.216694 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.217664 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp120834212663"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m12:08:34.218689 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:34.481284 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.263 seconds
[0m12:08:34.492841 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.494354 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m12:08:34.497087 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:08:34.498243 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.499446 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp120834212663'
        
      order by ordinal_position

  
[0m12:08:34.525112 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.024 seconds
[0m12:08:34.533289 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.534798 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.541775 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:08:34.547931 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.549897 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.557474 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m12:08:34.561471 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m12:08:34.567012 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.568527 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp120834212663" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp120834212663"
    )
  
[0m12:08:34.573337 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m12:08:34.576365 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m12:08:34.578332 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m12:08:34.579356 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m12:08:34.582320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:34.584907 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m12:08:34.586938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014253198910>]}
[0m12:08:34.587902 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.40s]
[0m12:08:34.591830 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m12:08:34.593828 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m12:08:34.595907 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public.mart_invoice ....................... [RUN]
[0m12:08:34.599282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m12:08:34.601280 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m12:08:34.610319 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m12:08:34.614409 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m12:08:34.623783 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.624795 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp120834619452"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m12:08:34.626833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:34.901972 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.275 seconds
[0m12:08:34.908732 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.910723 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m12:08:34.913308 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m12:08:34.914818 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.916848 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp120834619452'
        
      order by ordinal_position

  
[0m12:08:34.945078 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.027 seconds
[0m12:08:34.952876 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.955406 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.962530 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m12:08:34.969504 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.970503 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m12:08:34.978238 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m12:08:34.984739 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m12:08:34.990310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:34.991464 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp120834619452" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp120834619452"
    )
  
[0m12:08:34.996875 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m12:08:35.001370 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m12:08:35.003361 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m12:08:35.004864 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m12:08:35.006865 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:08:35.009336 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m12:08:35.011338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17007a13-b637-469e-ad8d-12cea5a1c080', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142532D3E10>]}
[0m12:08:35.013334 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.41s]
[0m12:08:35.017121 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m12:08:35.020983 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:35.023027 [debug] [MainThread]: On master: BEGIN
[0m12:08:35.025700 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:35.291061 [debug] [MainThread]: SQL status: BEGIN in 0.266 seconds
[0m12:08:35.293466 [debug] [MainThread]: On master: COMMIT
[0m12:08:35.294806 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:35.295841 [debug] [MainThread]: On master: COMMIT
[0m12:08:35.296834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:35.297838 [debug] [MainThread]: On master: Close
[0m12:08:35.299831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:35.300795 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m12:08:35.302814 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m12:08:35.302814 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m12:08:35.305355 [info ] [MainThread]: 
[0m12:08:35.307444 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m12:08:35.315293 [debug] [MainThread]: Command end result
[0m12:08:35.390393 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:08:35.399432 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:08:35.417184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:08:35.418191 [info ] [MainThread]: 
[0m12:08:35.420387 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:35.422921 [info ] [MainThread]: 
[0m12:08:35.424432 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:08:35.427721 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:35.427721 after 10.19 seconds
[0m12:08:35.429881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142513F3190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424AF1FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424AF1F3D0>]}
[0m12:08:35.431876 [debug] [MainThread]: Flushing usage events
[0m12:08:36.758499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:47.033177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0B76750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0B58E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0B58E10>]}


============================== 12:08:47.042819 | 6f1884d1-19a8-40d7-8a17-8edc47f5e06c ==============================
[0m12:08:47.042819 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:08:47.045338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:08:47.528130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0CD53D0>]}
[0m12:08:47.649519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EED7774D0>]}
[0m12:08:47.652511 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:48.513788 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:08:49.032240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:08:49.032749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:08:49.175269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0CC4E10>]}
[0m12:08:49.415759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:08:49.427126 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:08:49.522751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF22DBCD0>]}
[0m12:08:49.523747 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m12:08:49.526190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0B9FF10>]}
[0m12:08:49.529998 [info ] [MainThread]: 
[0m12:08:49.532959 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:08:49.536964 [info ] [MainThread]: 
[0m12:08:49.540045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:49.556825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m12:08:49.959164 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:08:49.960885 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:08:49.962240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:50.222859 [debug] [ThreadPool]: SQL status: BEGIN in 0.261 seconds
[0m12:08:50.224376 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:08:50.225408 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:08:50.237465 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m12:08:50.240496 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:08:50.241528 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:08:50.244363 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m12:08:50.250544 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:08:50.252060 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:08:50.253053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:08:50.489225 [debug] [ThreadPool]: SQL status: BEGIN in 0.237 seconds
[0m12:08:50.491501 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:08:50.492507 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:08:50.503874 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m12:08:50.508207 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:08:50.509245 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:08:50.528289 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:50.529323 [debug] [MainThread]: On master: BEGIN
[0m12:08:50.530364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:50.758869 [debug] [MainThread]: SQL status: BEGIN in 0.229 seconds
[0m12:08:50.761334 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:50.762348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:50.805412 [debug] [MainThread]: SQL status: SELECT 6 in 0.043 seconds
[0m12:08:50.812190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f1884d1-19a8-40d7-8a17-8edc47f5e06c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF1ECAA90>]}
[0m12:08:50.813187 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:50.814696 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:50.815803 [debug] [MainThread]: On master: BEGIN
[0m12:08:50.817821 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:08:50.819815 [debug] [MainThread]: On master: COMMIT
[0m12:08:50.820813 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:50.821811 [debug] [MainThread]: On master: COMMIT
[0m12:08:50.824109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:50.824615 [debug] [MainThread]: On master: Close
[0m12:08:50.834579 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:08:50.836941 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m12:08:50.839052 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m12:08:50.840064 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:08:50.878149 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m12:08:50.883142 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:08:50.920796 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m12:08:50.925892 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m12:08:50.927082 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m12:08:50.928403 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:51.160190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m12:08:51.162299 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m12:08:51.163763 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m12:08:51.169171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:08:51.177485 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m12:08:51.179285 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m12:08:51.181321 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.34s]
[0m12:08:51.184536 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:08:51.186558 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:08:51.188557 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m12:08:51.192237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m12:08:51.193865 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:08:51.208121 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m12:08:51.213427 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:08:51.222462 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m12:08:51.226932 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m12:08:51.228927 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m12:08:51.230921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:51.465201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.235 seconds
[0m12:08:51.467208 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m12:08:51.468204 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m12:08:51.473260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:08:51.477802 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m12:08:51.479228 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m12:08:51.481580 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.29s]
[0m12:08:51.483817 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:08:51.486325 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:08:51.488327 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m12:08:51.490322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m12:08:51.492422 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:08:51.501850 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m12:08:51.512466 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:08:51.520100 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m12:08:51.524304 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m12:08:51.526473 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m12:08:51.527893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:51.772894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m12:08:51.774423 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m12:08:51.774952 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m12:08:51.779564 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:51.783561 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m12:08:51.785070 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m12:08:51.787072 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.30s]
[0m12:08:51.790456 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:08:51.793141 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:08:51.794809 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m12:08:51.797401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m12:08:51.799943 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:08:51.808486 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m12:08:51.812480 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:08:51.820319 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m12:08:51.825043 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m12:08:51.827037 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m12:08:51.830029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:52.114381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.284 seconds
[0m12:08:52.116576 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m12:08:52.117919 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m12:08:52.123478 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:52.128536 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m12:08:52.130574 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m12:08:52.132568 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.34s]
[0m12:08:52.135719 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:08:52.137373 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:08:52.140357 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patient_id .................... [RUN]
[0m12:08:52.144591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m12:08:52.146620 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:08:52.159938 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m12:08:52.165868 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:08:52.172100 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m12:08:52.177642 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m12:08:52.179637 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: BEGIN
[0m12:08:52.180650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:52.462545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.282 seconds
[0m12:08:52.464541 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m12:08:52.466061 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "propharma"."public"."patients"
where patient_id is null



      
    ) dbt_internal_test
[0m12:08:52.470062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:52.474455 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: ROLLBACK
[0m12:08:52.475743 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: Close
[0m12:08:52.478755 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_raw_tables_pat_patient_id .......................... [[32mPASS[0m in 0.33s]
[0m12:08:52.482501 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:08:52.484517 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:08:52.487516 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescription_id ............... [RUN]
[0m12:08:52.489798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m12:08:52.492455 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:08:52.501468 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m12:08:52.505971 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:08:52.515247 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m12:08:52.521090 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m12:08:52.523227 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: BEGIN
[0m12:08:52.526152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:52.804518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.278 seconds
[0m12:08:52.806925 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m12:08:52.808376 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescription_id
from "propharma"."public"."prescriptions"
where prescription_id is null



      
    ) dbt_internal_test
[0m12:08:52.812827 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:52.816064 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: ROLLBACK
[0m12:08:52.818467 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: Close
[0m12:08:52.819563 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_raw_tables_pre_prescription_id ..................... [[32mPASS[0m in 0.33s]
[0m12:08:52.822873 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:08:52.825523 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:08:52.826525 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sale_id ....................... [RUN]
[0m12:08:52.828580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m12:08:52.831271 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:08:52.844281 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m12:08:52.849801 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:08:52.859419 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m12:08:52.864410 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m12:08:52.867103 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: BEGIN
[0m12:08:52.868137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:53.133835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.265 seconds
[0m12:08:53.135912 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m12:08:53.136916 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "propharma"."public"."sales"
where sale_id is null



      
    ) dbt_internal_test
[0m12:08:53.141369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:53.145057 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: ROLLBACK
[0m12:08:53.147078 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: Close
[0m12:08:53.149242 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_raw_tables_sal_sale_id ............................. [[32mPASS[0m in 0.32s]
[0m12:08:53.153100 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:08:53.155643 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:08:53.157637 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_supplier_id ................... [RUN]
[0m12:08:53.160636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m12:08:53.163011 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:08:53.176027 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m12:08:53.182210 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:08:53.193443 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m12:08:53.198642 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m12:08:53.200638 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: BEGIN
[0m12:08:53.202715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:08:53.468309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.266 seconds
[0m12:08:53.470329 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m12:08:53.472323 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from "propharma"."public"."suppliers"
where supplier_id is null



      
    ) dbt_internal_test
[0m12:08:53.477315 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m12:08:53.480644 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: ROLLBACK
[0m12:08:53.481721 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: Close
[0m12:08:53.483781 [info ] [Thread-1 (]: 8 of 8 PASS source_not_null_raw_tables_sup_supplier_id ......................... [[32mPASS[0m in 0.32s]
[0m12:08:53.487794 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:08:53.491970 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:53.492968 [debug] [MainThread]: On master: BEGIN
[0m12:08:53.495802 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:53.760828 [debug] [MainThread]: SQL status: BEGIN in 0.265 seconds
[0m12:08:53.762844 [debug] [MainThread]: On master: COMMIT
[0m12:08:53.762844 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:53.764353 [debug] [MainThread]: On master: COMMIT
[0m12:08:53.766373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:53.768633 [debug] [MainThread]: On master: Close
[0m12:08:53.769630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:53.771625 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m12:08:53.772622 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd' was properly closed.
[0m12:08:53.774623 [info ] [MainThread]: 
[0m12:08:53.776822 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 4.24 seconds (4.24s).
[0m12:08:53.784390 [debug] [MainThread]: Command end result
[0m12:08:53.926766 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:08:53.934026 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:08:53.951035 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:08:53.953931 [info ] [MainThread]: 
[0m12:08:53.955941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:53.958926 [info ] [MainThread]: 
[0m12:08:53.961919 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m12:08:53.966132 [debug] [MainThread]: Command `dbt test` succeeded at 12:08:53.966132 after 7.28 seconds
[0m12:08:53.968134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EF0673310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EEA19FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026EEA19F350>]}
[0m12:08:53.971131 [debug] [MainThread]: Flushing usage events
[0m12:08:54.940654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:03.782253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803EDD7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803EDD6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803EDB5ED0>]}


============================== 12:09:03.790770 | 399464b6-2cfe-4a3a-8dcc-77cc558cefcf ==============================
[0m12:09:03.790770 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:09:03.793187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:04.235178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803BC71410>]}
[0m12:09:04.361716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803BA07610>]}
[0m12:09:04.366389 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:09:05.229495 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:09:05.853057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:05.854568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:06.027485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028040230BD0>]}
[0m12:09:06.110435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002804040BF90>]}
[0m12:09:06.112468 [info ] [MainThread]: Found 1 seed, 1 snapshot, 8 data tests, 11 models, 6 sources, 435 macros
[0m12:09:06.115880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028040153990>]}
[0m12:09:06.123672 [info ] [MainThread]: 
[0m12:09:06.125749 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:09:06.129702 [info ] [MainThread]: 
[0m12:09:06.133379 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:06.160812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m12:09:06.694785 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:09:06.696832 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m12:09:06.697838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:06.950298 [debug] [ThreadPool]: SQL status: BEGIN in 0.253 seconds
[0m12:09:06.951542 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m12:09:06.953004 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m12:09:06.967087 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.014 seconds
[0m12:09:06.970874 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m12:09:06.972968 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m12:09:06.975905 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m12:09:06.982810 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:09:06.983807 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m12:09:06.985311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:07.217306 [debug] [ThreadPool]: SQL status: BEGIN in 0.232 seconds
[0m12:09:07.218662 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m12:09:07.219663 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:09:07.231289 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m12:09:07.234793 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m12:09:07.236824 [debug] [ThreadPool]: On list_propharma_public: Close
[0m12:09:07.257637 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:07.258634 [debug] [MainThread]: On master: BEGIN
[0m12:09:07.260425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:07.484313 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m12:09:07.485398 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:07.487704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:07.532293 [debug] [MainThread]: SQL status: SELECT 6 in 0.043 seconds
[0m12:09:07.539132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '399464b6-2cfe-4a3a-8dcc-77cc558cefcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028040751C50>]}
[0m12:09:07.540290 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:07.540817 [debug] [MainThread]: On master: Close
[0m12:09:07.551417 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m12:09:07.553796 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m12:09:07.554870 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m12:09:07.572793 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m12:09:07.575831 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m12:09:07.578864 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m12:09:07.579404 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m12:09:07.581807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m12:09:07.582870 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m12:09:07.589467 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m12:09:07.593140 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m12:09:07.595672 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m12:09:07.596669 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m12:09:07.598847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m12:09:07.599850 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m12:09:07.606837 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m12:09:07.611319 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m12:09:07.613785 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m12:09:07.614796 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m12:09:07.616705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m12:09:07.618011 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m12:09:07.624547 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m12:09:07.628447 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m12:09:07.629960 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m12:09:07.630955 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m12:09:07.632878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m12:09:07.634392 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m12:09:07.641329 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m12:09:07.645944 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m12:09:07.647948 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m12:09:07.649457 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m12:09:07.650463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m12:09:07.651632 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m12:09:07.658743 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m12:09:07.662704 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m12:09:07.664716 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m12:09:07.666705 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m12:09:07.667707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m12:09:07.669378 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m12:09:07.674594 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m12:09:07.676972 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m12:09:07.678985 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:09:07.680533 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4)
[0m12:09:07.682258 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:09:07.698418 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m12:09:07.702409 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:09:07.704909 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m12:09:07.705910 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:09:07.707906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m12:09:07.709416 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:09:07.732387 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m12:09:07.735575 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:09:07.737392 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m12:09:07.739453 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:09:07.740485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m12:09:07.742175 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:09:07.751373 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m12:09:07.755190 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:09:07.757185 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m12:09:07.758891 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:09:07.759427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m12:09:07.760750 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:09:07.769251 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m12:09:07.772244 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:09:07.774805 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m12:09:07.776803 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:09:07.778802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m12:09:07.780797 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:09:07.790291 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m12:09:07.794081 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:09:07.795920 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m12:09:07.796926 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:09:07.798840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m12:09:07.800040 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:09:07.809041 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m12:09:07.813208 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:09:07.816210 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m12:09:07.817204 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:09:07.819199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m12:09:07.820198 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:09:07.830721 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m12:09:07.834774 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:09:07.836976 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m12:09:07.838104 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:09:07.840155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m12:09:07.841172 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:09:07.848793 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m12:09:07.852858 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:09:07.855406 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m12:09:07.857401 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m12:09:07.858397 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd, now model.Propharma.mart_expired_drugs)
[0m12:09:07.860396 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m12:09:07.870885 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m12:09:07.875677 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m12:09:07.877671 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m12:09:07.878667 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m12:09:07.879877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m12:09:07.882027 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m12:09:07.888329 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m12:09:07.893917 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m12:09:07.895581 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m12:09:07.897694 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m12:09:07.898721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now snapshot.Propharma.snapshot_prescriptions)
[0m12:09:07.899718 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m12:09:07.906521 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m12:09:07.908575 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m12:09:07.910570 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m12:09:07.912564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m12:09:07.913561 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m12:09:07.919568 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m12:09:07.924064 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m12:09:07.926641 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m12:09:07.928691 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m12:09:07.929707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m12:09:07.930897 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m12:09:07.938607 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m12:09:07.942057 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m12:09:07.944591 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m12:09:07.945615 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m12:09:07.946979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m12:09:07.948066 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m12:09:07.959578 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m12:09:07.965405 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m12:09:07.967407 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m12:09:07.969915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:07.971422 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m12:09:07.972420 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m12:09:07.980133 [debug] [MainThread]: Command end result
[0m12:09:08.217909 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:09:08.229729 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:09:08.553454 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m12:09:08.581473 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:09:08.583469 [info ] [MainThread]: Building catalog
[0m12:09:08.614848 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m12:09:08.635626 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m12:09:08.636623 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m12:09:08.638618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:09.047409 [debug] [ThreadPool]: SQL status: BEGIN in 0.409 seconds
[0m12:09:09.048761 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m12:09:09.049799 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_invoice')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:09:09.081484 [debug] [ThreadPool]: SQL status: SELECT 99 in 0.029 seconds
[0m12:09:09.097896 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m12:09:09.098893 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m12:09:09.141208 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m12:09:09.210413 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m12:09:09.216907 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m12:09:09.218906 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m12:09:09.222895 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:09:09.222895 after 5.71 seconds
[0m12:09:09.224403 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:09:09.225409 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m12:09:09.227443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002803DFA3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280384AFF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280384AF2D0>]}
[0m12:09:09.228541 [debug] [MainThread]: Flushing usage events
[0m12:09:10.252742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:18.472717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263966E1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263966EF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026396742B10>]}


============================== 12:09:18.480330 | f362f001-a0ea-4caf-8a67-f2d6c6a05e05 ==============================
[0m12:09:18.480330 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:09:18.483398 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:09:18.923377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f362f001-a0ea-4caf-8a67-f2d6c6a05e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263968BB510>]}
[0m12:09:19.046845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f362f001-a0ea-4caf-8a67-f2d6c6a05e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026393335FD0>]}
[0m19:47:12.917029 [error] [MainThread]: Encountered an error:

[0m19:47:12.988248 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\anisin06\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:47:13.009480 [debug] [MainThread]: Command `dbt docs serve` failed at 19:47:13.007322 after 286686.47 seconds
[0m19:47:13.016014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026396742310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026396720ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263966EF090>]}
[0m19:47:13.023190 [debug] [MainThread]: Flushing usage events
[0m19:47:14.207604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:24.602865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E37311790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E37355050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E37354E10>]}


============================== 19:47:24.612434 | 57914377-2ff6-4e16-931b-eaafcdc1f0f9 ==============================
[0m19:47:24.612434 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:47:24.615427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:47:25.117205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57914377-2ff6-4e16-931b-eaafcdc1f0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3751EAD0>]}
[0m19:47:25.228983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57914377-2ff6-4e16-931b-eaafcdc1f0f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E3744D910>]}
[0m19:47:25.232936 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:47:26.078518 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:47:26.082508 [debug] [MainThread]: Command `dbt run` failed at 19:47:26.082508 after 1.78 seconds
[0m19:47:26.084503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E36F83190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E30A0FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E36F73B10>]}
[0m19:47:26.085683 [debug] [MainThread]: Flushing usage events
[0m19:47:27.097108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:47:53.195244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027638D214D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276388B4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027638993310>]}


============================== 19:47:53.204127 | 5665d009-4ae8-43b2-9640-62930db59474 ==============================
[0m19:47:53.204127 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:47:53.206232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:47:53.511534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5665d009-4ae8-43b2-9640-62930db59474', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027638E60190>]}
[0m19:47:53.606409 [debug] [MainThread]: Set downloads directory='C:\Users\anisin06\AppData\Local\Temp\dbt-downloads-3j3vweii'
[0m19:47:53.609349 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:47:54.026637 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:47:54.028637 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:47:54.110469 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:47:54.140202 [info ] [MainThread]: Updating lock file in file path: C:\Users\anisin06\Downloads\Propharma/package-lock.yml
[0m19:47:54.147989 [debug] [MainThread]: Set downloads directory='C:\Users\anisin06\AppData\Local\Temp\dbt-downloads-q1si6ein'
[0m19:47:54.155844 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:47:56.112336 [info ] [MainThread]: Installed from version 1.3.0
[0m19:47:56.114749 [info ] [MainThread]: Up to date!
[0m19:47:56.117497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5665d009-4ae8-43b2-9640-62930db59474', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027638DD5F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027638DAEF50>]}
[0m19:47:56.124080 [debug] [MainThread]: Command `dbt deps` succeeded at 19:47:56.123078 after 3.19 seconds
[0m19:47:56.125257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276324BFF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276324BF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276324BF390>]}
[0m19:47:56.126259 [debug] [MainThread]: Flushing usage events
[0m19:47:57.279499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:27.225273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A066AE32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A066ED7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A066A08650>]}


============================== 19:48:27.234248 | f8812e37-23ac-4b11-85b6-a691a03a6722 ==============================
[0m19:48:27.234248 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:48:27.236643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:48:27.705550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8812e37-23ac-4b11-85b6-a691a03a6722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0670753D0>]}
[0m19:48:27.823511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8812e37-23ac-4b11-85b6-a691a03a6722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A063B0F1D0>]}
[0m19:48:27.827501 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:48:28.751644 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:48:29.024627 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:48:29.026811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f8812e37-23ac-4b11-85b6-a691a03a6722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0660D7B10>]}
[0m19:48:31.872306 [error] [MainThread]: Encountered an error:
Compilation Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  invalid syntax for function call expression
    line 12
      {{ dbt_utils.group_by(n=1,2) }}
[0m19:48:31.877691 [debug] [MainThread]: Command `dbt run` failed at 19:48:31.876332 after 4.95 seconds
[0m19:48:31.879692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A066EB4950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0605AFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A066A08610>]}
[0m19:48:31.881935 [debug] [MainThread]: Flushing usage events
[0m19:48:32.960483 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:52:23.749400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505FEE1B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505FEE1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505FEE3A90>]}


============================== 19:52:23.760369 | d7882d5a-6153-4f8b-ad9c-9d75e4bb5089 ==============================
[0m19:52:23.760369 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:52:23.763590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:52:24.231824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250600DFF90>]}
[0m19:52:24.358507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505CB67D50>]}
[0m19:52:24.362018 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:52:25.338768 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:52:25.643378 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:52:25.645565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505F133B10>]}
[0m19:52:30.705995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250619D1910>]}
[0m19:52:30.987097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m19:52:31.003490 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m19:52:31.094442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025061B4AB10>]}
[0m19:52:31.095746 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m19:52:31.098621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250619E8C90>]}
[0m19:52:31.103478 [info ] [MainThread]: 
[0m19:52:31.106038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:52:31.109404 [info ] [MainThread]: 
[0m19:52:31.112991 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:52:31.129478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m19:52:31.753687 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m19:52:31.754722 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m19:52:31.755918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:32.162642 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.406 seconds
[0m19:52:32.165639 [debug] [ThreadPool]: On list_propharma: Close
[0m19:52:32.170698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m19:52:32.185007 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m19:52:32.187020 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m19:52:32.188035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:52:32.421739 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m19:52:32.422700 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m19:52:32.424694 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:52:32.436719 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.012 seconds
[0m19:52:32.440674 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m19:52:32.441671 [debug] [ThreadPool]: On list_propharma_public: Close
[0m19:52:32.443665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m19:52:32.456152 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m19:52:32.457144 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m19:52:32.458470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:52:32.673441 [debug] [ThreadPool]: SQL status: BEGIN in 0.216 seconds
[0m19:52:32.676014 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m19:52:32.677224 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:52:32.687267 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m19:52:32.690700 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m19:52:32.691710 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m19:52:32.703856 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:32.704854 [debug] [MainThread]: On master: BEGIN
[0m19:52:32.706850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:52:32.923269 [debug] [MainThread]: SQL status: BEGIN in 0.216 seconds
[0m19:52:32.924263 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:32.925486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:52:32.982741 [debug] [MainThread]: SQL status: SELECT 6 in 0.056 seconds
[0m19:52:32.989149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250619A5190>]}
[0m19:52:32.990147 [debug] [MainThread]: On master: ROLLBACK
[0m19:52:32.992145 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:32.993140 [debug] [MainThread]: On master: BEGIN
[0m19:52:32.994431 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:52:32.996856 [debug] [MainThread]: On master: COMMIT
[0m19:52:32.997853 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:32.999497 [debug] [MainThread]: On master: COMMIT
[0m19:52:33.000534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:52:33.001529 [debug] [MainThread]: On master: Close
[0m19:52:33.019648 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m19:52:33.021651 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_inventory .............................. [RUN]
[0m19:52:33.023664 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m19:52:33.024662 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m19:52:33.126675 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m19:52:33.130666 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m19:52:33.197067 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m19:52:33.201021 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.202053 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m19:52:33.203560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:52:33.428738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m19:52:33.429768 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.431762 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m19:52:33.444169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m19:52:33.456100 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.458133 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m19:52:33.460122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:33.466789 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.467785 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m19:52:33.469816 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:33.500777 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m19:52:33.502733 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.502733 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m19:52:33.513594 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:52:33.527097 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m19:52:33.536553 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:52:33.537558 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m19:52:33.542158 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:52:33.547193 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m19:52:33.553138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505D70BE10>]}
[0m19:52:33.554167 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.53s]
[0m19:52:33.557014 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m19:52:33.558701 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m19:52:33.560701 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_medicines .............................. [RUN]
[0m19:52:33.562643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m19:52:33.563726 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m19:52:33.571679 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m19:52:33.576867 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m19:52:33.585876 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m19:52:33.590280 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.591276 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m19:52:33.593269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:33.851975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.259 seconds
[0m19:52:33.854135 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.856584 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m19:52:33.868628 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m19:52:33.878956 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.879968 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m19:52:33.883317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:33.895754 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.898101 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m19:52:33.900369 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:33.902805 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m19:52:33.905736 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.907736 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m19:52:33.918570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:52:33.927310 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m19:52:33.929926 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:52:33.930935 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m19:52:33.935451 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:52:33.940087 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m19:52:33.942149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025061752C90>]}
[0m19:52:33.944170 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.38s]
[0m19:52:33.948054 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m19:52:33.950452 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m19:52:33.951630 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_patients ............................... [RUN]
[0m19:52:33.954977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m19:52:33.957969 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m19:52:33.969217 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m19:52:33.975700 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m19:52:33.985324 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m19:52:33.991611 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:33.992608 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m19:52:33.994743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:34.338374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.343 seconds
[0m19:52:34.339840 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:34.341347 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m19:52:34.351864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:52:34.358845 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:34.359842 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m19:52:34.361838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:34.368818 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:34.369816 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m19:52:34.371811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:34.374803 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m19:52:34.376797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:34.377794 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m19:52:34.380787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:52:34.385773 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m19:52:34.387768 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:52:34.388766 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m19:52:34.392758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:52:34.395750 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m19:52:34.396747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250616ED510>]}
[0m19:52:34.398743 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.44s]
[0m19:52:34.402222 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m19:52:34.403364 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m19:52:34.404990 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_prescriptions .......................... [RUN]
[0m19:52:34.407114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m19:52:34.408294 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m19:52:34.415198 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m19:52:34.420849 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m19:52:34.429546 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m19:52:34.433935 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.435395 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m19:52:34.436594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:34.666366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m19:52:34.667363 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.669358 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m19:52:34.678404 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m19:52:34.688376 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.690375 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m19:52:34.692407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:34.698545 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.699583 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m19:52:34.701920 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:34.704953 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m19:52:34.705495 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.707354 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m19:52:34.717765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:52:34.722768 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m19:52:34.724542 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:52:34.726586 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m19:52:34.729536 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:52:34.732977 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m19:52:34.734975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025061561410>]}
[0m19:52:34.736544 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m19:52:34.739689 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m19:52:34.740686 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m19:52:34.741683 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m19:52:34.744163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m19:52:34.746324 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m19:52:34.753389 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m19:52:34.757683 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m19:52:34.766499 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m19:52:34.769990 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:34.771989 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m19:52:34.772988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:35.027618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.254 seconds
[0m19:52:35.029129 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:35.030126 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m19:52:35.043129 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m19:52:35.049922 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:35.051929 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:52:35.054326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:35.062431 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:35.064778 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:52:35.067298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:35.071639 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m19:52:35.074116 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:35.075935 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m19:52:35.087256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:52:35.094521 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m19:52:35.095525 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:52:35.098371 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m19:52:35.101989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:52:35.107182 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m19:52:35.110217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505EBE2E50>]}
[0m19:52:35.112217 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m19:52:35.115213 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m19:52:35.117348 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m19:52:35.118366 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_suppliers .............................. [RUN]
[0m19:52:35.122375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m19:52:35.125060 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m19:52:35.133002 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m19:52:35.137994 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m19:52:35.150423 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m19:52:35.156833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.158345 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m19:52:35.159344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:35.420225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.260 seconds
[0m19:52:35.421228 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.422224 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m19:52:35.439834 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m19:52:35.450073 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.452447 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m19:52:35.454488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:35.461326 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.463321 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m19:52:35.465629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:52:35.468593 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m19:52:35.470420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.472167 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m19:52:35.474753 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:52:35.479743 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m19:52:35.481738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:52:35.482735 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m19:52:35.486728 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m19:52:35.489840 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m19:52:35.491838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250610FCB10>]}
[0m19:52:35.493833 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.37s]
[0m19:52:35.496287 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m19:52:35.497292 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m19:52:35.499283 [info ] [Thread-1 (]: 7 of 11 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m19:52:35.501333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m19:52:35.502441 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m19:52:35.511456 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m19:52:35.514725 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m19:52:35.607298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:35.609294 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp195235575972"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m19:52:35.610291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:35.865812 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.256 seconds
[0m19:52:35.891999 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:35.892996 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m19:52:35.894993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:52:35.896986 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:35.897983 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp195235575972'
        
      order by ordinal_position

  
[0m19:52:35.924907 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.026 seconds
[0m19:52:35.935503 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:35.937550 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:35.944257 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m19:52:35.959419 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:35.961468 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:35.967787 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m19:52:35.997158 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m19:52:36.002149 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:36.004178 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp195235575972" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp195235575972"
    )
  
[0m19:52:36.008579 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:52:36.011539 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m19:52:36.012537 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:52:36.013534 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m19:52:36.019445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m19:52:36.021538 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m19:52:36.023583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002506181E610>]}
[0m19:52:36.025702 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.52s]
[0m19:52:36.029001 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m19:52:36.030217 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m19:52:36.031224 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m19:52:36.034001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m19:52:36.036422 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m19:52:36.047392 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m19:52:36.051824 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m19:52:36.061018 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.062033 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp195236056971"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m19:52:36.063054 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:36.290429 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.227 seconds
[0m19:52:36.297248 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.298247 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m19:52:36.299578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:52:36.301509 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.303048 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp195236056971'
        
      order by ordinal_position

  
[0m19:52:36.327707 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m19:52:36.336879 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.338874 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:36.346823 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m19:52:36.354119 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.355116 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:36.365089 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m19:52:36.370076 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m19:52:36.373857 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.374859 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp195236056971" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp195236056971"
    )
  
[0m19:52:36.379934 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:52:36.382376 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m19:52:36.383825 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:52:36.385214 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m19:52:36.387556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:52:36.390065 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m19:52:36.392073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002506131E550>]}
[0m19:52:36.394082 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.36s]
[0m19:52:36.397730 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m19:52:36.399817 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m19:52:36.400822 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public.mart_sales_summary .................. [RUN]
[0m19:52:36.403037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m19:52:36.405337 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m19:52:36.412831 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m19:52:36.415972 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m19:52:36.426520 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:52:36.428966 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp195236422036"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
#group by sales_day, sales_month
order by sales_day
  );
  
  
[0m19:52:36.429971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:36.747957 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "group"
LINE 23: #group by sales_day, sales_month
          ^

[0m19:52:36.749966 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m19:52:36.769605 [debug] [Thread-1 (]: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near "group"
  LINE 23: #group by sales_day, sales_month
            ^
[0m19:52:36.771570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025061852050>]}
[0m19:52:36.772600 [error] [Thread-1 (]: 9 of 11 ERROR creating sql incremental model public.mart_sales_summary ......... [[31mERROR[0m in 0.37s]
[0m19:52:36.775033 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m19:52:36.777075 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m19:52:36.778135 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.mart_sales_summary' to be skipped because of status 'error'.  Reason: Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near "group"
  LINE 23: #group by sales_day, sales_month
            ^.
[0m19:52:36.778687 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public.mart_top_customers ................. [RUN]
[0m19:52:36.782902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m19:52:36.784902 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m19:52:36.792879 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m19:52:36.796873 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m19:52:36.805733 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:36.807698 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp195236802012"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m19:52:36.808718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:37.048558 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.239 seconds
[0m19:52:37.057497 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.059493 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m19:52:37.061715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:52:37.063319 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.065318 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp195236802012'
        
      order by ordinal_position

  
[0m19:52:37.091015 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m19:52:37.097001 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.098996 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:37.105874 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m19:52:37.112327 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.114323 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:37.121669 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m19:52:37.125658 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m19:52:37.129650 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.131646 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp195236802012" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp195236802012"
    )
  
[0m19:52:37.135632 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:52:37.138672 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m19:52:37.140663 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:52:37.141665 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m19:52:37.146855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:52:37.149578 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m19:52:37.151577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250613DBA50>]}
[0m19:52:37.152574 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.37s]
[0m19:52:37.155996 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m19:52:37.157989 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m19:52:37.160474 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public.mart_invoice ....................... [RUN]
[0m19:52:37.162947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m19:52:37.164204 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m19:52:37.173031 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m19:52:37.177399 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m19:52:37.188287 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.189322 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp195237184889"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m19:52:37.190327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:52:37.433179 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.243 seconds
[0m19:52:37.439458 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.441447 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m19:52:37.443411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:52:37.444407 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.445406 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp195237184889'
        
      order by ordinal_position

  
[0m19:52:37.469232 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m19:52:37.476496 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.478125 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:37.485460 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m19:52:37.492473 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.493443 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:52:37.500464 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.005 seconds
[0m19:52:37.504454 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m19:52:37.508609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.509612 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp195237184889" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp195237184889"
    )
  
[0m19:52:37.513531 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:52:37.516523 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m19:52:37.517520 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:52:37.519487 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m19:52:37.521509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:52:37.524334 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m19:52:37.525339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7882d5a-6153-4f8b-ad9c-9d75e4bb5089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025061467710>]}
[0m19:52:37.527369 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.36s]
[0m19:52:37.529635 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m19:52:37.533106 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:37.534384 [debug] [MainThread]: On master: BEGIN
[0m19:52:37.536546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:52:37.757127 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m19:52:37.758734 [debug] [MainThread]: On master: COMMIT
[0m19:52:37.759771 [debug] [MainThread]: Using postgres connection "master"
[0m19:52:37.760769 [debug] [MainThread]: On master: COMMIT
[0m19:52:37.761766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:52:37.764179 [debug] [MainThread]: On master: Close
[0m19:52:37.765227 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:52:37.767091 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m19:52:37.768164 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m19:52:37.770712 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m19:52:37.771754 [info ] [MainThread]: 
[0m19:52:37.773850 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 6.66 seconds (6.66s).
[0m19:52:37.779767 [debug] [MainThread]: Command end result
[0m19:52:37.860350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m19:52:37.867057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m19:52:37.882789 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m19:52:37.884781 [info ] [MainThread]: 
[0m19:52:37.886776 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:52:37.888770 [info ] [MainThread]: 
[0m19:52:37.891793 [error] [MainThread]:   Database Error in model mart_sales_summary (models\marts\mart_sales_summary.sql)
  syntax error at or near "group"
  LINE 23: #group by sales_day, sales_month
            ^
[0m19:52:37.893757 [info ] [MainThread]: 
[0m19:52:37.896166 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:52:37.899918 [debug] [MainThread]: Command `dbt run` failed at 19:52:37.899918 after 14.45 seconds
[0m19:52:37.902546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002505FB42B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250598A9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250598A9650>]}
[0m19:52:37.904541 [debug] [MainThread]: Flushing usage events
[0m19:52:39.214052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:54:15.419453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C4186590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C4165010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C4165AD0>]}


============================== 19:54:15.427904 | b6795cb8-7ece-477e-8474-1ac8b1717d89 ==============================
[0m19:54:15.427904 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:54:15.429929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:54:15.875773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C4320650>]}
[0m19:54:15.991904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C0D87CD0>]}
[0m19:54:15.994856 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m19:54:16.851398 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:54:17.489878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:54:17.491904 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\mart_sales_summary.sql
[0m19:54:18.081240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C54C1BD0>]}
[0m19:54:18.310386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m19:54:18.321367 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m19:54:18.380993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C579BB10>]}
[0m19:54:18.382000 [info ] [MainThread]: Found 11 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m19:54:18.384301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5615F50>]}
[0m19:54:18.388698 [info ] [MainThread]: 
[0m19:54:18.391035 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:54:18.392034 [info ] [MainThread]: 
[0m19:54:18.395099 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:54:18.407288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m19:54:18.835121 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m19:54:18.836119 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m19:54:18.837334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:19.217036 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.380 seconds
[0m19:54:19.220027 [debug] [ThreadPool]: On list_propharma: Close
[0m19:54:19.225229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m19:54:19.237200 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m19:54:19.238197 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m19:54:19.239195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:19.472397 [debug] [ThreadPool]: SQL status: BEGIN in 0.233 seconds
[0m19:54:19.473358 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m19:54:19.474354 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:54:19.485365 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m19:54:19.489314 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m19:54:19.490311 [debug] [ThreadPool]: On list_propharma_public: Close
[0m19:54:19.493304 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m19:54:19.503505 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m19:54:19.504502 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m19:54:19.506465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:54:19.750147 [debug] [ThreadPool]: SQL status: BEGIN in 0.244 seconds
[0m19:54:19.751144 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m19:54:19.752142 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:54:19.763114 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m19:54:19.766104 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m19:54:19.768100 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m19:54:19.778072 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:19.780067 [debug] [MainThread]: On master: BEGIN
[0m19:54:19.781066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:20.009990 [debug] [MainThread]: SQL status: BEGIN in 0.229 seconds
[0m19:54:20.010945 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:20.011943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:54:20.055293 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m19:54:20.060276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5696DD0>]}
[0m19:54:20.061274 [debug] [MainThread]: On master: ROLLBACK
[0m19:54:20.063233 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:20.064232 [debug] [MainThread]: On master: BEGIN
[0m19:54:20.066229 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m19:54:20.067225 [debug] [MainThread]: On master: COMMIT
[0m19:54:20.068922 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:20.069928 [debug] [MainThread]: On master: COMMIT
[0m19:54:20.070925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:54:20.072921 [debug] [MainThread]: On master: Close
[0m19:54:20.082824 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m19:54:20.084443 [info ] [Thread-1 (]: 1 of 11 START sql view model public.stg_inventory .............................. [RUN]
[0m19:54:20.087441 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.stg_inventory'
[0m19:54:20.088467 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m19:54:20.104899 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m19:54:20.108925 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m19:54:20.204449 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m19:54:20.212573 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.215584 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m19:54:20.217584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:20.474288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m19:54:20.475296 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.477314 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m19:54:20.487371 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:20.500476 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.501479 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m19:54:20.503571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:20.510616 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.511622 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m19:54:20.513636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:20.543699 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m19:54:20.544743 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.546818 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m19:54:20.549343 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:54:20.561938 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m19:54:20.571495 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m19:54:20.572504 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m19:54:20.576675 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:20.580927 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m19:54:20.586383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5D47790>]}
[0m19:54:20.588375 [info ] [Thread-1 (]: 1 of 11 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.50s]
[0m19:54:20.591757 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m19:54:20.592753 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m19:54:20.593725 [info ] [Thread-1 (]: 2 of 11 START sql view model public.stg_medicines .............................. [RUN]
[0m19:54:20.595951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m19:54:20.598183 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m19:54:20.607384 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m19:54:20.610407 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m19:54:20.618460 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m19:54:20.622585 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.623585 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m19:54:20.625499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:20.850658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m19:54:20.853019 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.854026 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m19:54:20.863639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:20.871257 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.872264 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m19:54:20.874424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:20.880741 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.881744 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m19:54:20.884006 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:20.887381 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m19:54:20.888388 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.889420 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m19:54:20.894759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m19:54:20.900196 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m19:54:20.902222 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m19:54:20.903228 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m19:54:20.907091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:20.909890 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m19:54:20.911849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5D294D0>]}
[0m19:54:20.913843 [info ] [Thread-1 (]: 2 of 11 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m19:54:20.918082 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m19:54:20.919550 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m19:54:20.921896 [info ] [Thread-1 (]: 3 of 11 START sql view model public.stg_patients ............................... [RUN]
[0m19:54:20.924899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m19:54:20.925896 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m19:54:20.932910 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m19:54:20.937049 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m19:54:20.947053 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m19:54:20.951543 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:20.953785 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m19:54:20.954792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:21.172127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m19:54:21.173116 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:21.174113 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m19:54:21.183877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:21.191225 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:21.191769 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m19:54:21.194976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:21.200188 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:21.202236 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m19:54:21.203268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:21.206265 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m19:54:21.208224 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:21.209215 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m19:54:21.218831 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:54:21.224411 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m19:54:21.226374 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m19:54:21.228368 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m19:54:21.232046 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:21.235073 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m19:54:21.236039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5DC2690>]}
[0m19:54:21.238520 [info ] [Thread-1 (]: 3 of 11 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m19:54:21.241522 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m19:54:21.242519 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m19:54:21.244369 [info ] [Thread-1 (]: 4 of 11 START sql view model public.stg_prescriptions .......................... [RUN]
[0m19:54:21.246340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m19:54:21.247716 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m19:54:21.256732 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m19:54:21.261154 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m19:54:21.269313 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m19:54:21.273550 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.275538 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m19:54:21.276663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:21.629441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.353 seconds
[0m19:54:21.631826 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.633821 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m19:54:21.643100 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:21.650411 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.652373 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m19:54:21.653404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:21.660215 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.661209 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m19:54:21.663688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:21.666699 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m19:54:21.667735 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.668734 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m19:54:21.678781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:54:21.683964 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m19:54:21.685926 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m19:54:21.686957 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m19:54:21.690630 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:21.694012 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m19:54:21.695009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C55AFD90>]}
[0m19:54:21.697004 [info ] [Thread-1 (]: 4 of 11 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.45s]
[0m19:54:21.699956 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m19:54:21.701954 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m19:54:21.702951 [info ] [Thread-1 (]: 5 of 11 START sql view model public.stg_sales .................................. [RUN]
[0m19:54:21.706187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m19:54:21.708591 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m19:54:21.722325 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m19:54:21.726669 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m19:54:21.733655 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m19:54:21.737872 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:21.738991 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m19:54:21.741345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:22.054548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.314 seconds
[0m19:54:22.056537 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:22.057578 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m19:54:22.067059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:22.074048 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:22.075046 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m19:54:22.077491 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:22.084669 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:22.085709 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m19:54:22.087756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:22.089944 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m19:54:22.091993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:22.093048 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m19:54:22.102803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:54:22.108841 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m19:54:22.109839 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m19:54:22.111834 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m19:54:22.115415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:22.118004 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m19:54:22.119973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5D75690>]}
[0m19:54:22.121967 [info ] [Thread-1 (]: 5 of 11 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m19:54:22.124464 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m19:54:22.126789 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m19:54:22.128409 [info ] [Thread-1 (]: 6 of 11 START sql view model public.stg_suppliers .............................. [RUN]
[0m19:54:22.131406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m19:54:22.132408 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m19:54:22.139048 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m19:54:22.144583 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m19:54:22.152860 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m19:54:22.157845 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.159839 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m19:54:22.163828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:22.473264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.309 seconds
[0m19:54:22.474220 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.475256 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m19:54:22.485665 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m19:54:22.496585 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.497583 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m19:54:22.500793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:22.507297 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.508294 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m19:54:22.510248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:54:22.513043 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m19:54:22.514040 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.516004 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m19:54:22.518057 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:54:22.523661 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m19:54:22.524658 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m19:54:22.525653 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m19:54:22.529609 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m19:54:22.532631 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m19:54:22.534598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5DA0F10>]}
[0m19:54:22.536630 [info ] [Thread-1 (]: 6 of 11 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.40s]
[0m19:54:22.539565 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m19:54:22.540599 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m19:54:22.541743 [info ] [Thread-1 (]: 7 of 11 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m19:54:22.544024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.mart_expired_drugs)
[0m19:54:22.545019 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m19:54:22.556531 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m19:54:22.560488 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m19:54:22.643000 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:22.643994 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp195422612012"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m19:54:22.644993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:22.971455 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.326 seconds
[0m19:54:22.996360 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:22.998355 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m19:54:23.000382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:54:23.001347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:23.003342 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp195422612012'
        
      order by ordinal_position

  
[0m19:54:23.026354 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.022 seconds
[0m19:54:23.036302 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:23.038295 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.045310 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m19:54:23.059757 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:23.060755 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.068443 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m19:54:23.098047 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m19:54:23.102041 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:23.103034 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp195422612012" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp195422612012"
    )
  
[0m19:54:23.107058 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:54:23.111039 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m19:54:23.112040 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m19:54:23.113033 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m19:54:23.116008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m19:54:23.117993 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m19:54:23.119989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C59C6AD0>]}
[0m19:54:23.120986 [info ] [Thread-1 (]: 7 of 11 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.58s]
[0m19:54:23.124167 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m19:54:23.125857 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m19:54:23.128043 [info ] [Thread-1 (]: 8 of 11 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m19:54:23.131034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m19:54:23.133053 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m19:54:23.141313 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m19:54:23.144311 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m19:54:23.155181 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.157220 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp195423150276"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m19:54:23.159176 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:23.389064 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.230 seconds
[0m19:54:23.397995 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.398992 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m19:54:23.400985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:54:23.401984 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.403977 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp195423150276'
        
      order by ordinal_position

  
[0m19:54:23.427915 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m19:54:23.433898 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.435903 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.442850 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m19:54:23.449831 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.450829 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.457378 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m19:54:23.461320 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m19:54:23.465310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.466307 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp195423150276" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp195423150276"
    )
  
[0m19:54:23.471294 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:54:23.473396 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m19:54:23.475389 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m19:54:23.476387 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m19:54:23.479433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:54:23.481750 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m19:54:23.482751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C4293210>]}
[0m19:54:23.484746 [info ] [Thread-1 (]: 8 of 11 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.35s]
[0m19:54:23.488254 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m19:54:23.490252 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m19:54:23.491246 [info ] [Thread-1 (]: 9 of 11 START sql incremental model public.mart_sales_summary .................. [RUN]
[0m19:54:23.493495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m19:54:23.494589 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m19:54:23.504330 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m19:54:23.507293 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m19:54:23.516268 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.518591 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp195423512277"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m19:54:23.520909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:23.762952 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.243 seconds
[0m19:54:23.768967 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.770926 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m19:54:23.771924 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:54:23.773228 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.775228 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp195423512277'
        
      order by ordinal_position

  
[0m19:54:23.798973 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m19:54:23.804954 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.806914 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.813529 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m19:54:23.819545 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.821504 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:23.827524 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m19:54:23.839531 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m19:54:23.843522 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.845871 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp195423512277"
    )


  
[0m19:54:23.849234 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m19:54:23.852306 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m19:54:23.853338 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m19:54:23.854658 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m19:54:23.863982 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m19:54:23.866025 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m19:54:23.866980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C58A1410>]}
[0m19:54:23.869297 [info ] [Thread-1 (]: 9 of 11 OK created sql incremental model public.mart_sales_summary ............. [[32mINSERT 0 10[0m in 0.37s]
[0m19:54:23.872289 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m19:54:23.874283 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m19:54:23.877276 [info ] [Thread-1 (]: 10 of 11 START sql incremental model public.mart_top_customers ................. [RUN]
[0m19:54:23.879941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m19:54:23.881486 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m19:54:23.888463 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m19:54:23.892423 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m19:54:23.907058 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:23.908059 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp195423899390"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m19:54:23.909805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:24.152072 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.243 seconds
[0m19:54:24.159632 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.160932 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m19:54:24.163930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:54:24.165960 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.166951 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp195423899390'
        
      order by ordinal_position

  
[0m19:54:24.190791 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m19:54:24.197421 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.199380 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:24.205397 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m19:54:24.212379 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.213377 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:24.220395 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m19:54:24.224384 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m19:54:24.228373 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.229372 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp195423899390" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp195423899390"
    )
  
[0m19:54:24.233360 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:54:24.236352 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m19:54:24.237355 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m19:54:24.238353 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m19:54:24.248798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m19:54:24.251807 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m19:54:24.253319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C5E02910>]}
[0m19:54:24.255315 [info ] [Thread-1 (]: 10 of 11 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.37s]
[0m19:54:24.258304 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m19:54:24.260299 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m19:54:24.261296 [info ] [Thread-1 (]: 11 of 11 START sql incremental model public.mart_invoice ....................... [RUN]
[0m19:54:24.264288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m19:54:24.266320 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m19:54:24.275532 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m19:54:24.279506 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m19:54:24.288244 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.290580 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp195424284617"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m19:54:24.292117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:54:24.582073 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.290 seconds
[0m19:54:24.588089 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.589816 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m19:54:24.592497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m19:54:24.594233 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.595235 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp195424284617'
        
      order by ordinal_position

  
[0m19:54:24.619634 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m19:54:24.625998 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.628053 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:24.638069 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m19:54:24.644149 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.646167 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m19:54:24.656038 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m19:54:24.660077 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m19:54:24.664100 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.666095 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp195424284617" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp195424284617"
    )
  
[0m19:54:24.669341 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m19:54:24.672379 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m19:54:24.673427 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m19:54:24.675261 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m19:54:24.680291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m19:54:24.682929 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m19:54:24.684923 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6795cb8-7ece-477e-8474-1ac8b1717d89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224C61C3B10>]}
[0m19:54:24.686915 [info ] [Thread-1 (]: 11 of 11 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.42s]
[0m19:54:24.688913 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m19:54:24.693010 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:24.694018 [debug] [MainThread]: On master: BEGIN
[0m19:54:24.695821 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:54:24.948620 [debug] [MainThread]: SQL status: BEGIN in 0.253 seconds
[0m19:54:24.950614 [debug] [MainThread]: On master: COMMIT
[0m19:54:24.952123 [debug] [MainThread]: Using postgres connection "master"
[0m19:54:24.954125 [debug] [MainThread]: On master: COMMIT
[0m19:54:24.955124 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:54:24.956612 [debug] [MainThread]: On master: Close
[0m19:54:24.958067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:24.960068 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m19:54:24.961069 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m19:54:24.962062 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m19:54:24.964222 [info ] [MainThread]: 
[0m19:54:24.966182 [info ] [MainThread]: Finished running 5 incremental models, 6 view models in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m19:54:24.971199 [debug] [MainThread]: Command end result
[0m19:54:25.065222 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m19:54:25.073019 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m19:54:25.088220 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m19:54:25.090145 [info ] [MainThread]: 
[0m19:54:25.092980 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:54:25.094529 [info ] [MainThread]: 
[0m19:54:25.096848 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:54:25.101204 [debug] [MainThread]: Command `dbt run` succeeded at 19:54:25.101204 after 9.94 seconds
[0m19:54:25.103207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BD82FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BD82F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224BD82F350>]}
[0m19:54:25.105202 [debug] [MainThread]: Flushing usage events
[0m19:54:26.370234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:32.283348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859002710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859067150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859066C90>]}


============================== 20:20:32.291326 | 647ded1e-5a07-4331-8f29-f78e39d4c110 ==============================
[0m20:20:32.291326 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:20:32.294654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:32.746112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278592058D0>]}
[0m20:20:32.861938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027855C67C90>]}
[0m20:20:32.864929 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:20:33.767800 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:20:34.354447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m20:20:34.355447 [debug] [MainThread]: Partial parsing: added file: Propharma://models\cte\date_spine.sql
[0m20:20:34.357222 [debug] [MainThread]: Partial parsing: added file: Propharma://models\marts\expired_med_count_in_last_10_days.sql
[0m20:20:34.982288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A6CA850>]}
[0m20:20:35.210423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:20:35.220913 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:20:35.285746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A7ABB90>]}
[0m20:20:35.287742 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:20:35.289738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A7A73D0>]}
[0m20:20:35.294728 [info ] [MainThread]: 
[0m20:20:35.297747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:35.298744 [info ] [MainThread]: 
[0m20:20:35.300842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:35.314139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:20:35.836824 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:20:35.837822 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:20:35.839817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:36.224974 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.385 seconds
[0m20:20:36.228008 [debug] [ThreadPool]: On list_propharma: Close
[0m20:20:36.231960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:20:36.243655 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:20:36.244650 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:20:36.246609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:36.461763 [debug] [ThreadPool]: SQL status: BEGIN in 0.215 seconds
[0m20:20:36.462989 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:20:36.463495 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:20:36.475475 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m20:20:36.479500 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:20:36.480498 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:20:36.483177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:20:36.493197 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:20:36.494179 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:20:36.495509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:36.706639 [debug] [ThreadPool]: SQL status: BEGIN in 0.211 seconds
[0m20:20:36.707708 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:20:36.709057 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:20:36.720343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:20:36.724013 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:20:36.725557 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:20:36.735529 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:36.737524 [debug] [MainThread]: On master: BEGIN
[0m20:20:36.738521 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:36.956056 [debug] [MainThread]: SQL status: BEGIN in 0.217 seconds
[0m20:20:36.957024 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:36.958340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:37.001155 [debug] [MainThread]: SQL status: SELECT 6 in 0.042 seconds
[0m20:20:37.006548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A491990>]}
[0m20:20:37.007547 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:37.009546 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:37.010630 [debug] [MainThread]: On master: BEGIN
[0m20:20:37.012509 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:20:37.013804 [debug] [MainThread]: On master: COMMIT
[0m20:20:37.014810 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:37.015837 [debug] [MainThread]: On master: COMMIT
[0m20:20:37.017422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:37.018383 [debug] [MainThread]: On master: Close
[0m20:20:37.027640 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:20:37.029108 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:20:37.030105 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:20:37.067280 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:20:37.069238 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:20:37.070233 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:37.300610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m20:20:37.301606 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:20:37.302608 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:20:37.304602 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:20:37.308760 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:20:37.313891 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:20:37.314986 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:20:37.317499 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:20:37.319820 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:20:37.320837 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:20:37.324135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:20:37.325145 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:20:37.333429 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:20:37.338064 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:20:37.407799 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:20:37.411308 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.413452 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:20:37.414457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:37.654464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.240 seconds
[0m20:20:37.655957 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.657090 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:20:37.669507 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:20:37.685052 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.687048 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:20:37.689147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:37.696398 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.697414 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:20:37.699321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:37.730863 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:20:37.731867 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.732892 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:20:37.736772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:37.749411 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:20:37.757905 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:37.760311 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:20:37.764551 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:20:37.769646 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:20:37.774633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785ABB79D0>]}
[0m20:20:37.776627 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.45s]
[0m20:20:37.780014 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:20:37.782036 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:20:37.784417 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:20:37.786420 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:20:37.788414 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:20:37.795395 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:20:37.799285 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:20:37.807006 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:20:37.811429 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:37.812932 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:20:37.815430 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:38.049736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.234 seconds
[0m20:20:38.050853 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:38.052182 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:20:38.062160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:20:38.069789 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:38.070786 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:20:38.073538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.083119 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:38.088444 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:20:38.090481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.093386 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:20:38.095389 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:38.096398 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:20:38.098836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:38.104930 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:20:38.105925 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:38.107887 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:20:38.110920 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:38.114712 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:20:38.115711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785AC99CD0>]}
[0m20:20:38.117259 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:20:38.121046 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:20:38.122102 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:20:38.123112 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:20:38.125654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:20:38.126786 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:20:38.134545 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:20:38.137740 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:20:38.146693 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:20:38.150900 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.151903 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:20:38.152900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:38.375831 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m20:20:38.377315 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.379318 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:20:38.388289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:20:38.396441 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.397439 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:20:38.399855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.405876 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.406843 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:20:38.409133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.412292 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:20:38.413260 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.414288 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:20:38.417434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:38.423620 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:20:38.425040 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:20:38.426077 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:20:38.429507 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:38.432124 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:20:38.434452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785AC99B50>]}
[0m20:20:38.435453 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:20:38.438445 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:20:38.440444 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:20:38.441441 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:20:38.443394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:20:38.445035 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:20:38.452057 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:20:38.456200 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:20:38.466359 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:20:38.470324 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.472804 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:20:38.473876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:38.698091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:20:38.699079 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.700077 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:20:38.709759 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:20:38.717289 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.718325 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:20:38.720867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.729187 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.731181 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:20:38.732147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:38.735885 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:20:38.736848 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.737879 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:20:38.740715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:38.746303 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:20:38.748265 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:20:38.749259 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:20:38.752890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:38.755917 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:20:38.757911 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B074610>]}
[0m20:20:38.758873 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:20:38.762388 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:20:38.763392 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:20:38.764650 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:20:38.767432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:20:38.768435 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:20:38.775596 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:20:38.778847 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:20:38.787132 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:20:38.792118 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:38.793120 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:20:38.794117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:39.016154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:20:39.018168 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:39.019165 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:20:39.029172 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:20:39.036153 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:39.037150 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:20:39.039111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:39.046126 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:39.047104 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:20:39.049113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:39.052107 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:20:39.053105 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:39.055073 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:20:39.065094 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:20:39.070431 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:20:39.072561 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:20:39.073627 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:20:39.077656 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:39.080659 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:20:39.081610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785A88E390>]}
[0m20:20:39.083607 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m20:20:39.086982 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:20:39.087983 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:20:39.089324 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:20:39.092747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:20:39.093765 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:20:39.100752 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:20:39.103753 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:20:39.111399 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:20:39.115388 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.116386 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:20:39.117892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:39.442640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.325 seconds
[0m20:20:39.445033 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.446514 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:20:39.456962 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:20:39.463124 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.465129 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:20:39.467259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:39.475819 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.477353 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:20:39.479351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:39.482624 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:20:39.484518 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.485522 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:20:39.489695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:39.497221 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:20:39.498897 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:20:39.500534 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:20:39.504623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:39.507863 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:20:39.508833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B0823D0>]}
[0m20:20:39.510826 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:20:39.514497 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:20:39.516037 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_last_10_days
[0m20:20:39.517576 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_last_10_days .......... [RUN]
[0m20:20:39.519683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_last_10_days)
[0m20:20:39.520741 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_last_10_days
[0m20:20:39.534472 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:20:39.539120 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_last_10_days
[0m20:20:39.548071 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:20:39.553332 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:20:39.554329 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: BEGIN
[0m20:20:39.555751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:39.873603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.318 seconds
[0m20:20:39.875703 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:20:39.876752 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_last_10_days"} */

  create view "propharma"."public"."expired_med_count_in_last_10_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(m.quantity)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
where m.expiry_date between start_date and end_date;
  );
[0m20:20:39.878815 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 92: where m.expiry_date between start_date and end_date;
                                                            ^

[0m20:20:39.879812 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: ROLLBACK
[0m20:20:39.882027 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: Close
[0m20:20:39.895576 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:20:39.896818 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785921AA90>]}
[0m20:20:39.899240 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_last_10_days . [[31mERROR[0m in 0.38s]
[0m20:20:39.903298 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_last_10_days
[0m20:20:39.905432 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:20:39.906435 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_last_10_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql.
[0m20:20:39.908712 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:20:39.911922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_last_10_days, now model.Propharma.mart_expired_drugs)
[0m20:20:39.914115 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:20:39.924203 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:20:39.928967 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:20:40.008514 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.009746 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202039978242"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:20:40.011112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:40.245497 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.234 seconds
[0m20:20:40.271303 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.272300 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:20:40.274366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:20:40.276128 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.277165 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202039978242'
        
      order by ordinal_position

  
[0m20:20:40.303360 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.025 seconds
[0m20:20:40.316945 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.317944 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:40.325657 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:20:40.340297 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.342283 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:40.348740 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:20:40.379368 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:20:40.384035 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.385073 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202039978242" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202039978242"
    )
  
[0m20:20:40.389610 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:20:40.392602 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:20:40.393599 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:20:40.394602 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:20:40.405633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:20:40.407681 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:20:40.409645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785900EAD0>]}
[0m20:20:40.411767 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.50s]
[0m20:20:40.414762 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:20:40.417095 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:20:40.418965 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:20:40.421149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:20:40.422691 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:20:40.430569 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:20:40.433565 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:20:40.442540 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.444536 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202040438551"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:20:40.447528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:40.712916 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.266 seconds
[0m20:20:40.723673 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.725666 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:20:40.727921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:20:40.729921 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.732149 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202040438551'
        
      order by ordinal_position

  
[0m20:20:40.764003 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.030 seconds
[0m20:20:40.775260 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.777264 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:40.784858 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:20:40.791849 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.794316 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:40.800988 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:20:40.815785 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:20:40.820540 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.821541 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202040438551" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202040438551"
    )
  
[0m20:20:40.825763 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:20:40.829983 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:20:40.831987 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:20:40.833357 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:20:40.837089 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:20:40.838918 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:20:40.840917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B09D050>]}
[0m20:20:40.842913 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.42s]
[0m20:20:40.846448 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:20:40.848559 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:20:40.850562 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:20:40.853663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:20:40.855663 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:20:40.871778 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:20:40.876446 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:20:40.888720 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:40.889729 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202040884657"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:20:40.891747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:41.144940 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.254 seconds
[0m20:20:41.153251 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.155247 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:20:41.156936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:20:41.158261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.159305 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202040884657'
        
      order by ordinal_position

  
[0m20:20:41.184214 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:20:41.190933 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.191969 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:41.198954 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:20:41.205939 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.208531 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:41.217552 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m20:20:41.229761 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:20:41.234183 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.234690 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202040884657"
    )


  
[0m20:20:41.238370 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:20:41.241594 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:20:41.243587 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:20:41.244586 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:20:41.250750 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:20:41.253741 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:20:41.254738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785AC72150>]}
[0m20:20:41.256733 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.40s]
[0m20:20:41.261125 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:20:41.262222 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:20:41.264224 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:20:41.267216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:20:41.268214 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:20:41.278290 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:20:41.281034 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:20:41.292434 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.294429 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202041289444"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:20:41.295426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:41.566154 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.270 seconds
[0m20:20:41.575224 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.577224 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:20:41.579223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:20:41.581214 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.582231 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202041289444'
        
      order by ordinal_position

  
[0m20:20:41.606288 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:20:41.613398 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.614396 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:41.621919 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:20:41.628910 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.629906 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:41.636197 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:20:41.642613 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:20:41.646046 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.647500 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202041289444" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202041289444"
    )
  
[0m20:20:41.652148 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:20:41.655147 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:20:41.656146 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:20:41.658284 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:20:41.667416 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:20:41.670709 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:20:41.672019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B12CB90>]}
[0m20:20:41.675406 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.41s]
[0m20:20:41.679394 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:20:41.680391 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:20:41.683182 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:20:41.685677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:20:41.686673 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:20:41.697483 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:20:41.701473 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:20:41.715130 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:41.716127 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202041712137"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:20:41.717124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:41.997747 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.280 seconds
[0m20:20:42.005931 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.007938 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:20:42.010400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:20:42.011732 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.014110 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202041712137'
        
      order by ordinal_position

  
[0m20:20:42.039532 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m20:20:42.046513 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.047510 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:42.054797 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:20:42.062175 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.063207 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:20:42.071186 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:20:42.075779 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:20:42.079390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.080407 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202041712137" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202041712137"
    )
  
[0m20:20:42.084442 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:20:42.087513 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:20:42.089602 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:20:42.090597 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:20:42.096204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:20:42.098450 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:20:42.099431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '647ded1e-5a07-4331-8f29-f78e39d4c110', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B15DC10>]}
[0m20:20:42.101741 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.41s]
[0m20:20:42.106360 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:20:42.110048 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:42.111054 [debug] [MainThread]: On master: BEGIN
[0m20:20:42.112051 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:42.391791 [debug] [MainThread]: SQL status: BEGIN in 0.280 seconds
[0m20:20:42.393811 [debug] [MainThread]: On master: COMMIT
[0m20:20:42.395826 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:42.397839 [debug] [MainThread]: On master: COMMIT
[0m20:20:42.398844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:42.400838 [debug] [MainThread]: On master: Close
[0m20:20:42.401836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:42.403831 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:20:42.404828 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:20:42.405847 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:20:42.407915 [info ] [MainThread]: 
[0m20:20:42.410642 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.11 seconds (7.11s).
[0m20:20:42.417083 [debug] [MainThread]: Command end result
[0m20:20:42.512829 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:20:42.519866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:20:42.537078 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:20:42.539134 [info ] [MainThread]: 
[0m20:20:42.542256 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:20:42.547860 [info ] [MainThread]: 
[0m20:20:42.550860 [error] [MainThread]:   Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:20:42.555970 [info ] [MainThread]: 
[0m20:20:42.560239 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:20:42.565842 [debug] [MainThread]: Command `dbt run` failed at 20:20:42.564845 after 10.55 seconds
[0m20:20:42.567200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785260FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027859066C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785B17E6D0>]}
[0m20:20:42.569862 [debug] [MainThread]: Flushing usage events
[0m20:20:45.003165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:20:55.043581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C172250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C1B4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C1B71D0>]}


============================== 20:20:55.051799 | 5f120486-e129-4785-b9ca-4a3463fe1047 ==============================
[0m20:20:55.051799 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:20:55.054287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:20:55.470763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C373B50>]}
[0m20:20:55.583157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A638E47810>]}
[0m20:20:55.585899 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:20:56.412940 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:20:56.987508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:56.988506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:57.121735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63D66CBD0>]}
[0m20:20:57.358580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:20:57.369848 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:20:57.438439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63D5AAF90>]}
[0m20:20:57.439436 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:20:57.441821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63B38E0D0>]}
[0m20:20:57.446473 [info ] [MainThread]: 
[0m20:20:57.448939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:57.450217 [info ] [MainThread]: 
[0m20:20:57.453072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:20:57.467535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:20:57.845738 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:20:57.847950 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:20:57.848954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:58.240494 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.391 seconds
[0m20:20:58.242516 [debug] [ThreadPool]: On list_propharma: Close
[0m20:20:58.248378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:20:58.260018 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:20:58.261053 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:20:58.262091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:58.490175 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m20:20:58.491903 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:20:58.492941 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:20:58.503874 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:20:58.506906 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:20:58.508877 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:20:58.509900 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:20:58.516501 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:20:58.518500 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:20:58.519497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:20:58.733769 [debug] [ThreadPool]: SQL status: BEGIN in 0.215 seconds
[0m20:20:58.735986 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:20:58.737076 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:20:58.747328 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m20:20:58.751356 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:20:58.752346 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:20:58.767502 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:58.768545 [debug] [MainThread]: On master: BEGIN
[0m20:20:58.769585 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:58.983632 [debug] [MainThread]: SQL status: BEGIN in 0.214 seconds
[0m20:20:58.985633 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:58.986632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:20:59.028349 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m20:20:59.033296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63D8E9510>]}
[0m20:20:59.035291 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:59.036288 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:59.037286 [debug] [MainThread]: On master: BEGIN
[0m20:20:59.039798 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:20:59.040798 [debug] [MainThread]: On master: COMMIT
[0m20:20:59.041827 [debug] [MainThread]: Using postgres connection "master"
[0m20:20:59.042824 [debug] [MainThread]: On master: COMMIT
[0m20:20:59.043821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:20:59.045784 [debug] [MainThread]: On master: Close
[0m20:20:59.056040 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:20:59.057548 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:20:59.058545 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:20:59.111677 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:20:59.112673 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:20:59.114287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:59.330015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m20:20:59.332569 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:20:59.333566 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:20:59.336384 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:20:59.357614 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:20:59.362096 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:20:59.363654 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:20:59.365914 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:20:59.366917 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:20:59.368912 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:20:59.370906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:20:59.372901 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:20:59.378884 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:20:59.383872 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:20:59.454922 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:20:59.459728 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.460730 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:20:59.461727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:59.676510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.215 seconds
[0m20:20:59.678824 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.679821 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:20:59.688838 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:20:59.701081 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.702083 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:20:59.705095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:59.711083 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.713078 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:20:59.715072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:20:59.744994 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:20:59.746034 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.747080 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:20:59.757687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:20:59.770155 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:20:59.780124 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:20:59.781096 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:20:59.784015 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:20:59.789776 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:20:59.793730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63DBF6FD0>]}
[0m20:20:59.795997 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:20:59.799451 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:20:59.801450 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:20:59.802447 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:20:59.804938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:20:59.805944 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:20:59.813436 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:20:59.817677 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:20:59.824741 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:20:59.829017 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:20:59.831347 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:20:59.833432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:00.056651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:21:00.058697 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:00.059693 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:21:00.068534 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:21:00.078515 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:00.079512 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:21:00.080902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.144261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:00.145682 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:21:00.148046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.151044 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:21:00.152041 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:00.154035 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:21:00.164713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:21:00.175641 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:21:00.178627 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:00.180621 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:21:00.185613 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:21:00.189766 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:21:00.191902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63E0FF990>]}
[0m20:21:00.195002 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.39s]
[0m20:21:00.198303 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:21:00.199300 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:21:00.201295 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:21:00.203115 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:21:00.205828 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:21:00.214809 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:21:00.219345 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:21:00.230352 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:21:00.234926 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.237918 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:21:00.240421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:00.497445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.257 seconds
[0m20:21:00.499457 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.500453 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:21:00.509160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:21:00.516145 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.518140 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:21:00.519137 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.525796 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.526797 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:21:00.529449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.532446 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:21:00.533443 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.534440 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:21:00.544453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:21:00.549355 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:21:00.551527 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:00.553526 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:21:00.556726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:00.559346 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:21:00.561725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63E0FFC50>]}
[0m20:21:00.563725 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.36s]
[0m20:21:00.566717 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:21:00.567718 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:21:00.570380 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:21:00.572035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:21:00.574571 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:21:00.581367 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:21:00.584359 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:21:00.592428 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:21:00.596699 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.598714 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:21:00.599695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:00.822625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m20:21:00.823825 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.825493 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:21:00.833863 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:21:00.843959 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.845810 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:21:00.847478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.853896 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.854894 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:21:00.856889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:00.859883 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:21:00.860883 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.862833 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:21:00.871825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:21:00.878116 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:21:00.879113 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:00.880146 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:21:00.884283 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:00.886908 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:21:00.889293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63DC5F2D0>]}
[0m20:21:00.890295 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:21:00.893287 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:21:00.895370 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:21:00.896365 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:21:00.898596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:21:00.899674 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:21:00.907550 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:21:00.912096 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:21:00.919085 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:21:00.923644 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:00.925564 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:21:00.926569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.149531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m20:21:01.150536 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:01.151534 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:21:01.163994 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:21:01.172317 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:01.174311 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:21:01.175308 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:01.182293 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:01.184289 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:21:01.185286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:01.189273 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:21:01.190294 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:01.191301 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:21:01.200579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:21:01.206057 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:21:01.208053 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:01.209050 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:21:01.213077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:01.216031 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:21:01.218027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63D8FF790>]}
[0m20:21:01.220021 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m20:21:01.221720 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:21:01.223746 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:21:01.224805 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:21:01.227855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:21:01.228897 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:21:01.237136 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:21:01.241640 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:21:01.254732 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:21:01.258726 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.260722 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:21:01.262175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.484607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:21:01.485614 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.487098 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:21:01.496711 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:21:01.503691 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.504689 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:21:01.507129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:01.513117 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.515113 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:21:01.517147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:01.519445 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:21:01.521440 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.522437 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:21:01.532618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:21:01.538097 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:21:01.540056 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:01.541088 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:21:01.544628 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:01.547638 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:21:01.548676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63DCED610>]}
[0m20:21:01.550674 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:21:01.554917 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:21:01.555880 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:01.557469 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_last_10_days .......... [RUN]
[0m20:21:01.559645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_last_10_days)
[0m20:21:01.561745 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:01.573490 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:01.577662 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:01.586644 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:01.591793 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:01.593789 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: BEGIN
[0m20:21:01.594791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:01.917173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.322 seconds
[0m20:21:01.918171 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:01.919167 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_last_10_days"} */

  create view "propharma"."public"."expired_med_count_in_last_10_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(m.quantity)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
where m.expiry_date between start_date and end_date;
  );
[0m20:21:01.922314 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 92: where m.expiry_date between start_date and end_date;
                                                            ^

[0m20:21:01.923399 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: ROLLBACK
[0m20:21:01.925432 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: Close
[0m20:21:01.939070 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:21:01.940076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C347190>]}
[0m20:21:01.942691 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_last_10_days . [[31mERROR[0m in 0.38s]
[0m20:21:01.945180 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:01.946219 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:21:01.948177 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_last_10_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql.
[0m20:21:01.949212 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:21:01.953588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_last_10_days, now model.Propharma.mart_expired_drugs)
[0m20:21:01.955590 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:21:01.964564 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:21:01.968590 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:21:02.048757 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.049755 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202102016971"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:21:02.051715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:02.287356 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.236 seconds
[0m20:21:02.313364 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.314399 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:21:02.316741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:02.317738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.320027 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202102016971'
        
      order by ordinal_position

  
[0m20:21:02.343857 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:21:02.357997 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.359992 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:02.367119 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:21:02.382604 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.383639 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:02.390492 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:21:02.422101 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:21:02.428097 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.430088 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202102016971" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202102016971"
    )
  
[0m20:21:02.434109 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:02.437933 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:21:02.438469 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:02.440497 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:21:02.445659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:21:02.447736 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:21:02.450200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63BB0AE90>]}
[0m20:21:02.452200 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.50s]
[0m20:21:02.454565 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:21:02.457146 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:21:02.458348 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:21:02.460770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:21:02.461887 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:21:02.470120 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:21:02.475127 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:21:02.488124 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.490419 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202102482882"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:21:02.491431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:02.749534 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.258 seconds
[0m20:21:02.756098 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.757458 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:21:02.759434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:02.761170 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.762730 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202102482882'
        
      order by ordinal_position

  
[0m20:21:02.788049 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:21:02.795047 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.796812 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:02.803149 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:02.810163 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.812183 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:02.819251 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:02.823236 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:21:02.827231 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.828519 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202102482882" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202102482882"
    )
  
[0m20:21:02.832599 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:02.835705 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:21:02.837664 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:02.838838 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:21:02.847829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:21:02.850867 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:21:02.852027 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A639331590>]}
[0m20:21:02.854027 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.39s]
[0m20:21:02.857459 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:21:02.859611 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:21:02.861854 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:21:02.863886 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:21:02.866166 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:21:02.880958 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:21:02.884976 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:21:02.901936 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:02.903931 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202102897947"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:21:02.906925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:03.146675 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.240 seconds
[0m20:21:03.153124 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.153667 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:21:03.165680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.002 seconds
[0m20:21:03.168843 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.170267 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202102897947'
        
      order by ordinal_position

  
[0m20:21:03.200410 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.027 seconds
[0m20:21:03.207009 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.208012 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.215087 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:21:03.222668 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.223631 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.230113 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:21:03.242963 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:21:03.247260 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.248257 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202102897947"
    )


  
[0m20:21:03.251290 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:21:03.254277 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:21:03.256160 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:03.256699 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:21:03.263219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:21:03.265221 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:21:03.267217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63C2F7490>]}
[0m20:21:03.268215 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.40s]
[0m20:21:03.271807 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:21:03.274045 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:21:03.275061 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:21:03.277399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:21:03.279615 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:21:03.288594 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:21:03.293240 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:21:03.301898 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.302895 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202103298906"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:21:03.305280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:03.539743 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.236 seconds
[0m20:21:03.546827 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.547872 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:21:03.549921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:03.550963 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.553016 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202103298906'
        
      order by ordinal_position

  
[0m20:21:03.576617 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:21:03.584055 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.585147 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.591417 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:21:03.598479 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.599477 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.606886 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:21:03.610971 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:21:03.614783 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.616785 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202103298906" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202103298906"
    )
  
[0m20:21:03.620775 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:03.624795 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:21:03.625790 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:03.627756 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:21:03.630484 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:03.633396 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:21:03.633934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63E185FD0>]}
[0m20:21:03.636402 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.36s]
[0m20:21:03.639745 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:21:03.641656 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:21:03.644173 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:21:03.646174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:21:03.647233 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:21:03.659918 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:21:03.663905 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:21:03.674283 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:03.675281 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202103670274"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:21:03.677273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:03.925751 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.248 seconds
[0m20:21:03.931741 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:03.932770 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:21:03.935156 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:03.936341 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:03.937378 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202103670274'
        
      order by ordinal_position

  
[0m20:21:03.961865 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:21:03.968876 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:03.969852 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.976855 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:03.984101 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:03.986062 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:03.993101 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:03.996875 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:21:04.000829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:04.002822 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202103670274" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202103670274"
    )
  
[0m20:21:04.006846 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:04.009839 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:21:04.010835 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:04.011798 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:21:04.014931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:21:04.016682 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:21:04.018932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f120486-e129-4785-b9ca-4a3463fe1047', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A63E159250>]}
[0m20:21:04.020931 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.37s]
[0m20:21:04.025005 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:21:04.028492 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:04.030220 [debug] [MainThread]: On master: BEGIN
[0m20:21:04.031253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:04.356296 [debug] [MainThread]: SQL status: BEGIN in 0.325 seconds
[0m20:21:04.357500 [debug] [MainThread]: On master: COMMIT
[0m20:21:04.358542 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:04.359535 [debug] [MainThread]: On master: COMMIT
[0m20:21:04.361495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:21:04.361495 [debug] [MainThread]: On master: Close
[0m20:21:04.363750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:04.364747 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:21:04.365746 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:21:04.366743 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:21:04.368862 [info ] [MainThread]: 
[0m20:21:04.369909 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m20:21:04.376475 [debug] [MainThread]: Command end result
[0m20:21:04.452539 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:21:04.459530 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:21:04.474588 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:21:04.475586 [info ] [MainThread]: 
[0m20:21:04.478610 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:21:04.480416 [info ] [MainThread]: 
[0m20:21:04.482620 [error] [MainThread]:   Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  syntax error at or near ";"
  LINE 92: where m.expiry_date between start_date and end_date;
                                                              ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:21:04.484411 [info ] [MainThread]: 
[0m20:21:04.486583 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:21:04.489573 [debug] [MainThread]: Command `dbt run` failed at 20:21:04.489573 after 9.71 seconds
[0m20:21:04.491590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6358EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A635B89590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A635B89650>]}
[0m20:21:04.492845 [debug] [MainThread]: Flushing usage events
[0m20:21:05.715246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:21:14.801075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC66FC6C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC66F62B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC66F61450>]}


============================== 20:21:14.809022 | f11c6332-5085-42cc-ab50-816257ea4c7b ==============================
[0m20:21:14.809022 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:21:14.810997 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:21:15.233964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6716EB10>]}
[0m20:21:15.349143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC63C5B810>]}
[0m20:21:15.352135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:21:16.215828 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:21:16.876442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:21:16.878401 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_last_10_days.sql
[0m20:21:18.060768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6833D990>]}
[0m20:21:18.497286 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:21:18.515124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:21:18.616414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC686577D0>]}
[0m20:21:18.619090 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:21:18.621581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68537D90>]}
[0m20:21:18.629089 [info ] [MainThread]: 
[0m20:21:18.632180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:18.634475 [info ] [MainThread]: 
[0m20:21:18.639006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:21:18.666722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:21:19.594801 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:21:19.596795 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:21:19.597792 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:20.113516 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.515 seconds
[0m20:21:20.118503 [debug] [ThreadPool]: On list_propharma: Close
[0m20:21:20.134652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:21:20.157285 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:21:20.158282 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:21:20.160277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:20.496041 [debug] [ThreadPool]: SQL status: BEGIN in 0.336 seconds
[0m20:21:20.498035 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:21:20.500030 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:21:20.518980 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.017 seconds
[0m20:21:20.524963 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:21:20.526958 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:21:20.529950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:21:20.547699 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:21:20.548970 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:21:20.550969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:21:20.974835 [debug] [ThreadPool]: SQL status: BEGIN in 0.423 seconds
[0m20:21:20.976827 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:21:20.978821 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:21:20.998946 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.018 seconds
[0m20:21:21.003680 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:21:21.005682 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:21:21.024800 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:21.027044 [debug] [MainThread]: On master: BEGIN
[0m20:21:21.028046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:21.523151 [debug] [MainThread]: SQL status: BEGIN in 0.495 seconds
[0m20:21:21.525147 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:21.527659 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:21:21.616983 [debug] [MainThread]: SQL status: SELECT 6 in 0.086 seconds
[0m20:21:21.625414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC6865F290>]}
[0m20:21:21.627408 [debug] [MainThread]: On master: ROLLBACK
[0m20:21:21.630400 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:21.631680 [debug] [MainThread]: On master: BEGIN
[0m20:21:21.634680 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:21:21.637483 [debug] [MainThread]: On master: COMMIT
[0m20:21:21.639091 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:21.641174 [debug] [MainThread]: On master: COMMIT
[0m20:21:21.643814 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:21:21.645325 [debug] [MainThread]: On master: Close
[0m20:21:21.697824 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:21:21.703620 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:21:21.706000 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:21:21.805658 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:21:21.808649 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:21:21.810645 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:21:22.270177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.459 seconds
[0m20:21:22.272648 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:21:22.274652 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:21:22.277643 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:21:22.318164 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:21:22.323694 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:21:22.326686 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:21:22.330113 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:21:22.332627 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:21:22.334621 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:21:22.339757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:21:22.341967 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:21:22.353768 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:21:22.359644 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:21:22.501896 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:21:22.510104 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:22.512513 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:21:22.515513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:22.917862 [debug] [Thread-1 (]: SQL status: BEGIN in 0.402 seconds
[0m20:21:22.919859 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:22.921697 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:21:22.936381 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:21:22.958557 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:22.959692 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:21:22.963555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:22.973771 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:22.976050 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:21:22.979222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:23.033218 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:21:23.035213 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:23.037208 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:21:23.041197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:23.060664 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:21:23.077180 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:21:23.079789 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:21:23.085586 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:21:23.093764 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:21:23.100180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68B42450>]}
[0m20:21:23.102556 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.76s]
[0m20:21:23.106883 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:21:23.108385 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:21:23.110662 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:21:23.114005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:21:23.115517 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:21:23.127781 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:21:23.133089 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:21:23.158366 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:21:23.163870 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.165871 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:21:23.167866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:23.491540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.323 seconds
[0m20:21:23.492547 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.494823 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:21:23.508130 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:21:23.519584 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.522042 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:21:23.525466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:23.534029 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.535545 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:21:23.538962 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:23.544097 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:21:23.546111 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.547109 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:21:23.550106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:23.556212 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:21:23.558207 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:21:23.559204 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:21:23.563194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:23.567693 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:21:23.569801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC685368D0>]}
[0m20:21:23.572967 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.46s]
[0m20:21:23.576202 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:21:23.577199 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:21:23.579194 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:21:23.581222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:21:23.583530 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:21:23.599169 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:21:23.612867 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:21:23.626678 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:21:23.631668 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.634151 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:21:23.636146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:23.931683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.295 seconds
[0m20:21:23.933028 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.935116 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:21:23.948562 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:21:23.955664 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.957678 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:21:23.959710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:23.966693 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.967690 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:21:23.970230 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:23.973382 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:21:23.975382 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.976380 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:21:23.979372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:21:23.985555 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:21:23.987575 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:21:23.988871 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:21:23.992292 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:21:23.997106 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:21:23.999369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC671D4610>]}
[0m20:21:24.002361 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:21:24.006379 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:21:24.008452 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:21:24.011444 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:21:24.013931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:21:24.014936 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:21:24.025285 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:21:24.028663 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:21:24.039628 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:21:24.045951 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.047965 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:21:24.049965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:24.382097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.333 seconds
[0m20:21:24.384316 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.386732 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:21:24.400486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:21:24.413363 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.415358 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:21:24.418785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:24.430532 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.432532 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:21:24.435525 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:24.440982 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:21:24.443041 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.444552 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:21:24.448799 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:24.457780 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:21:24.460773 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:21:24.462768 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:21:24.468538 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:21:24.473877 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:21:24.475873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68864B90>]}
[0m20:21:24.478864 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.46s]
[0m20:21:24.482926 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:21:24.484928 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:21:24.486924 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:21:24.489916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:21:24.492340 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:21:24.510901 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:21:24.515889 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:21:24.529965 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:21:24.535734 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:24.537487 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:21:24.540956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:24.941694 [debug] [Thread-1 (]: SQL status: BEGIN in 0.401 seconds
[0m20:21:24.944257 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:24.946252 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:21:24.961626 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:21:24.974108 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:24.976103 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:21:24.980092 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:24.991275 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:24.993271 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:21:24.996262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:25.000756 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:21:25.002811 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:25.005037 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:21:25.010306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:25.019335 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:21:25.021204 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:21:25.022638 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:21:25.028047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:21:25.032418 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:21:25.034414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC63F10650>]}
[0m20:21:25.037405 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.54s]
[0m20:21:25.040396 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:21:25.042723 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:21:25.045758 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:21:25.048874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:21:25.051095 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:21:25.062930 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:21:25.068642 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:21:25.083817 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:21:25.089852 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.091727 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:21:25.093729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:25.453544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.360 seconds
[0m20:21:25.455539 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.457535 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:21:25.473215 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m20:21:25.485467 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.487973 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:21:25.490966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:25.501087 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.503087 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:21:25.506108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:21:25.511289 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:21:25.513291 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.515286 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:21:25.519444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:25.528763 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:21:25.531692 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:21:25.533695 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:21:25.539014 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:21:25.544364 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:21:25.546887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68868590>]}
[0m20:21:25.549891 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.50s]
[0m20:21:25.553881 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:21:25.555875 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:25.558867 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_last_10_days .......... [RUN]
[0m20:21:25.561859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_last_10_days)
[0m20:21:25.562857 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:25.590862 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:25.595730 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:25.616281 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:25.623567 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:25.626261 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: BEGIN
[0m20:21:25.628262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:25.990393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.363 seconds
[0m20:21:25.993539 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_last_10_days"
[0m20:21:25.995692 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_last_10_days"} */

  create view "propharma"."public"."expired_med_count_in_last_10_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(m.quantity)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
where m.expiry_date between start_date and end_date
  );
[0m20:21:26.010388 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column m.quantity does not exist
LINE 88: select count(m.quantity)
                      ^

[0m20:21:26.013388 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: ROLLBACK
[0m20:21:26.015903 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_last_10_days: Close
[0m20:21:26.039030 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:21:26.040028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC662CFF10>]}
[0m20:21:26.043019 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_last_10_days . [[31mERROR[0m in 0.48s]
[0m20:21:26.046369 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_last_10_days
[0m20:21:26.048630 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:21:26.049627 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_last_10_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql.
[0m20:21:26.051894 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:21:26.056034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_last_10_days, now model.Propharma.mart_expired_drugs)
[0m20:21:26.058618 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:21:26.069386 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:21:26.073647 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:21:26.200335 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.202341 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202126148538"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:21:26.204945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:26.547512 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.343 seconds
[0m20:21:26.574390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.576373 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:21:26.578332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:26.580427 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.581424 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202126148538'
        
      order by ordinal_position

  
[0m20:21:26.605744 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:21:26.621784 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.622823 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:26.629979 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:21:26.649895 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.651895 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:26.659873 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m20:21:26.691487 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:21:26.695169 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.697403 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202126148538" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202126148538"
    )
  
[0m20:21:26.701423 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:26.705381 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:21:26.706378 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:21:26.707376 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:21:26.710576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:21:26.711658 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:21:26.713335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68802490>]}
[0m20:21:26.715318 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.66s]
[0m20:21:26.718978 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:21:26.721686 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:21:26.722716 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:21:26.726132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:21:26.728127 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:21:26.746959 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:21:26.751636 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:21:26.761661 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:26.762992 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202126757616"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:21:26.765472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:27.068819 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.303 seconds
[0m20:21:27.075384 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.076387 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:21:27.079142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:27.080139 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.081136 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202126757616'
        
      order by ordinal_position

  
[0m20:21:27.106384 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:21:27.113411 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.114610 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:27.122404 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:27.129385 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.130382 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:27.137720 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:27.141707 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:21:27.146033 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.147035 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202126757616" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202126757616"
    )
  
[0m20:21:27.152633 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m20:21:27.156069 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:21:27.157581 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:21:27.159348 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:21:27.162180 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:21:27.164230 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:21:27.166741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC68FFA450>]}
[0m20:21:27.167737 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.44s]
[0m20:21:27.172109 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:21:27.174103 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:21:27.176098 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:21:27.179505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:21:27.181537 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:21:27.195132 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:21:27.200235 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:21:27.211369 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.213450 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202127206814"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:21:27.215953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:27.477291 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.262 seconds
[0m20:21:27.483926 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.485921 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:21:27.486918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:27.489635 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.491707 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202127206814'
        
      order by ordinal_position

  
[0m20:21:27.517540 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m20:21:27.525021 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.526535 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:27.533284 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:21:27.543261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.544258 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:27.554509 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m20:21:27.567416 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:21:27.571530 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.573246 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202127206814"
    )


  
[0m20:21:27.577096 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:21:27.580092 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:21:27.581089 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:21:27.583084 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:21:27.593704 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:21:27.595134 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:21:27.597134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC69038C10>]}
[0m20:21:27.599129 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.42s]
[0m20:21:27.602907 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:21:27.605164 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:21:27.607164 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:21:27.609158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:21:27.610691 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:21:27.620438 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:21:27.623952 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:21:27.634134 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:27.637585 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202127629954"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:21:27.639580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:27.958047 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.318 seconds
[0m20:21:27.966443 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:27.968494 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:21:27.970796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:27.971813 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:27.972815 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202127629954'
        
      order by ordinal_position

  
[0m20:21:28.001473 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.026 seconds
[0m20:21:28.008337 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:28.009339 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:28.016749 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:21:28.027347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:28.029840 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:28.036454 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:21:28.042374 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:21:28.046648 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:28.047659 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202127629954" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202127629954"
    )
  
[0m20:21:28.053469 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:21:28.057537 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:21:28.059575 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:21:28.061821 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:21:28.064144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:21:28.066659 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:21:28.067661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC684D2CD0>]}
[0m20:21:28.071366 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.46s]
[0m20:21:28.074941 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:21:28.076936 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:21:28.078931 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:21:28.081408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:21:28.083697 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:21:28.092171 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:21:28.096243 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:21:28.108757 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.110886 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202128104758"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:21:28.112910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:28.396035 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.284 seconds
[0m20:21:28.403374 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.404410 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:21:28.406444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:21:28.407514 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.408516 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202128104758'
        
      order by ordinal_position

  
[0m20:21:28.433394 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:21:28.443375 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.444373 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:28.451805 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:28.459508 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.460515 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:21:28.467834 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:21:28.472827 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:21:28.477184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.478187 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202128104758" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202128104758"
    )
  
[0m20:21:28.483612 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m20:21:28.487609 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:21:28.488607 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:21:28.489604 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:21:28.493124 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:21:28.495266 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:21:28.496790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f11c6332-5085-42cc-ab50-816257ea4c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC69034D10>]}
[0m20:21:28.499419 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.42s]
[0m20:21:28.503606 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:21:28.506362 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:28.509718 [debug] [MainThread]: On master: BEGIN
[0m20:21:28.511991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:21:28.758886 [debug] [MainThread]: SQL status: BEGIN in 0.247 seconds
[0m20:21:28.760150 [debug] [MainThread]: On master: COMMIT
[0m20:21:28.762327 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:28.763333 [debug] [MainThread]: On master: COMMIT
[0m20:21:28.765326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:21:28.767320 [debug] [MainThread]: On master: Close
[0m20:21:28.769565 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:28.770568 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:21:28.772563 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:21:28.774558 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:21:28.777135 [info ] [MainThread]: 
[0m20:21:28.779209 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 10.14 seconds (10.14s).
[0m20:21:28.788724 [debug] [MainThread]: Command end result
[0m20:21:28.888284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:21:28.895461 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:21:28.910484 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:21:28.912479 [info ] [MainThread]: 
[0m20:21:28.913477 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:21:28.915947 [info ] [MainThread]: 
[0m20:21:28.918092 [error] [MainThread]:   Database Error in model expired_med_count_in_last_10_days (models\marts\expired_med_count_in_last_10_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_last_10_days.sql
[0m20:21:28.920103 [info ] [MainThread]: 
[0m20:21:28.922507 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:21:28.925797 [debug] [MainThread]: Command `dbt run` failed at 20:21:28.925797 after 14.39 seconds
[0m20:21:28.927908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC66F60F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC69032C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC69030BD0>]}
[0m20:21:28.930356 [debug] [MainThread]: Flushing usage events
[0m20:21:30.509008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:11.397920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A51C1F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A51C2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A51C1E90>]}


============================== 20:25:11.406899 | 4653e769-dbd8-418e-9371-9252dbd62c15 ==============================
[0m20:25:11.406899 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:25:11.409183 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:25:11.922957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A53C2010>]}
[0m20:25:12.039308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A1E17550>]}
[0m20:25:12.043304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:25:12.916675 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:25:13.625812 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:25:13.628847 [debug] [MainThread]: Partial parsing: added file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:25:13.632372 [debug] [MainThread]: Partial parsing: deleted file: Propharma://models\marts\expired_med_count_in_last_10_days.sql
[0m20:25:14.391987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A68B7150>]}
[0m20:25:14.654595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:25:14.667353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:25:14.735687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A69AB750>]}
[0m20:25:14.737475 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:25:14.739662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A65F1C90>]}
[0m20:25:14.745289 [info ] [MainThread]: 
[0m20:25:14.747411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:25:14.750087 [info ] [MainThread]: 
[0m20:25:14.752185 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:14.765462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:25:15.236109 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:25:15.237315 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:25:15.238348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:15.646051 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.407 seconds
[0m20:25:15.648561 [debug] [ThreadPool]: On list_propharma: Close
[0m20:25:15.654317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:25:15.673109 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:25:15.675537 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:25:15.677536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:15.939290 [debug] [ThreadPool]: SQL status: BEGIN in 0.262 seconds
[0m20:25:15.941312 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:25:15.942319 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:25:15.953623 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m20:25:15.957667 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:25:15.958672 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:25:15.960722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:25:15.973552 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:25:15.974591 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:25:15.975634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:16.202334 [debug] [ThreadPool]: SQL status: BEGIN in 0.227 seconds
[0m20:25:16.203933 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:25:16.204939 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:25:16.216312 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:25:16.219878 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:25:16.220847 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:25:16.231392 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:16.233321 [debug] [MainThread]: On master: BEGIN
[0m20:25:16.234353 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:16.465225 [debug] [MainThread]: SQL status: BEGIN in 0.231 seconds
[0m20:25:16.466494 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:16.467533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:25:16.513579 [debug] [MainThread]: SQL status: SELECT 6 in 0.044 seconds
[0m20:25:16.518572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6E44A10>]}
[0m20:25:16.520636 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:16.522267 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:16.523495 [debug] [MainThread]: On master: BEGIN
[0m20:25:16.525049 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:25:16.526329 [debug] [MainThread]: On master: COMMIT
[0m20:25:16.528442 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:16.529597 [debug] [MainThread]: On master: COMMIT
[0m20:25:16.530910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:16.531947 [debug] [MainThread]: On master: Close
[0m20:25:16.542570 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:25:16.543567 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:25:16.545562 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:25:16.599884 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:25:16.601878 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:25:16.602876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:16.853111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.250 seconds
[0m20:25:16.854620 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:25:16.855617 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:25:16.858062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:25:16.881011 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:25:16.884249 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:25:16.886258 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:25:16.888395 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:25:16.890414 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:25:16.892691 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:25:16.893700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:25:16.895694 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:25:16.902677 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:25:16.906913 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:25:16.997737 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:25:17.002474 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.004486 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:25:17.005491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:17.312282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.307 seconds
[0m20:25:17.313735 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.315748 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:25:17.327125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:25:17.345277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.346280 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:25:17.348689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:17.355958 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.358012 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:25:17.360727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:17.397482 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:25:17.399500 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.400510 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:25:17.411894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:25:17.428776 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:25:17.441616 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:25:17.442653 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:25:17.446169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:25:17.452968 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:25:17.460331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A65F2050>]}
[0m20:25:17.462701 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.56s]
[0m20:25:17.466703 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:25:17.468719 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:25:17.470869 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:25:17.473223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:25:17.474588 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:25:17.485085 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:25:17.489365 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:25:17.499950 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:25:17.505163 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.506546 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:25:17.508567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:17.755684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m20:25:17.756833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.758860 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:25:17.768110 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:25:17.775851 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.777949 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:25:17.780141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:17.787270 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.788277 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:25:17.789508 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:17.795219 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:25:17.796548 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.798780 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:25:17.805063 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:25:17.810730 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:25:17.812921 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:25:17.814108 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:25:17.818271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:25:17.821323 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:25:17.822395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A53C4510>]}
[0m20:25:17.824931 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:25:17.827167 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:25:17.829167 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:25:17.831162 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:25:17.834257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:25:17.835708 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:25:17.846377 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:25:17.849496 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:25:17.858110 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:25:17.862559 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:17.864016 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:25:17.865150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:18.097824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m20:25:18.099826 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:18.100823 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:25:18.111466 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:25:18.119595 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:18.121798 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:25:18.123817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.131024 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:18.132057 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:25:18.133948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.138045 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:25:18.139042 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:18.141037 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:25:18.150270 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:25:18.156762 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:25:18.158757 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:25:18.159755 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:25:18.163744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:25:18.167750 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:25:18.170740 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6A62F50>]}
[0m20:25:18.172735 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.34s]
[0m20:25:18.176742 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:25:18.179384 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:25:18.180386 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:25:18.182730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:25:18.185436 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:25:18.195973 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:25:18.200861 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:25:18.210320 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:25:18.215432 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.217431 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:25:18.219528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:18.469145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.250 seconds
[0m20:25:18.470795 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.471803 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:25:18.484889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:25:18.492632 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.493631 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:25:18.495626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.503168 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.504200 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:25:18.506705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.510676 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:25:18.512079 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.514084 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:25:18.517102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:18.521667 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:25:18.523631 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:25:18.524663 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:25:18.528829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:25:18.531859 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:25:18.533824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A5324790>]}
[0m20:25:18.535846 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:25:18.538303 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:25:18.539629 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:25:18.541629 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:25:18.543887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:25:18.545278 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:25:18.555668 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:25:18.558660 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:25:18.572550 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:25:18.578688 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.581634 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:25:18.583375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:18.845780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.262 seconds
[0m20:25:18.846785 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.848799 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:25:18.867305 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m20:25:18.874691 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.875730 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:25:18.878283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.885967 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.888459 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:25:18.890801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:18.894317 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:25:18.896320 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.897317 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:25:18.899944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:18.906191 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:25:18.908186 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:25:18.909184 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:25:18.913203 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:25:18.915815 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:25:18.917697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6A69D90>]}
[0m20:25:18.920002 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.37s]
[0m20:25:18.923001 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:25:18.924840 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:25:18.926906 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:25:18.928962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:25:18.930046 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:25:18.937550 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:25:18.942346 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:25:18.950330 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:25:18.955486 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:18.956486 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:25:18.957769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:19.319240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.361 seconds
[0m20:25:19.320748 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:19.321750 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:25:19.332793 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m20:25:19.339772 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:19.340770 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:25:19.343709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:19.349522 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:19.351519 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:25:19.352516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:19.355838 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:25:19.357832 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:19.358829 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:25:19.364798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:25:19.370821 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:25:19.371818 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:25:19.372818 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:25:19.376953 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:25:19.380543 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:25:19.382537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6A7BA50>]}
[0m20:25:19.383891 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.45s]
[0m20:25:19.386387 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:25:19.388386 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:25:19.390386 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:25:19.392377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:25:19.394402 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:25:19.414832 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:25:19.420051 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:25:19.429540 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:25:19.434882 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:25:19.435911 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:25:19.438645 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:19.768141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.329 seconds
[0m20:25:19.770142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:25:19.772136 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(m.quantity)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
where m.expiry_date between start_date and end_date
  );
[0m20:25:19.777791 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column m.quantity does not exist
LINE 88: select count(m.quantity)
                      ^

[0m20:25:19.779536 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: ROLLBACK
[0m20:25:19.781783 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:25:19.796398 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:25:19.798568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A5371590>]}
[0m20:25:19.800573 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_days ......... [[31mERROR[0m in 0.41s]
[0m20:25:19.804214 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:25:19.805176 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:25:19.806173 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql.
[0m20:25:19.807178 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:25:19.811879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:25:19.813699 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:25:19.823495 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:25:19.829373 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:25:19.916232 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:19.918228 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202519882917"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:25:19.919254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:20.200008 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.281 seconds
[0m20:25:20.231099 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.232106 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:25:20.234704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:25:20.235836 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.237899 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202519882917'
        
      order by ordinal_position

  
[0m20:25:20.263752 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.025 seconds
[0m20:25:20.274727 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.275724 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:20.283567 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:25:20.298527 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.299524 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:20.306639 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:25:20.337079 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:25:20.341383 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.342375 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202519882917" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202519882917"
    )
  
[0m20:25:20.347461 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:25:20.350452 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:25:20.351449 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:25:20.352447 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:25:20.354888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:20.357336 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:25:20.359335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6DB5B50>]}
[0m20:25:20.361334 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.55s]
[0m20:25:20.364557 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:25:20.366551 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:25:20.369221 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:25:20.372246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:25:20.374363 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:25:20.386743 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:25:20.389893 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:25:20.398874 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.400869 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202520395881"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:25:20.401867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:20.649354 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.247 seconds
[0m20:25:20.656298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.657295 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:25:20.659674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:25:20.661454 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.662471 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202520395881'
        
      order by ordinal_position

  
[0m20:25:20.688118 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:25:20.694719 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.695716 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:20.702725 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:25:20.709679 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.711674 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:20.718659 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:25:20.722423 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:25:20.727143 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.728149 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202520395881" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202520395881"
    )
  
[0m20:25:20.732170 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:25:20.735127 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:25:20.737121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:25:20.738121 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:25:20.740460 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:20.742497 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:25:20.744491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A6DD6B90>]}
[0m20:25:20.746450 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.37s]
[0m20:25:20.749940 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:25:20.751809 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:25:20.753882 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:25:20.756386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:25:20.758381 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:25:20.772527 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:25:20.777147 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:25:20.791277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:20.792715 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202520786633"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:25:20.795096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:21.094774 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.300 seconds
[0m20:25:21.101599 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.102608 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:25:21.104626 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:25:21.105665 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.106673 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202520786633'
        
      order by ordinal_position

  
[0m20:25:21.132539 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.025 seconds
[0m20:25:21.139980 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.141028 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:21.147878 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:25:21.157264 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.158266 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:21.165018 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:25:21.176961 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:25:21.181943 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.183936 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202520786633"
    )


  
[0m20:25:21.187926 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:25:21.191915 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:25:21.193912 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:25:21.196090 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:25:21.198384 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:21.200456 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:25:21.202454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A72ADB50>]}
[0m20:25:21.203417 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.45s]
[0m20:25:21.206839 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:25:21.209026 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:25:21.211275 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:25:21.212964 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:25:21.215171 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:25:21.222552 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:25:21.227101 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:25:21.236320 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.237318 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202521233329"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:25:21.239314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:21.515031 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.277 seconds
[0m20:25:21.522031 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.524534 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:25:21.527003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:25:21.529339 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.530355 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202521233329'
        
      order by ordinal_position

  
[0m20:25:21.553829 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:25:21.561721 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.562225 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:21.570435 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:25:21.579062 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.580059 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:21.586879 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:25:21.591547 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:25:21.596126 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.597128 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202521233329" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202521233329"
    )
  
[0m20:25:21.601149 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:25:21.604176 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:25:21.605173 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:25:21.606174 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:25:21.609633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:21.612244 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:25:21.614427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A72AE110>]}
[0m20:25:21.616934 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.40s]
[0m20:25:21.619839 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:25:21.621832 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:25:21.622829 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:25:21.626510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:25:21.629845 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:25:21.641941 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:25:21.647952 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:25:21.661144 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:21.663139 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202521656459"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:25:21.665133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:21.964012 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.299 seconds
[0m20:25:21.972106 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:21.973115 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:25:21.976152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:25:21.977158 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:21.979437 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202521656459'
        
      order by ordinal_position

  
[0m20:25:22.005125 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m20:25:22.015137 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:22.017419 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:22.023474 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:25:22.030753 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:22.031759 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:25:22.039498 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:25:22.043486 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:25:22.047477 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:22.049467 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202521656459" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202521656459"
    )
  
[0m20:25:22.054454 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:25:22.057445 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:25:22.059441 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:25:22.060438 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:25:22.063527 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:22.065770 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:25:22.067764 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4653e769-dbd8-418e-9371-9252dbd62c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A72A6550>]}
[0m20:25:22.069758 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.44s]
[0m20:25:22.072944 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:25:22.076933 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:22.078930 [debug] [MainThread]: On master: BEGIN
[0m20:25:22.081122 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:22.333711 [debug] [MainThread]: SQL status: BEGIN in 0.253 seconds
[0m20:25:22.335712 [debug] [MainThread]: On master: COMMIT
[0m20:25:22.337708 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:22.338705 [debug] [MainThread]: On master: COMMIT
[0m20:25:22.341696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:22.342694 [debug] [MainThread]: On master: Close
[0m20:25:22.345686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:22.346683 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:25:22.348683 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:25:22.350673 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:25:22.352667 [info ] [MainThread]: 
[0m20:25:22.354661 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m20:25:22.379073 [debug] [MainThread]: Command end result
[0m20:25:22.462138 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:25:22.468174 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:25:22.483755 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:25:22.484760 [info ] [MainThread]: 
[0m20:25:22.487030 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:25:22.488600 [info ] [MainThread]: 
[0m20:25:22.489744 [error] [MainThread]:   Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column m.quantity does not exist
  LINE 88: select count(m.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:25:22.491979 [info ] [MainThread]: 
[0m20:25:22.494159 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:25:22.496592 [debug] [MainThread]: Command `dbt run` failed at 20:25:22.496592 after 11.37 seconds
[0m20:25:22.497653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001839E89FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A5204E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183A68CDB90>]}
[0m20:25:22.499694 [debug] [MainThread]: Flushing usage events
[0m20:25:24.041365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:27:33.288773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446FBF6E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446F724450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446FB92B10>]}


============================== 20:27:33.296785 | 516ffc15-7a8c-4814-87ac-0e0ea588abd5 ==============================
[0m20:27:33.296785 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:27:33.299138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:27:33.741128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446FD93F50>]}
[0m20:27:33.881687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446C887A90>]}
[0m20:27:33.884713 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:27:35.115748 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:27:35.841119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:35.843086 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:27:36.527728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024470FAF690>]}
[0m20:27:36.767339 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:27:36.778272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:27:36.838069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024470F78050>]}
[0m20:27:36.839068 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:27:36.841494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024470D77410>]}
[0m20:27:36.846730 [info ] [MainThread]: 
[0m20:27:36.849081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:36.851252 [info ] [MainThread]: 
[0m20:27:36.853069 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:27:36.866203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:27:37.286781 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:27:37.287779 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:27:37.288776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:37.674002 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.385 seconds
[0m20:27:37.676467 [debug] [ThreadPool]: On list_propharma: Close
[0m20:27:37.683044 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:27:37.695123 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:27:37.696377 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:27:37.698109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:37.915530 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m20:27:37.916485 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:27:37.918479 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:27:37.930339 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.011 seconds
[0m20:27:37.933508 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:27:37.935539 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:27:37.936515 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:27:37.948112 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:27:37.949112 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:27:37.950704 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:38.171333 [debug] [ThreadPool]: SQL status: BEGIN in 0.221 seconds
[0m20:27:38.172372 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:27:38.174406 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:27:38.186292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:27:38.189576 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:27:38.190609 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:27:38.202315 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:38.203284 [debug] [MainThread]: On master: BEGIN
[0m20:27:38.204307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:38.437659 [debug] [MainThread]: SQL status: BEGIN in 0.233 seconds
[0m20:27:38.438659 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:38.440915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:27:38.490005 [debug] [MainThread]: SQL status: SELECT 6 in 0.047 seconds
[0m20:27:38.494954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024471433C90>]}
[0m20:27:38.496948 [debug] [MainThread]: On master: ROLLBACK
[0m20:27:38.497946 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:38.499942 [debug] [MainThread]: On master: BEGIN
[0m20:27:38.501604 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:27:38.502604 [debug] [MainThread]: On master: COMMIT
[0m20:27:38.504600 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:38.504600 [debug] [MainThread]: On master: COMMIT
[0m20:27:38.506582 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:38.507620 [debug] [MainThread]: On master: Close
[0m20:27:38.519573 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:27:38.521828 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:27:38.523828 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:27:38.576153 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:27:38.578148 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:27:38.579149 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:38.809359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m20:27:38.810355 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:27:38.811353 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:27:38.813349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:27:38.835331 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:27:38.839932 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:27:38.840933 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:27:38.843594 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:27:38.845300 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:27:38.846715 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:27:38.848885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:27:38.849918 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:27:38.856732 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:27:38.859733 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:27:38.934215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:27:38.938558 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:38.940182 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:27:38.940718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:39.167119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m20:27:39.168126 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:39.170120 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:27:39.178829 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:27:39.192038 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:39.193079 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:27:39.195163 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.201333 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:39.202331 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:27:39.204325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.234594 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:27:39.236547 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:39.237544 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:27:39.247163 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:27:39.260279 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:27:39.270289 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:27:39.271254 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:27:39.275275 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:27:39.279266 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:27:39.285253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244713F65D0>]}
[0m20:27:39.286652 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m20:27:39.289357 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:27:39.290957 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:27:39.291960 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:27:39.294200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:27:39.295497 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:27:39.303282 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:27:39.307271 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:27:39.316018 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:27:39.320023 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.321099 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:27:39.322805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:39.538551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.216 seconds
[0m20:27:39.540543 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.541542 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:27:39.550518 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:27:39.557533 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.559490 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:27:39.561533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.567256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.569215 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:27:39.570249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.574242 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:27:39.575199 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.576233 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:27:39.585471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:27:39.591695 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:27:39.592696 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:27:39.593691 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:27:39.597645 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:27:39.601229 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:27:39.602228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447179B810>]}
[0m20:27:39.603591 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:27:39.606772 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:27:39.608771 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:27:39.609775 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:27:39.612110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:27:39.613201 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:27:39.623550 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:27:39.627874 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:27:39.638240 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:27:39.641279 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.643632 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:27:39.644635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:39.869084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:27:39.870081 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.871080 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:27:39.881049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:27:39.888590 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.889585 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:27:39.891580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.897564 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.898561 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:27:39.900520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:39.903516 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:27:39.904514 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.906509 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:27:39.912817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m20:27:39.918553 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:27:39.919594 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:27:39.920634 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:27:39.924886 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:27:39.928180 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:27:39.929217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446EE65BD0>]}
[0m20:27:39.931175 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:27:39.934672 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:27:39.935668 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:27:39.936665 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:27:39.938970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:27:39.940003 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:27:39.947267 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:27:39.950622 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:27:39.959999 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:27:39.964705 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:39.966704 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:27:39.967705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:40.195154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m20:27:40.196161 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:40.197145 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:27:40.206125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:27:40.213102 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:40.215067 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:27:40.216095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.223075 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:40.224074 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:27:40.226068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.229064 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:27:40.230058 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:40.231060 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:27:40.237354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:27:40.242564 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:27:40.244611 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:27:40.245644 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:27:40.248880 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:27:40.252405 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:27:40.254451 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446FCDBD10>]}
[0m20:27:40.256447 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:27:40.258679 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:27:40.260170 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:27:40.262206 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:27:40.264035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:27:40.265772 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:27:40.275102 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:27:40.279057 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:27:40.288470 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:27:40.292241 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.294252 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:27:40.296246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:40.539946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m20:27:40.540942 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.541940 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:27:40.562873 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m20:27:40.572556 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.573559 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:27:40.576144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.582639 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.583640 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:27:40.585635 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.588627 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:27:40.589625 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.591620 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:27:40.593614 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:27:40.599598 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:27:40.600595 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:27:40.602590 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:27:40.605582 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:27:40.608574 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:27:40.610569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447184B810>]}
[0m20:27:40.612564 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.35s]
[0m20:27:40.615556 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:27:40.616553 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:27:40.617944 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:27:40.621340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:27:40.622335 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:27:40.630301 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:27:40.633314 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:27:40.641778 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:27:40.645950 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.646958 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:27:40.648345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:40.904617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.256 seconds
[0m20:27:40.907121 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.908117 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:27:40.917172 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:27:40.925470 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.927485 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:27:40.929500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.935529 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.936848 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:27:40.938756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:27:40.942203 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:27:40.943508 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.944549 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:27:40.954142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:27:40.960376 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:27:40.962770 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:27:40.963814 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:27:40.967178 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:27:40.970313 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:27:40.971354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244717B3F90>]}
[0m20:27:40.973438 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:27:40.976829 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:27:40.977825 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:27:40.980390 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:27:40.983114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:27:40.985115 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:27:41.002677 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:27:41.005783 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:27:41.015098 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:27:41.019993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:27:41.021196 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:27:41.023253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:41.245771 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:27:41.246763 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:27:41.247760 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.quantity)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
where m.expiry_date between start_date and end_date
  );
[0m20:27:41.252745 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column i.quantity does not exist
LINE 88: select count(i.quantity)
                      ^

[0m20:27:41.253749 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: ROLLBACK
[0m20:27:41.255738 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:27:41.271133 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column i.quantity does not exist
  LINE 88: select count(i.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:27:41.273098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446FBD5C90>]}
[0m20:27:41.274271 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_days ......... [[31mERROR[0m in 0.29s]
[0m20:27:41.278266 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:27:41.279263 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:27:41.281258 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column i.quantity does not exist
  LINE 88: select count(i.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql.
[0m20:27:41.283252 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:27:41.286754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:27:41.288750 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:27:41.299970 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:27:41.304958 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:27:41.443083 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.445078 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202741386629"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:27:41.447072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:41.778213 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.331 seconds
[0m20:27:41.806372 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.807777 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:27:41.810067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:27:41.811119 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.812372 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202741386629'
        
      order by ordinal_position

  
[0m20:27:41.838153 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m20:27:41.849128 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.850126 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:41.859863 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m20:27:41.881778 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.884799 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:41.892777 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:27:41.926416 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:27:41.930509 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.931515 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202741386629" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202741386629"
    )
  
[0m20:27:41.936632 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:27:41.941048 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:27:41.942046 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:27:41.944274 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:27:41.946511 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:27:41.949514 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:27:41.950523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024470FA1B10>]}
[0m20:27:41.952568 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.66s]
[0m20:27:41.956693 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:27:41.958985 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:27:41.961255 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:27:41.964281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:27:41.966281 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:27:41.979126 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:27:41.984383 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:27:41.998296 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.000538 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202741991962"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:27:42.002668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:42.281932 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.280 seconds
[0m20:27:42.288432 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.290427 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:27:42.292421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:27:42.293419 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.294741 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202741991962'
        
      order by ordinal_position

  
[0m20:27:42.320689 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:27:42.328103 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.329590 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:42.336577 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:27:42.343558 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.345553 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:42.352534 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:27:42.356523 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:27:42.360514 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.362579 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202741991962" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202741991962"
    )
  
[0m20:27:42.367566 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m20:27:42.370562 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:27:42.371559 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:27:42.373554 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:27:42.376546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:27:42.378541 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:27:42.380536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447143E8D0>]}
[0m20:27:42.382531 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.42s]
[0m20:27:42.386034 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:27:42.388029 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:27:42.390446 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:27:42.392903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:27:42.395290 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:27:42.409739 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:27:42.412784 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:27:42.426760 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.428756 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202742423775"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:27:42.430749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:42.735195 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.305 seconds
[0m20:27:42.741347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.742392 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:27:42.744477 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:27:42.745518 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.746559 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202742423775'
        
      order by ordinal_position

  
[0m20:27:42.770690 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:27:42.778026 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.779075 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:42.785869 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:27:42.795286 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.797543 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:42.804408 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:27:42.816314 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:27:42.820154 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.821152 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202742423775"
    )


  
[0m20:27:42.823818 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:27:42.827313 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:27:42.828310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:27:42.829310 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:27:42.832112 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:27:42.833690 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:27:42.835651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024471C3E5D0>]}
[0m20:27:42.836853 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.44s]
[0m20:27:42.840039 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:27:42.842321 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:27:42.844320 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:27:42.846314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:27:42.848843 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:27:42.857400 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:27:42.860791 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:27:42.870697 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:42.872524 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202742868156"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:27:42.874525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:43.109634 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.235 seconds
[0m20:27:43.116374 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.117378 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:27:43.119718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:27:43.120791 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.121826 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202742868156'
        
      order by ordinal_position

  
[0m20:27:43.145878 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:27:43.152093 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.154053 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:43.160730 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:27:43.166634 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.168631 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:43.174654 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:27:43.179309 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:27:43.183262 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.184297 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202742868156" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202742868156"
    )
  
[0m20:27:43.188883 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:27:43.192073 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:27:43.193145 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:27:43.194188 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:27:43.198110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:27:43.199985 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:27:43.201022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024471C3E350>]}
[0m20:27:43.203622 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.35s]
[0m20:27:43.206614 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:27:43.208608 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:27:43.209605 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:27:43.212750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:27:43.214257 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:27:43.223263 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:27:43.228201 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:27:43.239034 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.241494 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202743235400"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:27:43.243496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:43.506748 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.264 seconds
[0m20:27:43.514984 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.515985 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:27:43.518517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:27:43.519635 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.520639 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202743235400'
        
      order by ordinal_position

  
[0m20:27:43.543671 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:27:43.554073 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.555071 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:43.562529 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:27:43.568856 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.569858 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:27:43.577231 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:27:43.582000 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:27:43.585498 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.587496 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202743235400" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202743235400"
    )
  
[0m20:27:43.591521 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:27:43.594903 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:27:43.596144 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:27:43.597149 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:27:43.599483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:27:43.602631 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:27:43.603637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '516ffc15-7a8c-4814-87ac-0e0ea588abd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002447102D510>]}
[0m20:27:43.604935 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.39s]
[0m20:27:43.608349 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:27:43.611341 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:43.613336 [debug] [MainThread]: On master: BEGIN
[0m20:27:43.614333 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:27:43.852017 [debug] [MainThread]: SQL status: BEGIN in 0.238 seconds
[0m20:27:43.853063 [debug] [MainThread]: On master: COMMIT
[0m20:27:43.854217 [debug] [MainThread]: Using postgres connection "master"
[0m20:27:43.855381 [debug] [MainThread]: On master: COMMIT
[0m20:27:43.857019 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:27:43.858157 [debug] [MainThread]: On master: Close
[0m20:27:43.859195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:43.860815 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:27:43.862017 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:27:43.863436 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:27:43.864485 [info ] [MainThread]: 
[0m20:27:43.866865 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m20:27:43.872857 [debug] [MainThread]: Command end result
[0m20:27:43.962136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:27:43.971559 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:27:43.987369 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:27:43.988728 [info ] [MainThread]: 
[0m20:27:43.990921 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:27:43.992932 [info ] [MainThread]: 
[0m20:27:43.994927 [error] [MainThread]:   Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column i.quantity does not exist
  LINE 88: select count(i.quantity)
                        ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:27:43.997918 [info ] [MainThread]: 
[0m20:27:43.999913 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:27:44.003083 [debug] [MainThread]: Command `dbt run` failed at 20:27:44.003083 after 10.98 seconds
[0m20:27:44.005099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244695C9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446F802D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002446F802890>]}
[0m20:27:44.006097 [debug] [MainThread]: Flushing usage events
[0m20:27:45.365224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:28:18.194926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA05C5E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA05A4FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA05C5C90>]}


============================== 20:28:18.202909 | b5121752-c026-4a76-9b68-d914abc71ca0 ==============================
[0m20:28:18.202909 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:28:18.206272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:28:18.684105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA05D3A90>]}
[0m20:28:18.807364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C9D257790>]}
[0m20:28:18.810365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:28:19.713013 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:28:20.304504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:28:20.305430 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:28:21.006794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA079B0D0>]}
[0m20:28:21.372882 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:28:21.388005 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:28:21.499169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA1C556D0>]}
[0m20:28:21.501207 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:28:21.503348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA1CE2890>]}
[0m20:28:21.508857 [info ] [MainThread]: 
[0m20:28:21.511524 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:21.513859 [info ] [MainThread]: 
[0m20:28:21.517064 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:28:21.535139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:28:22.015904 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:28:22.016879 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:28:22.017899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:22.275387 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.257 seconds
[0m20:28:22.278347 [debug] [ThreadPool]: On list_propharma: Close
[0m20:28:22.284116 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:28:22.295401 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:28:22.297640 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:28:22.298646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:22.522732 [debug] [ThreadPool]: SQL status: BEGIN in 0.224 seconds
[0m20:28:22.523738 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:28:22.525247 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:28:22.536166 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:28:22.539354 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:28:22.541634 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:28:22.542629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:28:22.549029 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:28:22.550447 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:28:22.551680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:22.779136 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m20:28:22.780184 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:28:22.782100 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:28:22.793075 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m20:28:22.796838 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:28:22.797837 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:28:22.813367 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:22.814331 [debug] [MainThread]: On master: BEGIN
[0m20:28:22.815329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:23.042807 [debug] [MainThread]: SQL status: BEGIN in 0.227 seconds
[0m20:28:23.044136 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:23.045170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:28:23.087549 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m20:28:23.095849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA1E64790>]}
[0m20:28:23.097849 [debug] [MainThread]: On master: ROLLBACK
[0m20:28:23.100245 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:23.101753 [debug] [MainThread]: On master: BEGIN
[0m20:28:23.103972 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:28:23.105639 [debug] [MainThread]: On master: COMMIT
[0m20:28:23.106673 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:23.107881 [debug] [MainThread]: On master: COMMIT
[0m20:28:23.109912 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:23.111054 [debug] [MainThread]: On master: Close
[0m20:28:23.121690 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:28:23.123198 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:28:23.124195 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:28:23.181559 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:28:23.183386 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:28:23.184754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:28:23.541734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.357 seconds
[0m20:28:23.542960 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:28:23.545384 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:28:23.547566 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:28:23.571082 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:28:23.575957 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:28:23.578618 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:28:23.581331 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:28:23.582333 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:28:23.585552 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:28:23.586780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:28:23.589072 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:28:23.597802 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:28:23.601231 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:28:23.684498 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:28:23.688879 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:23.690062 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:28:23.692091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:23.959139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.267 seconds
[0m20:28:23.961393 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:23.963388 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:28:23.974911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:28:23.989469 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:23.991495 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:28:23.993770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.003447 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:24.005891 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:28:24.007897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.042846 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:28:24.044950 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:24.046002 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:28:24.048705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:24.064574 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:28:24.075544 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:28:24.077538 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:28:24.081214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:24.086692 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:28:24.091589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA19DF790>]}
[0m20:28:24.093587 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.50s]
[0m20:28:24.097124 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:28:24.098424 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:28:24.099426 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:28:24.101770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:28:24.102890 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:28:24.112664 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:28:24.115655 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:28:24.125276 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:28:24.128882 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.130883 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:28:24.131879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:24.364258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m20:28:24.365998 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.368001 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:28:24.377973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:28:24.386156 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.387695 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:28:24.389720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.396842 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.397834 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:28:24.399802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.402668 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:28:24.404667 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.405695 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:28:24.410930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:28:24.417256 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:28:24.419264 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:28:24.420335 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:28:24.423625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:28:24.427471 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:28:24.429471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA1C9A150>]}
[0m20:28:24.431466 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:28:24.434952 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:28:24.435953 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:28:24.436951 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:28:24.439746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:28:24.441785 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:28:24.452755 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:28:24.456891 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:28:24.464163 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:28:24.468587 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.470601 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:28:24.471605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:24.735834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.264 seconds
[0m20:28:24.736840 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.739440 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:28:24.751486 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:28:24.761458 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.762810 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:28:24.765820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.771869 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.774000 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:28:24.776156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:24.779190 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:28:24.780191 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.781637 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:28:24.788199 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:28:24.799228 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:28:24.802350 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:28:24.805083 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:28:24.811722 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:28:24.817767 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:28:24.822499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA21B34D0>]}
[0m20:28:24.826210 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.38s]
[0m20:28:24.831943 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:28:24.835931 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:28:24.838922 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:28:24.842913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:28:24.845594 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:28:24.854249 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:28:24.858594 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:28:24.867954 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:28:24.871184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:24.873740 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:28:24.875740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:25.100490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:28:25.101035 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:25.102566 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:28:25.112301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:28:25.119233 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:25.121228 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:28:25.123192 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.130187 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:25.131220 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:28:25.133187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.136180 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:28:25.138174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:25.139170 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:28:25.144509 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:28:25.150694 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:28:25.152689 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:28:25.153686 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:28:25.157085 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:25.161038 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:28:25.162041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA06EAA90>]}
[0m20:28:25.163999 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:28:25.167063 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:28:25.169476 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:28:25.170482 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:28:25.173470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:28:25.175467 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:28:25.184996 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:28:25.189007 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:28:25.197820 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:28:25.201567 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.202837 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:28:25.203900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:25.521106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.316 seconds
[0m20:28:25.522899 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.524147 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:28:25.533372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:28:25.540899 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.542446 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:28:25.544441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.550423 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.552451 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:28:25.553417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.557441 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:28:25.558580 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.559618 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:28:25.566913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:28:25.572385 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:28:25.574383 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:28:25.576137 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:28:25.579252 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:25.583056 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:28:25.585409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA07C7210>]}
[0m20:28:25.586738 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.41s]
[0m20:28:25.590389 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:28:25.591936 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:28:25.593103 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:28:25.595505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:28:25.597719 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:28:25.604271 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:28:25.608460 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:28:25.617447 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:28:25.621829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.622841 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:28:25.623850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:25.854388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m20:28:25.856381 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.857377 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:28:25.867372 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:28:25.875407 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.876991 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:28:25.879199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.886210 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.887212 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:28:25.889203 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:28:25.892844 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:28:25.893806 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.895801 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:28:25.900787 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:28:25.906772 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:28:25.908797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:28:25.909765 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:28:25.913781 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:28:25.916885 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:28:25.919072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA18F6690>]}
[0m20:28:25.920657 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:28:25.923122 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:28:25.925375 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:28:25.926380 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:28:25.929049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:28:25.931052 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:28:25.949346 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:28:25.953326 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:28:25.963456 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:28:25.968131 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:28:25.970278 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:28:25.970784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:26.197859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m20:28:26.199902 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:28:26.200953 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.stock_qty)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
where m.expiry_date between start_date and end_date
  );
[0m20:28:26.205607 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "start_date" does not exist
LINE 93: where m.expiry_date between start_date and end_date
                                     ^

[0m20:28:26.207976 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: ROLLBACK
[0m20:28:26.208973 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:28:26.223283 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column "start_date" does not exist
  LINE 93: where m.expiry_date between start_date and end_date
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:28:26.225278 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA0563010>]}
[0m20:28:26.227273 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_days ......... [[31mERROR[0m in 0.30s]
[0m20:28:26.230345 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:28:26.231388 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:28:26.232467 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column "start_date" does not exist
  LINE 93: where m.expiry_date between start_date and end_date
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql.
[0m20:28:26.233472 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:28:26.237995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:28:26.240144 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:28:26.249815 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:28:26.254035 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:28:26.341787 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.342860 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202826308515"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:28:26.344863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:26.578729 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.234 seconds
[0m20:28:26.605167 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.606164 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:28:26.609441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:28:26.611568 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.613015 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202826308515'
        
      order by ordinal_position

  
[0m20:28:26.645542 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.031 seconds
[0m20:28:26.656710 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.658705 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:26.665686 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:28:26.681644 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.682641 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:26.690295 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:28:26.721054 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:28:26.725634 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.727448 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202826308515" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202826308515"
    )
  
[0m20:28:26.732130 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:28:26.735127 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:28:26.736123 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:28:26.737122 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:28:26.740621 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:26.742621 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:28:26.744616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA06935D0>]}
[0m20:28:26.746611 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.51s]
[0m20:28:26.749976 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:28:26.750972 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:28:26.753384 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:28:26.755076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:28:26.757289 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:28:26.769341 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:28:26.772869 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:28:26.782180 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:26.784245 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202826778598"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:28:26.785452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:27.017526 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.232 seconds
[0m20:28:27.023445 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.025440 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:28:27.027468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:28:27.028470 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.030019 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202826778598'
        
      order by ordinal_position

  
[0m20:28:27.053588 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.022 seconds
[0m20:28:27.062385 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.064398 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.071840 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:28:27.078825 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.079823 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.087160 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:28:27.091418 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:28:27.096214 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.098200 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202826778598" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202826778598"
    )
  
[0m20:28:27.101422 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:28:27.105219 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:28:27.106256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:28:27.108395 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:28:27.111639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:28:27.114248 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:28:27.115559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA1E06F10>]}
[0m20:28:27.118120 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.36s]
[0m20:28:27.120500 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:28:27.123174 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:28:27.125567 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:28:27.127106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:28:27.129906 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:28:27.145466 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:28:27.148493 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:28:27.158107 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.159704 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202827154481"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:28:27.160737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:27.404729 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.243 seconds
[0m20:28:27.411028 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.412024 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:28:27.414798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:28:27.415833 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.417050 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202827154481'
        
      order by ordinal_position

  
[0m20:28:27.441154 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:28:27.448137 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.449098 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.456052 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:28:27.466411 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.467372 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.474353 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:28:27.487353 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:28:27.491519 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.492562 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202827154481"
    )


  
[0m20:28:27.496426 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:28:27.499437 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:28:27.507458 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:28:27.510407 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:28:27.524169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m20:28:27.528212 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:28:27.530198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA260FE10>]}
[0m20:28:27.533495 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.40s]
[0m20:28:27.537490 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:28:27.539789 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:28:27.541586 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:28:27.543585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:28:27.544920 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:28:27.553741 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:28:27.557701 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:28:27.567214 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.568210 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202827564186"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:28:27.570174 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:27.811218 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.241 seconds
[0m20:28:27.817209 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.818206 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:28:27.820203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:28:27.821737 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.823333 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202827564186'
        
      order by ordinal_position

  
[0m20:28:27.847494 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:28:27.854787 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.856828 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.863837 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:28:27.870681 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.871721 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:27.879230 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:28:27.883215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:28:27.888170 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.889419 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202827564186" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202827564186"
    )
  
[0m20:28:27.893626 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:28:27.896883 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:28:27.897916 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:28:27.899349 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:28:27.903045 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:28:27.905038 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:28:27.906264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA260A150>]}
[0m20:28:27.908367 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.36s]
[0m20:28:27.911919 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:28:27.914199 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:28:27.914736 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:28:27.918354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:28:27.920918 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:28:27.928633 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:28:27.933504 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:28:27.943688 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:27.944982 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202827939701"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:28:27.946994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:28:28.288715 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.342 seconds
[0m20:28:28.295556 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.296547 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:28:28.299529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:28:28.299529 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.301547 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202827939701'
        
      order by ordinal_position

  
[0m20:28:28.330218 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.027 seconds
[0m20:28:28.341193 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.342190 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:28.349205 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:28:28.362137 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.363134 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:28:28.370738 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:28:28.374723 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:28:28.378941 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.380940 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202827939701" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202827939701"
    )
  
[0m20:28:28.385141 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:28:28.389090 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:28:28.390085 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:28:28.392079 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:28:28.394106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:28:28.396138 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:28:28.398132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5121752-c026-4a76-9b68-d914abc71ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA220A350>]}
[0m20:28:28.401342 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.48s]
[0m20:28:28.404498 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:28:28.407490 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:28.409484 [debug] [MainThread]: On master: BEGIN
[0m20:28:28.410483 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:28:28.661504 [debug] [MainThread]: SQL status: BEGIN in 0.251 seconds
[0m20:28:28.663684 [debug] [MainThread]: On master: COMMIT
[0m20:28:28.664734 [debug] [MainThread]: Using postgres connection "master"
[0m20:28:28.665819 [debug] [MainThread]: On master: COMMIT
[0m20:28:28.667320 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:28:28.668331 [debug] [MainThread]: On master: Close
[0m20:28:28.670430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:28.671433 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:28:28.672431 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:28:28.674425 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:28:28.675422 [info ] [MainThread]: 
[0m20:28:28.677968 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m20:28:28.684571 [debug] [MainThread]: Command end result
[0m20:28:28.761217 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:28:28.768294 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:28:28.784197 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:28:28.785164 [info ] [MainThread]: 
[0m20:28:28.788036 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:28:28.790061 [info ] [MainThread]: 
[0m20:28:28.792062 [error] [MainThread]:   Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  column "start_date" does not exist
  LINE 93: where m.expiry_date between start_date and end_date
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:28:28.794661 [info ] [MainThread]: 
[0m20:28:28.796176 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:28:28.799168 [debug] [MainThread]: Command `dbt run` failed at 20:28:28.799168 after 10.87 seconds
[0m20:28:28.800165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C99CFFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C9D4D79D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C99F99590>]}
[0m20:28:28.802160 [debug] [MainThread]: Flushing usage events
[0m20:28:30.397776 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:25.008820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D05317590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D05316450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D05315ED0>]}


============================== 20:29:25.017796 | 61e18470-a8be-49be-9ae7-3d022c0949d8 ==============================
[0m20:29:25.017796 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:29:25.019895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:29:25.586491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D054A0750>]}
[0m20:29:25.978843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D01FA7B50>]}
[0m20:29:25.983830 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:29:26.938084 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:29:27.561742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:27.563737 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:29:28.217364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D05320E90>]}
[0m20:29:28.594069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:29:28.612024 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:29:28.705598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06A29D50>]}
[0m20:29:28.706603 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:29:28.710551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D066CDF90>]}
[0m20:29:28.720807 [info ] [MainThread]: 
[0m20:29:28.724598 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:28.728824 [info ] [MainThread]: 
[0m20:29:28.731816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:28.753745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:29:29.306225 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:29:29.308499 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:29:29.309500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:29.612351 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.303 seconds
[0m20:29:29.615343 [debug] [ThreadPool]: On list_propharma: Close
[0m20:29:29.621329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:29:29.635482 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:29:29.637477 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:29:29.638474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:29.882506 [debug] [ThreadPool]: SQL status: BEGIN in 0.244 seconds
[0m20:29:29.884220 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:29:29.885253 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:29:29.896786 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:29:29.900746 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:29:29.902741 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:29:29.904750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:29:29.912093 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:29:29.913763 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:29:29.916215 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:30.180672 [debug] [ThreadPool]: SQL status: BEGIN in 0.264 seconds
[0m20:29:30.181808 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:29:30.182811 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:30.193491 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m20:29:30.197721 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:29:30.198729 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:29:30.216148 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:30.217151 [debug] [MainThread]: On master: BEGIN
[0m20:29:30.218153 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:30.462374 [debug] [MainThread]: SQL status: BEGIN in 0.244 seconds
[0m20:29:30.463878 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:30.465387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:29:30.508781 [debug] [MainThread]: SQL status: SELECT 6 in 0.043 seconds
[0m20:29:30.513673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06EFBE50>]}
[0m20:29:30.515716 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:30.516727 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:30.517764 [debug] [MainThread]: On master: BEGIN
[0m20:29:30.520028 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:29:30.521056 [debug] [MainThread]: On master: COMMIT
[0m20:29:30.522095 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:30.523472 [debug] [MainThread]: On master: COMMIT
[0m20:29:30.524903 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:30.526078 [debug] [MainThread]: On master: Close
[0m20:29:30.536009 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:29:30.537518 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:29:30.538863 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:29:30.591877 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:29:30.592874 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:29:30.593871 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:29:30.822322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.228 seconds
[0m20:29:30.824352 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:29:30.825354 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:29:30.827487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:29:30.851503 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:29:30.855520 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:29:30.857550 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:29:30.859653 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:29:30.860656 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:29:30.862655 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:29:30.865091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:29:30.866093 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:29:30.873173 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:29:30.877263 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:29:30.956465 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:29:30.960921 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:30.962429 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:29:30.963457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:31.194416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m20:29:31.195445 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:31.197440 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:29:31.206384 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:29:31.220368 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:31.221336 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:29:31.224502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.230485 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:31.231483 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:29:31.233475 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.264745 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:29:31.265747 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:31.266741 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:29:31.270383 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:31.283532 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:29:31.294420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:29:31.295418 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:29:31.299371 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:29:31.304361 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:29:31.309344 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06706950>]}
[0m20:29:31.311344 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.44s]
[0m20:29:31.314489 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:29:31.316521 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:29:31.317486 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:29:31.320587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:29:31.322508 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:29:31.328528 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:29:31.332491 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:29:31.341796 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:29:31.346285 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.347288 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:29:31.349285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:31.576612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.227 seconds
[0m20:29:31.577814 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.579173 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:29:31.589607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:29:31.596969 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.597966 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:29:31.599932 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.607020 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.608986 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:29:31.609992 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.613315 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:29:31.615310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.617305 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:29:31.619395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:31.626739 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:29:31.628861 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:29:31.629884 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:29:31.634370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:29:31.637961 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:29:31.639955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06F06150>]}
[0m20:29:31.641953 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:29:31.644287 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:29:31.646763 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:29:31.650071 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:29:31.652499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:29:31.654877 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:29:31.665607 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:29:31.669781 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:29:31.681637 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:29:31.686623 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.689126 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:29:31.690442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:31.934274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m20:29:31.935817 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.937462 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:29:31.950157 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m20:29:31.958136 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.960131 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:29:31.962125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.970415 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.971569 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:29:31.973605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:31.977628 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:29:31.978592 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.979589 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:29:31.983788 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:31.989792 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:29:31.991786 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:29:31.992784 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:29:31.997805 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:29:32.000763 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:29:32.002755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D04C97B10>]}
[0m20:29:32.005096 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:29:32.007690 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:29:32.009725 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:29:32.012085 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:29:32.014079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:29:32.015081 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:29:32.024399 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:29:32.027723 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:29:32.036696 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:29:32.040793 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.042794 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:29:32.045082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:32.317493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.273 seconds
[0m20:29:32.318774 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.319787 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:29:32.329981 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:29:32.337014 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.338012 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:29:32.340007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:32.346533 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.348969 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:29:32.351020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:32.354140 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:29:32.355185 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.356390 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:29:32.360118 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:32.366577 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:29:32.367543 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:29:32.369535 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:29:32.372801 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:29:32.375948 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:29:32.377943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06BB8D10>]}
[0m20:29:32.378939 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.36s]
[0m20:29:32.382620 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:29:32.383592 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:29:32.384616 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:29:32.386629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:29:32.389143 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:29:32.400218 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:29:32.403179 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:29:32.411648 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:29:32.416519 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.416519 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:29:32.418380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:32.642761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:29:32.644242 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.645949 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:29:32.654769 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:29:32.662374 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.663371 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:29:32.665811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:32.672540 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.673559 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:29:32.675571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:32.679233 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:29:32.680230 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.682226 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:29:32.685463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:32.691006 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:29:32.693001 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:29:32.693999 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:29:32.698022 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:29:32.701095 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:29:32.703056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06EC7110>]}
[0m20:29:32.705313 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m20:29:32.708338 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:29:32.709334 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:29:32.711362 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:29:32.713197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:29:32.714503 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:29:32.721871 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:29:32.727188 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:29:32.736792 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:29:32.741658 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:32.743166 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:29:32.744162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:32.968189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.223 seconds
[0m20:29:32.970184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:32.971181 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:29:32.980302 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:29:32.988485 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:32.989030 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:29:32.991498 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:32.998353 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:32.999318 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:29:33.001371 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:33.004647 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:29:33.005646 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:33.007663 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:29:33.011119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:33.016834 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:29:33.017374 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:29:33.018868 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:29:33.023695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:29:33.026613 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:29:33.028574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06EC6ED0>]}
[0m20:29:33.029920 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:29:33.033325 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:29:33.034323 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:29:33.036319 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:29:33.038406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:29:33.039498 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:29:33.061753 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:29:33.066071 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:29:33.073980 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:29:33.079476 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:29:33.080480 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:29:33.081508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:33.305527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:29:33.307578 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:29:33.308608 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.stock_qty)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
where m.expiry_date between spine.start_date and spine.end_date
  );
[0m20:29:33.313409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "spine"
LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                     ^

[0m20:29:33.314826 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: ROLLBACK
[0m20:29:33.316872 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:29:33.332079 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:29:33.333077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D053F45D0>]}
[0m20:29:33.334331 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_days ......... [[31mERROR[0m in 0.29s]
[0m20:29:33.338071 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:29:33.339144 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:29:33.340177 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql.
[0m20:29:33.342171 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:29:33.344731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:29:33.347094 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:29:33.357018 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:29:33.361953 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:29:33.443306 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.445301 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp202933410653"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:29:33.446298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:33.700461 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.254 seconds
[0m20:29:33.727389 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.728373 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:29:33.730587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:29:33.731887 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.733054 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp202933410653'
        
      order by ordinal_position

  
[0m20:29:33.763676 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.027 seconds
[0m20:29:33.773653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.775652 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:33.782588 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:29:33.798380 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.799420 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:33.806429 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:29:33.844126 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:29:33.848578 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.850581 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp202933410653" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp202933410653"
    )
  
[0m20:29:33.855400 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:29:33.858391 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:29:33.859391 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:29:33.861018 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:29:33.863016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:29:33.865365 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:29:33.867410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D064DE6D0>]}
[0m20:29:33.869410 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.52s]
[0m20:29:33.873396 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:29:33.875396 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:29:33.878667 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:29:33.881393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:29:33.882833 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:29:33.895218 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:29:33.899225 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:29:33.912966 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:33.914962 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp202933908975"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:29:33.915959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:34.160913 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.246 seconds
[0m20:29:34.168666 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.170676 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:29:34.172689 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:29:34.173685 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.174953 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp202933908975'
        
      order by ordinal_position

  
[0m20:29:34.199893 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:29:34.207532 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.208534 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:34.217549 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m20:29:34.225405 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.226409 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:34.233561 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:29:34.237571 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:29:34.242198 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.243201 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp202933908975" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp202933908975"
    )
  
[0m20:29:34.248042 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:29:34.251143 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:29:34.252139 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:29:34.253353 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:29:34.256433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:34.258354 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:29:34.260402 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06F16690>]}
[0m20:29:34.261528 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.38s]
[0m20:29:34.265736 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:29:34.266732 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:29:34.268726 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:29:34.271151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:29:34.273356 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:29:34.286900 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:29:34.292024 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:29:34.300684 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.302037 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp202934297640"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:29:34.303377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:34.556973 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.253 seconds
[0m20:29:34.563038 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.565033 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:29:34.566030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:29:34.567530 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.569808 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp202934297640'
        
      order by ordinal_position

  
[0m20:29:34.593551 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:29:34.601077 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.602716 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:34.610031 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:29:34.621074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.623069 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:34.629084 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:29:34.642055 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:29:34.646697 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.647731 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp202934297640"
    )


  
[0m20:29:34.650722 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:29:34.654561 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:29:34.655098 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:29:34.656808 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:29:34.658579 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:29:34.661044 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:29:34.663039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D053F66D0>]}
[0m20:29:34.664068 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.39s]
[0m20:29:34.668853 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:29:34.670853 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:29:34.672216 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:29:34.675176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:29:34.676409 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:29:34.685007 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:29:34.688866 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:29:34.699151 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:34.700336 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp202934695310"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:29:34.701847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:34.946559 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.245 seconds
[0m20:29:34.953976 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:34.954973 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:29:34.957551 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:29:34.958091 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:34.960150 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp202934695310'
        
      order by ordinal_position

  
[0m20:29:34.983873 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:29:34.990670 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:34.991637 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:34.997815 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:29:35.005534 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:35.006574 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:35.013808 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:29:35.017876 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:29:35.022215 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:35.024395 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp202934695310" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp202934695310"
    )
  
[0m20:29:35.027733 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:29:35.030909 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:29:35.031906 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:29:35.033901 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:29:35.037455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:29:35.040568 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:29:35.041824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D068F6890>]}
[0m20:29:35.044161 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.37s]
[0m20:29:35.047327 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:29:35.049321 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:29:35.050940 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:29:35.053850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:29:35.055965 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:29:35.064342 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:29:35.068972 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:29:35.077544 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.078878 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp202935074303"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:29:35.080139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:29:35.438829 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.358 seconds
[0m20:29:35.444964 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.446183 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:29:35.449142 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:29:35.450140 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.451137 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp202935074303'
        
      order by ordinal_position

  
[0m20:29:35.475255 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:29:35.486190 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.487214 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:35.495736 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m20:29:35.502988 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.503955 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:29:35.511292 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:29:35.515385 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:29:35.519863 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.520887 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp202935074303" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp202935074303"
    )
  
[0m20:29:35.525580 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:29:35.528671 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:29:35.530163 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:29:35.530700 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:29:35.534143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:35.536982 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:29:35.538014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61e18470-a8be-49be-9ae7-3d022c0949d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06F8F550>]}
[0m20:29:35.539371 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.48s]
[0m20:29:35.542850 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:29:35.545843 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:35.546840 [debug] [MainThread]: On master: BEGIN
[0m20:29:35.548835 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:35.779719 [debug] [MainThread]: SQL status: BEGIN in 0.231 seconds
[0m20:29:35.780726 [debug] [MainThread]: On master: COMMIT
[0m20:29:35.782034 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:35.783266 [debug] [MainThread]: On master: COMMIT
[0m20:29:35.785379 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:35.786561 [debug] [MainThread]: On master: Close
[0m20:29:35.787874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:35.788876 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:29:35.789874 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:29:35.790871 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:29:35.791872 [info ] [MainThread]: 
[0m20:29:35.793884 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.06 seconds (7.06s).
[0m20:29:35.799957 [debug] [MainThread]: Command end result
[0m20:29:35.878020 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:29:35.884852 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:29:35.900119 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:29:35.902160 [info ] [MainThread]: 
[0m20:29:35.904037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:29:35.906083 [info ] [MainThread]: 
[0m20:29:35.908772 [error] [MainThread]:   Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:29:35.912059 [info ] [MainThread]: 
[0m20:29:35.915498 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:29:35.920568 [debug] [MainThread]: Command `dbt run` failed at 20:29:35.919486 after 11.21 seconds
[0m20:29:35.922479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D7EBA9590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D07395DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D04585190>]}
[0m20:29:35.924475 [debug] [MainThread]: Flushing usage events
[0m20:29:37.522700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:12.581237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1676C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1654A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1675ED0>]}


============================== 20:31:12.589292 | c63ecb5b-8177-498c-b06c-7570182bdbde ==============================
[0m20:31:12.589292 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:31:12.591381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:31:13.035105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819E4F0F90>]}
[0m20:31:13.161817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819E277410>]}
[0m20:31:13.164831 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:31:14.180186 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:31:14.787284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:31:14.790245 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:31:15.394443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A2B17650>]}
[0m20:31:15.630224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:31:15.641200 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:31:15.702034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A2D0EA10>]}
[0m20:31:15.704029 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:31:15.706195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A2A41C10>]}
[0m20:31:15.710946 [info ] [MainThread]: 
[0m20:31:15.712376 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:31:15.714452 [info ] [MainThread]: 
[0m20:31:15.717072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:15.730659 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:31:16.169036 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:31:16.170033 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:31:16.171031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:16.632248 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.461 seconds
[0m20:31:16.637344 [debug] [ThreadPool]: On list_propharma: Close
[0m20:31:16.644699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:31:16.668123 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:31:16.669207 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:31:16.670525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:16.916699 [debug] [ThreadPool]: SQL status: BEGIN in 0.246 seconds
[0m20:31:16.919208 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:31:16.920692 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:31:16.931775 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:31:16.935343 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:31:16.935881 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:31:16.938564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:31:16.943987 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:31:16.945024 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:31:16.946031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:17.293363 [debug] [ThreadPool]: SQL status: BEGIN in 0.347 seconds
[0m20:31:17.294360 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:31:17.296356 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:17.311957 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.014 seconds
[0m20:31:17.315947 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:31:17.319851 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:31:17.350224 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:17.352492 [debug] [MainThread]: On master: BEGIN
[0m20:31:17.355107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:17.611191 [debug] [MainThread]: SQL status: BEGIN in 0.256 seconds
[0m20:31:17.612660 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:17.614825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:31:17.658223 [debug] [MainThread]: SQL status: SELECT 6 in 0.043 seconds
[0m20:31:17.663641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A3211090>]}
[0m20:31:17.664684 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:17.666868 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:17.667910 [debug] [MainThread]: On master: BEGIN
[0m20:31:17.670101 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:31:17.671335 [debug] [MainThread]: On master: COMMIT
[0m20:31:17.672394 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:17.672394 [debug] [MainThread]: On master: COMMIT
[0m20:31:17.673654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:17.676095 [debug] [MainThread]: On master: Close
[0m20:31:17.686289 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:31:17.687811 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:31:17.689819 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:31:17.741720 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:31:17.742718 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:31:17.744709 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:18.068093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.324 seconds
[0m20:31:18.070234 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:31:18.071702 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:31:18.073883 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:31:18.094483 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:31:18.098838 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:31:18.099840 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:31:18.103680 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:31:18.104677 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:31:18.106672 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:31:18.108923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:31:18.110998 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:31:18.118122 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:31:18.121892 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:31:18.194762 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:31:18.198888 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.200793 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:31:18.201796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:18.423747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:31:18.423747 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.425768 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:31:18.435720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:31:18.448640 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.450635 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:31:18.452666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:18.458935 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.459932 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:31:18.461528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:18.493755 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:31:18.494926 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.495964 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:31:18.499821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:18.512840 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:31:18.522327 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:31:18.523328 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:31:18.527455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:31:18.532858 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:31:18.536848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A321DD10>]}
[0m20:31:18.539846 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:31:18.543327 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:31:18.545326 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:31:18.546697 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:31:18.548750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:31:18.550936 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:31:18.557916 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:31:18.562106 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:31:18.571113 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:31:18.575583 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.579050 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:31:18.581220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:18.828103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m20:31:18.828609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.830486 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:31:18.843100 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:31:18.851427 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.853422 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:31:18.855422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:18.862429 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.863427 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:31:18.865517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:18.868552 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:31:18.870510 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.871525 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:31:18.873919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:18.879907 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:31:18.881904 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:31:18.883897 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:31:18.888888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:31:18.891879 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:31:18.892877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A170D7D0>]}
[0m20:31:18.895427 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m20:31:18.898574 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:31:18.900568 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:31:18.902567 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:31:18.904559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:31:18.906236 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:31:18.918608 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:31:18.921604 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:31:18.930052 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:31:18.934555 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:18.935777 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:31:18.937663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:19.170669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m20:31:19.172151 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:19.173192 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:31:19.183221 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:31:19.190892 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:19.192095 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:31:19.193277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.199789 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:19.201823 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:31:19.203394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.206344 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:31:19.208067 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:19.209106 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:31:19.212061 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:19.218076 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:31:19.220042 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:31:19.221036 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:31:19.225761 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:31:19.228745 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:31:19.230743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A17558D0>]}
[0m20:31:19.231741 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:31:19.234733 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:31:19.237015 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:31:19.238073 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:31:19.241133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:31:19.242217 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:31:19.249497 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:31:19.254092 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:31:19.262064 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:31:19.266393 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.267389 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:31:19.268386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:19.498960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.231 seconds
[0m20:31:19.500985 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.502010 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:31:19.511309 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:31:19.518940 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.519942 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:31:19.522162 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.528317 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.529315 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:31:19.531543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.534550 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:31:19.536632 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.537724 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:31:19.540608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:19.545724 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:31:19.547789 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:31:19.548821 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:31:19.552066 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:31:19.555069 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:31:19.557063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1755B90>]}
[0m20:31:19.559059 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:31:19.561316 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:31:19.562404 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:31:19.564897 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:31:19.566951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:31:19.569450 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:31:19.579227 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:31:19.583320 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:31:19.594295 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:31:19.598653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.599658 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:31:19.602018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:19.819867 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m20:31:19.822420 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.822420 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:31:19.832010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:31:19.839756 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.840797 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:31:19.842844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.850257 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.851263 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:31:19.853216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:19.856523 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:31:19.857521 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.858521 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:31:19.861330 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:19.867151 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:31:19.869109 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:31:19.870139 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:31:19.873462 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:31:19.876454 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:31:19.878850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A32D3D10>]}
[0m20:31:19.881427 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.31s]
[0m20:31:19.884420 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:31:19.885417 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:31:19.887572 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:31:19.889405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:31:19.890895 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:31:19.899663 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:31:19.903683 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:31:19.912318 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:31:19.916449 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:19.918449 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:31:19.919449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:20.141780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:31:20.143150 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:20.144871 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:31:20.153888 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:31:20.160836 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:20.161833 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:31:20.163830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:20.170809 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:20.171806 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:31:20.173802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:20.176794 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:31:20.177791 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:20.178788 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:31:20.181626 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:20.187037 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:31:20.188079 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:31:20.189525 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:31:20.193242 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:31:20.196728 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:31:20.197768 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A321CF90>]}
[0m20:31:20.199795 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:31:20.201788 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:31:20.204025 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:31:20.205447 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:31:20.207503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:31:20.208506 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:31:20.227065 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:31:20.231024 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:31:20.240072 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:31:20.244065 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:31:20.245064 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:31:20.246092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:20.461318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.214 seconds
[0m20:31:20.462348 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:31:20.463352 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.stock_qty)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
where m.expiry_date between spine.start_date and spine.end_date
group by 2,3
  );
[0m20:31:20.468683 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "spine"
LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                     ^

[0m20:31:20.469648 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: ROLLBACK
[0m20:31:20.471687 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:31:20.485102 [debug] [Thread-1 (]: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:31:20.487094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A093A890>]}
[0m20:31:20.489258 [error] [Thread-1 (]: 7 of 12 ERROR creating sql view model public.expired_med_count_in_days ......... [[31mERROR[0m in 0.28s]
[0m20:31:20.492058 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:31:20.493060 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:31:20.494057 [debug] [Thread-4 (]: Marking all children of 'model.Propharma.expired_med_count_in_days' to be skipped because of status 'error'.  Reason: Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql.
[0m20:31:20.495602 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:31:20.498500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:31:20.500500 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:31:20.509893 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:31:20.513857 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:31:20.592993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:20.594951 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp203120562455"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:31:20.595984 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:20.948266 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.352 seconds
[0m20:31:20.974913 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:20.975911 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:31:20.977905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:31:20.979905 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:20.980929 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp203120562455'
        
      order by ordinal_position

  
[0m20:31:21.005505 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:31:21.017981 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:21.019481 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.027430 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:31:21.043448 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:21.045444 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.052544 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:31:21.083423 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:31:21.089476 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:21.090595 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp203120562455" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp203120562455"
    )
  
[0m20:31:21.094772 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:31:21.097784 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:31:21.099797 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:31:21.100795 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:31:21.103048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:21.105059 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:31:21.107094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1662190>]}
[0m20:31:21.109105 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.61s]
[0m20:31:21.113357 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:31:21.115351 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:31:21.117346 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:31:21.119545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:31:21.121737 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:31:21.136264 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:31:21.140412 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:31:21.155099 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.157330 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp203121149927"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:31:21.160350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:21.447662 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.288 seconds
[0m20:31:21.454347 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.455352 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:31:21.457710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:31:21.458752 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.459795 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp203121149927'
        
      order by ordinal_position

  
[0m20:31:21.484143 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m20:31:21.490865 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.491868 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.498863 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:31:21.505975 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.506977 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.514688 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:31:21.519674 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:31:21.523664 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.525167 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp203121149927" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp203121149927"
    )
  
[0m20:31:21.530158 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:31:21.533150 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:31:21.534147 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:31:21.536142 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:31:21.538137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:21.540132 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:31:21.542126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A2A40F50>]}
[0m20:31:21.544121 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.42s]
[0m20:31:21.548110 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:31:21.550105 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:31:21.551103 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:31:21.553098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:31:21.556586 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:31:21.571088 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:31:21.574628 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:31:21.583609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.584607 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp203121580618"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:31:21.587055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:21.845830 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.259 seconds
[0m20:31:21.851813 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.852810 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:31:21.855804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:31:21.856802 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.857836 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp203121580618'
        
      order by ordinal_position

  
[0m20:31:21.882144 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:31:21.889044 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.890042 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.897023 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:31:21.906907 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.908011 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:21.914530 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:31:21.926083 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:31:21.930711 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.931252 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp203121580618"
    )


  
[0m20:31:21.934247 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:31:21.937279 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:31:21.938277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:31:21.939274 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:31:21.942268 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:31:21.944491 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:31:21.946486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A36FE5D0>]}
[0m20:31:21.948481 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.39s]
[0m20:31:21.951473 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:31:21.953520 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:31:21.955053 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:31:21.956098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:31:21.959065 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:31:21.968022 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:31:21.970988 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:31:21.979964 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:21.981638 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp203121977004"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:31:21.982642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:22.215146 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.232 seconds
[0m20:31:22.221140 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.223098 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:31:22.224134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:31:22.225671 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.226885 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp203121977004'
        
      order by ordinal_position

  
[0m20:31:22.250695 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m20:31:22.256982 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.258942 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:22.265277 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:31:22.271708 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.273700 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:22.279651 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:31:22.284192 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:31:22.288607 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.289611 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp203121977004" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp203121977004"
    )
  
[0m20:31:22.293353 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:31:22.296348 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:31:22.298343 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:31:22.299340 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:31:22.309213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:31:22.311837 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:31:22.312838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A32F3810>]}
[0m20:31:22.314830 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.36s]
[0m20:31:22.318864 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:31:22.319861 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:31:22.322111 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:31:22.324504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:31:22.326332 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:31:22.333928 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:31:22.337884 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:31:22.349024 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.351019 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp203122346029"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:31:22.352018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:22.597641 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.246 seconds
[0m20:31:22.604653 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.605654 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:31:22.607696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:31:22.608970 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.610539 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp203122346029'
        
      order by ordinal_position

  
[0m20:31:22.633847 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.022 seconds
[0m20:31:22.643569 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.644566 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:22.652547 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:31:22.658566 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.660524 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:31:22.667422 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:31:22.671083 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:31:22.675303 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.676348 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp203122346029" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp203122346029"
    )
  
[0m20:31:22.680590 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:31:22.683880 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:31:22.684912 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:31:22.686442 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:31:22.696948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:31:22.699241 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:31:22.700236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c63ecb5b-8177-498c-b06c-7570182bdbde', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A3713BD0>]}
[0m20:31:22.702444 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.38s]
[0m20:31:22.705608 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:31:22.708600 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:22.710055 [debug] [MainThread]: On master: BEGIN
[0m20:31:22.711097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:22.931994 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m20:31:22.933989 [debug] [MainThread]: On master: COMMIT
[0m20:31:22.934986 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:22.935983 [debug] [MainThread]: On master: COMMIT
[0m20:31:22.936980 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:22.939205 [debug] [MainThread]: On master: Close
[0m20:31:22.941142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:22.942144 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:31:22.943142 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:31:22.944140 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:31:22.946138 [info ] [MainThread]: 
[0m20:31:22.947937 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m20:31:22.953930 [debug] [MainThread]: Command end result
[0m20:31:23.029735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:31:23.036721 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:31:23.051074 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:31:23.053069 [info ] [MainThread]: 
[0m20:31:23.054773 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:31:23.056847 [info ] [MainThread]: 
[0m20:31:23.059212 [error] [MainThread]:   Database Error in model expired_med_count_in_days (models\marts\expired_med_count_in_days.sql)
  missing FROM-clause entry for table "spine"
  LINE 93: where m.expiry_date between spine.start_date and spine.end_d...
                                       ^
  compiled code at target\run\Propharma\models\marts\expired_med_count_in_days.sql
[0m20:31:23.062211 [info ] [MainThread]: 
[0m20:31:23.064205 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=1 SKIP=0 TOTAL=12
[0m20:31:23.068543 [debug] [MainThread]: Command `dbt run` failed at 20:31:23.068543 after 10.79 seconds
[0m20:31:23.070698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002819AC8FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1611610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281A1613190>]}
[0m20:31:23.071233 [debug] [MainThread]: Flushing usage events
[0m20:31:24.384081 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:32:49.981781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDDCFEE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDDCF2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDD05FE10>]}


============================== 20:32:49.989759 | daa1aa50-4b07-41ae-b37b-83ee0f82069d ==============================
[0m20:32:49.989759 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:32:49.991657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:32:50.406101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDDEF2110>]}
[0m20:32:50.523744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDA95B2D0>]}
[0m20:32:50.526288 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:32:51.367869 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:32:51.928813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:32:51.930774 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:32:52.489091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDEF38850>]}
[0m20:32:52.717522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:32:52.728536 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:32:52.786271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF484610>]}
[0m20:32:52.788269 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:32:52.790846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF459F50>]}
[0m20:32:52.795832 [info ] [MainThread]: 
[0m20:32:52.798475 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:52.800524 [info ] [MainThread]: 
[0m20:32:52.802518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:32:52.816304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:32:53.228183 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:32:53.230178 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:32:53.231146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:53.618441 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.387 seconds
[0m20:32:53.621472 [debug] [ThreadPool]: On list_propharma: Close
[0m20:32:53.626712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:32:53.642185 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:32:53.644180 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:32:53.645177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:53.965472 [debug] [ThreadPool]: SQL status: BEGIN in 0.321 seconds
[0m20:32:53.967462 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:32:53.968463 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:32:53.979429 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.010 seconds
[0m20:32:53.982421 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:32:53.984416 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:32:53.986412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:32:53.997992 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:32:53.998990 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:32:53.999988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:32:54.229514 [debug] [ThreadPool]: SQL status: BEGIN in 0.230 seconds
[0m20:32:54.231503 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:32:54.232715 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:32:54.243898 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:32:54.246923 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:32:54.247922 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:32:54.258690 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:54.260685 [debug] [MainThread]: On master: BEGIN
[0m20:32:54.261683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:32:54.477912 [debug] [MainThread]: SQL status: BEGIN in 0.217 seconds
[0m20:32:54.479909 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:54.480906 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:32:54.523322 [debug] [MainThread]: SQL status: SELECT 6 in 0.041 seconds
[0m20:32:54.528307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF952190>]}
[0m20:32:54.530303 [debug] [MainThread]: On master: ROLLBACK
[0m20:32:54.531301 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:54.533296 [debug] [MainThread]: On master: BEGIN
[0m20:32:54.534292 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:32:54.536801 [debug] [MainThread]: On master: COMMIT
[0m20:32:54.537806 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:54.538803 [debug] [MainThread]: On master: COMMIT
[0m20:32:54.539800 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:32:54.541795 [debug] [MainThread]: On master: Close
[0m20:32:54.551766 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:32:54.552765 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:32:54.553763 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:32:54.605656 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:32:54.606684 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:32:54.608648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:32:54.929463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.321 seconds
[0m20:32:54.930424 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:32:54.932419 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2000-01-05' as date))::date - (cast('2000-01-01' as date))::date)
    
[0m20:32:54.934448 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:32:54.955974 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:32:54.959933 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:32:54.961924 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:32:54.963946 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:32:54.964914 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:32:54.966909 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:32:54.968904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:32:54.970540 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:32:54.977529 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:32:54.981732 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:32:55.054732 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:32:55.058718 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.060687 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:32:55.061715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:55.386224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.324 seconds
[0m20:32:55.387530 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.388537 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:32:55.398515 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:32:55.411480 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.412477 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:32:55.414649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:55.421743 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.422743 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:32:55.425217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:55.461644 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:32:55.463638 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.464636 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:32:55.473946 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:32:55.487037 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:32:55.496648 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:32:55.497652 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:32:55.501492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:32:55.506303 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:32:55.511457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF554B50>]}
[0m20:32:55.513451 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.54s]
[0m20:32:55.515738 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:32:55.517740 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:32:55.518770 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:32:55.520728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:32:55.521725 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:32:55.529709 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:32:55.533700 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:32:55.542190 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:32:55.546333 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.547339 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:32:55.548365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:55.765261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m20:32:55.766220 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.768215 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:32:55.778104 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:32:55.785083 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.786082 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:32:55.788040 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:55.797697 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.799661 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:32:55.801656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:55.805646 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:32:55.806643 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.807639 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:32:55.817924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:32:55.823628 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:32:55.825621 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:32:55.826586 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:32:55.830096 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:32:55.833487 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:32:55.834528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF841AD0>]}
[0m20:32:55.836530 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:32:55.839125 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:32:55.841587 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:32:55.843593 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:32:55.846739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:32:55.847749 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:32:55.858814 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:32:55.863622 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:32:55.871145 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:32:55.875204 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:55.876611 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:32:55.877910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:56.102662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m20:32:56.104844 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:56.105874 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:32:56.115854 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:32:56.123587 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:56.124588 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:32:56.127012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.133871 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:56.135272 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:32:56.136363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.140054 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:32:56.140599 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:56.142597 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:32:56.152373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:32:56.157965 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:32:56.159952 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:32:56.160955 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:32:56.164909 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:32:56.167928 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:32:56.169893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDCF1E550>]}
[0m20:32:56.171932 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:32:56.174924 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:32:56.177258 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:32:56.178380 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:32:56.181380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:32:56.182556 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:32:56.189252 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:32:56.193745 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:32:56.202215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:32:56.206203 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.207729 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:32:56.209812 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:56.443128 [debug] [Thread-1 (]: SQL status: BEGIN in 0.233 seconds
[0m20:32:56.444130 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.445133 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:32:56.454573 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:32:56.462098 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.464132 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:32:56.466145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.472310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.474360 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:32:56.476372 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.479436 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:32:56.480434 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.482430 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:32:56.492515 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:32:56.498073 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:32:56.500074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:32:56.501030 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:32:56.504054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:32:56.508046 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:32:56.509041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDD6939D0>]}
[0m20:32:56.511878 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:32:56.514950 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:32:56.515947 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:32:56.517941 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:32:56.520225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:32:56.522356 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:32:56.532928 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:32:56.537602 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:32:56.545727 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:32:56.548706 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.550815 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:32:56.552392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:56.780109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.229 seconds
[0m20:32:56.782111 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.783109 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:32:56.793599 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:32:56.800184 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.801620 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:32:56.803911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.811272 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.813255 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:32:56.814264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:56.818136 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:32:56.820036 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.822088 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:32:56.828490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:32:56.834233 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:32:56.835530 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:32:56.837825 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:32:56.840858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:32:56.844280 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:32:56.845647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF90C390>]}
[0m20:32:56.846785 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.33s]
[0m20:32:56.850999 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:32:56.852147 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:32:56.855797 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:32:56.857789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:32:56.859010 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:32:56.866421 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:32:56.870300 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:32:56.879552 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:32:56.883964 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:56.885964 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:32:56.886961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:57.112702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m20:32:57.113736 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:57.114731 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:32:57.124802 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:32:57.132723 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:57.134053 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:32:57.136413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:57.142912 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:57.144907 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:32:57.147138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:57.149993 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:32:57.151174 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:57.152468 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:32:57.162978 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:32:57.169745 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:32:57.170744 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:32:57.172489 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:32:57.175519 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:32:57.179118 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:32:57.181116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF92F750>]}
[0m20:32:57.183111 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:32:57.186478 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:32:57.188730 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:32:57.190927 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:32:57.192437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:32:57.194789 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:32:57.213086 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:32:57.218042 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:32:57.228328 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:32:57.232899 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:32:57.234900 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:32:57.236312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:57.471111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.235 seconds
[0m20:32:57.473064 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:32:57.474317 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
    
    

    )

    select *
    from unioned
    where generated_number <= 4
    order by generated_number



),

all_periods as (

    select (
        

    cast('2000-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2000-01-05' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.stock_qty)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
join spine on 1=1
where m.expiry_date between spine.start_date and spine.end_date
group by 2,3
  );
[0m20:32:57.500550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m20:32:57.506569 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:32:57.507565 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
alter table "propharma"."public"."expired_med_count_in_days__dbt_tmp" rename to "expired_med_count_in_days"
[0m20:32:57.510526 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:32:57.513517 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:32:57.514515 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:32:57.515512 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:32:57.518377 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:32:57.524227 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."expired_med_count_in_days__dbt_backup"
[0m20:32:57.525224 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:32:57.527221 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
drop view if exists "propharma"."public"."expired_med_count_in_days__dbt_backup" cascade
[0m20:32:57.528184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:32:57.531732 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:32:57.532732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF9C6490>]}
[0m20:32:57.534606 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.expired_med_count_in_days ............. [[32mCREATE VIEW[0m in 0.34s]
[0m20:32:57.537762 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:32:57.539772 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:32:57.540798 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:32:57.542797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:32:57.545281 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:32:57.556573 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:32:57.559564 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:32:57.641167 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:57.643162 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp203257609736"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:32:57.644159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:57.899921 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.256 seconds
[0m20:32:57.925706 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:57.927667 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:32:57.929696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:32:57.930785 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:57.932329 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp203257609736'
        
      order by ordinal_position

  
[0m20:32:57.956411 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:32:57.976007 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:57.977965 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:57.985362 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:32:57.999446 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:58.001442 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:58.008109 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:32:58.037476 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:32:58.041442 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:58.042482 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp203257609736" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp203257609736"
    )
  
[0m20:32:58.047322 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:32:58.051301 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:32:58.051842 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:32:58.053655 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:32:58.063073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:32:58.065073 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:32:58.067067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF0DAD90>]}
[0m20:32:58.069062 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.52s]
[0m20:32:58.072054 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:32:58.074048 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:32:58.076043 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:32:58.079137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:32:58.080139 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:32:58.087957 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:32:58.091948 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:32:58.101123 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.102359 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp203258097087"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:32:58.104359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:58.362748 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.259 seconds
[0m20:32:58.368695 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.370690 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:32:58.372685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:32:58.373682 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.374679 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp203258097087'
        
      order by ordinal_position

  
[0m20:32:58.399340 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m20:32:58.406285 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.408280 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:58.415262 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:32:58.421245 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.423241 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:58.429264 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:32:58.434251 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:32:58.437515 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.439631 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp203258097087" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp203258097087"
    )
  
[0m20:32:58.445159 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:32:58.448150 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:32:58.449147 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:32:58.450144 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:32:58.456046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:32:58.458084 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:32:58.459082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF8BE890>]}
[0m20:32:58.461581 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.38s]
[0m20:32:58.464962 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:32:58.466956 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:32:58.467952 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:32:58.470341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:32:58.472131 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:32:58.484475 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:32:58.488879 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:32:58.498142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.499239 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp203258495178"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:32:58.500320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:58.857883 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.357 seconds
[0m20:32:58.866824 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.867822 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:32:58.870815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:32:58.871812 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.872809 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp203258495178'
        
      order by ordinal_position

  
[0m20:32:58.897743 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:32:58.903687 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.905683 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:58.912357 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:32:58.919306 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.920304 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:58.930324 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.008 seconds
[0m20:32:58.942782 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:32:58.946685 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.947689 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp203258495178"
    )


  
[0m20:32:58.953694 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.004 seconds
[0m20:32:58.956731 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:32:58.957719 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:32:58.958717 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:32:58.962233 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:32:58.964227 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:32:58.966225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDFD83890>]}
[0m20:32:58.968577 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.50s]
[0m20:32:58.971874 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:32:58.973043 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:32:58.975534 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:32:58.978373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:32:58.980310 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:32:58.990391 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:32:58.994811 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:32:59.003835 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.004841 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp203258999797"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:32:59.007688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:59.255731 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.249 seconds
[0m20:32:59.261681 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.262679 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:32:59.264674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:32:59.266669 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.267667 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp203258999797'
        
      order by ordinal_position

  
[0m20:32:59.292365 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.023 seconds
[0m20:32:59.298348 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.300344 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:59.306615 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:32:59.313564 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.315382 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:59.322371 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:32:59.326369 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:32:59.330362 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.331357 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp203258999797" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp203258999797"
    )
  
[0m20:32:59.336344 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:32:59.338852 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:32:59.339857 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:32:59.341850 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:32:59.344884 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:32:59.346875 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:32:59.348832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF596950>]}
[0m20:32:59.350825 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.37s]
[0m20:32:59.354142 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:32:59.356136 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:32:59.358130 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:32:59.361182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:32:59.363150 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:32:59.372171 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:32:59.376313 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:32:59.388482 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.389843 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp203259385296"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:32:59.391365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:32:59.654689 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.264 seconds
[0m20:32:59.662110 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.664074 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:32:59.666072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:32:59.667069 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.668066 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp203259385296'
        
      order by ordinal_position

  
[0m20:32:59.693742 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m20:32:59.700721 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.701719 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:59.708732 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:32:59.716679 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.717672 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:32:59.729285 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m20:32:59.733275 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:32:59.738134 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.739146 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp203259385296" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp203259385296"
    )
  
[0m20:32:59.743621 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:32:59.746586 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:32:59.748580 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:32:59.749579 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:32:59.752601 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:32:59.755594 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:32:59.756560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'daa1aa50-4b07-41ae-b37b-83ee0f82069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DDF972090>]}
[0m20:32:59.758554 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.40s]
[0m20:32:59.762540 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:32:59.765673 [debug] [MainThread]: Using postgres connection "master"
[0m20:32:59.767673 [debug] [MainThread]: On master: BEGIN
[0m20:32:59.768674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:00.000996 [debug] [MainThread]: SQL status: BEGIN in 0.231 seconds
[0m20:33:00.001503 [debug] [MainThread]: On master: COMMIT
[0m20:33:00.003505 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:00.004501 [debug] [MainThread]: On master: COMMIT
[0m20:33:00.005497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:00.006495 [debug] [MainThread]: On master: Close
[0m20:33:00.007499 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:00.009490 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:33:00.010486 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:33:00.011480 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:33:00.012477 [info ] [MainThread]: 
[0m20:33:00.015781 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m20:33:00.024431 [debug] [MainThread]: Command end result
[0m20:33:00.101857 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:33:00.108542 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:33:00.123748 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:33:00.124749 [info ] [MainThread]: 
[0m20:33:00.127162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:00.129243 [info ] [MainThread]: 
[0m20:33:00.131333 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:33:00.134403 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:00.134403 after 10.41 seconds
[0m20:33:00.135950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD733FF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD733F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DD733F350>]}
[0m20:33:00.136980 [debug] [MainThread]: Flushing usage events
[0m20:33:01.573084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:58.146543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99473E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99473E190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99473E9D0>]}


============================== 20:34:58.154977 | 5cb343f7-9ceb-4279-b295-1f0de832e621 ==============================
[0m20:34:58.154977 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:34:58.157173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:34:58.590298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99493FFD0>]}
[0m20:34:58.707124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9913AF4D0>]}
[0m20:34:58.710116 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:34:59.545892 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:35:00.126238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:35:00.127238 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\cte\date_spine.sql
[0m20:35:00.788195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995EE2750>]}
[0m20:35:01.024435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:35:01.035831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:35:01.093313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995EEE410>]}
[0m20:35:01.095309 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:35:01.097304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995EEBB90>]}
[0m20:35:01.102290 [info ] [MainThread]: 
[0m20:35:01.104738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:35:01.106845 [info ] [MainThread]: 
[0m20:35:01.109358 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:35:01.121450 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:35:01.524060 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:35:01.525058 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:35:01.526055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:01.759855 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.233 seconds
[0m20:35:01.762846 [debug] [ThreadPool]: On list_propharma: Close
[0m20:35:01.768008 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:35:01.779339 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:35:01.781035 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:35:01.782068 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:35:01.999992 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m20:35:02.000990 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:35:02.002092 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:35:02.013299 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:35:02.016258 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:35:02.018253 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:35:02.020280 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:35:02.025329 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:35:02.026327 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:35:02.028322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:35:02.342303 [debug] [ThreadPool]: SQL status: BEGIN in 0.315 seconds
[0m20:35:02.344765 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:35:02.345901 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:35:02.357532 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m20:35:02.360762 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:35:02.362817 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:35:02.377860 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:02.378855 [debug] [MainThread]: On master: BEGIN
[0m20:35:02.380358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:35:02.593450 [debug] [MainThread]: SQL status: BEGIN in 0.213 seconds
[0m20:35:02.595143 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:02.597141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:35:02.641720 [debug] [MainThread]: SQL status: SELECT 8 in 0.043 seconds
[0m20:35:02.647736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996331950>]}
[0m20:35:02.648738 [debug] [MainThread]: On master: ROLLBACK
[0m20:35:02.650697 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:02.651695 [debug] [MainThread]: On master: BEGIN
[0m20:35:02.653686 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:35:02.654682 [debug] [MainThread]: On master: COMMIT
[0m20:35:02.655680 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:02.656874 [debug] [MainThread]: On master: COMMIT
[0m20:35:02.657914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:02.659877 [debug] [MainThread]: On master: Close
[0m20:35:02.669804 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:35:02.671315 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:35:02.673333 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:35:02.708810 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:35:02.710804 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:35:02.711770 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:35:02.920769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.210 seconds
[0m20:35:02.922834 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:35:02.923871 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2025-05-25' as date))::date - (cast('2025-05-15' as date))::date)
    
[0m20:35:02.926013 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:35:02.929046 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:35:02.934104 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:35:02.935100 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:35:02.937096 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:35:02.939091 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:35:02.940098 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:35:02.942777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:35:02.943313 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:35:02.952552 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:35:02.957318 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:35:03.025259 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:35:03.029256 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.031404 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:35:03.032398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:03.251269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.218 seconds
[0m20:35:03.252307 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.253304 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:35:03.262281 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:35:03.275535 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.276533 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:35:03.279488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:03.285604 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.286606 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:35:03.288562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:03.318430 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:35:03.320392 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.321428 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:35:03.331274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:35:03.344638 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:35:03.353611 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:35:03.354607 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:35:03.359651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:35:03.364677 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:35:03.369098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E995C19B50>]}
[0m20:35:03.371185 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:35:03.374836 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:35:03.376083 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:35:03.376618 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:35:03.379547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:35:03.381082 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:35:03.387103 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:35:03.391170 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:35:03.399146 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:35:03.403135 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.405343 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:35:03.407461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:03.624843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m20:35:03.626627 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.627647 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:35:03.637231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:35:03.644379 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.645376 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:35:03.648368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:03.657043 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.659383 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:35:03.661145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:03.664120 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:35:03.665154 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.666121 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:35:03.676256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:35:03.681592 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:35:03.683961 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:35:03.684467 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:35:03.688349 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:03.691579 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:35:03.693033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9963EEA50>]}
[0m20:35:03.695233 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:35:03.698259 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:35:03.701519 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:35:03.702525 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:35:03.705733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:35:03.707833 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:35:03.718395 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:35:03.723814 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:35:03.731880 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:35:03.736650 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:03.737735 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:35:03.739945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:03.965585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m20:35:03.966745 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:03.967783 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:35:03.976767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:35:03.984767 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:03.985777 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:35:03.987828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:03.994049 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:03.995072 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:35:03.997239 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.000395 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:35:04.001404 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:04.002446 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:35:04.007836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:04.013642 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:35:04.014683 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:35:04.015679 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:35:04.018912 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:04.022609 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:35:04.023891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9963D6610>]}
[0m20:35:04.026147 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:35:04.029138 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:35:04.030314 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:35:04.032336 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:35:04.034351 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:35:04.036753 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:35:04.043739 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:35:04.047971 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:35:04.056787 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:35:04.061595 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.063036 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:35:04.064341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:04.299410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.236 seconds
[0m20:35:04.301422 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.302464 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:35:04.312727 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:35:04.320263 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.322340 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:35:04.324420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.332687 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.334072 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:35:04.336082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.339112 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:35:04.341112 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.342434 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:35:04.350848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:35:04.357118 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:35:04.358142 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:35:04.360226 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:35:04.363321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:04.366451 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:35:04.368518 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99642B250>]}
[0m20:35:04.369526 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.33s]
[0m20:35:04.373042 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:35:04.374050 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:35:04.376486 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:35:04.378756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:35:04.380782 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:35:04.386322 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:35:04.391180 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:35:04.399003 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:35:04.401996 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.405493 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:35:04.407509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:04.632153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:35:04.633102 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.634332 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:35:04.643810 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:35:04.650790 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.651787 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:35:04.654810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.660509 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.661510 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:35:04.663505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.666499 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:35:04.667525 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.668534 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:35:04.680079 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m20:35:04.689238 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:35:04.692233 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:35:04.693223 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:35:04.697234 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:35:04.700817 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:35:04.702811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E99642B290>]}
[0m20:35:04.704806 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m20:35:04.707179 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:35:04.709178 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:35:04.710175 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:35:04.712709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:35:04.714027 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:35:04.721221 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:35:04.725321 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:35:04.734204 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:35:04.738195 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:04.739889 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:35:04.740897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:04.962059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:35:04.964052 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:04.965089 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:35:04.974196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:35:04.981538 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:04.982078 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:35:04.983678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:04.993127 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:04.995123 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:35:04.997168 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:05.000144 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:35:05.001143 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:05.002143 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:35:05.008274 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:35:05.014138 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:35:05.015122 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:35:05.017078 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:35:05.020459 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:35:05.023103 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:35:05.025065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9967C1FD0>]}
[0m20:35:05.026636 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:35:05.029824 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:35:05.030833 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:35:05.032851 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:35:05.034845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:35:05.036005 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:35:05.050775 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:35:05.056057 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:35:05.065032 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:35:05.069151 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:35:05.071144 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:35:05.073140 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:05.389334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.317 seconds
[0m20:35:05.390918 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:35:05.391955 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
    
    

    )

    select *
    from unioned
    where generated_number <= 10
    order by generated_number



),

all_periods as (

    select (
        

    cast('2025-05-15' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-05-25' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select count(i.stock_qty)
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
join spine on 1=1
where m.expiry_date between spine.start_date and spine.end_date
group by 2,3
  );
[0m20:35:05.406872 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:35:05.414188 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:35:05.415184 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
alter table "propharma"."public"."expired_med_count_in_days__dbt_tmp" rename to "expired_med_count_in_days"
[0m20:35:05.418209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:35:05.420986 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:35:05.422022 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:35:05.423634 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:35:05.425671 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:35:05.431778 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."expired_med_count_in_days__dbt_backup"
[0m20:35:05.432739 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:35:05.434511 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
drop view if exists "propharma"."public"."expired_med_count_in_days__dbt_backup" cascade
[0m20:35:05.436115 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:35:05.438592 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:35:05.440587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996414790>]}
[0m20:35:05.442583 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.expired_med_count_in_days ............. [[32mCREATE VIEW[0m in 0.41s]
[0m20:35:05.445016 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:35:05.447016 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:35:05.448013 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:35:05.450277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:35:05.451493 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:35:05.462303 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:35:05.466544 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:35:05.548807 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.550768 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp203505518096"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:35:05.551766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:05.780594 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.229 seconds
[0m20:35:05.808962 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.809946 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:35:05.811906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:35:05.813502 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.814548 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp203505518096'
        
      order by ordinal_position

  
[0m20:35:05.839481 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:35:05.849465 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.850465 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:05.859561 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.007 seconds
[0m20:35:05.873977 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.875973 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:05.882294 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:35:05.911273 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:35:05.915140 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.917346 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp203505518096" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp203505518096"
    )
  
[0m20:35:05.921338 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:35:05.924327 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:35:05.925359 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:35:05.926358 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:35:05.932306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:35:05.934393 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:35:05.935436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996354650>]}
[0m20:35:05.936570 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.49s]
[0m20:35:05.941256 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:35:05.943250 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:35:05.944431 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:35:05.946800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:35:05.949324 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:35:05.957921 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:35:05.962141 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:35:05.972690 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:05.974034 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp203505968352"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:35:05.975055 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:06.201550 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.227 seconds
[0m20:35:06.209008 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.210005 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:35:06.212140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:35:06.213183 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.214223 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp203505968352'
        
      order by ordinal_position

  
[0m20:35:06.238924 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m20:35:06.245160 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.246199 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:06.253549 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:35:06.259889 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.260929 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:06.268356 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:35:06.272464 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:35:06.276700 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.277736 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp203505968352" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp203505968352"
    )
  
[0m20:35:06.281477 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:35:06.285089 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:35:06.286390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:35:06.287519 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:35:06.290485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:06.292029 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:35:06.293708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996354650>]}
[0m20:35:06.295181 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.35s]
[0m20:35:06.299480 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:35:06.301818 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:35:06.302826 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:35:06.305319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:35:06.307529 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:35:06.325606 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:35:06.328596 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:35:06.337571 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.338569 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp203506334579"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:35:06.341018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:06.570767 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.230 seconds
[0m20:35:06.576752 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.577750 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:35:06.579755 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:35:06.581703 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.582830 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp203506334579'
        
      order by ordinal_position

  
[0m20:35:06.606682 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.023 seconds
[0m20:35:06.613699 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.614705 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:06.621698 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:35:06.628665 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.629626 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:06.636642 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:35:06.648405 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:35:06.652394 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.653391 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp203506334579"
    )


  
[0m20:35:06.657383 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:35:06.659377 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:35:06.661333 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:35:06.662336 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:35:06.664723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:35:06.667027 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:35:06.668808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9963D1B10>]}
[0m20:35:06.669812 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.36s]
[0m20:35:06.673294 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:35:06.675288 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:35:06.677574 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:35:06.679580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:35:06.681572 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:35:06.688960 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:35:06.693135 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:35:06.702116 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:06.703114 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp203506699125"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:35:06.704934 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:07.059004 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.354 seconds
[0m20:35:07.065359 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.067094 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:35:07.068767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:35:07.070102 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.071144 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp203506699125'
        
      order by ordinal_position

  
[0m20:35:07.094585 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m20:35:07.100455 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.102461 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:07.108656 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:35:07.115590 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.116555 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:07.122841 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:35:07.129856 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:35:07.133936 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.135931 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp203506699125" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp203506699125"
    )
  
[0m20:35:07.139958 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:35:07.141950 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:35:07.144155 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:35:07.145191 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:35:07.148017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:07.150463 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:35:07.152598 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996847950>]}
[0m20:35:07.154598 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.47s]
[0m20:35:07.158020 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:35:07.160101 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:35:07.161107 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:35:07.163989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:35:07.166015 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:35:07.173372 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:35:07.178363 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:35:07.186847 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.188843 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp203507183346"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:35:07.189841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:35:07.538563 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.348 seconds
[0m20:35:07.544578 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.546546 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:35:07.547571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:35:07.548751 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.550994 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp203507183346'
        
      order by ordinal_position

  
[0m20:35:07.574954 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:35:07.581686 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.582727 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:07.589862 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:35:07.596842 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.598802 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:35:07.604821 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:35:07.609808 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:35:07.612929 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.614964 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp203507183346" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp203507183346"
    )
  
[0m20:35:07.618959 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:35:07.620951 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:35:07.622944 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:35:07.623909 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:35:07.626514 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:35:07.628774 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:35:07.630769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cb343f7-9ceb-4279-b295-1f0de832e621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E996847950>]}
[0m20:35:07.631765 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.47s]
[0m20:35:07.634774 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:35:07.637765 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:07.639760 [debug] [MainThread]: On master: BEGIN
[0m20:35:07.640757 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:35:07.864710 [debug] [MainThread]: SQL status: BEGIN in 0.224 seconds
[0m20:35:07.866749 [debug] [MainThread]: On master: COMMIT
[0m20:35:07.867753 [debug] [MainThread]: Using postgres connection "master"
[0m20:35:07.868756 [debug] [MainThread]: On master: COMMIT
[0m20:35:07.870115 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:35:07.871120 [debug] [MainThread]: On master: Close
[0m20:35:07.872431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:35:07.874097 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:35:07.875259 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:35:07.876540 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:35:07.877547 [info ] [MainThread]: 
[0m20:35:07.880057 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m20:35:07.885795 [debug] [MainThread]: Command end result
[0m20:35:07.959773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:35:07.967206 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:35:07.982367 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:35:07.984362 [info ] [MainThread]: 
[0m20:35:07.986450 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:35:07.988446 [info ] [MainThread]: 
[0m20:35:07.989702 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:35:07.993602 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:07.993602 after 10.11 seconds
[0m20:35:07.994605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98DDDFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98DDDF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E98E079510>]}
[0m20:35:07.996599 [debug] [MainThread]: Flushing usage events
[0m20:35:09.745341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:47.597494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C67590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C02110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C023D0>]}


============================== 20:36:47.607513 | 6150e68a-0133-4421-9536-02421c2dd88d ==============================
[0m20:36:47.607513 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:36:47.609470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:36:48.023305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C03C10>]}
[0m20:36:48.135087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F5867BD0>]}
[0m20:36:48.138044 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:36:48.958378 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:36:49.527255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:49.529253 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:36:50.102302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA302390>]}
[0m20:36:50.328538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:36:50.339007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:36:50.396443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA2E8A50>]}
[0m20:36:50.398419 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:36:50.400379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA27D910>]}
[0m20:36:50.404503 [info ] [MainThread]: 
[0m20:36:50.407300 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:50.409351 [info ] [MainThread]: 
[0m20:36:50.411350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:50.424172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:36:50.846758 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:36:50.847725 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:36:50.849279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:51.208742 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.360 seconds
[0m20:36:51.211737 [debug] [ThreadPool]: On list_propharma: Close
[0m20:36:51.216684 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:36:51.228703 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:36:51.229702 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:36:51.230697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:51.543480 [debug] [ThreadPool]: SQL status: BEGIN in 0.313 seconds
[0m20:36:51.545662 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:36:51.546660 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:36:51.557276 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:36:51.560357 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:36:51.562405 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:36:51.564400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:36:51.570442 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:36:51.571448 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:36:51.572808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:51.795163 [debug] [ThreadPool]: SQL status: BEGIN in 0.222 seconds
[0m20:36:51.796406 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:36:51.796948 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:36:51.808085 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m20:36:51.812074 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:36:51.813071 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:36:51.829240 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:51.831236 [debug] [MainThread]: On master: BEGIN
[0m20:36:51.832232 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:52.041845 [debug] [MainThread]: SQL status: BEGIN in 0.210 seconds
[0m20:36:52.043844 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:52.044841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:36:52.087615 [debug] [MainThread]: SQL status: SELECT 8 in 0.042 seconds
[0m20:36:52.093645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA2CFA50>]}
[0m20:36:52.095633 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:52.096594 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:52.097876 [debug] [MainThread]: On master: BEGIN
[0m20:36:52.099428 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:36:52.100463 [debug] [MainThread]: On master: COMMIT
[0m20:36:52.101459 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:52.102456 [debug] [MainThread]: On master: COMMIT
[0m20:36:52.103943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:52.104942 [debug] [MainThread]: On master: Close
[0m20:36:52.116632 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:36:52.118626 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:36:52.119623 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:36:52.169985 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:36:52.171270 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:36:52.172309 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:36:52.386310 [debug] [Thread-1 (]: SQL status: BEGIN in 0.213 seconds
[0m20:36:52.387447 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:36:52.388664 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2025-05-25' as date))::date - (cast('2025-05-15' as date))::date)
    
[0m20:36:52.390425 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:36:52.411886 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:36:52.415984 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:36:52.416982 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:36:52.419197 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:36:52.421576 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:36:52.422578 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:36:52.424917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:36:52.426309 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:36:52.432780 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:36:52.437016 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:36:52.508957 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:36:52.513612 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.514646 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:36:52.515942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:52.736446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m20:36:52.738127 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.739165 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:36:52.752302 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:36:52.765297 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.766300 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:36:52.768786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:52.775335 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.783741 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:36:52.785741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:52.817482 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:36:52.818479 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.820747 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:36:52.823644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:52.835752 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:36:52.845550 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:36:52.846557 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:36:52.851251 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:36:52.856245 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:36:52.861232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA18FE90>]}
[0m20:36:52.863654 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m20:36:52.866488 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:36:52.868487 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:36:52.869485 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:36:52.871714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:36:52.873318 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:36:52.880340 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:36:52.883776 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:36:52.894338 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:36:52.899785 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:52.901443 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:36:52.902522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:53.128199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m20:36:53.130158 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:53.131154 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:36:53.140998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:36:53.147984 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:53.148982 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:36:53.152013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.157446 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:53.159405 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:36:53.160438 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.164179 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:36:53.165221 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:53.166787 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:36:53.169084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:53.175570 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:36:53.176569 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:36:53.177652 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:36:53.181730 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:36:53.184816 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:36:53.185868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA816BD0>]}
[0m20:36:53.187870 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:36:53.191250 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:36:53.192251 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:36:53.193249 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:36:53.196073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:36:53.197886 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:36:53.207875 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:36:53.212202 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:36:53.220674 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:36:53.223722 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.225721 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:36:53.227724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:53.452594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m20:36:53.455038 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.456036 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:36:53.465547 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:36:53.472563 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.473565 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:36:53.476326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.482362 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.484366 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:36:53.485424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.488867 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:36:53.489918 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.490958 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:36:53.501284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:36:53.507035 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:36:53.508785 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:36:53.509797 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:36:53.513423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:36:53.516552 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:36:53.517569 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C8FB10>]}
[0m20:36:53.519913 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:36:53.523210 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:36:53.524249 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:36:53.525288 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:36:53.527583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:36:53.529578 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:36:53.536557 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:36:53.540865 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:36:53.551202 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:36:53.556073 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.557098 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:36:53.559069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:53.785254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.226 seconds
[0m20:36:53.786264 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.787305 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:36:53.796988 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:36:53.802384 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.805084 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:36:53.807141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.813297 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.815279 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:36:53.816240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:53.820231 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:36:53.821240 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.822620 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:36:53.831837 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:36:53.837513 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:36:53.839472 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:36:53.840506 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:36:53.844495 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:36:53.847266 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:36:53.849228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F8C319D0>]}
[0m20:36:53.851470 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:36:53.854209 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:36:53.855208 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:36:53.856902 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:36:53.859188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:36:53.860209 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:36:53.870540 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:36:53.875173 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:36:53.883025 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:36:53.887660 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:53.888707 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:36:53.890228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:54.112637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.222 seconds
[0m20:36:54.114641 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:54.115629 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:36:54.125350 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:36:54.132988 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:54.133986 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:36:54.135980 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:54.142961 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:54.143958 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:36:54.145953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:54.158124 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:36:54.160083 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:54.162077 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:36:54.164641 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:54.170211 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:36:54.172206 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:36:54.173216 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:36:54.176699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:36:54.180380 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:36:54.182338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F9F9FE10>]}
[0m20:36:54.184333 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m20:36:54.187325 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:36:54.189320 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:36:54.191423 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:36:54.193410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:36:54.194609 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:36:54.205242 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:36:54.210864 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:36:54.219215 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:36:54.223930 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.225933 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:36:54.227927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:54.480962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.253 seconds
[0m20:36:54.481923 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.483917 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:36:54.493617 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:36:54.500829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.501866 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:36:54.502827 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:54.510489 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.511450 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:36:54.513588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:54.517090 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:36:54.518087 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.519084 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:36:54.528549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:36:54.534201 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:36:54.536164 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:36:54.537801 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:36:54.540801 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:36:54.543793 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:36:54.545787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F7F29AD0>]}
[0m20:36:54.547782 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:36:54.551068 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:36:54.552451 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:36:54.554981 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:36:54.556982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:36:54.558615 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:36:54.582223 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:36:54.586870 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:36:54.596049 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:36:54.601401 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:36:54.603407 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:36:54.604446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:54.850845 [debug] [Thread-1 (]: SQL status: BEGIN in 0.246 seconds
[0m20:36:54.852839 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:36:54.853836 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
    
    

    )

    select *
    from unioned
    where generated_number <= 10
    order by generated_number



),

all_periods as (

    select (
        

    cast('2025-05-15' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-05-25' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select i.stock_qty
,m.name
,m.expiry_date
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
join spine on 1=1
where m.expiry_date between spine.start_date and spine.end_date
  );
[0m20:36:54.871788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m20:36:54.877772 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:36:54.879766 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
alter table "propharma"."public"."expired_med_count_in_days__dbt_tmp" rename to "expired_med_count_in_days"
[0m20:36:54.881762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:36:54.884753 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:36:54.886748 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:36:54.887745 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:36:54.890741 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:36:54.895728 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."expired_med_count_in_days__dbt_backup"
[0m20:36:54.897723 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:36:54.898720 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
drop view if exists "propharma"."public"."expired_med_count_in_days__dbt_backup" cascade
[0m20:36:54.900715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:36:54.903707 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:36:54.905209 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F7EECB90>]}
[0m20:36:54.907208 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.expired_med_count_in_days ............. [[32mCREATE VIEW[0m in 0.35s]
[0m20:36:54.910200 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:36:54.912195 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:36:54.913192 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:36:54.915188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:36:54.916184 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:36:54.926728 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:36:54.930879 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:36:55.014864 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.015873 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp203654981843"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:36:55.017892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:55.260872 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.243 seconds
[0m20:36:55.286261 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.287270 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:36:55.290417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:36:55.291885 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.293400 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp203654981843'
        
      order by ordinal_position

  
[0m20:36:55.317671 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:36:55.330675 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.331674 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:55.338392 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:36:55.359334 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.361332 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:55.368053 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:36:55.397659 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:36:55.401608 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.402610 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp203654981843" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp203654981843"
    )
  
[0m20:36:55.407388 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:36:55.411373 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:36:55.412338 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:36:55.413368 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:36:55.415898 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:36:55.417119 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:36:55.419648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA84A350>]}
[0m20:36:55.421644 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.50s]
[0m20:36:55.424871 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:36:55.427006 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:36:55.428148 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:36:55.431047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:36:55.432104 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:36:55.441177 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:36:55.446836 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:36:55.455107 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.456339 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp203655451999"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:36:55.458482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:55.689042 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.230 seconds
[0m20:36:55.695030 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.696027 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:36:55.698254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:36:55.699296 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.700355 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp203655451999'
        
      order by ordinal_position

  
[0m20:36:55.724858 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m20:36:55.731800 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.732797 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:55.740248 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:36:55.746231 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.748226 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:55.755012 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:36:55.759006 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:36:55.763074 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.764075 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp203655451999" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp203655451999"
    )
  
[0m20:36:55.768636 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:36:55.771627 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:36:55.772623 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:36:55.773621 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:36:55.776950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:55.779445 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:36:55.780952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA7E6910>]}
[0m20:36:55.782951 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.35s]
[0m20:36:55.786204 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:36:55.787645 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:36:55.788936 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:36:55.792322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:36:55.793733 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:36:55.805760 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:36:55.809749 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:36:55.820057 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:55.822057 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp203655815890"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:36:55.824049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:56.055129 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.231 seconds
[0m20:36:56.063978 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.064977 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:36:56.066936 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:36:56.068390 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.069429 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp203655815890'
        
      order by ordinal_position

  
[0m20:36:56.093331 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.022 seconds
[0m20:36:56.099568 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.101565 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.107525 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:36:56.115217 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.116259 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.123082 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:36:56.134709 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:36:56.138747 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.139815 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp203655815890"
    )


  
[0m20:36:56.143336 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:36:56.146464 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:36:56.147471 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:36:56.148706 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:36:56.151439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:36:56.153546 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:36:56.155660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F85CD190>]}
[0m20:36:56.157666 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.36s]
[0m20:36:56.160938 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:36:56.163216 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:36:56.165372 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:36:56.167396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:36:56.168597 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:36:56.177924 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:36:56.180919 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:36:56.192795 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.194789 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp203656186428"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:36:56.196784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:56.430470 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.234 seconds
[0m20:36:56.436367 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.438360 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:36:56.439321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:36:56.441092 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.442128 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp203656186428'
        
      order by ordinal_position

  
[0m20:36:56.465877 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m20:36:56.472829 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.473828 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.479775 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:36:56.487239 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.488238 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.494235 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:36:56.499105 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:36:56.502535 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.504303 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp203656186428" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp203656186428"
    )
  
[0m20:36:56.507932 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:36:56.511262 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:36:56.512298 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:36:56.513953 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:36:56.516222 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:36:56.517306 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:36:56.519385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F7E2E750>]}
[0m20:36:56.521624 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.35s]
[0m20:36:56.525214 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:36:56.526841 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:36:56.528841 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:36:56.530949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:36:56.531992 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:36:56.540409 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:36:56.544524 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:36:56.557748 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.559844 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp203656554502"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:36:56.561182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:56.809311 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.248 seconds
[0m20:36:56.815845 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.816837 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:36:56.818832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:36:56.819798 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.820795 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp203656554502'
        
      order by ordinal_position

  
[0m20:36:56.845209 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:36:56.851190 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.853154 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.860163 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:36:56.867147 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.868114 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:36:56.875331 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:36:56.879349 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:36:56.883309 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.884944 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp203656554502" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp203656554502"
    )
  
[0m20:36:56.889041 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:36:56.892108 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:36:56.893107 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:36:56.894102 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:36:56.897151 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:36:56.898731 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:36:56.900689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6150e68a-0133-4421-9536-02421c2dd88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FA833550>]}
[0m20:36:56.901723 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.37s]
[0m20:36:56.906053 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:36:56.909348 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:56.910351 [debug] [MainThread]: On master: BEGIN
[0m20:36:56.911971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:57.164782 [debug] [MainThread]: SQL status: BEGIN in 0.253 seconds
[0m20:36:57.166253 [debug] [MainThread]: On master: COMMIT
[0m20:36:57.166788 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:57.168566 [debug] [MainThread]: On master: COMMIT
[0m20:36:57.170175 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:57.170175 [debug] [MainThread]: On master: Close
[0m20:36:57.172722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:57.174559 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:36:57.176034 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:36:57.177736 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:36:57.179072 [info ] [MainThread]: 
[0m20:36:57.181618 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 6.77 seconds (6.77s).
[0m20:36:57.187966 [debug] [MainThread]: Command end result
[0m20:36:57.262690 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:36:57.267707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:36:57.284327 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:36:57.285817 [info ] [MainThread]: 
[0m20:36:57.287513 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:57.289714 [info ] [MainThread]: 
[0m20:36:57.290870 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:36:57.294598 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:57.293601 after 9.97 seconds
[0m20:36:57.296000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F22DFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F22DF3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256F22DF350>]}
[0m20:36:57.297044 [debug] [MainThread]: Flushing usage events
[0m20:36:58.596467 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:39:14.701381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EE06ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EDE4FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EE05ED0>]}


============================== 20:39:14.710070 | cb8f5ec5-7918-41bf-9228-257b38344a77 ==============================
[0m20:39:14.710070 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:39:14.712081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:39:15.129314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EFA6A50>]}
[0m20:39:15.248068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3BA05E10>]}
[0m20:39:15.251060 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:39:16.089810 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:39:16.645003 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:39:16.646000 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:39:17.232182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE401C2390>]}
[0m20:39:17.485674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:39:17.496163 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:39:17.553872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40528150>]}
[0m20:39:17.555810 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:39:17.556809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE4041D510>]}
[0m20:39:17.562079 [info ] [MainThread]: 
[0m20:39:17.564032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:39:17.566711 [info ] [MainThread]: 
[0m20:39:17.568190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:39:17.582198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:39:18.003949 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:39:18.005754 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:39:18.007322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:18.380418 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.373 seconds
[0m20:39:18.383549 [debug] [ThreadPool]: On list_propharma: Close
[0m20:39:18.388781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:39:18.400392 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:39:18.401389 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:39:18.402418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:39:18.631343 [debug] [ThreadPool]: SQL status: BEGIN in 0.228 seconds
[0m20:39:18.632299 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:39:18.633297 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:39:18.646077 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.012 seconds
[0m20:39:18.650121 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:39:18.652118 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:39:18.653114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:39:18.659712 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:39:18.660710 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:39:18.661708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:39:18.986874 [debug] [ThreadPool]: SQL status: BEGIN in 0.325 seconds
[0m20:39:18.987875 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:39:18.989384 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:39:19.000598 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m20:39:19.004210 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:39:19.006210 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:39:19.021677 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:19.022685 [debug] [MainThread]: On master: BEGIN
[0m20:39:19.024335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:39:19.242908 [debug] [MainThread]: SQL status: BEGIN in 0.220 seconds
[0m20:39:19.244899 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:19.245936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:39:19.289568 [debug] [MainThread]: SQL status: SELECT 8 in 0.042 seconds
[0m20:39:19.295151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE409EF790>]}
[0m20:39:19.297100 [debug] [MainThread]: On master: ROLLBACK
[0m20:39:19.298140 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:19.299127 [debug] [MainThread]: On master: BEGIN
[0m20:39:19.301122 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:39:19.302119 [debug] [MainThread]: On master: COMMIT
[0m20:39:19.303120 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:19.304114 [debug] [MainThread]: On master: COMMIT
[0m20:39:19.306215 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:19.307248 [debug] [MainThread]: On master: Close
[0m20:39:19.316870 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:39:19.318865 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:39:19.320901 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:39:19.376154 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:39:19.378151 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:39:19.379147 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:39:19.623863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.244 seconds
[0m20:39:19.624864 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:39:19.626990 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2025-05-25' as date))::date - (cast('2025-05-15' as date))::date)
    
[0m20:39:19.629415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:39:19.655949 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:39:19.660936 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:39:19.663012 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:39:19.665403 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:39:19.667420 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:39:19.669891 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:39:19.671894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:39:19.674060 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:39:19.682434 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:39:19.686449 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:39:19.764138 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:39:19.768677 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:19.769683 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:39:19.770771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:20.013339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.241 seconds
[0m20:39:20.014329 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:20.016897 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:39:20.026654 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:39:20.040580 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:20.041578 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:39:20.043573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.050553 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:20.051553 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:39:20.053546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.085302 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:39:20.086299 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:20.088298 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:39:20.092806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:39:20.105768 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:39:20.116738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:39:20.118788 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:39:20.123595 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:39:20.128793 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:39:20.133570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EEB3B90>]}
[0m20:39:20.135692 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.46s]
[0m20:39:20.140181 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:39:20.142260 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:39:20.143265 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:39:20.145479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:39:20.146629 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:39:20.154865 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:39:20.158262 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:39:20.165839 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:39:20.170021 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.172817 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:39:20.173822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:20.416549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.242 seconds
[0m20:39:20.417559 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.418569 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:39:20.428595 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:39:20.436576 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.437572 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:39:20.439709 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.446310 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.448267 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:39:20.449264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.453571 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:39:20.454113 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.456088 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:39:20.466325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:39:20.472314 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:39:20.473311 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:39:20.474309 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:39:20.478368 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:39:20.482079 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:39:20.483116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40528390>]}
[0m20:39:20.486171 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.34s]
[0m20:39:20.488771 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:39:20.490768 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:39:20.492818 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:39:20.494815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:39:20.497389 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:39:20.507780 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:39:20.511771 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:39:20.518755 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:39:20.523573 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.525555 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:39:20.527554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:20.777401 [debug] [Thread-1 (]: SQL status: BEGIN in 0.250 seconds
[0m20:39:20.778884 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.779893 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:39:20.790169 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:39:20.797965 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.799224 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:39:20.802000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.807958 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.809701 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:39:20.810718 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:20.814175 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:39:20.816170 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.817966 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:39:20.824195 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:39:20.830047 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:39:20.832698 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:39:20.833704 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:39:20.838201 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:39:20.841284 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:39:20.842311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE409D7A90>]}
[0m20:39:20.844315 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.35s]
[0m20:39:20.847429 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:39:20.850006 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:39:20.851447 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:39:20.853804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:39:20.856091 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:39:20.864064 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:39:20.868138 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:39:20.876114 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:39:20.881321 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:20.882320 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:39:20.884312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:21.237533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.353 seconds
[0m20:39:21.238538 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:21.240762 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:39:21.251581 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:39:21.258944 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:21.260994 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:39:21.263061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:21.268911 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:21.270961 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:39:21.273058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:21.275698 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:39:21.276738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:21.278789 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:39:21.280807 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:39:21.286187 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:39:21.288231 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:39:21.289276 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:39:21.292368 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:39:21.296396 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:39:21.297364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40591590>]}
[0m20:39:21.299353 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.44s]
[0m20:39:21.303444 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:39:21.304951 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:39:21.306946 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:39:21.308941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:39:21.311154 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:39:21.321389 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:39:21.326061 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:39:21.334566 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:39:21.339052 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.340050 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:39:21.342048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:21.683304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.341 seconds
[0m20:39:21.684300 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.685298 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:39:21.695883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:39:21.702865 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.703863 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:39:21.705861 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:21.712841 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.713807 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:39:21.715798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:21.718439 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:39:21.720389 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.721386 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:39:21.727371 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:39:21.733471 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:39:21.734472 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:39:21.736467 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:39:21.740496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:39:21.743496 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:39:21.744450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3EF68310>]}
[0m20:39:21.746533 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.44s]
[0m20:39:21.749139 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:39:21.751241 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:39:21.752238 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:39:21.755247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:39:21.757496 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:39:21.764159 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:39:21.768156 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:39:21.775729 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:39:21.780958 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:21.781952 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:39:21.782950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:22.096848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.314 seconds
[0m20:39:22.098741 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:22.099777 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:39:22.109751 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:39:22.116920 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:22.117918 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:39:22.120013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:22.125581 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:22.127539 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:39:22.129539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:22.131532 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:39:22.133528 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:22.134525 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:39:22.144207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:39:22.149804 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:39:22.151477 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:39:22.152482 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:39:22.156281 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:39:22.159070 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:39:22.161029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE401F2F10>]}
[0m20:39:22.163024 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.41s]
[0m20:39:22.166048 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:39:22.167043 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:39:22.168178 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:39:22.170710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:39:22.172302 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:39:22.190885 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:39:22.195398 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:39:22.204121 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:39:22.208084 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:39:22.210080 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:39:22.211077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:22.430533 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m20:39:22.431562 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:39:22.433404 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
    
    

    )

    select *
    from unioned
    where generated_number <= 10
    order by generated_number



),

all_periods as (

    select (
        

    cast('2025-05-15' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-05-25' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select i.stock_qty
,m.name
,m.expiry_date
,m.price*i.stock_qty as "loss"
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
join spine on 1=1
where m.expiry_date between spine.start_date and spine.end_date
  );
[0m20:39:22.458627 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.022 seconds
[0m20:39:22.465012 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:39:22.466009 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
alter table "propharma"."public"."expired_med_count_in_days__dbt_tmp" rename to "expired_med_count_in_days"
[0m20:39:22.468042 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:39:22.471034 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:39:22.472993 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:39:22.473989 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:39:22.476485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:39:22.482316 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."expired_med_count_in_days__dbt_backup"
[0m20:39:22.483313 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:39:22.484349 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
drop view if exists "propharma"."public"."expired_med_count_in_days__dbt_backup" cascade
[0m20:39:22.486020 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:39:22.489114 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:39:22.491074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40A82E10>]}
[0m20:39:22.493442 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.expired_med_count_in_days ............. [[32mCREATE VIEW[0m in 0.32s]
[0m20:39:22.496496 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:39:22.497493 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:39:22.498518 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:39:22.501602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:39:22.503604 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:39:22.513594 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:39:22.517013 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:39:22.595649 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:22.596648 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp203922564536"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:39:22.598640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:22.865246 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.267 seconds
[0m20:39:22.891707 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:22.893701 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:39:22.895217 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:39:22.897206 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:22.898210 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp203922564536'
        
      order by ordinal_position

  
[0m20:39:22.923666 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.024 seconds
[0m20:39:22.937668 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:22.938657 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:22.945609 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:39:22.960570 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:22.963261 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:22.970784 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:39:23.000774 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:39:23.004725 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:23.006719 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp203922564536" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp203922564536"
    )
  
[0m20:39:23.011478 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:39:23.014470 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:39:23.015466 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:39:23.016464 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:39:23.022446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:39:23.024441 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:39:23.026944 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3FFD08D0>]}
[0m20:39:23.030143 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.53s]
[0m20:39:23.033136 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:39:23.035136 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:39:23.037131 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:39:23.039125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:39:23.041590 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:39:23.049567 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:39:23.053975 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:39:23.065788 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.067783 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp203923062796"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:39:23.069778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:23.333191 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.264 seconds
[0m20:39:23.340493 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.341497 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:39:23.343490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:39:23.345487 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.346484 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp203923062796'
        
      order by ordinal_position

  
[0m20:39:23.373771 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.025 seconds
[0m20:39:23.380572 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.381794 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:23.388738 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:39:23.395228 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.397223 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:23.404209 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:39:23.408197 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:39:23.412190 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.414179 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp203923062796" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp203923062796"
    )
  
[0m20:39:23.418171 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:39:23.422156 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:39:23.423153 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:39:23.424151 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:39:23.433336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m20:39:23.435728 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:39:23.437722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE4096EB10>]}
[0m20:39:23.439718 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.40s]
[0m20:39:23.443991 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:39:23.444989 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:39:23.448559 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:39:23.450561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:39:23.453564 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:39:23.468628 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:39:23.472909 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:39:23.485504 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.488500 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp203923480520"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:39:23.490721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:23.751287 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.261 seconds
[0m20:39:23.760965 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.761963 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:39:23.764960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:39:23.765957 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.766968 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp203923480520'
        
      order by ordinal_position

  
[0m20:39:23.795057 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.026 seconds
[0m20:39:23.802277 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.804592 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:23.811980 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:39:23.820204 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.821201 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:23.829180 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.006 seconds
[0m20:39:23.842145 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:39:23.846135 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.847800 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp203923480520"
    )


  
[0m20:39:23.852091 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:39:23.856082 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:39:23.857076 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:39:23.858077 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:39:23.867948 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:39:23.871232 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:39:23.872229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3E7A1A90>]}
[0m20:39:23.875223 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.42s]
[0m20:39:23.878295 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:39:23.880646 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:39:23.882906 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:39:23.885490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:39:23.887494 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:39:23.896527 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:39:23.901513 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:39:23.911209 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:23.913395 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp203923906724"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:39:23.915397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:24.185463 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.271 seconds
[0m20:39:24.191766 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.192770 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:39:24.196301 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:39:24.197301 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.198766 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp203923906724'
        
      order by ordinal_position

  
[0m20:39:24.226621 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.026 seconds
[0m20:39:24.233815 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.234926 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:24.242552 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.006 seconds
[0m20:39:24.249656 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.250768 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:24.257892 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:39:24.262852 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:39:24.267343 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.269337 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp203923906724" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp203923906724"
    )
  
[0m20:39:24.274326 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:39:24.277320 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:39:24.279316 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:39:24.280794 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:39:24.286339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:39:24.288336 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:39:24.290333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40A036D0>]}
[0m20:39:24.293092 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.40s]
[0m20:39:24.296603 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:39:24.298597 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:39:24.300598 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:39:24.302586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:39:24.304583 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:39:24.313558 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:39:24.319812 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:39:24.337418 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.339409 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp203924331315"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:39:24.340406 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:39:24.676064 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.335 seconds
[0m20:39:24.686006 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.687016 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:39:24.689613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:39:24.690656 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.692662 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp203924331315'
        
      order by ordinal_position

  
[0m20:39:24.725217 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.030 seconds
[0m20:39:24.734427 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.736427 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:24.743404 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:39:24.751595 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.752593 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:39:24.760655 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:39:24.765642 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:39:24.769042 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.771384 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp203924331315" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp203924331315"
    )
  
[0m20:39:24.775426 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:39:24.778563 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:39:24.780576 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:39:24.781573 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:39:24.787042 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:39:24.789450 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:39:24.791444 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb8f5ec5-7918-41bf-9228-257b38344a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE40957190>]}
[0m20:39:24.793439 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.49s]
[0m20:39:24.797246 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:39:24.801581 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:24.802585 [debug] [MainThread]: On master: BEGIN
[0m20:39:24.804579 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:39:25.088579 [debug] [MainThread]: SQL status: BEGIN in 0.284 seconds
[0m20:39:25.089714 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.091723 [debug] [MainThread]: Using postgres connection "master"
[0m20:39:25.092728 [debug] [MainThread]: On master: COMMIT
[0m20:39:25.093736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:39:25.094743 [debug] [MainThread]: On master: Close
[0m20:39:25.096248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:39:25.097631 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:39:25.099644 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:39:25.100774 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:39:25.102235 [info ] [MainThread]: 
[0m20:39:25.104865 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 7.53 seconds (7.53s).
[0m20:39:25.114493 [debug] [MainThread]: Command end result
[0m20:39:25.201421 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:39:25.208198 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:39:25.223378 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:39:25.225465 [info ] [MainThread]: 
[0m20:39:25.227611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:39:25.228619 [info ] [MainThread]: 
[0m20:39:25.231823 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:39:25.235126 [debug] [MainThread]: Command `dbt run` succeeded at 20:39:25.235126 after 10.81 seconds
[0m20:39:25.236357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3848FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3848F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002DE3848F350>]}
[0m20:39:25.237535 [debug] [MainThread]: Flushing usage events
[0m20:39:26.908875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:41:34.339109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B2F2E510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B2F3AD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B2F74490>]}


============================== 20:41:34.347101 | 0deac0d0-fd7c-4135-b87a-cf0288107249 ==============================
[0m20:41:34.347101 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:41:34.350009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:41:34.771598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B30B1350>]}
[0m20:41:34.888799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AFBAD910>]}
[0m20:41:34.891791 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:41:35.717845 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:41:36.282649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:41:36.284614 [debug] [MainThread]: Partial parsing: updated file: Propharma://models\marts\expired_med_count_in_days.sql
[0m20:41:36.838375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4301810>]}
[0m20:41:37.066932 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:41:37.078160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:41:37.135181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B483BE90>]}
[0m20:41:37.136712 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:41:37.139119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4762150>]}
[0m20:41:37.143805 [info ] [MainThread]: 
[0m20:41:37.145820 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:41:37.147974 [info ] [MainThread]: 
[0m20:41:37.150180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:41:37.163156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma'
[0m20:41:37.579943 [debug] [ThreadPool]: Using postgres connection "list_propharma"
[0m20:41:37.580942 [debug] [ThreadPool]: On list_propharma: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma"} */

    select distinct nspname from pg_namespace
  
[0m20:41:37.581941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:37.957282 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.375 seconds
[0m20:41:37.960310 [debug] [ThreadPool]: On list_propharma: Close
[0m20:41:37.965261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:41:37.977465 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:41:37.979460 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:41:37.980666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:41:38.198401 [debug] [ThreadPool]: SQL status: BEGIN in 0.218 seconds
[0m20:41:38.200130 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:41:38.201166 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:41:38.212577 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m20:41:38.215433 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:41:38.217388 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:41:38.219385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:41:38.230246 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:41:38.231232 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:41:38.232229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:41:38.451415 [debug] [ThreadPool]: SQL status: BEGIN in 0.219 seconds
[0m20:41:38.452409 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:41:38.454369 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:41:38.465168 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:41:38.468160 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:41:38.469126 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:41:38.480092 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:38.482087 [debug] [MainThread]: On master: BEGIN
[0m20:41:38.483084 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:41:38.696815 [debug] [MainThread]: SQL status: BEGIN in 0.213 seconds
[0m20:41:38.697817 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:38.698813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:41:38.742757 [debug] [MainThread]: SQL status: SELECT 8 in 0.042 seconds
[0m20:41:38.748443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4AE9950>]}
[0m20:41:38.749440 [debug] [MainThread]: On master: ROLLBACK
[0m20:41:38.751403 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:38.752437 [debug] [MainThread]: On master: BEGIN
[0m20:41:38.754392 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:41:38.755389 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.756386 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:38.757383 [debug] [MainThread]: On master: COMMIT
[0m20:41:38.758380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:38.760099 [debug] [MainThread]: On master: Close
[0m20:41:38.769432 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:41:38.771427 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:41:38.773454 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:41:38.822885 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:41:38.824886 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:41:38.825917 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:41:39.143384 [debug] [Thread-1 (]: SQL status: BEGIN in 0.317 seconds
[0m20:41:39.144381 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:41:39.145894 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2025-05-25' as date))::date - (cast('2025-05-15' as date))::date)
    
[0m20:41:39.147897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:41:39.169000 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:41:39.172992 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:41:39.174957 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:41:39.176957 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:41:39.178957 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:41:39.180111 [info ] [Thread-1 (]: 1 of 12 START sql view model public.stg_inventory .............................. [RUN]
[0m20:41:39.182214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:41:39.183247 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:41:39.190062 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:41:39.193058 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:41:39.265703 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_inventory"
[0m20:41:39.269665 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.270837 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: BEGIN
[0m20:41:39.273123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.492165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m20:41:39.493452 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.494496 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */

  create view "propharma"."public"."stg_inventory__dbt_tmp"
    
    
  as (
    

with raw_inventory as (
    select * from "propharma"."public"."inventory"
)

select
    medicine_id,
    stock_qty::int as stock_qty,
    last_updated::date as last_updated
from raw_inventory
  );
[0m20:41:39.504477 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:41:39.517568 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.518558 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory" rename to "stg_inventory__dbt_backup"
[0m20:41:39.520791 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:39.527220 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.528226 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
alter table "propharma"."public"."stg_inventory__dbt_tmp" rename to "stg_inventory"
[0m20:41:39.530175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:39.562286 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:41:39.564250 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.565279 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: COMMIT
[0m20:41:39.568030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:41:39.581499 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_inventory__dbt_backup"
[0m20:41:39.592432 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_inventory"
[0m20:41:39.593429 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_inventory"} */
drop view if exists "propharma"."public"."stg_inventory__dbt_backup" cascade
[0m20:41:39.598415 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:41:39.603435 [debug] [Thread-1 (]: On model.Propharma.stg_inventory: Close
[0m20:41:39.608541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B3134110>]}
[0m20:41:39.610597 [info ] [Thread-1 (]: 1 of 12 OK created sql view model public.stg_inventory ......................... [[32mCREATE VIEW[0m in 0.42s]
[0m20:41:39.613281 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:41:39.614278 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:41:39.616273 [info ] [Thread-1 (]: 2 of 12 START sql view model public.stg_medicines .............................. [RUN]
[0m20:41:39.618268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:41:39.620263 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:41:39.627244 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:41:39.631822 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:41:39.641437 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_medicines"
[0m20:41:39.645957 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:39.648141 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: BEGIN
[0m20:41:39.649600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:39.983439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.334 seconds
[0m20:41:39.984858 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:39.986277 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */

  create view "propharma"."public"."stg_medicines__dbt_tmp"
    
    
  as (
    

with raw_medicines as (
    select * from "propharma"."public"."medicines"
)

select
    medicine_id,
    name,
    category,
    price::numeric(10,2) as price,
    expiry_date::date as expiry_date
from raw_medicines
  );
[0m20:41:39.995899 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:41:40.003328 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:40.004369 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines" rename to "stg_medicines__dbt_backup"
[0m20:41:40.007429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.013636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:40.014676 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
alter table "propharma"."public"."stg_medicines__dbt_tmp" rename to "stg_medicines"
[0m20:41:40.016726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.019869 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:41:40.020877 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:40.022185 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: COMMIT
[0m20:41:40.026445 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:41:40.032326 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_medicines__dbt_backup"
[0m20:41:40.033323 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_medicines"
[0m20:41:40.035374 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_medicines"} */
drop view if exists "propharma"."public"."stg_medicines__dbt_backup" cascade
[0m20:41:40.038141 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:41:40.041787 [debug] [Thread-1 (]: On model.Propharma.stg_medicines: Close
[0m20:41:40.043747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B3134110>]}
[0m20:41:40.045555 [info ] [Thread-1 (]: 2 of 12 OK created sql view model public.stg_medicines ......................... [[32mCREATE VIEW[0m in 0.43s]
[0m20:41:40.048693 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:41:40.050688 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:41:40.052682 [info ] [Thread-1 (]: 3 of 12 START sql view model public.stg_patients ............................... [RUN]
[0m20:41:40.054962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:41:40.057388 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:41:40.067681 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:41:40.073397 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:41:40.081382 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_patients"
[0m20:41:40.085991 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.087835 [debug] [Thread-1 (]: On model.Propharma.stg_patients: BEGIN
[0m20:41:40.088976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.319115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.230 seconds
[0m20:41:40.321109 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.322107 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */

  create view "propharma"."public"."stg_patients__dbt_tmp"
    
    
  as (
    

with raw_patients as (
    select * from "propharma"."public"."patients"
)

select
    patient_id,
    name,
    dob::date as dob,
    gender
from raw_patients
  );
[0m20:41:40.331083 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:41:40.338809 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.339806 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients" rename to "stg_patients__dbt_backup"
[0m20:41:40.341801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.348289 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.349323 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
alter table "propharma"."public"."stg_patients__dbt_tmp" rename to "stg_patients"
[0m20:41:40.351316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.354276 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:41:40.356272 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.357268 [debug] [Thread-1 (]: On model.Propharma.stg_patients: COMMIT
[0m20:41:40.361039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:41:40.367062 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_patients__dbt_backup"
[0m20:41:40.369023 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_patients"
[0m20:41:40.370058 [debug] [Thread-1 (]: On model.Propharma.stg_patients: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_patients"} */
drop view if exists "propharma"."public"."stg_patients__dbt_backup" cascade
[0m20:41:40.374012 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:41:40.377004 [debug] [Thread-1 (]: On model.Propharma.stg_patients: Close
[0m20:41:40.378001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B306CF10>]}
[0m20:41:40.379996 [info ] [Thread-1 (]: 3 of 12 OK created sql view model public.stg_patients .......................... [[32mCREATE VIEW[0m in 0.32s]
[0m20:41:40.382984 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:41:40.384983 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:41:40.385977 [info ] [Thread-1 (]: 4 of 12 START sql view model public.stg_prescriptions .......................... [RUN]
[0m20:41:40.388687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:41:40.390154 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:41:40.398432 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:41:40.402422 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:41:40.410818 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_prescriptions"
[0m20:41:40.415290 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.417290 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: BEGIN
[0m20:41:40.418287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.638296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.219 seconds
[0m20:41:40.639294 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.640291 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */

  create view "propharma"."public"."stg_prescriptions__dbt_tmp"
    
    
  as (
    

with raw_prescriptions as (
    select * from "propharma"."public"."prescriptions"
)

select
    prescription_id,
    patient_id,
    medicine_id,
    prescribed_date,
    quantity::int as quantity
from raw_prescriptions
  );
[0m20:41:40.649855 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:41:40.656840 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.657832 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions" rename to "stg_prescriptions__dbt_backup"
[0m20:41:40.659832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.665814 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.666810 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
alter table "propharma"."public"."stg_prescriptions__dbt_tmp" rename to "stg_prescriptions"
[0m20:41:40.668801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:40.671802 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:41:40.672790 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.674749 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: COMMIT
[0m20:41:40.679566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:41:40.685589 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_prescriptions__dbt_backup"
[0m20:41:40.686582 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_prescriptions"
[0m20:41:40.687584 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_prescriptions"} */
drop view if exists "propharma"."public"."stg_prescriptions__dbt_backup" cascade
[0m20:41:40.691558 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:41:40.694664 [debug] [Thread-1 (]: On model.Propharma.stg_prescriptions: Close
[0m20:41:40.695659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4B71AD0>]}
[0m20:41:40.697805 [info ] [Thread-1 (]: 4 of 12 OK created sql view model public.stg_prescriptions ..................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:41:40.700083 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:41:40.701779 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:41:40.703253 [info ] [Thread-1 (]: 5 of 12 START sql view model public.stg_sales .................................. [RUN]
[0m20:41:40.704794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:41:40.706590 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:41:40.716788 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:41:40.720772 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:41:40.731493 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_sales"
[0m20:41:40.735488 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:40.737098 [debug] [Thread-1 (]: On model.Propharma.stg_sales: BEGIN
[0m20:41:40.738145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:40.974787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.237 seconds
[0m20:41:40.977231 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:40.980223 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */

  create view "propharma"."public"."stg_sales__dbt_tmp"
    
    
  as (
    


with raw_sales as (
    select * from "propharma"."public"."sales"
)
select
    sale_id,
    prescription_id,
    medicine_id,
    sale_date::date as sale_date,
    quantity_sold::int,
    amount::numeric(10,2)
from raw_sales
  );
[0m20:41:40.993308 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:41:40.999792 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:41.000789 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m20:41:41.003590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:41.009848 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:41.010846 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
alter table "propharma"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:41:41.013356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:41.016408 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:41:41.018403 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:41.021396 [debug] [Thread-1 (]: On model.Propharma.stg_sales: COMMIT
[0m20:41:41.032941 [debug] [Thread-1 (]: SQL status: COMMIT in 0.010 seconds
[0m20:41:41.037835 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_sales__dbt_backup"
[0m20:41:41.040245 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_sales"
[0m20:41:41.041242 [debug] [Thread-1 (]: On model.Propharma.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_sales"} */
drop view if exists "propharma"."public"."stg_sales__dbt_backup" cascade
[0m20:41:41.044703 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:41:41.048507 [debug] [Thread-1 (]: On model.Propharma.stg_sales: Close
[0m20:41:41.049504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B31071D0>]}
[0m20:41:41.051581 [info ] [Thread-1 (]: 5 of 12 OK created sql view model public.stg_sales ............................. [[32mCREATE VIEW[0m in 0.34s]
[0m20:41:41.055060 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:41:41.056057 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:41:41.057054 [info ] [Thread-1 (]: 6 of 12 START sql view model public.stg_suppliers .............................. [RUN]
[0m20:41:41.059498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:41:41.060503 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:41:41.070369 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:41:41.074043 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:41:41.083615 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.stg_suppliers"
[0m20:41:41.087636 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.088634 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: BEGIN
[0m20:41:41.090628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:41.311942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.221 seconds
[0m20:41:41.313899 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.314896 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */

  create view "propharma"."public"."stg_suppliers__dbt_tmp"
    
    
  as (
    


with raw_suppliers as (
    select * from "propharma"."public"."suppliers"
)

select
    supplier_id,
    supplier_name,
    medicine_id,
    last_supplied_date::date as last_supplied_date
from raw_suppliers
  );
[0m20:41:41.323907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m20:41:41.330597 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.331636 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers" rename to "stg_suppliers__dbt_backup"
[0m20:41:41.333667 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:41.339656 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.341613 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
alter table "propharma"."public"."stg_suppliers__dbt_tmp" rename to "stg_suppliers"
[0m20:41:41.342612 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:41.346633 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:41:41.346633 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.349155 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: COMMIT
[0m20:41:41.354642 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:41:41.360192 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."stg_suppliers__dbt_backup"
[0m20:41:41.362186 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.stg_suppliers"
[0m20:41:41.363184 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.stg_suppliers"} */
drop view if exists "propharma"."public"."stg_suppliers__dbt_backup" cascade
[0m20:41:41.367211 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m20:41:41.369723 [debug] [Thread-1 (]: On model.Propharma.stg_suppliers: Close
[0m20:41:41.371981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B43EC910>]}
[0m20:41:41.372526 [info ] [Thread-1 (]: 6 of 12 OK created sql view model public.stg_suppliers ......................... [[32mCREATE VIEW[0m in 0.31s]
[0m20:41:41.376715 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:41:41.377223 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:41:41.378939 [info ] [Thread-1 (]: 7 of 12 START sql view model public.expired_med_count_in_days .................. [RUN]
[0m20:41:41.381616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now model.Propharma.expired_med_count_in_days)
[0m20:41:41.382747 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:41:41.403363 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:41:41.406812 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:41:41.416849 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.expired_med_count_in_days"
[0m20:41:41.420808 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:41:41.422872 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: BEGIN
[0m20:41:41.423906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:41.751852 [debug] [Thread-1 (]: SQL status: BEGIN in 0.327 seconds
[0m20:41:41.752813 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:41:41.753852 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */

  create view "propharma"."public"."expired_med_count_in_days__dbt_tmp"
    
    
  as (
    with  __dbt__cte__date_spine as (








with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
    
    

    )

    select *
    from unioned
    where generated_number <= 10
    order by generated_number



),

all_periods as (

    select (
        

    cast('2025-05-15' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2025-05-25' as date)

)

select * from filtered


), spine as (
  select min(date_day) as start_date, max(date_day) as end_date
  from __dbt__cte__date_spine
)

select i.stock_qty
,m.name
,m.expiry_date
,-(m.price*i.stock_qty ) as "loss"
from "propharma"."public"."stg_medicines" m
join "propharma"."public"."stg_inventory" i on m.medicine_id = i.medicine_id
join spine on 1=1
where m.expiry_date between spine.start_date and spine.end_date
  );
[0m20:41:41.776735 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m20:41:41.782717 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:41:41.784682 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
alter table "propharma"."public"."expired_med_count_in_days__dbt_tmp" rename to "expired_med_count_in_days"
[0m20:41:41.786680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:41:41.790701 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:41:41.791699 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:41:41.792660 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: COMMIT
[0m20:41:41.794999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:41:41.799989 [debug] [Thread-1 (]: Applying DROP to: "propharma"."public"."expired_med_count_in_days__dbt_backup"
[0m20:41:41.802417 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.expired_med_count_in_days"
[0m20:41:41.803922 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.expired_med_count_in_days"} */
drop view if exists "propharma"."public"."expired_med_count_in_days__dbt_backup" cascade
[0m20:41:41.805922 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:41:41.809131 [debug] [Thread-1 (]: On model.Propharma.expired_med_count_in_days: Close
[0m20:41:41.810127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B3094C50>]}
[0m20:41:41.812092 [info ] [Thread-1 (]: 7 of 12 OK created sql view model public.expired_med_count_in_days ............. [[32mCREATE VIEW[0m in 0.43s]
[0m20:41:41.815083 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:41:41.816667 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:41:41.818668 [info ] [Thread-1 (]: 8 of 12 START sql incremental model public.mart_expired_drugs .................. [RUN]
[0m20:41:41.820930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:41:41.822932 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:41:41.831940 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:41:41.834946 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:41:41.915506 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:41.917516 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

    
  
    

  create temporary table "mart_expired_drugs__dbt_tmp204141883963"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag,
    
        true as expired
    
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:41:41.918498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:42.159045 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.241 seconds
[0m20:41:42.183527 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.185486 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: BEGIN
[0m20:41:42.187476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:41:42.188522 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.189547 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs__dbt_tmp204141883963'
        
      order by ordinal_position

  
[0m20:41:42.213658 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:41:42.226646 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.228620 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:42.235643 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:41:42.249119 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.251121 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_expired_drugs'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:42.258135 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.006 seconds
[0m20:41:42.286025 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_expired_drugs"
[0m20:41:42.290502 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.291543 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_expired_drugs"} */

      
        
        
        delete from "propharma"."public"."mart_expired_drugs" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_expired_drugs__dbt_tmp204141883963" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_expired_drugs" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag", "expired"
        from "mart_expired_drugs__dbt_tmp204141883963"
    )
  
[0m20:41:42.295529 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:41:42.298523 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:41:42.299520 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_expired_drugs"
[0m20:41:42.301484 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: COMMIT
[0m20:41:42.306287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m20:41:42.308329 [debug] [Thread-1 (]: On model.Propharma.mart_expired_drugs: Close
[0m20:41:42.310290 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B482D390>]}
[0m20:41:42.312303 [info ] [Thread-1 (]: 8 of 12 OK created sql incremental model public.mart_expired_drugs ............. [[32mINSERT 0 10[0m in 0.49s]
[0m20:41:42.315304 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:41:42.317762 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:41:42.319300 [info ] [Thread-1 (]: 9 of 12 START sql incremental model public.mart_inventory_status ............... [RUN]
[0m20:41:42.320932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:41:42.322890 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:41:42.331195 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:41:42.335153 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:41:42.346853 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.349255 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

    
  
    

  create temporary table "mart_inventory_status__dbt_tmp204142342254"
  
  
    as
  
  (
    

select
    m.medicine_id,
    m.name,
    m.category,
    m.price,
    m.expiry_date,
    i.stock_qty,
    i.last_updated,
    case 
        when i.stock_qty < 20 then true
        else false
    end as low_stock_flag
from "propharma"."public"."stg_inventory" i
join "propharma"."public"."stg_medicines" m on i.medicine_id = m.medicine_id
  );
  
  
[0m20:41:42.350258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:42.578728 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.228 seconds
[0m20:41:42.584977 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.586980 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: BEGIN
[0m20:41:42.589170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:41:42.590211 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.591271 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status__dbt_tmp204142342254'
        
      order by ordinal_position

  
[0m20:41:42.615878 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.024 seconds
[0m20:41:42.622601 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.623596 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:42.630830 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:41:42.637585 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.638583 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_inventory_status'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:42.645665 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:41:42.649688 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_inventory_status"
[0m20:41:42.653804 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.655225 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_inventory_status"} */

      
        
        
        delete from "propharma"."public"."mart_inventory_status" as DBT_INTERNAL_DEST
        where (medicine_id) in (
            select distinct medicine_id
            from "mart_inventory_status__dbt_tmp204142342254" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_inventory_status" ("medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag")
    (
        select "medicine_id", "name", "category", "price", "expiry_date", "stock_qty", "last_updated", "low_stock_flag"
        from "mart_inventory_status__dbt_tmp204142342254"
    )
  
[0m20:41:42.659255 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:41:42.662250 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:41:42.663244 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_inventory_status"
[0m20:41:42.664944 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: COMMIT
[0m20:41:42.667306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:41:42.669221 [debug] [Thread-1 (]: On model.Propharma.mart_inventory_status: Close
[0m20:41:42.671183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4B8CFD0>]}
[0m20:41:42.672178 [info ] [Thread-1 (]: 9 of 12 OK created sql incremental model public.mart_inventory_status .......... [[32mINSERT 0 10[0m in 0.35s]
[0m20:41:42.675326 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:41:42.677614 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:41:42.678620 [info ] [Thread-1 (]: 10 of 12 START sql incremental model public.mart_sales_summary ................. [RUN]
[0m20:41:42.681591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now model.Propharma.mart_sales_summary)
[0m20:41:42.684001 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:41:42.698086 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:41:42.702475 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:41:42.710980 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:42.712979 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

    
  
    

  create temporary table "mart_sales_summary__dbt_tmp204142707467"
  
  
    as
  
  (
    

select
    date_trunc('day', sale_date) as sales_day,
    date_trunc('month', sale_date) as sales_month,
    count(*) as total_sales_count,
    sum(quantity_sold)::int as total_quantity,
    sum(amount)::numeric(10,2) as total_revenue
from "propharma"."public"."stg_sales"
group by 1,2 --only generates seq group by col like group 1,2 when passed =2 like that if =3 then group by 1,2,3
--group by sales_day, sales_month
order by sales_day
  );
  
  
[0m20:41:42.713980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:42.953456 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.239 seconds
[0m20:41:42.962467 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:42.963467 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: BEGIN
[0m20:41:42.965985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:41:42.966976 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:42.967973 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary__dbt_tmp204142707467'
        
      order by ordinal_position

  
[0m20:41:42.992499 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.024 seconds
[0m20:41:42.999520 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:43.000516 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.007393 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:41:43.013738 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:43.015699 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_sales_summary'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.021717 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.005 seconds
[0m20:41:43.033685 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_sales_summary"
[0m20:41:43.041223 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:43.043180 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_sales_summary"} */

      insert into "propharma"."public"."mart_sales_summary" ("sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue")
    (
        select "sales_day", "sales_month", "total_sales_count", "total_quantity", "total_revenue"
        from "mart_sales_summary__dbt_tmp204142707467"
    )


  
[0m20:41:43.045864 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.002 seconds
[0m20:41:43.048900 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:41:43.050436 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_sales_summary"
[0m20:41:43.051471 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: COMMIT
[0m20:41:43.054334 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:41:43.056773 [debug] [Thread-1 (]: On model.Propharma.mart_sales_summary: Close
[0m20:41:43.058540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B214E6D0>]}
[0m20:41:43.059556 [info ] [Thread-1 (]: 10 of 12 OK created sql incremental model public.mart_sales_summary ............ [[32mINSERT 0 10[0m in 0.38s]
[0m20:41:43.063050 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:41:43.065054 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:41:43.067233 [info ] [Thread-1 (]: 11 of 12 START sql incremental model public.mart_top_customers ................. [RUN]
[0m20:41:43.069233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:41:43.070229 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:41:43.078208 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:41:43.082198 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:41:43.092925 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.093931 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

    
  
    

  create temporary table "mart_top_customers__dbt_tmp204143089200"
  
  
    as
  
  (
    

select
    p.patient_id,
    p.name,
    count(*) as purchase_count,
    sum(s.amount)::numeric(10,2) as total_value
from "propharma"."public"."stg_sales" s
join "propharma"."public"."stg_prescriptions" pr on s.prescription_id = pr.prescription_id
join "propharma"."public"."stg_patients" p on pr.patient_id = p.patient_id
group by p.patient_id, p.name
  );
  
  
[0m20:41:43.094922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:43.321563 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.227 seconds
[0m20:41:43.328479 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.329473 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: BEGIN
[0m20:41:43.331469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:41:43.332465 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.333463 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers__dbt_tmp204143089200'
        
      order by ordinal_position

  
[0m20:41:43.358190 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.022 seconds
[0m20:41:43.364029 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.365995 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.372009 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:41:43.378424 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.380383 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_top_customers'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.386568 [debug] [Thread-1 (]: SQL status: SELECT 4 in 0.005 seconds
[0m20:41:43.390595 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_top_customers"
[0m20:41:43.394336 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.396331 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_top_customers"} */

      
        
        
        delete from "propharma"."public"."mart_top_customers" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_top_customers__dbt_tmp204143089200" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_top_customers" ("patient_id", "name", "purchase_count", "total_value")
    (
        select "patient_id", "name", "purchase_count", "total_value"
        from "mart_top_customers__dbt_tmp204143089200"
    )
  
[0m20:41:43.401083 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:41:43.404111 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:41:43.405104 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_top_customers"
[0m20:41:43.406101 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: COMMIT
[0m20:41:43.416433 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m20:41:43.418020 [debug] [Thread-1 (]: On model.Propharma.mart_top_customers: Close
[0m20:41:43.419846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B2F96450>]}
[0m20:41:43.422681 [info ] [Thread-1 (]: 11 of 12 OK created sql incremental model public.mart_top_customers ............ [[32mINSERT 0 10[0m in 0.35s]
[0m20:41:43.425724 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:41:43.427197 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:41:43.429524 [info ] [Thread-1 (]: 12 of 12 START sql incremental model public.mart_invoice ....................... [RUN]
[0m20:41:43.431772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:41:43.433549 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:41:43.442317 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:41:43.445280 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:41:43.457122 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.458534 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

    
  
    

  create temporary table "mart_invoice__dbt_tmp204143454131"
  
  
    as
  
  (
    

select pat.patient_id,
	pat.name AS "Patients Name",
	EXTRACT(YEAR FROM AGE(CURRENT_DATE, pat.dob)) AS "Patients Age",
	pre.prescribed_date as "Prescribed Date",
	pre.quantity as "Prescribed Quantity",
	med.name as "Medicine Name",
	sup.supplier_name as "Supplier Name",
	pre.quantity * med.price::numeric(10,2) as "Total Price",
	med.expiry_date AS "Medicine Expiry Date"
	from "propharma"."public"."stg_patients" pat
	join "propharma"."public"."stg_prescriptions" pre on pat.patient_id = pre.patient_id
	join "propharma"."public"."stg_medicines" med on pre.medicine_id = med.medicine_id
	join "propharma"."public"."stg_suppliers" sup on med.medicine_id = sup.medicine_id
  );
  
  
[0m20:41:43.459715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:43.701631 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.241 seconds
[0m20:41:43.707422 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.708456 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: BEGIN
[0m20:41:43.710756 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m20:41:43.712545 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.713689 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice__dbt_tmp204143454131'
        
      order by ordinal_position

  
[0m20:41:43.737639 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.023 seconds
[0m20:41:43.744609 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.745645 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.753238 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:41:43.759861 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.760897 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "propharma".INFORMATION_SCHEMA.columns
      where table_name = 'mart_invoice'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
[0m20:41:43.767593 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m20:41:43.772579 [debug] [Thread-1 (]: Writing runtime sql for node "model.Propharma.mart_invoice"
[0m20:41:43.776533 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.777532 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.mart_invoice"} */

      
        
        
        delete from "propharma"."public"."mart_invoice" as DBT_INTERNAL_DEST
        where (patient_id) in (
            select distinct patient_id
            from "mart_invoice__dbt_tmp204143454131" as DBT_INTERNAL_SOURCE
        );

    

    insert into "propharma"."public"."mart_invoice" ("patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date")
    (
        select "patient_id", "Patients Name", "Patients Age", "Prescribed Date", "Prescribed Quantity", "Medicine Name", "Total Price", "Medicine Expiry Date"
        from "mart_invoice__dbt_tmp204143454131"
    )
  
[0m20:41:43.781519 [debug] [Thread-1 (]: SQL status: INSERT 0 10 in 0.003 seconds
[0m20:41:43.784752 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:41:43.785783 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.mart_invoice"
[0m20:41:43.786783 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: COMMIT
[0m20:41:43.790099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:41:43.793172 [debug] [Thread-1 (]: On model.Propharma.mart_invoice: Close
[0m20:41:43.795125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0deac0d0-fd7c-4135-b87a-cf0288107249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272B4B45D10>]}
[0m20:41:43.796127 [info ] [Thread-1 (]: 12 of 12 OK created sql incremental model public.mart_invoice .................. [[32mINSERT 0 10[0m in 0.36s]
[0m20:41:43.799372 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:41:43.802362 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:43.804358 [debug] [MainThread]: On master: BEGIN
[0m20:41:43.806353 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:41:44.049158 [debug] [MainThread]: SQL status: BEGIN in 0.243 seconds
[0m20:41:44.050162 [debug] [MainThread]: On master: COMMIT
[0m20:41:44.051671 [debug] [MainThread]: Using postgres connection "master"
[0m20:41:44.052680 [debug] [MainThread]: On master: COMMIT
[0m20:41:44.054687 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:41:44.055694 [debug] [MainThread]: On master: Close
[0m20:41:44.057711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:44.058721 [debug] [MainThread]: Connection 'list_propharma' was properly closed.
[0m20:41:44.059731 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:41:44.060739 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:41:44.062751 [info ] [MainThread]: 
[0m20:41:44.064491 [info ] [MainThread]: Finished running 5 incremental models, 7 view models in 0 hours 0 minutes and 6.91 seconds (6.91s).
[0m20:41:44.069692 [debug] [MainThread]: Command end result
[0m20:41:44.142149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:41:44.149404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:41:44.165888 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:41:44.166884 [info ] [MainThread]: 
[0m20:41:44.167887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:41:44.170839 [info ] [MainThread]: 
[0m20:41:44.172003 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=0 SKIP=0 TOTAL=12
[0m20:41:44.175582 [debug] [MainThread]: Command `dbt run` succeeded at 20:41:44.175582 after 10.09 seconds
[0m20:41:44.177577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AC64FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AC64F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AC8E9510>]}
[0m20:41:44.178573 [debug] [MainThread]: Flushing usage events
[0m20:41:45.786403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:44:35.945590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA9257090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA9257AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA9257FD0>]}


============================== 20:44:35.953572 | 38ef0718-e1db-4a3b-96c2-428f58103d8b ==============================
[0m20:44:35.953572 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:44:35.956584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:44:36.406587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA93E4D50>]}
[0m20:44:36.518084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA5E67450>]}
[0m20:44:36.521034 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:44:37.358156 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:44:37.940403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:44:37.942084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:44:38.075358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAA7C3F90>]}
[0m20:44:38.307980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:44:38.319982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:44:38.407419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAAA2BF50>]}
[0m20:44:38.409415 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:44:38.411410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAAA13650>]}
[0m20:44:38.416396 [info ] [MainThread]: 
[0m20:44:38.418797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:44:38.419794 [info ] [MainThread]: 
[0m20:44:38.423265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:44:38.437318 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_snapshots'
[0m20:44:38.799831 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:44:38.800826 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:44:38.802781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:44:39.161101 [debug] [ThreadPool]: SQL status: BEGIN in 0.358 seconds
[0m20:44:39.162142 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:44:39.163506 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:44:39.174107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.009 seconds
[0m20:44:39.177204 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:44:39.178644 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:44:39.180666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_snapshots, now list_propharma_public)
[0m20:44:39.186519 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:44:39.187517 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:44:39.188514 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:44:39.409712 [debug] [ThreadPool]: SQL status: BEGIN in 0.221 seconds
[0m20:44:39.410912 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:44:39.411949 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:44:39.422919 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.010 seconds
[0m20:44:39.425876 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:44:39.427873 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:44:39.443856 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.444854 [debug] [MainThread]: On master: BEGIN
[0m20:44:39.445817 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:44:39.665188 [debug] [MainThread]: SQL status: BEGIN in 0.219 seconds
[0m20:44:39.667180 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.668195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:44:39.711938 [debug] [MainThread]: SQL status: SELECT 8 in 0.042 seconds
[0m20:44:39.718113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ef0718-e1db-4a3b-96c2-428f58103d8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EAA435E10>]}
[0m20:44:39.719111 [debug] [MainThread]: On master: ROLLBACK
[0m20:44:39.720111 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.721481 [debug] [MainThread]: On master: BEGIN
[0m20:44:39.723483 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:44:39.724699 [debug] [MainThread]: On master: COMMIT
[0m20:44:39.725240 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:39.727069 [debug] [MainThread]: On master: COMMIT
[0m20:44:39.728683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:39.728683 [debug] [MainThread]: On master: Close
[0m20:44:39.739509 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:44:39.741274 [info ] [Thread-1 (]: 1 of 8 START test source_empty_string_raw_tables_med_name ...................... [RUN]
[0m20:44:39.743785 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4'
[0m20:44:39.744324 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:44:39.770297 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m20:44:39.776011 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:44:39.811590 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m20:44:39.815588 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m20:44:39.816765 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: BEGIN
[0m20:44:39.818636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:44:40.056752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.239 seconds
[0m20:44:40.059211 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m20:44:40.060207 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
        SELECT name
        FROM "propharma"."public"."medicines"
        WHERE TRIM(name) = ''

      
    ) dbt_internal_test
[0m20:44:40.064652 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:40.072365 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: ROLLBACK
[0m20:44:40.074389 [debug] [Thread-1 (]: On test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4: Close
[0m20:44:40.076406 [info ] [Thread-1 (]: 1 of 8 PASS source_empty_string_raw_tables_med_name ............................ [[32mPASS[0m in 0.33s]
[0m20:44:40.079423 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:44:40.081417 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:44:40.083780 [info ] [Thread-1 (]: 2 of 8 START test source_not_null_raw_tables_inv_inventory_id .................. [RUN]
[0m20:44:40.086220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m20:44:40.088579 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:44:40.102929 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m20:44:40.106980 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:44:40.113451 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m20:44:40.118800 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m20:44:40.120856 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: BEGIN
[0m20:44:40.122239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:40.370269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.247 seconds
[0m20:44:40.371274 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m20:44:40.372273 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select inventory_id
from "propharma"."public"."inventory"
where inventory_id is null



      
    ) dbt_internal_test
[0m20:44:40.376819 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:40.379994 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: ROLLBACK
[0m20:44:40.381002 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51: Close
[0m20:44:40.383018 [info ] [Thread-1 (]: 2 of 8 PASS source_not_null_raw_tables_inv_inventory_id ........................ [[32mPASS[0m in 0.30s]
[0m20:44:40.386031 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:44:40.387029 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:44:40.389023 [info ] [Thread-1 (]: 3 of 8 START test source_not_null_raw_tables_med_medicine_id ................... [RUN]
[0m20:44:40.391159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m20:44:40.394149 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:44:40.402127 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m20:44:40.405609 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:44:40.412223 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m20:44:40.416279 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m20:44:40.417291 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: BEGIN
[0m20:44:40.418299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:40.654438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.236 seconds
[0m20:44:40.656682 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m20:44:40.659384 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select medicine_id
from "propharma"."public"."medicines"
where medicine_id is null



      
    ) dbt_internal_test
[0m20:44:40.662764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:40.666698 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: ROLLBACK
[0m20:44:40.668764 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa: Close
[0m20:44:40.669776 [info ] [Thread-1 (]: 3 of 8 PASS source_not_null_raw_tables_med_medicine_id ......................... [[32mPASS[0m in 0.28s]
[0m20:44:40.673637 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:44:40.674980 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:44:40.677389 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_raw_tables_med_name .......................... [RUN]
[0m20:44:40.680386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m20:44:40.682381 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:44:40.691196 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m20:44:40.694870 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:44:40.700853 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m20:44:40.703845 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m20:44:40.706330 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: BEGIN
[0m20:44:40.708461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:40.949777 [debug] [Thread-1 (]: SQL status: BEGIN in 0.241 seconds
[0m20:44:40.951779 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m20:44:40.952895 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select name
from "propharma"."public"."medicines"
where name is null



      
    ) dbt_internal_test
[0m20:44:40.959062 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m20:44:40.963507 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: ROLLBACK
[0m20:44:40.965829 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_med_name.01052fa279: Close
[0m20:44:40.968829 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_raw_tables_med_name ................................ [[32mPASS[0m in 0.29s]
[0m20:44:40.971821 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:44:40.974328 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:44:40.976322 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_raw_tables_pat_patient_id .................... [RUN]
[0m20:44:40.980311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m20:44:40.982306 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:44:41.000114 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m20:44:41.006869 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:44:41.089156 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m20:44:41.093205 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m20:44:41.095242 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: BEGIN
[0m20:44:41.097643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:41.335490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.238 seconds
[0m20:44:41.336500 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m20:44:41.338521 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "propharma"."public"."patients"
where patient_id is null



      
    ) dbt_internal_test
[0m20:44:41.342613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:41.345575 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: ROLLBACK
[0m20:44:41.347567 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d: Close
[0m20:44:41.350071 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_raw_tables_pat_patient_id .......................... [[32mPASS[0m in 0.37s]
[0m20:44:41.353069 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:44:41.355063 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:44:41.357503 [info ] [Thread-1 (]: 6 of 8 START test source_not_null_raw_tables_pre_prescription_id ............... [RUN]
[0m20:44:41.359961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m20:44:41.361350 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:44:41.369886 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m20:44:41.373365 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:44:41.380023 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m20:44:41.383979 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m20:44:41.384976 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: BEGIN
[0m20:44:41.385976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:41.603760 [debug] [Thread-1 (]: SQL status: BEGIN in 0.218 seconds
[0m20:44:41.605784 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m20:44:41.606843 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select prescription_id
from "propharma"."public"."prescriptions"
where prescription_id is null



      
    ) dbt_internal_test
[0m20:44:41.611024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:41.614262 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: ROLLBACK
[0m20:44:41.615266 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d: Close
[0m20:44:41.617414 [info ] [Thread-1 (]: 6 of 8 PASS source_not_null_raw_tables_pre_prescription_id ..................... [[32mPASS[0m in 0.26s]
[0m20:44:41.620640 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:44:41.621637 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:44:41.623632 [info ] [Thread-1 (]: 7 of 8 START test source_not_null_raw_tables_sal_sale_id ....................... [RUN]
[0m20:44:41.624766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m20:44:41.626766 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:44:41.634744 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m20:44:41.639131 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:44:41.647639 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m20:44:41.650721 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m20:44:41.652771 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: BEGIN
[0m20:44:41.653809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:41.877653 [debug] [Thread-1 (]: SQL status: BEGIN in 0.224 seconds
[0m20:44:41.879166 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m20:44:41.880416 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_id
from "propharma"."public"."sales"
where sale_id is null



      
    ) dbt_internal_test
[0m20:44:41.884458 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:41.888438 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: ROLLBACK
[0m20:44:41.889432 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e: Close
[0m20:44:41.891912 [info ] [Thread-1 (]: 7 of 8 PASS source_not_null_raw_tables_sal_sale_id ............................. [[32mPASS[0m in 0.27s]
[0m20:44:41.894751 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:44:41.895768 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:44:41.897235 [info ] [Thread-1 (]: 8 of 8 START test source_not_null_raw_tables_sup_supplier_id ................... [RUN]
[0m20:44:41.899693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m20:44:41.901710 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:44:41.910497 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m20:44:41.914436 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:44:41.920091 [debug] [Thread-1 (]: Writing runtime sql for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m20:44:41.923628 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m20:44:41.925381 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: BEGIN
[0m20:44:41.927097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:44:42.144368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.217 seconds
[0m20:44:42.145365 [debug] [Thread-1 (]: Using postgres connection "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m20:44:42.146362 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select supplier_id
from "propharma"."public"."suppliers"
where supplier_id is null



      
    ) dbt_internal_test
[0m20:44:42.151349 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m20:44:42.154341 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: ROLLBACK
[0m20:44:42.156336 [debug] [Thread-1 (]: On test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd: Close
[0m20:44:42.157333 [info ] [Thread-1 (]: 8 of 8 PASS source_not_null_raw_tables_sup_supplier_id ......................... [[32mPASS[0m in 0.26s]
[0m20:44:42.161251 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:44:42.164088 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:42.165680 [debug] [MainThread]: On master: BEGIN
[0m20:44:42.166681 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:44:42.387830 [debug] [MainThread]: SQL status: BEGIN in 0.221 seconds
[0m20:44:42.389108 [debug] [MainThread]: On master: COMMIT
[0m20:44:42.390339 [debug] [MainThread]: Using postgres connection "master"
[0m20:44:42.391858 [debug] [MainThread]: On master: COMMIT
[0m20:44:42.392873 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:44:42.393900 [debug] [MainThread]: On master: Close
[0m20:44:42.395415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:44:42.396488 [debug] [MainThread]: Connection 'list_propharma_public' was properly closed.
[0m20:44:42.397618 [debug] [MainThread]: Connection 'test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd' was properly closed.
[0m20:44:42.399618 [info ] [MainThread]: 
[0m20:44:42.401295 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m20:44:42.406689 [debug] [MainThread]: Command end result
[0m20:44:42.480425 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:44:42.486840 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:44:42.502809 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:44:42.503819 [info ] [MainThread]: 
[0m20:44:42.506588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:44:42.508493 [info ] [MainThread]: 
[0m20:44:42.510737 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m20:44:42.514435 [debug] [MainThread]: Command `dbt test` succeeded at 20:44:42.514435 after 6.84 seconds
[0m20:44:42.515431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA290F390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA290F350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018EA2BA9590>]}
[0m20:44:42.516429 [debug] [MainThread]: Flushing usage events
[0m20:44:43.871626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:04.126089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C0A3990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C107B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C1071D0>]}


============================== 20:45:04.134522 | 0e5d2cac-ec62-4615-931d-56bea66dd1aa ==============================
[0m20:45:04.134522 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:45:04.136533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m20:45:04.608751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C10CA50>]}
[0m20:45:04.728765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B528D07810>]}
[0m20:45:04.731758 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:45:05.609598 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:45:06.316642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:06.318636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:06.570810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52D604550>]}
[0m20:45:06.675823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52D474D10>]}
[0m20:45:06.677816 [info ] [MainThread]: Found 13 models, 1 snapshot, 1 seed, 8 data tests, 6 sources, 551 macros
[0m20:45:06.680250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C213910>]}
[0m20:45:06.689232 [info ] [MainThread]: 
[0m20:45:06.693791 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:06.697582 [info ] [MainThread]: 
[0m20:45:06.701816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:45:06.723444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_propharma_public'
[0m20:45:07.286426 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:45:07.288441 [debug] [ThreadPool]: On list_propharma_public: BEGIN
[0m20:45:07.289449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:07.611771 [debug] [ThreadPool]: SQL status: BEGIN in 0.322 seconds
[0m20:45:07.612768 [debug] [ThreadPool]: Using postgres connection "list_propharma_public"
[0m20:45:07.613765 [debug] [ThreadPool]: On list_propharma_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_public"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:45:07.626720 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.012 seconds
[0m20:45:07.630709 [debug] [ThreadPool]: On list_propharma_public: ROLLBACK
[0m20:45:07.632704 [debug] [ThreadPool]: On list_propharma_public: Close
[0m20:45:07.634699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_propharma_public, now list_propharma_snapshots)
[0m20:45:07.649139 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:45:07.651149 [debug] [ThreadPool]: On list_propharma_snapshots: BEGIN
[0m20:45:07.652153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:07.928157 [debug] [ThreadPool]: SQL status: BEGIN in 0.276 seconds
[0m20:45:07.930150 [debug] [ThreadPool]: Using postgres connection "list_propharma_snapshots"
[0m20:45:07.932145 [debug] [ThreadPool]: On list_propharma_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "list_propharma_snapshots"} */
select
      'propharma' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'propharma' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m20:45:07.943115 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.010 seconds
[0m20:45:07.946398 [debug] [ThreadPool]: On list_propharma_snapshots: ROLLBACK
[0m20:45:07.947407 [debug] [ThreadPool]: On list_propharma_snapshots: Close
[0m20:45:07.961424 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:07.962435 [debug] [MainThread]: On master: BEGIN
[0m20:45:07.963444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:08.209297 [debug] [MainThread]: SQL status: BEGIN in 0.245 seconds
[0m20:45:08.210470 [debug] [MainThread]: Using postgres connection "master"
[0m20:45:08.212613 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:45:08.257330 [debug] [MainThread]: SQL status: SELECT 8 in 0.044 seconds
[0m20:45:08.263362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e5d2cac-ec62-4615-931d-56bea66dd1aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52BA71390>]}
[0m20:45:08.264366 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:08.266380 [debug] [MainThread]: On master: Close
[0m20:45:08.278115 [debug] [Thread-1 (]: Began running node model.Propharma.date_spine
[0m20:45:08.280109 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.Propharma.date_spine'
[0m20:45:08.281106 [debug] [Thread-1 (]: Began compiling node model.Propharma.date_spine
[0m20:45:08.335271 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:45:08.336269 [debug] [Thread-1 (]: On model.Propharma.date_spine: BEGIN
[0m20:45:08.337266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:08.587117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.249 seconds
[0m20:45:08.589112 [debug] [Thread-1 (]: Using postgres connection "model.Propharma.date_spine"
[0m20:45:08.590109 [debug] [Thread-1 (]: On model.Propharma.date_spine: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "node_id": "model.Propharma.date_spine"} */


        select 
        ((cast('2025-05-25' as date))::date - (cast('2025-05-15' as date))::date)
    
[0m20:45:08.593693 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m20:45:08.625112 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.date_spine"
[0m20:45:08.628454 [debug] [Thread-1 (]: On model.Propharma.date_spine: ROLLBACK
[0m20:45:08.630882 [debug] [Thread-1 (]: On model.Propharma.date_spine: Close
[0m20:45:08.633874 [debug] [Thread-1 (]: Finished running node model.Propharma.date_spine
[0m20:45:08.636033 [debug] [Thread-1 (]: Began running node model.Propharma.stg_inventory
[0m20:45:08.637030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.date_spine, now model.Propharma.stg_inventory)
[0m20:45:08.639025 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_inventory
[0m20:45:08.648157 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_inventory"
[0m20:45:08.651524 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_inventory
[0m20:45:08.655072 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_inventory
[0m20:45:08.657067 [debug] [Thread-1 (]: Began running node model.Propharma.stg_medicines
[0m20:45:08.658065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_inventory, now model.Propharma.stg_medicines)
[0m20:45:08.660552 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_medicines
[0m20:45:08.669840 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_medicines"
[0m20:45:08.674118 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_medicines
[0m20:45:08.677111 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_medicines
[0m20:45:08.679106 [debug] [Thread-1 (]: Began running node model.Propharma.stg_patients
[0m20:45:08.681696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_medicines, now model.Propharma.stg_patients)
[0m20:45:08.682704 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_patients
[0m20:45:08.692402 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_patients"
[0m20:45:08.696591 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_patients
[0m20:45:08.698888 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_patients
[0m20:45:08.700372 [debug] [Thread-1 (]: Began running node model.Propharma.stg_prescriptions
[0m20:45:08.702384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_patients, now model.Propharma.stg_prescriptions)
[0m20:45:08.703617 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_prescriptions
[0m20:45:08.711183 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_prescriptions"
[0m20:45:08.714203 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_prescriptions
[0m20:45:08.717628 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_prescriptions
[0m20:45:08.718696 [debug] [Thread-1 (]: Began running node model.Propharma.stg_sales
[0m20:45:08.720708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_prescriptions, now model.Propharma.stg_sales)
[0m20:45:08.721873 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_sales
[0m20:45:08.728278 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_sales"
[0m20:45:08.732138 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_sales
[0m20:45:08.735239 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_sales
[0m20:45:08.736265 [debug] [Thread-1 (]: Began running node model.Propharma.stg_suppliers
[0m20:45:08.738272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_sales, now model.Propharma.stg_suppliers)
[0m20:45:08.739302 [debug] [Thread-1 (]: Began compiling node model.Propharma.stg_suppliers
[0m20:45:08.745350 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.stg_suppliers"
[0m20:45:08.748513 [debug] [Thread-1 (]: Began executing node model.Propharma.stg_suppliers
[0m20:45:08.751761 [debug] [Thread-1 (]: Finished running node model.Propharma.stg_suppliers
[0m20:45:08.752757 [debug] [Thread-1 (]: Began running node seed.Propharma.sample_data
[0m20:45:08.754752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.stg_suppliers, now seed.Propharma.sample_data)
[0m20:45:08.755749 [debug] [Thread-1 (]: Began compiling node seed.Propharma.sample_data
[0m20:45:08.760735 [debug] [Thread-1 (]: Began executing node seed.Propharma.sample_data
[0m20:45:08.761733 [debug] [Thread-1 (]: Finished running node seed.Propharma.sample_data
[0m20:45:08.763728 [debug] [Thread-1 (]: Began running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:45:08.765750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.Propharma.sample_data, now test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4)
[0m20:45:08.766754 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:45:08.781658 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4"
[0m20:45:08.786673 [debug] [Thread-1 (]: Began executing node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:45:08.790663 [debug] [Thread-1 (]: Finished running node test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4
[0m20:45:08.792663 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:45:08.794658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_empty_string_raw_tables_med_name.8592fbfff4, now test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51)
[0m20:45:08.796653 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:45:08.821203 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51"
[0m20:45:08.826881 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:45:08.828875 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51
[0m20:45:08.832553 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:45:08.834548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_inv_inventory_id.ea7fecdc51, now test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa)
[0m20:45:08.836542 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:45:08.850794 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa"
[0m20:45:08.855782 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:45:08.858773 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa
[0m20:45:08.860768 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:45:08.862785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_medicine_id.7de6f18efa, now test.Propharma.source_not_null_raw_tables_med_name.01052fa279)
[0m20:45:08.864780 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:45:08.877882 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_med_name.01052fa279"
[0m20:45:08.881025 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:45:08.883025 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_med_name.01052fa279
[0m20:45:08.885019 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:45:08.887014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_med_name.01052fa279, now test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d)
[0m20:45:08.888011 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:45:08.896994 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d"
[0m20:45:08.901157 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:45:08.904155 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d
[0m20:45:08.906669 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:45:08.908664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pat_patient_id.da59dcb00d, now test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d)
[0m20:45:08.909662 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:45:08.921555 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d"
[0m20:45:08.924820 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:45:08.927908 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d
[0m20:45:08.929919 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:45:08.930925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_pre_prescription_id.52a4550e1d, now test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e)
[0m20:45:08.931948 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:45:08.940930 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e"
[0m20:45:08.943922 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:45:08.946948 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e
[0m20:45:08.947946 [debug] [Thread-1 (]: Began running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:45:08.948943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sal_sale_id.999d8ef35e, now test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd)
[0m20:45:08.951289 [debug] [Thread-1 (]: Began compiling node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:45:08.959856 [debug] [Thread-1 (]: Writing injected SQL for node "test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd"
[0m20:45:08.963329 [debug] [Thread-1 (]: Began executing node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:45:08.965329 [debug] [Thread-1 (]: Finished running node test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd
[0m20:45:08.967323 [debug] [Thread-1 (]: Began running node model.Propharma.expired_med_count_in_days
[0m20:45:08.968320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Propharma.source_not_null_raw_tables_sup_supplier_id.3c47983bfd, now model.Propharma.expired_med_count_in_days)
[0m20:45:08.971722 [debug] [Thread-1 (]: Began compiling node model.Propharma.expired_med_count_in_days
[0m20:45:08.985685 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.expired_med_count_in_days"
[0m20:45:08.989674 [debug] [Thread-1 (]: Began executing node model.Propharma.expired_med_count_in_days
[0m20:45:08.991673 [debug] [Thread-1 (]: Finished running node model.Propharma.expired_med_count_in_days
[0m20:45:08.992670 [debug] [Thread-1 (]: Began running node model.Propharma.mart_expired_drugs
[0m20:45:08.994665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.expired_med_count_in_days, now model.Propharma.mart_expired_drugs)
[0m20:45:08.995662 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_expired_drugs
[0m20:45:09.004931 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_expired_drugs"
[0m20:45:09.008525 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_expired_drugs
[0m20:45:09.011634 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_expired_drugs
[0m20:45:09.012882 [debug] [Thread-1 (]: Began running node model.Propharma.mart_inventory_status
[0m20:45:09.013889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_expired_drugs, now model.Propharma.mart_inventory_status)
[0m20:45:09.014895 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_inventory_status
[0m20:45:09.022765 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_inventory_status"
[0m20:45:09.027248 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_inventory_status
[0m20:45:09.029249 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_inventory_status
[0m20:45:09.031243 [debug] [Thread-1 (]: Began running node snapshot.Propharma.snapshot_prescriptions
[0m20:45:09.032240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_inventory_status, now snapshot.Propharma.snapshot_prescriptions)
[0m20:45:09.034236 [debug] [Thread-1 (]: Began compiling node snapshot.Propharma.snapshot_prescriptions
[0m20:45:09.041217 [debug] [Thread-1 (]: Began executing node snapshot.Propharma.snapshot_prescriptions
[0m20:45:09.043604 [debug] [Thread-1 (]: Finished running node snapshot.Propharma.snapshot_prescriptions
[0m20:45:09.044910 [debug] [Thread-1 (]: Began running node model.Propharma.mart_sales_summary
[0m20:45:09.047044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.Propharma.snapshot_prescriptions, now model.Propharma.mart_sales_summary)
[0m20:45:09.048051 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_sales_summary
[0m20:45:09.061335 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_sales_summary"
[0m20:45:09.064807 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_sales_summary
[0m20:45:09.066821 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_sales_summary
[0m20:45:09.067825 [debug] [Thread-1 (]: Began running node model.Propharma.mart_top_customers
[0m20:45:09.070281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_sales_summary, now model.Propharma.mart_top_customers)
[0m20:45:09.071286 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_top_customers
[0m20:45:09.078313 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_top_customers"
[0m20:45:09.081370 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_top_customers
[0m20:45:09.084471 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_top_customers
[0m20:45:09.086487 [debug] [Thread-1 (]: Began running node model.Propharma.mart_invoice
[0m20:45:09.087493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Propharma.mart_top_customers, now model.Propharma.mart_invoice)
[0m20:45:09.088499 [debug] [Thread-1 (]: Began compiling node model.Propharma.mart_invoice
[0m20:45:09.096846 [debug] [Thread-1 (]: Writing injected SQL for node "model.Propharma.mart_invoice"
[0m20:45:09.100039 [debug] [Thread-1 (]: Began executing node model.Propharma.mart_invoice
[0m20:45:09.102034 [debug] [Thread-1 (]: Finished running node model.Propharma.mart_invoice
[0m20:45:09.104135 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:09.105138 [debug] [MainThread]: Connection 'list_propharma_snapshots' was properly closed.
[0m20:45:09.106138 [debug] [MainThread]: Connection 'model.Propharma.mart_invoice' was properly closed.
[0m20:45:09.114809 [debug] [MainThread]: Command end result
[0m20:45:09.472436 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:45:09.483905 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:45:09.506853 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\anisin06\Downloads\Propharma\target\run_results.json
[0m20:45:09.519303 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m20:45:09.520513 [info ] [MainThread]: Building catalog
[0m20:45:09.543859 [debug] [ThreadPool]: Acquiring new postgres connection 'propharma.information_schema'
[0m20:45:09.560763 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m20:45:09.561776 [debug] [ThreadPool]: On propharma.information_schema: BEGIN
[0m20:45:09.562905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:09.805672 [debug] [ThreadPool]: SQL status: BEGIN in 0.242 seconds
[0m20:45:09.807185 [debug] [ThreadPool]: Using postgres connection "propharma.information_schema"
[0m20:45:09.808201 [debug] [ThreadPool]: On propharma.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Propharma", "target_name": "dev", "connection_name": "propharma.information_schema"} */

    
    

    select
        'propharma' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sample_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('patients')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('expired_med_count_in_days')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('suppliers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patients')) or (upper(sch.nspname) = upper('snapshots') and
           upper(tbl.relname) = upper('snapshot_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_prescriptions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_invoice')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_inventory')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medicines')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_inventory_status')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_sales_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_expired_drugs')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m20:45:09.824372 [debug] [ThreadPool]: SQL status: SELECT 103 in 0.015 seconds
[0m20:45:09.839298 [debug] [ThreadPool]: On propharma.information_schema: ROLLBACK
[0m20:45:09.841289 [debug] [ThreadPool]: On propharma.information_schema: Close
[0m20:45:09.875380 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m20:45:09.943316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\anisin06\Downloads\Propharma\target\manifest.json
[0m20:45:09.950405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\anisin06\Downloads\Propharma\target\semantic_manifest.json
[0m20:45:09.951440 [info ] [MainThread]: Catalog written to C:\Users\anisin06\Downloads\Propharma\target\catalog.json
[0m20:45:09.955432 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:45:09.954432 after 6.12 seconds
[0m20:45:09.956400 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:45:09.957425 [debug] [MainThread]: Connection 'propharma.information_schema' was properly closed.
[0m20:45:09.958408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C106D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C106650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B52C1067D0>]}
[0m20:45:09.959418 [debug] [MainThread]: Flushing usage events
[0m20:45:11.213129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:45:23.141593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28BC61E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28BC62010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28BC62950>]}


============================== 20:45:23.152563 | 727687ac-6e7f-436f-be57-e2d3e53e312c ==============================
[0m20:45:23.152563 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:45:23.154981 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\anisin06\\Downloads\\Propharma', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\anisin06\\Downloads\\Propharma\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:45:23.694070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '727687ac-6e7f-436f-be57-e2d3e53e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B28BC68950>]}
[0m20:45:23.838861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '727687ac-6e7f-436f-be57-e2d3e53e312c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2888974D0>]}
